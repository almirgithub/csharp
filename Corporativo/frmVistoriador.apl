.head 0 +  Application Description: **************************************************************************************
Projeto Divisão dos Sistemas em APL
Leandro Neves - 05.10.2005
*************************************************************************************
.head 1 -  Outline Version - 4.0.28
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000001F0100 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730E6672
0080: 6D566973746F7269 61646F72
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: Tela_Corporativo.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 3 -  Enumerations
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 1390972424
0000: 2200000013000000 0000000000000000 020000010000001E 030000D019000000
0020: 01FE00FF03
.enddata
.head 2 +  Internal Functions
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 1810728310
0000: 840400002F020000 0000000000000000 0200000700FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666FC2003C00 000A630051434B31
0040: 47657261006C0202 00001100001E0004 0000C20003000000 FF7F048300190000
0060: 00F001000000FF1F 1D0000AC00190001 FD00FF0736000000 196B000100FFFFC1
0080: 4F00000019DA0001 00FF7F68B0000000 0400F4020000FF1F 6C0000AC00040002
00A0: FD00FF0770000000 046B000200FFFFC1 7400000004DA0002 00FF7F78B0000000
00C0: 0400F60200FF1F7C 0000AC00040002FD 00FF17800000046B 000200FFFFC18400
00E0: 000004DA000200FF 7F88B00000000400 F60200FF1F8C0000 AC00190001FD00FF
0100: 07A5000000196B00 0100FFFFC1BE0000 0004DA000200FF7F 0180803E00000001
0120: 0070000E63514340 6F6E7461696E7200 AA00000005000000 6F0400E801020000
0140: FFC18001000000BF 04190019000101FA 00007F80F2010000 0F08000000961900
0160: 0100FE00FF832100 000004B5000200FF FF60250000001900 ED0100FF3F018064
0180: 0800000200380863 514D44C049400000 0002DE0004DA0002 00FF7F04B3000400
01A0: F60200FF5F011D32 000003000C1C6351 466F72406D465450 400000F602009619
01C0: 000100FE00FF9B19 0004B5000200FFFF 9801801D0004E100 1063510F54616273
01E0: 2046747040000002 7B00194B00010000 FFFFCD190004DA00 0200FF7F01C88004
0200: 00000570000D6351 43006865636B426F 7822A00000000100 00B70400F60200FF
0220: 1F01800403000600 0000060063446164 6F732200D1000100 005B040002FB00FF
0240: 0F
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field: cQCK1MultilineText
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 -  Application Actions
.head 1 +  Form Window: frmVistoriador
.data INHERITPROPS
0000: 0100
.enddata
.head 2 -  Class: cQCK1Form
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Vistoriador
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left: 25.35"
.head 4 -  Top: 1.865"
.head 4 -  Width:  10.45"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.833"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: { 
   Alteração: 08/10/2018 - afs 
   	Permitir que o F2 do campo setor ficasse liberado para localização do mesmo 
   Alteração: 12/12/2018 - afs 
   	Permitir mostrar o cpf do vistoriador   
  Alteração: 24-08-2021 - afs 
	Foram criados duas novas variáveis para dividir o campo observação
}
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfnMatricula
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.388"
.head 6 -  Top: 0.281"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sTextoStatusBar = 'Matrícula do Vistoriador'
.head 6 -  Set _sTipoMsgNulo = 'PADRAO'
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _sNomeParaMsgs = 'Matrícula'
.head 6 -  Set _bCompChaveGeradoPeloSistema = FALSE
.head 6 -  Set _bComponenteChave = TRUE
.head 6 -  Set _bDisparaConsultaEmValidate = TRUE
.head 6 -  Set _bCompChaveOpcionalParaPesquisa = TRUE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  Set _bPermiteNulos = FALSE
.head 6 -  Set _sMsgNulo = ''
.head 6 -  !
.head 6 -  Set _sNomeParaMsgs = 'Matrícula do Vistoriador'
.head 6 -  ! ! Procedure para popular a tabela na consulta de F2
.head 6 -  Set _sConsultaFrmOpcoesCampo = 'exec VistoriadorMatriculaNomeS @sSituacao = "T"'
.head 6 -  Set _sConsultaFrmOpcoesSQLOuSP = 'SP'
.head 6 -  ! ! Se for setada a próxima variável, então será habilitado a pesquisa aproximada por nome
.head 6 -  Set _sConsultaFrmOpcoesColunaOuParam = '@sNome'
.head 6 -  Set _bNaoTemDependentes = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  Frame
.head 4 -  Resource Id: 40383
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.138"
.head 5 -  Top: 0.115"
.head 5 -  Width:  10.05"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.958"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dfsCpf
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 746162566973746F 72696100000000
.enddata
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 7.588"
.head 6 -  Top: 0.281"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _sTextoStatusBar = 'CPF do Vistoriador'
.head 6 -  Set _sNomeParaMsgs = 'CPF do Vistoriador'
.head 6 -  Set _sTipoMsgValidacao = 'ESPECIFICA'
.head 6 -  Set _sMsgValidacao = 'Número de CPF inválido!'
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  ! On SAM_KillFocus
.head 6 -  Call SalFmtSetInputMask( hWndItem, '999.999.999-99' )
.head 5 +  ! On UDM_ValidaCampo 
.head 6 +  If NOT SalIsNull(  frmVistoriador.dfsCpf  )
.head 7 -  ! If ValidaCpf( frmVistoriador.dfsCpf )
.head 7 +  If DetranCPF( ( frmVistoriador.dfsCpf ) )
.head 8 -  Call SalFmtSetInputMask( hWndItem, '999.999.999-99' )
.head 8 -  Return TRUE
.head 7 +  Else 
.head 8 -  ! Call SalClearField(  hWndItem )   MPSCPF
.head 8 -  Return FALSE
.head 6 +  Else 
.head 7 -  Call SalFmtSetInputMask( hWndItem, '99999999999999' )
.head 7 -  Return FALSE
.head 5 +  On UDM_ValidaCampo
.head 6 +  If NOT SalIsNull(dfsCpf)
.head 7 -  Set frmVistoriador.dfsCpf = SalStrTrimX(frmVistoriador.dfsCpf)
.head 7 +  If SalStrLength(frmVistoriador.dfsCpf)>0
.head 8 +  If ValidaCpf( frmVistoriador.dfsCpf ) 
.head 9 -  ! Call SalFmtSetInputMask( hWndItem, '999.999.999-99' )    SalIsNull( frmVistoriador.dfsCpf )
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  ! Call SalClearField(  hWndItem )
.head 9 -  ! Call SalMessageBox( 'O cpf informado está inválido', 'Atenção', MB_Ok |MB_IconInformation )
.head 9 -  Return FALSE
.head 7 +  Else If SalStrLength(frmVistoriador.dfsCpf)=0
.head 8 -  ! Call SalFmtSetInputMask( hWndItem, '99999999999999' )
.head 8 -  Return VALIDATE_Ok
.head 8 -  ! Return FALSE
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 5 +  On MSG_FetchRefreshDerivados
.head 6 -  Call SalSendClassMessage(MSG_FetchRefreshDerivados,wParam,lParam)
.head 6 -  Set frmVistoriador.dfsCpf = SalStrTrimX(frmVistoriador.dfsCpf)
.head 6 +  If SalIsNull(dfsCpf)
.head 7 -  Call SalEnableWindow( dfsCpf )
.head 6 +  Else
.head 7 -  Call SalFmtSetInputMask( hWndItem, '999.999.999-99' )
.head 7 -  Call SalDisableWindow(dfsCpf ) 
.head 3 +  Data Field: dfsLogin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.388"
.head 6 -  Top: 0.573"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: Lowercase
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Sigla do usuário do sistema'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  !
.head 6 -  Set _bComponenteChave = FALSE
.head 6 -  Set _bDisparaConsultaEmValidate = FALSE
.head 6 -  Set _bCompChaveOpcionalParaPesquisa = TRUE
.head 6 -  Set _bCompChaveGeradoPeloSistema = TRUE
.head 6 -  !
.head 6 -  Set _sConsultaFrmOpcoesSQLOuSP = 'SP'
.head 6 -  Set _sConsultaFrmOpcoesColunaOuParam = '@Nome'
.head 6 -  Set _sConsultaFrmOpcoesCampo = 'exec UsuarioS_codnome'
.head 6 -  !
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Validate
.head 6 -  Call SalSendClassMessage( SAM_Validate, wParam, lParam )
.head 6 +  If SalIsNull( dfsNome ) OR dfsNome = ''
.head 7 -  Call SalSendMsg( dfsNome, MSG_Habilita1, 0, 0)
.head 6 +  Else
.head 7 -  Call SalSendMsg( dfsNome, MSG_Desabilita1, 0, 0)
.head 3 +  Pushbutton: pbPesquisar
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Pesquisar
.head 4 -  Window Location and Size
.head 5 -  Left: 9.15"
.head 5 -  Top: 0.229"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Efetua a pesquisa no banco de dados'
.head 6 -  Set _sTipoComando = 'Pesquisa'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Call SalPostMsg( hWndForm, UDM_AposPesquisa, 0, 0 )
.head 3 -  !
.head 3 -  !
.head 3 +  Check Box: cbRealizaVistoriaFora
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 74616253656C6563 616F0000
.enddata
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1CheckBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Realiza Vistoria Fora do DETRAN
.head 4 -  Window Location and Size
.head 5 -  Left: 2.563"
.head 5 -  Top: 0.281"
.head 5 -  Width:  3.125"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Marque quando o victoriador realiza vistoria fora do DETRAN'
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sNomeCampoFonte = 'dfsRealizaVistoriaFora'
.head 6 -  Set _sValorCHECKED = 'S'
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Set _sValorNOTCHECKED = 'N'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  !
.head 3 -  Background Text: Login:
.head 4 -  Resource Id: 40387
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.488"
.head 5 -  Top: 0.594"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Matrícula:
.head 4 -  Resource Id: 40386
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.388"
.head 5 -  Top: 0.302"
.head 5 -  Width:  0.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfsNome
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 50
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.513"
.head 6 -  Top: 0.573"
.head 6 -  Width:  6.475"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Uppercase
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Nome do usuário'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bNuncaHabilitado = TRUE
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  !
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sNomeParaMsgs = 'Nome'
.head 6 -  Set _bÉDependente = TRUE
.head 6 -  Set _sCamposResponsaveis[0] = 'dfsLogin'
.head 6 -  Set _sConsultaDescrição = 'exec dbvcen..UsuarioS_nome @Cod = :frmVistoriador.dfsLogin'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  !
.head 3 -  Background Text: Setor:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 746162566973746F 72696100000000
.enddata
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.head 4 -  Resource Id: 40385
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.625"
.head 5 -  Top: 0.896"
.head 5 -  Width:  0.725"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfnSetor
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 746162566973746F 72696100000000
.enddata
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.388"
.head 6 -  Top: 0.875"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: 000000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: 99999-9
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Número do setor'
.head 6 -  Set _sNomeParaMsgs = 'Setor'
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sConsultaFrmOpcoesSQLOuSP = 'SP'
.head 6 -  Set _sConsultaFrmOpcoesColunaOuParam = '@Descricao'
.head 6 -  Set _sConsultaFrmOpcoesCampo = 'exec SetorS_codreddesc'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Data Field: dfsSetor
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 746162566973746F 72696100000000
.enddata
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.513"
.head 6 -  Top: 0.875"
.head 6 -  Width:  6.475"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _bÉCampoDescrição = TRUE
.head 6 -  Set _bÉDependente = TRUE
.head 6 -  Set _sCamposResponsaveis[0] = 'dfnSetor'
.head 6 -  Set _sConsultaDescrição = 'exec SetorS_desc @CodReduzido = :frmVistoriador.dfnSetor'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  !
.head 3 -  Background Text: Situação:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 746162566973746F 7269610000
.enddata
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.head 4 -  Resource Id: 40384
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.538"
.head 5 -  Top: 1.229"
.head 5 -  Width:  0.813"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Combo Box: cmbSituacao
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 746162566973746F 7269610000
.enddata
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1ComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.388"
.head 5 -  Top: 1.188"
.head 5 -  Width:  1.675"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.938"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sRefresh = 'Create'
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _sTextoStatusBar = 'Situação'
.head 6 -  Set _sNomeParaMsgs = 'Situação'
.head 6 -  Set _sNomeCampoCodigo = 'dfsSituacao'
.head 6 -  Set _sConsultaBD = 'exec dbvcen..SituacaoS'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  !
.head 3 -  Background Text: Qtd. Vistoria Dia:
.head 4 -  Resource Id: 58900
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.288"
.head 5 -  Top: 1.229"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfnQtdVistoriaDia
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.788"
.head 6 -  Top: 1.188"
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Uppercase
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _sNomeParaMsgs = 'Quantidade Vistoria Dia'
.head 6 -  Set _sTextoStatusBar = 'Quantidade Vistoria Dia'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  !
.head 3 -  Background Text: Qtd. Vistoria Dia Fora:
.head 4 -  Resource Id: 62039
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.488"
.head 5 -  Top: 1.229"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfnQtdVistoriaDiaFora
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 7.388"
.head 6 -  Top: 1.188"
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Uppercase
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _sNomeParaMsgs = 'Quantidade Vistoria Fora'
.head 6 -  Set _sTextoStatusBar = 'Quantidade Vistoria Fora'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  !
.head 3 -  Background Text: Observação:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 746162566973746F 7269610000
.enddata
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.head 4 -  Resource Id: 5146
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top: 1.729"
.head 5 -  Width:  1.063"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Multiline Field: mlObservacao
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1MultilineText
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1000
.head 5 -  String Type: Long String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left: 1.388"
.head 6 -  Top: 1.656"
.head 6 -  Width:  8.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Observação'
.head 6 -  Set _sNomeParaMsgs = 'Observação'
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_KillFocus
.head 6 +  If NOT SalIsNull(mlObservacao)
.head 7 -  Set Observacao01 = SalStrLeftX( mlObservacao, 250 )
.head 7 -  Set Observacao02 = SalStrMidX( mlObservacao, 250, 250)
.head 7 -  Set Observacao03 = SalStrMidX( mlObservacao, 500, 250)
.head 7 -  Set Observacao04 = SalStrMidX( mlObservacao, 750, 250)
.head 3 -  Background Text: CPF:
.head 4 -  Resource Id: 6076
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 7.163"
.head 5 -  Top: 0.344"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  ! - - Botões
.head 3 +  Pushbutton: pbAnterior
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: A&nterior
.head 4 -  Window Location and Size
.head 5 -  Left: 9.15"
.head 5 -  Top: 0.521"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Move para o registro anterior'
.head 6 -  Set _sTipoComando = 'Anterior'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  ! Call VerificaCpfBanco()
.head 6 -  Call SalPostMsg( hWndForm, UDM_AposPesquisa, 0, 0 )
.head 3 +  Pushbutton: pbProximo
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Próxi&mo
.head 4 -  Window Location and Size
.head 5 -  Left: 9.15"
.head 5 -  Top: 0.813"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Move para o proximo registro'
.head 6 -  Set _sTipoComando = 'Próximo'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  ! Call VerificaCpfBanco()
.head 6 -  Call SalPostMsg( hWndForm, UDM_AposPesquisa, 0, 0 )
.head 3 -  !
.head 3 +  Pushbutton: pbArquivar
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Arquivar
.head 4 -  Window Location and Size
.head 5 -  Left: 6.188"
.head 5 -  Top: 4.198"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  Set _sTextoStatusBar = 'Arquiva o registro corrente'
.head 6 -  Set _sTipoComando = 'Arquiva'
.head 6 -  Set _bValidaCamposNulos = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Call SalPostMsg( dfsCpf, UDM_ValidaCampo, 0, 0 )
.head 3 +  Pushbutton: pbLimpar
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Limpar
.head 4 -  Window Location and Size
.head 5 -  Left: 7.188"
.head 5 -  Top: 4.198"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Limpa os dados da tela'
.head 6 -  Set _sTipoComando = 'Limpa'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Pushbutton: pbExcluir
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: E&xcluir
.head 4 -  Window Location and Size
.head 5 -  Left: 8.188"
.head 5 -  Top: 4.198"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  Set _sTextoStatusBar = 'Exclui o registro corrente'
.head 6 -  Set _sTipoComando = 'Remove'
.head 6 -  Set _bValidaCamposNulos = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Pushbutton: pbSair
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Sair
.head 4 -  Window Location and Size
.head 5 -  Left: 9.238"
.head 5 -  Top: 4.198"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Sai desta tela'
.head 6 -  Set _sTipoComando = 'Sai'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  ! - - Campos Auxiliares
.head 3 +  Data Field: dfsRealizaVistoriaFora
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.65"
.head 6 -  Top: 4.198"
.head 6 -  Width:  0.238"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  !
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bPermiteNulos = FALSE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  !
.head 6 -  Set _bVisivel = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Data Field: dfsSituacao
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.875"
.head 6 -  Top: 4.198"
.head 6 -  Width:  0.238"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = FALSE
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _sNomeParaMsgs = 'Situação'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  !
.head 3 +  Picture: picSemaforo
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1Form
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 4.198"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: VerificaCpf
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: pCpf
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If pCpf = '11111111111' OR pCpf = '22222222222' Or pCpf = '33333333333'
   OR pCpf = '44444444444' OR pCpf = '55555555555' OR pCpf = '66666666666'
   OR pCpf = '77777777777' OR pCpf = '88888888888' OR pCpf = '999999999996'
   OR pCpf = '00000000000'
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  Return TRUE
.head 3 +  Function: ValidaCpf
.head 4 -  Description: Valida dígitos verificadores de CPF.
Retorna 1 se OK, 0 se CPF inválido.
.head 4 +  Returns
.head 5 -  ! Number: nRetorno
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  ! Number: nCpf
.head 5 -  String: sCpfTela
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sCpf
.head 5 -  String: sInverso
.head 5 -  Number: nRetorno
.head 5 -  Number: nCpf
.head 5 -  Number: nDigito
.head 5 -  Number: nIndice
.head 5 -  Number: nPeso
.head 4 +  Actions
.head 5 -  Set nRetorno = 0
.head 5 +  ! If sCpfTela = '11111111111' OR sCpfTela = '22222222222' OR sCpfTela = '33333333333'
   OR sCpfTela = '44444444444' OR sCpfTela = '55555555555' OR sCpfTela = '66666666666'
   OR sCpfTela = '77777777777' OR sCpfTela = '88888888888' OR sCpfTela = '99999999999'
   OR sCpfTela = '00000000000'
.head 6 -  Return FALSE
.head 5 -  ! Verifica se foi preenchido com números iguais
.head 5 +  If NOT VerificaCpf(sCpfTela)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set nCpf = SalStrToNumber( sCpfTela )
.head 5 +  If nCpf = 0
.head 6 -  Return FALSE
.head 5 -  Set sCpf = SalStrMidX( SalNumberToStrX( 100000000000+nCpf, 0 ), 1, 11 )
.head 5 -  ! O CPF deve ter obrigatoriamente 11 dígitos
.head 5 +  If SalStrLength( sCpf ) != 11
.head 6 -  Return nRetorno
.head 5 -  Set nIndice = 0
.head 5 -  Set sInverso = ''
.head 5 -  ! Inverte o CPF para calcular o dígito
.head 5 +  While nIndice < 11
.head 6 -  Set sInverso = SalStrMidX( sCpf, nIndice, 1 ) || sInverso
.head 6 -  Set nIndice = nIndice + 1
.head 5 -  ! Calcula o segundo dígito verificador
.head 5 -  Set nDigito = 0
.head 5 -  Set nIndice = 2
.head 5 +  While nIndice < 11
.head 6 -  Set nDigito = nDigito + ( SalStrToNumber( SalStrMidX( sInverso, nIndice, 1 ) ) * nIndice )
.head 6 -  Set nIndice = nIndice + 1
.head 5 -  Set nDigito = ( 11 - SalNumberMod( nDigito, 11 ) )
.head 5 +  If nDigito > 9
.head 6 -  Set nDigito = 0
.head 5 +  If nDigito != SalStrToNumber( SalStrMidX( sInverso, 1, 1 ) )
.head 6 -  Return nRetorno
.head 5 -  ! Calcula o primeiro dígito verificador
.head 5 -  Set nDigito = 0
.head 5 -  Set nIndice = 1
.head 5 +  While nIndice < 11
.head 6 -  Set nDigito = nDigito + ( SalStrToNumber( SalStrMidX( sInverso, nIndice, 1 ) ) * ( nIndice + 1 ) )
.head 6 -  Set nIndice = nIndice + 1
.head 5 -  Set nDigito = ( 11 - SalNumberMod( nDigito, 11 ) )
.head 5 +  If nDigito > 9
.head 6 -  Set nDigito = 0
.head 5 +  If nDigito != SalStrToNumber( SalStrMidX( sInverso, 0, 1 ) )
.head 6 -  Return nRetorno
.head 5 -  ! O CPF é válido, retorna 1
.head 5 -  Set nRetorno = 1
.head 5 -  Return nRetorno
.head 3 +  Function: VerificaCpfBanco
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! If NOT SalIsNull(frmVistoriador.dfsLogin)
.head 6 -  ! If SalIsNull(frmVistoriador.dfsCpf)
.head 6 -  ! Consulta no cadastro do usuário
.head 6 +  If fMPSConnect( hwPesq )
.head 7 -  Call fMPSPrepareProc( hwPesq, 'Exec dbvcen..ConsultaCpfUsuarioS
		@sCodigo = :frmVistoriador.dfsLogin',':frmVistoriador.dfsCpf')
.head 7 -  Call SqlExecute( hwPesq )
.head 7 -  Call SqlFetchNext( hwPesq, lParam )
.head 7 -  Call SqlDisconnect( hwPesq )
.head 5 +  If fMPSConnect( hwPesq )
.head 6 -  Call fMPSPrepareProc( hwPesq, 'Exec dbvcen..ConsultaCpfUsuarioS
		@sCodigo = :frmVistoriador.dfsLogin,
		@sTipo = "U",
		@nMatric = :frmVistoriador.dfnMatricula',':frmVistoriador.dfsCpf')
.head 6 -  Call SqlExecute( hwPesq )
.head 6 -  Call SqlFetchNext( hwPesq, lParam )
.head 6 -  Call SqlDisconnect( hwPesq )
.head 5 +  If SalIsNull(frmVistoriador.dfsCpf)
.head 6 +  If fMPSConnect( hwPesq )
.head 7 -  Call fMPSPrepareProc( hwPesq, 'Exec dbvcen..ConsultaCpfUsuarioS
		@sCodigo = :frmVistoriador.dfsLogin,
		@sTipo = "V",
		@nMatric = :frmVistoriador.dfnMatricula',':frmVistoriador.dfsCpf')
.head 7 -  Call SqlExecute( hwPesq )
.head 7 -  Call SqlFetchNext( hwPesq, lParam )
.head 7 -  Call SqlDisconnect( hwPesq )
.head 7 +  If SalIsNull(frmVistoriador.dfsCpf)
.head 8 -  Call SalEnableWindow( dfsCpf )
.head 7 +  Else
.head 8 -  Call SalDisableWindow( dfsCpf )
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hwPesq
.head 3 -  String: Observacao01
.head 3 -  String: Observacao02
.head 3 -  String: Observacao03
.head 3 -  String: Observacao04
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set _nEstadoInicialForm = EF_Vazio
.head 4 -  Set _sTextoStatusBar = 'Tela de cadastro de Vistoriador'
.head 4 -  !
.head 4 -  ! Call SalStrSetBufferLength( mlObservacao, 3000 )
.head 4 -  Set _sCriacaoConexao = 'Default'
.head 4 -  Set _sComandoPesquisa = 'exec VistoriadorS 	@nMatricula = :frmVistoriador.dfnMatricula, 
					@sUsuario = :frmVistoriador.dfsLogin,
					@Cpf = :frmVistoriador.dfsCpf'
.head 4 -  Set _sListaINTOPesquisa =
'			:frmVistoriador.dfnMatricula,
			:frmVistoriador.dfsNome,
			:frmVistoriador.dfnSetor,
			:frmVistoriador.dfsSetor,
			:frmVistoriador.dfsSituacao,
			:frmVistoriador.dfnQtdVistoriaDia,
			:frmVistoriador.dfnQtdVistoriaDiaFora,
			:frmVistoriador.dfsRealizaVistoriaFora,
			:frmVistoriador.dfsLogin,
			:frmVistoriador.Observacao01,
			:frmVistoriador.Observacao02,
			:frmVistoriador.Observacao03,
			:frmVistoriador.Observacao04,
			:frmVistoriador.dfsCpf'
.head 4 -  ! ---------:frmVistoriador.mlObservacao          :frmVistoriador.mlObservacao2,
.head 4 -  Set _bLimpaTelaAposInclusao = FALSE
.head 4 -  Set _sComandoInclusao = '	exec VistoriadorI
			@nMatricula = :frmVistoriador.dfnMatricula,
			@sNome = :frmVistoriador.dfsNome,
			@nSetor = :frmVistoriador.dfnSetor,
			@sSituacao = :frmVistoriador.dfsSituacao,
			@nQtdVistoriaDia = :frmVistoriador.dfnQtdVistoriaDia,
			@nQtdVistoriaDiaFora = :frmVistoriador.dfnQtdVistoriaDiaFora,
			@sRealizaVistoriaFora = :frmVistoriador.dfsRealizaVistoriaFora,
			@sUsuario = :frmVistoriador.dfsLogin,
			@sObservacao = :frmVistoriador.Observacao01,
			@sObservacaoComp = :frmVistoriador.Observacao02,
			@sObservacaoComp03 = :frmVistoriador.Observacao03,
			@sObservacaoComp04 = :frmVistoriador.Observacao04,
			@sCpf = :frmVistoriador.dfsCpf'
.head 4 -  Set _sListaINTOInclusao = ''
.head 4 -  !
.head 4 -  Set _bLimpaTelaAposAtualizacao = FALSE
.head 4 -  Set _sComandoAtualizacao = 'exec VistoriadorA
			@nMatricula = :frmVistoriador.dfnMatricula,
			@sNome = :frmVistoriador.dfsNome,
			@nSetor = :frmVistoriador.dfnSetor,
			@sSituacao = :frmVistoriador.dfsSituacao,
			@nQtdVistoriaDia = :frmVistoriador.dfnQtdVistoriaDia,
			@nQtdVistoriaDiaFora = :frmVistoriador.dfnQtdVistoriaDiaFora,
			@sRealizaVistoriaFora = :frmVistoriador.dfsRealizaVistoriaFora,
			@sUsuario = :frmVistoriador.dfsLogin,			
			@sObservacao = :frmVistoriador.Observacao01,
			@sObservacaoComp = :frmVistoriador.Observacao02,
			@sObservacaoComp03 = :frmVistoriador.Observacao03,
			@sObservacaoComp04 = :frmVistoriador.Observacao04,
			@sCpf = :frmVistoriador.dfsCpf'
.head 4 -  Set _sListaINTOAtualizacao = ''
.head 4 -  !
.head 4 -  Set _bLimpaTelaAposRemocao = TRUE
.head 4 -  Set _sComandoRemocao = 'exec VistoriadorE @nMatricula = :frmVistoriador.dfnMatricula'
.head 4 -  Set _sListaINTORemocao = ''
.head 4 -  !
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call SalCenterWindow ( hWndForm )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendClassMessage( SAM_CreateComplete, wParam, lParam )
.head 4 -  !
.head 4 -  Call SalSendMsg( pbExcluir, MSG_Desabilita1, wParam, lParam )
.head 4 -  Call SalSendMsg( pbPesquisar, MSG_Habilita1, wParam, lParam )
.head 4 -  !
.head 4 +  If frmVistoriador.fObtemPermissao('frmVistoriador') = 1
.head 5 -  Call SalDisableWindow( pbArquivar )
.head 5 -  Call SalDisableWindow( pbExcluir )
.head 4 +  Else If frmVistoriador.fObtemPermissao('frmVistoriador') = 15
.head 5 -  Call SalEnableWindow( pbArquivar )
.head 5 -  Call SalEnableWindow( pbExcluir )
.head 4 -  !
.head 4 -  Call SalEnableWindow(dfsLogin)
.head 4 -  Call SalEnableWindow(dfsCpf)
.head 4 -  !
.head 4 -  Set Observacao01  = STRING_Null
.head 4 -  Set Observacao02  = STRING_Null
.head 4 -  Set Observacao03  = STRING_Null
.head 4 -  Set Observacao04  = STRING_Null
.head 4 -  !
.head 3 +  On UDM_AposPesquisa
.head 4 -  !
.head 4 -  ! Almir 12/12/2018
.head 4 -  ! Estou recuperando o cpf do vistoriador caso o mesmo
.head 4 -  ! esteja cadastrado na tabela de usuário
.head 4 -  ! ---------------------------------------------------------------------------- 
.head 4 +  ! If NOT SalIsNull(frmVistoriador.dfsLogin)
.head 5 +  ! If SalIsNull(frmVistoriador.dfsCpf)
.head 6 -  ! Call SqlImmediate( 'select CPF from Usuario where Cod = :frmVistoriador.dfsLogin  into :frmVistoriador.dfsCpf' )
.head 5 +  If fMPSConnect( hwPesq )
.head 6 -  Call fMPSPrepareProc( hwPesq, 'Exec dbvcen..ConsultaCpfUsuarioS
		@sCodigo = :frmVistoriador.dfsLogin,
		@sTipo = "U",
		@nMatric = :frmVistoriador.dfnMatricula',':frmVistoriador.dfsCpf')
.head 6 -  Call SqlExecute( hwPesq )
.head 6 -  Call SqlFetchNext( hwPesq, lParam )
.head 6 -  Call SqlDisconnect( hwPesq )
.head 4 +  ! If SalIsNull(frmVistoriador.dfsCpf)
.head 5 +  If fMPSConnect( hwPesq )
.head 6 -  Call fMPSPrepareProc( hwPesq, 'Exec dbvcen..ConsultaCpfUsuarioS
		@sCodigo = :frmVistoriador.dfsLogin,
		@sTipo = "V",
		@nMatric = :frmVistoriador.dfnMatricula',':frmVistoriador.dfsCpf')
.head 6 -  Call SqlExecute( hwPesq )
.head 6 -  Call SqlFetchNext( hwPesq, lParam )
.head 6 -  Call SqlDisconnect( hwPesq )
.head 6 +  If SalIsNull(frmVistoriador.dfsCpf)
.head 7 -  Call SalEnableWindow( dfsCpf )
.head 6 +  Else 
.head 7 -  Call SalDisableWindow( dfsCpf )
.head 4 +  ! Else
.head 5 -  ! Call SalFmtSetInputMask( frmVistoriador.dfsCpf, '999.999.999-99' )
.head 5 -  Call SalFmtSetInputMask( frmVistoriador.dfsCpf, '99999999999' )
.head 5 -  Call SalDisableWindow( dfsCpf )
.head 4 -  !
.head 4 -  !
.head 4 -  ! Set mlObservacao = RecuperaObs('dbvcen..Vistoriador','Observacao', 'Matricula = :frmVistoriador.dfnMatricula')
.head 4 +  ! If NOT SalIsNull( dfnMatricula )
.head 5 -  ! Call RecuperaObs() 
.head 5 -  ! Set dfsteste = SalStrMidX( mlObservacao, 1, 10 )
.head 5 -  Set mlObservacao2 = SalStrMidX( mlObservacao, 250,5 )
.head 4 -  ! Set mlObservacao = Observacao01 || Observacao02
.head 4 +  If Observacao01 != STRING_Null
.head 5 -  Set mlObservacao =Observacao01 || Observacao02 || Observacao03 || Observacao04
.head 4 +  Else
.head 5 -  Set mlObservacao = STRING_Null
.head 4 -  !
.head 4 +  If SalIsNull(frmVistoriador.dfsCpf)
.head 5 -  Call SalEnableWindow( dfsCpf )
.head 4 +  Else
.head 5 -  Call SalDisableWindow( dfsCpf )
.head 4 -  Return TRUE
.head 3 +  On UDM_AposInclusao
.head 4 -  Call SalSendClassMessage( UDM_AposInclusao, wParam, lParam )
.head 4 -  Call SalMessageBox( 'Arquivamento realizado com sucesso', 'Atenção', MB_Ok | MB_IconInformation )
.head 4 -  Call SalSendMsg( pbLimpar, SAM_Click,  wParam, lParam )
.head 3 +  On UDM_AntesAtualizacao
.head 4 +  If SalIsNull ( mlObservacao )
.head 5 -  Set Observacao01  = STRING_Null
.head 5 -  Set Observacao02  = STRING_Null
.head 5 -  Set Observacao03  = STRING_Null
.head 5 -  Set Observacao04  = STRING_Null
.head 4 -  Return TRUE
.head 3 +  On UDM_AposAtualizacao
.head 4 -  Call SalSendClassMessage( UDM_AposAtualizacao, wParam, lParam )
.head 4 -  Call SalMessageBox( 'Arquivamento realizado com sucesso', 'Atenção', MB_Ok | MB_IconInformation )
.head 4 -  Call SalSendMsg( pbLimpar, SAM_Click,  wParam, lParam )
.head 3 +  On UDM_AposRemocao
.head 4 -  Call SalSendClassMessage( UDM_AposInclusao, wParam, lParam )
.head 4 -  Call SalMessageBox( 'Exclusão realizada com sucesso', 'Atenção', MB_Ok | MB_IconInformation )
.head 4 -  Call SalSendMsg( pbLimpar, SAM_Click,  wParam, lParam )
.head 3 +  On MSG_Limpa
.head 4 -  Call SalSendClassMessage( MSG_Limpa, wParam, lParam )
.head 4 -  Call SalPostMsg( hWndForm, SAM_CreateComplete, wParam, lParam )
.head 0 -  
.head 0 -  



