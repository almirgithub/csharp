Application Description: **************************************************************************************
		Projeto Divisão dos Sistemas em APL
		Leandro Neves - 05.10.2005
		*************************************************************************************
	Outline Version - 4.0.28
	Design-time Settings
.data VIEWINFO
0000: 6F00000003000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000000D0100 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE2FFFFFFFFFFFF FF000000002B0300 0064020000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773136672
0080: 6D496D6167656D41 7373696E61747572 6100000180040001 00000000000000E9
00A0: 0000002C00000000 00000001000000FF FFFFFFFFFFFFFFF8 FFFFFFE2FFFFFF16
00C0: 0000001D00000042 0300001F02000000 0000000100000003 0000000F4170706C
00E0: 69636174696F6E49 74656D0757696E64 6F77731366726D49 6D6167656D417373
0100: 696E617475726100 000000
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left: -0.013"
			Top: 0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left: 4.15"
			Top: 1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left: 0.575"
			Top: 0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left: 6.388"
			Top: 0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		! File Include: Tela_Veiculo.apl
		! File Include: frmConsultaFotoVistoria.apl
		! File Include: AxisCameraControl.apl
		File Include: MxPEG_ActiveX ActiveX-Steuerelement-Modul.apl
		! File Include: qckwax.apl
		File Include: mimg.apl
		File Include: detran_funcoes.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: Use Parent
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
			Enumerations
		Resources
		Variables
.data RESOURCE 0 0 1 2801029132
0000: 2200000013000000 0000000000000000 0200000100000005 020000D019000000
0020: 01FE00FF03
.enddata
		Internal Functions
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 1443028049
0000: AC030000CA010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666FC2003C00 000A630051434B31
0040: 47657261006C0202 00001100001E0004 0000C20003000000 FF7F048300190000
0060: 00F001000000FF1F 1D0000AC00190001 FD00FF0736000000 196B000100FFFFC1
0080: 4F00000019DA0001 00FF7F68B0000000 0400F4020000FF1F 6C0000AC00040002
00A0: FD00FF0770000000 046B000200FFFFC1 7400000004DA0002 00FF7F78B0000000
00C0: 0400F60200FF1F7C 0000AC00040002FD 00FF17800000046B 000200FFFFC18400
00E0: 000004DA000200FF 7F88B00000000400 F60200FF1F8C0000 AC00190001FD00FF
0100: 07A5000000196B00 0100FFFFC1BE0000 0004DA000200FF7F 0180803E00000001
0120: 0070000E63514340 6F6E7461696E7220 AA0000000500006F 0400E801020000FF
0140: C18001000000BF04 190019000101FA00 007F80F20100000F 0800000096190001
0160: 00FE00FF83210000 0004B5000200FFFF 60250000001900ED 0100FF3F01806404
0180: 0000020038086351 4D44804922000000 0100DE0004DA0002 00FF7F01CC800400
01A0: 0370000D63514300 6865636B426F7822 A20000010000B704 00F60200FF1F0180
01C0: 0433000400060063 4461646F732200D1 000100005B040002 FB00FF0F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton:
			Radio Button:
			Option Button:
			Check Box:
			Child Table: cQCK1ChildTable
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control: cQuickHTTP
			ActiveX:
		Application Actions
	Form Window: frmImagemAssinatura
		Class: cQCK1Form
		Property Template:
		Class DLL Name:
		Title: Assinaturas Digitais
		Icon File:
		Accessories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? No
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? No
			Minimizable? No
			System Menu? Class Default
			Resizable? Yes
			Window Location and Size
				Left: -9.25"
				Top: 2.0"
				Width:  7.65"
				Width Editable? Class Default
				Height: 5.01"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Data Criação: 22/10/2013
				Autor: Djalma Júnior 
				Objetivo: Criado para cadastrar assinatura dos gestores DETRAN
				Restruturação Completa: Fernando Veras 15/12/2015
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
		Contents
			Frame
				Resource Id: 5592
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.138"
					Top: 0.115"
					Width:  7.05"
					Width Editable? Yes
					Height: 3.875"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: 3D Face Color
			!
			Background Text: Cargo:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625665696375 6C6F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Resource Id: 5392
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 0.988"
					Top: 0.292"
					Width:  0.588"
					Width Editable? Class Default
					Height: 0.167"
					Height Editable? Class Default
				Visible? Yes
				Justify: Right
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Combo Box: cmbCargo
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625665696375 6C6F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1ComboBox
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 1.638"
					Top: 0.24"
					Width:  5.4"
					Width Editable? Class Default
					Height: 1.104"
					Height Editable? Class Default
				Visible? Yes
				Editable? No
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sTextoStatusBar = 'Cargo'
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = FALSE
						Set _bPermiteNulos = TRUE
						Set _sRefresh = 'Create'
						Set _sNomeParaMsgs = 'Cargo'
						Set _sConsultaBD = 'exec dbvcen..CargoAssinaturaS'
						Set _sNomeCampoCodigo = 'dfnCodCargo'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalEnableWindow( pbNovo )
						If cmbCargo != 'Agente de Trânsito'
							Set cmbOrgaoLotacao = STRING_Null
							Set cmbAgenteTransito = STRING_Null
							Set dfsUsuario = STRING_Null
							Call SalSendMsg( cmbOrgaoLotacao, MSG_Desabilita1, wParam, lParam )
							Call SalSendMsg( cmbAgenteTransito, MSG_Desabilita1, wParam, lParam )
							Call SalSendMsg( dfsUsuario, MSG_Desabilita1, wParam, lParam )
						Else
							Call SalSendMsg( cmbOrgaoLotacao, MSG_Habilita1, wParam, lParam )
							Call SalSendMsg( dfsUsuario, MSG_Habilita1, wParam, lParam )
							Call SalDisableWindow(dfsNomeAssinatura)
						If cmbCargo != 'PRESIDENTE COMISSÃO LEILÃO'
							Set cmbGestores= STRING_Null
							Call SalShowWindow( dfsNomeAssinatura )
							Call SalHideWindow( cmbGestores)
							Call SalSendMsg( cmbGestores, MSG_Desabilita1, wParam, lParam )
						Else
							Call SalSendMsg( cmbGestores, MSG_Habilita1, wParam, lParam )
							Call SalShowWindow( cmbGestores )
							Call SalHideWindow( dfsNomeAssinatura)
						Set dfsNomeAssinatura = STRING_Null
						Call SalEnableWindow ( pbNovo )
						Call SalDisableWindow ( pbCapturarAssinatura )
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Return TRUE
			!
			Background Text: Nome:
				Resource Id: 13119
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 0.688"
					Top: 0.62"
					Width:  0.9"
					Width Editable? Class Default
					Height: 0.167"
					Height Editable? Class Default
				Visible? Class Default
				Justify: Right
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Combo Box: cmbGestores
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1ComboBox
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 1.638"
					Top: 0.57"
					Width:  5.4"
					Width Editable? Class Default
					Height: 1.104"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Nome Assinatura'
						!
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _bSempreHabilitado = TRUE
						!
						Set _sTipoMsgNulo = 'PADRAO'
						Set _sNroCamposIgnorados = 'NENHUM'
						Set _sNomeParaMsgs = 'Nome Assinatura'
						!
						Set _sRefresh = ''
						Set _sNomeCampoCodigo = 'dfnNomeAssinatura'
						!
						Set _sCamposResponsaveis[0] = 'dfnCodCargo'
						Set _sConsultaBD = 'exec dbvcen..ImagemAssinaturaS @nCargo = :frmImagemAssinatura.dfnCodCargo'
						!
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Set dfsNomeAssinatura = cmbGestores
			!
			Data Field: dfsNomeAssinatura
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625665696375 6C6F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 1.638"
						Top: 0.57"
						Width:  5.4"
						Width Editable? Class Default
						Height: 0.26"
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = FALSE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			!
			Background Text: Órgão Lotação:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625665696375 6C6F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Resource Id: 26557
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 0.288"
					Top: 1.0"
					Width:  1.3"
					Width Editable? Class Default
					Height: 0.198"
					Height Editable? Class Default
				Visible? Yes
				Justify: Right
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Combo Box: cmbOrgaoLotacao
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625665696375 6C6F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1ComboBox
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 1.638"
					Top: 0.948"
					Width:  5.4"
					Width Editable? Class Default
					Height: 1.104"
					Height Editable? Class Default
				Visible? Yes
				Editable? No
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sTextoStatusBar = 'Orgão Lotação'
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = FALSE
						Set _bPermiteNulos = TRUE
						Set _sRefresh = 'Create'
						Set _sNomeParaMsgs = 'Orgão Lotação'
						Set _sConsultaBD = 'exec dbfisc01..OrgaoFiscalizadorS'
						Set _sNomeCampoCodigo = 'dfnCodOrgaoLotacao'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalSendMsg( cmbAgenteTransito, MSG_Habilita1, wParam, lParam )
						Set cmbAgenteTransito = STRING_Null
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
			!
			Background Text: Agente:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625665696375 6C6F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Resource Id: 26556
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 0.888"
					Top: 1.333"
					Width:  0.7"
					Width Editable? Class Default
					Height: 0.167"
					Height Editable? Class Default
				Visible? Yes
				Justify: Right
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Combo Box: cmbAgenteTransito
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625665696375 6C6F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1ComboBox
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 1.638"
					Top: 1.281"
					Width:  5.4"
					Width Editable? Class Default
					Height: 1.104"
					Height Editable? Class Default
				Visible? Yes
				Editable? No
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Agente Trânsito'
						Set _bVisivel = TRUE
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = FALSE
						Set _bPermiteNulos = TRUE
						Set _bÉDependente = TRUE
						Set _sRefresh = 'Create'
						Set _sNomeParaMsgs = 'Agente Trânsito'
						Set _sCamposResponsaveis[0] = 'dfnCodOrgaoLotacao'
						Set _sConsultaBD = 'exec dbfisc01..AgenteTransitoCodigoNomeS @nOrgao = :frmImagemAssinatura.dfnCodOrgaoLotacao, @sTipoConsulta = "N"'
						Set _sNomeCampoCodigo = 'dfnCodAgenteTransito'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Set dfsNomeAssinatura = cmbAgenteTransito
			!
			Background Text: Login do Agente:
				Resource Id: 26558
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.188"
					Top: 1.823"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfsUsuario
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625665696375 6C6F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 8
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 1.638"
						Top: 1.781"
						Width:  1.15"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = FALSE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			!
			Group Box: Situação
				Resource Id: 5586
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 3.488"
					Top: 1.531"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.667"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Radio Button: rbAtivo
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 53656D7072654861 62696C697461646F 0005005452554500 005461624368696C
0020: 644E616D6573000C 0074616246696E61 6C697A6100004E75 6E6361486162696C
0040: 697461646F000600 46414C5345000000 0000000000
.enddata
.data CLASSPROPSSIZE
0000: 5500
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Ativo
				Window Location and Size
					Left: 3.863"
					Top: 1.781"
					Width:  0.725"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Yes
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Clique para Ativar a Assinatura'
						Set _sNomeParaMsgs = 'Ativo'
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _bNuncaHabilitado = FALSE
						Set _sTipoMsgNulo = 'PADRAO'
						! Variáveis para Check Box ou Radio Button
						Set _sNomeCampoFonte = 'dfsSituacao'
						Set _sValorCampoFonte = 'A'
						Set _bRadioButtonDefault = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Radio Button: rbInativo
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 53656D7072654861 62696C697461646F 0005005452554500 005461624368696C
0020: 644E616D6573000C 0074616246696E61 6C697A6100004E75 6E6361486162696C
0040: 697461646F000600 46414C5345000000 0000000000
.enddata
.data CLASSPROPSSIZE
0000: 5500
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Inativo
				Window Location and Size
					Left: 4.888"
					Top: 1.781"
					Width:  0.9"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Yes
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Clique para Inativar a Assinatura'
						Set _sNomeParaMsgs = 'Inativo'
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _bNuncaHabilitado = FALSE
						Set _sTipoMsgNulo = 'PADRAO'
						! Variáveis para Radio Button
						Set _bRadioButtonDefault = FALSE
						Set _sNomeCampoFonte = 'dfsSituacao'
						Set _sValorCampoFonte = 'I'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			!
			Background Text: Assinatura:
				Resource Id: 26234
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.588"
					Top: 2.26"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Custom Control: picAssinatura
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: CMImgCtl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left: 0.588"
						Top: 2.531"
						Width:  6.4"
						Width Editable? Class Default
						Height: 1.333"
						Height Editable? Class Default
					Visible? Class Default
					Border? Yes
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			! Campos Auxiliares
			Data Field: dfsSituacao
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? No
				Display Settings
					Window Location and Size
						Left: 0.788"
						Top: 0.656"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = FALSE
						Set _sTipoMsgNulo = 'PADRAO'
						Set _bPermiteNulos = TRUE
						Set _bNuncaHabilitado = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Data Field: dfnCodCargo
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 74616246696E616C 697A6100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Number
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 0.688"
						Top: 4.406"
						Width:  0.213"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Cargo'
						Set _sNomeParaMsgs = 'Cargo'
						Set _bVisivel = FALSE
						Set _bPermiteNulos = FALSE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Data Field: dfnNomeAssinatura
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 74616246696E616C 697A6100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: String
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 0.888"
						Top: 4.406"
						Width:  0.213"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'NomeAssinatura'
						Set _sNomeParaMsgs = 'NomeAssinatura'
						Set _bVisivel = FALSE
						Set _bPermiteNulos = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Data Field: dfnCodOrgaoLotacao
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 74616246696E616C 697A6100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Number
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 0.488"
						Top: 4.406"
						Width:  0.213"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Orgao Lotação'
						Set _sNomeParaMsgs = 'Orgao Lotação'
						Set _bVisivel = FALSE
						Set _bPermiteNulos = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Data Field: dfnCodAgenteTransito
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 74616246696E616C 697A6100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Number
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 0.288"
						Top: 4.406"
						Width:  0.213"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Agente Trânsito'
						Set _sNomeParaMsgs = 'Agente Trânsito'
						Set _bVisivel = FALSE
						Set _bPermiteNulos = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Data Field: dfsCaminhoArquivoImportado
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 53656D7072654861 62696C697461646F 0005005452554500 005461624368696C
0020: 644E616D6573000B 0074616253657276 69636F00004E756E 6361486162696C69
0040: 7461646F00060046 414C534500000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 5400
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left: 0.388"
						Top: 4.573"
						Width:  0.2"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? No
					Border? Class Default
					Justify: Left
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Caminho do Arquivo a ser Importado'
						Set _bVisivel = TRUE
						Set _bNuncaHabilitado = TRUE
						Set _bPermiteNulos = TRUE
						Set _bSempreHabilitado = FALSE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Picture: picFotoAssinatura
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 3.238"
					Top: 1.615"
					Width:  2.8"
					Width Editable? Yes
					Height: 1.75"
					Height Editable? Yes
				Visible? No
				Editable? No
				File Name: ImagemNaoDisponivel.jpg
				Storage: External
				Picture Transparent Color: None
				Fit: Size to Fit
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Tile To Parent? No
				Border Color: Default
				Background Color: Default
				Message Actions
			! Campos padroes (form)
			Pushbutton: pbPesquisar
.data CLASSPROPSSIZE
0000: 1E00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625665696375 6C6F00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: Pesquisar
				Window Location and Size
					Left: 1.188"
					Top: 4.073"
					Width:  0.96"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						!
						Set _sTextoStatusBar = 'Pesquisar ultima assinatura inativa ou ativa do gestor selecionado'
						Set _sTipoComando = 'Comum'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
						!
					On SAM_Click
						! Validações Agente de Transito
						If cmbCargo = 'Agente de Trânsito' and SalIsNull(dfnCodOrgaoLotacao)
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Escolha o órgão de lotação e depois o agente que deseja pesquisar!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus(cmbOrgaoLotacao)
							Return FALSE
						If cmbOrgaoLotacao != STRING_Null and cmbAgenteTransito = STRING_Null
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Informe o Agente que deseja pesquisar!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus(cmbAgenteTransito)
							Return FALSE
						! -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
						! Limpando as variaveis
						Set sCaminhoAssinatura = ""
						! Sem cargo ou usuario
						If SalIsNull(frmImagemAssinatura.cmbCargo) and SalIsNull(frmImagemAssinatura.dfsUsuario)
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Necessário informar o cargo ou o usuário para realizar a pesquisa.', 'Atenção', MB_IconExclamation | MB_Ok )
							Return FALSE
						! Agente de Transito
						If NOT SalIsNull(frmImagemAssinatura.dfsUsuario) or NOT SalIsNull(frmImagemAssinatura.cmbAgenteTransito)
							Call frmImagemAssinatura.fCapturaDadosAssinaturaAgente(
									frmImagemAssinatura.picFotoAssinatura, 
									sFotoAssinatura, 
									sNomeAssinatura ,
									sCargoAssinatura,
									sQRP,
									frmImagemAssinatura.dfnCodCargo,
									frmImagemAssinatura.dfsSituacao,
									dfsUsuario,
									frmImagemAssinatura.dfnCodOrgaoLotacao,
									frmImagemAssinatura.dfnCodAgenteTransito)
						! Comissão Leilão
						Else If NOT SalIsNull(frmImagemAssinatura.dfnNomeAssinatura)
							Call frmImagemAssinatura.fCapturaDadosAssinaturaComissaoLeilao(
									frmImagemAssinatura.picFotoAssinatura, 
									sFotoAssinatura, 
									sNomeAssinatura,
									sCargoAssinatura,
									sQRP,
									frmImagemAssinatura.dfnCodCargo,
									frmImagemAssinatura.dfsSituacao,
									frmImagemAssinatura.cmbGestores)
						! Geral
						Else
							Call frmImagemAssinatura.fCapturaDadosAssinatura(
									frmImagemAssinatura.picFotoAssinatura, 
									sFotoAssinatura, 
									sNomeAssinatura ,
									sCargoAssinatura,
									sQRP,
									frmImagemAssinatura.dfnCodCargo,
									frmImagemAssinatura.dfsSituacao)
						! -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
						Set hImg = MImgLoadFromPicture( picFotoAssinatura )
						If frmImagemAssinatura.sNomeAssinatura = STRING_Null
							Set hImg = NUMBER_Null
						Call picAssinatura.SetImage( hImg , TRUE )
						Call picAssinatura.SetFitMode( PIC_FitSizeToFit )
						If NOT SalIsNull(frmImagemAssinatura.dfsSituacao)
							Set nAssinatura = 1
						!
						! Call SalEnableWindow(pbArquivar)
						Call SalPostMsg( hWndForm, UDM_AposPesquisa, 0, 0 )
						! Set frmImagemAssinatura.dfsNomeAssinatura = sNomeAssinatura
						! Set frmImagemAssinatura.cmbCargo = sCargoAssinatura
						! Set cmbGestores = dfsNomeAssinatura
			Pushbutton: pbCapturarAssinatura
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: Assinatura
				Window Location and Size
					Left: 2.188"
					Top: 4.073"
					Width:  1.0"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: (none)
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Captura da Imagem'
						!
						Set _sTipoComando = 'Comum'
						!
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call fSelecionaArquivoImportar()
						If cmbCargo = 'PRESIDENTE COMISSÃO LEILÃO'
							Call SalHideWindow(cmbGestores)
							Call SalShowWindow(dfsNomeAssinatura)
							Call SalEnableWindow(dfsNomeAssinatura)
			Pushbutton: pbNovo
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 44656269746F0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: No&vo
				Window Location and Size
					Left: 3.225"
					Top: 4.073"
					Width:  1.019"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Habilita a tela para inserção de um novo registro'
						Set _sTipoComando = 'Comum'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalEnableWindow(pbLimpar)
						Call SalEnableWindow(pbCapturarAssinatura)
						Call SalDisableWindow(pbArquivar)
						Call SalEnableWindow(rbAtivo)
						Call SalEnableWindow(rbInativo)
						Call SalDisableWindow(pbPesquisar)
						Call SalEnableWindow(dfsNomeAssinatura)
						Call SalDisableWindow(pbNovo)
						Call SalDisableWindow(cmbGestores)
						Call SalHideWindow( cmbGestores )
						Call SalShowWindow( dfsNomeAssinatura )
						If cmbCargo = 'Agente de Trânsito'
							Call SalDisableWindow( dfsNomeAssinatura )
							Call SalSetFocus( cmbOrgaoLotacao )
						Else
							Call SalSetFocus( dfsNomeAssinatura )
						If cmbGestores != STRING_Null
							Set dfsNomeAssinatura = cmbGestores
						If cmbAgenteTransito != STRING_Null
							Set dfsNomeAssinatura = cmbAgenteTransito
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
			Pushbutton: pbArquivar
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 74616246696E616C 697A6100000000
.enddata
.data CLASSPROPSSIZE
0000: 1F00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Arquivar
				Window Location and Size
					Left: 4.275"
					Top: 4.073"
					Width:  1.0"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Arquiva o registro corrente'
						!
						Set _bValidaCamposNulos = TRUE
						Set _sNroCamposIgnorados = 'NENHUM'
						!
						Set _sTipoComando = 'Comum'
						!
						Call SalDisableWindow( hWndItem ) 
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						If dfsNomeAssinatura = STRING_Null
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Por favor preencha o nome!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus(dfsNomeAssinatura)
							Return FALSE
						If cmbCargo = 'Agente de Trânsito' and SalIsNull(dfsUsuario)
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Por favor preencha o Login do Agente!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus(dfsUsuario)
							Return FALSE
						If SalFileOpen( fhArquivoImagemAssinatura, sCaminhoAssinatura, OF_Exist ) and nAssinatura = 1
						!
						Call frmImagemAssinatura.fGravaBinarioAssinarura( sCaminhoAssinatura, 
											                   fhArquivoImagemAssinatura, 
											                   sMainBuffer, 
											                   nMainBytesLidos,
											                   frmImagemAssinatura.dfsNomeAssinatura, 
											                   frmImagemAssinatura.dfnCodCargo, 
											                   frmImagemAssinatura.dfsSituacao,
											                   frmImagemAssinatura.dfsUsuario)
						!
						Set nAssinatura = 0 
						Call SalShowWindow( cmbGestores )
						Call SalHideWindow( dfsNomeAssinatura )
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						! Call VisFileDelete( sCaminhoAssinatura||"*.*")
						! Call SalDisableWindow( frmImagemAssinatura.pbArquivar )
			Pushbutton: pbLimpar
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Limpar
				Window Location and Size
					Left: 5.325"
					Top: 4.073"
					Width:  0.863"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Limpa os dados da tela'
						Set _sTipoComando = 'Comum'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						! Ativa Botoões
						Call SalEnableWindow(cmbCargo)
						Call SalEnableWindow(pbPesquisar)
						Call SalShowWindow( cmbGestores )
						! Desativa Botões
						Call SalDisableWindow(pbCapturarAssinatura)
						Call SalDisableWindow(pbArquivar)
						Call SalDisableWindow(rbAtivo)
						Call SalDisableWindow( pbNovo )
						Call SalDisableWindow(rbInativo)
						Call SalHideWindow( dfsNomeAssinatura )
						! Seta Vazio
						Set frmImagemAssinatura.dfnCodCargo = NUMBER_Null
						Set frmImagemAssinatura.cmbGestores = STRING_Null
						Set frmImagemAssinatura.cmbCargo = STRING_Null
						Set cmbAgenteTransito = STRING_Null
						Set dfsNomeAssinatura = STRING_Null
						Set cmbOrgaoLotacao = STRING_Null
						Set psImagemAuxiliar = STRING_Null
						Set sNomeAssinatura = STRING_Null
						Set sCargoAssinatura = STRING_Null
						Set sFotoAssinatura = STRING_Null
						Set dfsUsuario = STRING_Null
						Set sQRP = STRING_Null
						Set hImg = NUMBER_Null
						! Outros
						Call picAssinatura.SetImage( hImg , TRUE )
						Call picAssinatura.SetFitMode( PIC_FitSizeToFit )
						Set frmImagemAssinatura.rbAtivo = TRUE
						Set frmImagemAssinatura.dfsSituacao = 'A'
						! Mensagens para Classe
						Call SalSendMsg( cmbOrgaoLotacao, MSG_Desabilita1, wParam, lParam )
						Call SalSendMsg( cmbAgenteTransito, MSG_Desabilita1, wParam, lParam )
						! Mensagem para classe da ação "click"
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
			Pushbutton: pbSair
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK2PbSair
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left: 6.225"
					Top: 4.073"
					Width:  0.95"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If ( NOT SalIsWindowEnabled( frmImagemAssinatura.pbArquivar ) )
								OR IDYES = SalMessageBox( "Deseja sair sem Arquivar os dados da Assinatura?", "Captura de Imagem", MB_YesNo )
							Call SalSendClassMessage( SAM_Click, wParam, lParam )
			Picture: picSemaforo
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQCK1Form
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 0.263"
					Top: 4.073"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
		Functions
			Function: fGravaBinarioAssinarura
				Description: Grava Arquivo Binário
				Returns
				Parameters
					String: psNomeArquivo
					File Handle: pfhArquivoImagem
					Receive Long String: prsMainBuffer
					Receive Number: prnMainBytesLidos
					String: psNomeAssinatura
					Number: pnCodCargo
					String: psSituacao
					String: psUsuario
				Static Variables
				Local variables
					Sql Handle: hSql
					Sql Handle: hSqlArquivo
					Long String: sImagem
					String: sSituacao
					Number: nCodAgente
					String: snErro
				Actions
					!
					Call SqlConnect( hSql )
					Call SqlConnect( hSqlArquivo)
					Set sSituacao = "A"
					Call frmImagemAssinatura.fLeArquivoDisco( psNomeArquivo, prsMainBuffer, prnMainBytesLidos )
					If dfnCodAgenteTransito =  NUMBER_Null or  cmbCargo != 'Agente de Trânsito'
						Set dfnCodAgenteTransito= 0
					If dfnCodOrgaoLotacao = NUMBER_Null or cmbCargo != 'Agente de Trânsito'
						Set dfnCodOrgaoLotacao = 0
					!
					If rbAtivo = TRUE
						Set sSituacao = 'A'
					If rbInativo = TRUE
						Set sSituacao = 'I'
					If frmImagemAssinatura.fVerificaSituacao(frmImagemAssinatura.dfsNomeAssinatura, frmImagemAssinatura.dfnCodCargo, 'SA', sSituacao ) = 'INATIVE'
						Call SalMessageBeep( 0 )
						Call SalMessageBox( 'Para realizar a inclusão de uma nova assinatura para este gestor será necessário inativar a anterior!', 'Atenção', MB_IconExclamation | MB_Ok )
						Call SalDisableWindow(pbCapturarAssinatura)
						Call SalEnableWindow(pbArquivar)
						Set cmbGestores = dfsNomeAssinatura
						Call SqlDisconnect( hSql )
						Call SqlDisconnect( hSqlArquivo )
						Return FALSE
					Else If frmImagemAssinatura.fVerificaSituacao(frmImagemAssinatura.dfsNomeAssinatura, frmImagemAssinatura.dfnCodCargo, 'SA', sSituacao ) = 'INSERT'
						If fMPSPrepareProc( hSql, "exec dbvcen..AssinaturaDigitalI
								@nCargo = :pnCodCargo,
								@sImagemAssinatura = '',
								@sNomeAssinatura = :psNomeAssinatura,
								@sSituacao = :psSituacao,
								@nTamanhoImagem = :prnMainBytesLidos,
								@nMatriculaAgente = :dfnCodAgenteTransito,
								@nOrgaoAgente = :dfnCodOrgaoLotacao,
								@sUsuario = :dfsUsuario", '' )
							If NOT SqlExecute( hSql )
								Call SqlDisconnect( hSql )
								Return FALSE
						Else
							Call SqlDisconnect( hSql )
							Return FALSE
						Call SqlPrepare( hSql,  "
										SELECT 	ImagemAssinatura
										FROM 	dbimg02..AssinaturaDigital FOR LONG UPDATE
										WHERE 	CargoAssinatura = :pnCodCargo
										AND 	NomeAssinatura = :psNomeAssinatura" )
						Call SqlOpen( hSql, "CURSOR1" )
						If NOT SqlFetchNext( hSql, lParam )
							Call SqlDisconnect( hSql )
							Call SqlDisconnect( hSqlArquivo )
							Return FALSE
						!
						Call SybWriteText( hSqlArquivo, "CURSOR1" ,1 , "ImagemAssinatura", prsMainBuffer , 0, 1)
						!
						If SqlExecute( hSql )
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Inclusão realizada com sucesso.', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalPostMsg( pbLimpar, SAM_Click, 0, 0 )
							Call SqlDisconnect( hSql )
							Call SqlDisconnect( hSqlArquivo )
							Return TRUE
						Else
							Call SqlDisconnect( hSql )
							Call SqlDisconnect( hSqlArquivo )
							Return FALSE
					Else If frmImagemAssinatura.fVerificaSituacao(frmImagemAssinatura.dfsNomeAssinatura, frmImagemAssinatura.dfnCodCargo, 'SA', sSituacao ) = 'UPDATE'
						If fMPSPrepareProc( hSql, "exec dbvcen..AssinaturaDigitalA
								@nCargo = :pnCodCargo,
								@sNomeAssinatura = :psNomeAssinatura,
								@sImagemAssinatura = '',
								@sSituacao = :psSituacao,
								@nTamanhoImagem = :prnMainBytesLidos,
								@sUsuario = :dfsUsuario", '' )
							If NOT SqlExecute( hSql )
								Call SqlDisconnect( hSql )
								Return FALSE
						Else
							Call SqlDisconnect( hSql )
							Return FALSE
						Call SqlPrepare( hSql,  "
										SELECT 	ImagemAssinatura
										FROM 	dbimg02..AssinaturaDigital FOR LONG UPDATE
										WHERE 	CargoAssinatura = :pnCodCargo
										AND 	NomeAssinatura = :psNomeAssinatura" )
						Call SqlOpen( hSql, "CURSOR1" )
						Call SqlFetchNext( hSql, lParam )
						!
						Call SybWriteText( hSqlArquivo, "CURSOR1" ,1 , "ImagemAssinatura", prsMainBuffer , 0, 1)
						!
						If SqlExecute( hSql)
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Atualização realizada com sucesso.', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalPostMsg( pbLimpar, SAM_Click, 0, 0 )
							Call SqlDisconnect( hSql )
							Call SqlDisconnect( hSqlArquivo )
							Return TRUE
						Else
							Call SqlDisconnect( hSql )
							Call SqlDisconnect( hSqlArquivo )
							Return FALSE
					Else
						Call SalMessageBeep( 0 )
						Call SalMessageBox( 'Erro! Por favor procurar o CPD.', 'Atenção', MB_IconExclamation | MB_Ok )
						Call SalDisableWindow(pbCapturarAssinatura)
						Call SalEnableWindow(pbArquivar)
						Call SqlDisconnect( hSql )
						Call SqlDisconnect( hSqlArquivo )
						Return FALSE
					!
					Call SqlDisconnect( hSql )
					Call SqlDisconnect( hSqlArquivo )
					!
			Function: fLeArquivoDisco
				Description:
				Returns
				Parameters
					String: psArquivo
					Receive Long String: prsMainBuffer
					Receive Number: prnMainBytesLidos
				Static Variables
				Local variables
					Number: nBytesLidos
					File Handle: hFile
					String: asArquivo[*]
					Number: anTamanho[*]
					Date/Time: adData[*]
					Number: anAtributo[*]
				Actions
					!
					Call VisDosEnumFileInfo( psArquivo, FA_Standard, asArquivo, anTamanho, adData, anAtributo )
					!
					If SalFileOpen( hFile, psArquivo, OF_Binary | OF_Read )
						Set prnMainBytesLidos = SalFileRead( hFile, prsMainBuffer, anTamanho[0] )
						Call SalFileClose( hFile )
			Function: fVerificaImagensSelecionadas
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If nAssinatura = 1
						Call SalEnableWindow(pbArquivar)
			Function: fSelecionaArquivoImportar
				Description: Esta função Seleciona o caminho do arquivo a ser importado e retorna os dados importados para consulta
				Returns
				Parameters
				Static Variables
				Local variables
					String: sBcpString
					File Handle: fhWndArquivo
					Sql Handle: hSqlBat
					Sql Handle: hSqlProc
					String: sNomeServ
					String: sLog
					Number: nRetorno
					Number: nStatus
					Window Handle: hWndPai
				Actions
					Set vsFiltro[0] = "Imagem JPG"
					Set vsFiltro[1] = "*.JPG"
					Set vsFiltro[2] = "Imagem BMP"
					Set vsFiltro[3] = "*.BMP"
					If SalDlgOpenFile(frmImagemAssinatura, 'Importação da imagem', vsFiltro, 4, nIndice, sArquivoEscolhido, sArquivoEscolhidoPath )
						Set dfsCaminhoArquivoImportado = sArquivoEscolhidoPath
						Set sCaminhoAssinatura = sArquivoEscolhidoPath
						Call SalPicSetFile( picAssinatura, sCaminhoAssinatura)
						If nIndice = 1
							Set hImg = MImgLoadFromFile( sCaminhoAssinatura , MIMG_TYPE_JPG, 0 )
						If nIndice = 2
							Set hImg = MImgLoadFromFile( sCaminhoAssinatura , MIMG_TYPE_BMP, 0 )
						Call picAssinatura.SetImage( hImg , TRUE )
						Call picAssinatura.SetFitMode( PIC_FitSizeToFit )
						Set nAssinatura = 1
						Call fVerificaImagensSelecionadas()
						If sArquivoEscolhido != STRING_Null
							Call SalEnableWindow(pbArquivar)
						Else
							Call SalEnableWindow(pbArquivar)
						Return TRUE
			Function: fCapturaDadosAssinatura
				Description:
				Returns
				Parameters
					Window Handle: phPictureImagemAssinatura
					Receive Long String: psImagemAssinatura
					Receive String: sNomeAssinatura
					Receive String: sCargoAssinatura
					String: psQRP
					Number: pnCargoAssinatura
					Receive String: psSituacao
				Static Variables
				Local variables
					Sql Handle: hSqlFunc
				Actions
					!
					Set psImagemAssinatura = STRING_Null
					!
					Call SqlConnect( hSqlFunc )
					If NOT fMPSPrepareProc( hSqlFunc, 'exec dbvcen..AssinaturaDigitalS
							@Qrp = :psQRP,
							@Cargo = :pnCargoAssinatura',
							':sNomeAssinatura,
							:sCargoAssinatura,
							:psSituacao,
							:psImagemAssinatura' )
						Call SqlDisconnect( hSqlFunc )
						Return FALSE
					If NOT SqlExecute( hSqlFunc)
						Call SqlDisconnect( hSqlFunc )
						Return FALSE
					!
					Call SqlFetchNext( hSqlFunc, lParam )
					Call SqlDisconnect( hSqlFunc )
					!
					If psImagemAssinatura != STRING_Null
						!
						Call SalPicSetImage( phPictureImagemAssinatura, psImagemAssinatura, 7 )
						Call SalPicGetString( phPictureImagemAssinatura, PIC_FormatObject, psImagemAssinatura )
						Set frmImagemAssinatura.psImagemAuxiliar = psImagemAssinatura
					!
			Function: fCapturaDadosAssinaturaAgente
				Description:
				Returns
				Parameters
					Window Handle: phPictureImagemAssinaturaAgente
					Receive Long String: psImagemAssinatura
					Receive String: sNomeAssinaturaAgente
					Receive String: sCargoAssinaturaAgente
					String: psQRPAgente
					Number: pnCargoAssinaturaAgente
					Receive String: psSituacaoAgente
					String: sUsuarioAgente
					Number: pnOrgaoLotacaoAgente
					Number: pnAgenteTransitoAgente
				Static Variables
				Local variables
					Sql Handle: hSqlFunc
				Actions
					!
					Set psImagemAssinatura = STRING_Null
					!
					Call SqlConnect( hSqlFunc )
					If NOT fMPSPrepareProc( hSqlFunc, 'exec dbvcen..AssinaturaDigitalS
							@Qrp = :psQRPAgente,
							@Usuario = :sUsuarioAgente,
							@OrgaoLotacao = :pnOrgaoLotacaoAgente,
							@AgenteTransito = :pnAgenteTransitoAgente',
							':sNomeAssinaturaAgente,
							:sCargoAssinaturaAgente,
							:psSituacaoAgente,
							:dfsUsuario,
							:dfnCodOrgaoLotacao,
							:dfnCodAgenteTransito,
							:cmbOrgaoLotacao,
							:cmbAgenteTransito,
							:psImagemAssinatura')
						Return FALSE
					If NOT SqlExecute( hSqlFunc)
						Return FALSE
					!
					Call SqlFetchNext( hSqlFunc, lParam )
					Call SqlDisconnect( hSqlFunc )
					!
					!
					If psImagemAssinatura != STRING_Null
						!
						Call SalPicSetImage( phPictureImagemAssinaturaAgente, psImagemAssinatura, 7 )
						Call SalPicGetString( phPictureImagemAssinaturaAgente, PIC_FormatObject, psImagemAssinatura )
						Set frmImagemAssinatura.psImagemAuxiliar = psImagemAssinatura
					!
			Function: fCapturaDadosAssinaturaComissaoLeilao
				Description:
				Returns
				Parameters
					Window Handle: phPictureImagemAssinatura
					Receive Long String: psImagemAssinatura
					Receive String: sNomeAssinatura
					Receive String: sCargoAssinatura
					String: psQRP
					Number: pnCargoAssinatura
					Receive String: psSituacao
					Long String: psNomeGestor
				Static Variables
				Local variables
					Sql Handle: hSqlFunc
				Actions
					!
					Set psImagemAssinatura = STRING_Null
					!
					Call SqlConnect( hSqlFunc )
					If NOT fMPSPrepareProc( hSqlFunc, 'exec dbvcen..AssinaturaDigitalS
							@Qrp = :psQRP,
							@Cargo = :pnCargoAssinatura,
							@NomeAssinatura = :psNomeGestor',
							':sNomeAssinatura,
							:sCargoAssinatura,
							:psSituacao,
							:psImagemAssinatura' )
						Call SqlDisconnect( hSqlFunc )
						Return FALSE
					If NOT SqlExecute( hSqlFunc )
						Call SqlDisconnect( hSqlFunc )
						Return FALSE
					!
					Call SqlFetchNext( hSqlFunc, lParam )
					Call SqlDisconnect( hSqlFunc )
					!
					If psImagemAssinatura != STRING_Null
						!
						Call SalPicSetImage( phPictureImagemAssinatura, psImagemAssinatura, 7 )
						Call SalPicGetString( phPictureImagemAssinatura, PIC_FormatObject, psImagemAssinatura )
						Set frmImagemAssinatura.psImagemAuxiliar = psImagemAssinatura
					!
			Function: fVerificaSituacao
				Description: Verfifica a situação do usuario cadastrado no sistema (Agente, Diretor e etc)
						A situação Ativo (SA) tem retorno se já existe algum usuario ativo para o tipo de cargo selecionado.
						A situação Especifica (SE) tem retorno da situação de algum usuario especifico.
						Obs: Passar ambos parametros em UpperCase (CapsLock).
				Returns
					String: sSituacao
				Parameters
					String: psNomeAssinatura
					Number: pnCodCargo
					String: psTipoPesquisa
					String: psSituacao
				Static Variables
				Local variables
					Sql Handle: hSqlFunc
					String: sSituacao
					String: sNomeAssinatura
					Number: nResult
				Actions
					Call SqlConnect( hSqlFunc )
					If fMPSPrepareProc( hSqlFunc, 'exec dbvcen..ImagemAssinaturaS
							@nCargo = :pnCodCargo,
							@sNomeAssinatura = :psNomeAssinatura,
							@iTipoPesquisa = :psTipoPesquisa,
							@sSituacao = :psSituacao',
							':sSituacao' )
						If NOT SqlExecute( hSqlFunc )
							Call SqlDisconnect( hSqlFunc )
							Return sSituacao
						Else
							Call SqlFetchNext( hSqlFunc, nResult )
							Call SqlDisconnect( hSqlFunc )
							Return sSituacao
					Else
						Call SalMessageBeep( 0 )
						Call SalMessageBox( 'Comando não executado! Por favor procurar o CPD.', 'Atenção', MB_IconExclamation | MB_Ok )
						Call SqlDisconnect( hSqlFunc )
						Return sSituacao
		Window Parameters
		Window Variables
			Number: nIndex
			Number: nTamVetor
			Number: nRetorno
			Number: nMainBytesLidos
			Number: nTamanho[*]
			Number: nAtributos[*]
			Number: hImg
			Number: nHor
			Number: nVer
			Number: nRowAtual
			Number: nAssinatura
			Number: nExisteFoto
			Number: nIndice
			Number: nCargoAssinatura
			Number: nLinhaAtual
			Long String: sMainBuffer
			Long String: sSource
			Long String: sFotoAssinatura
			String: sBox
			String: sArquivoTiff[*]
			String: sCaminhoAssinatura
			String: sArquivoEscolhido
			String: sArquivoEscolhidoPath
			String: vsFiltro[*]
			String: sNomeAssinatura
			String: sCargoAssinatura
			String: sQRP
			String: sAuxNomeAssinatura
			String: sAuxSituacao
			String: sSituacao
			Date/Time: dDataTiff[*]
			File Handle: fhArquivoImagemAssinatura
			File Handle: hFile
			Window Handle: hSql
			String: psImagemAuxiliar
		Message Actions
			On SAM_Create
				!
				Set _sTextoStatusBar = 'Assinaturas Gestores Detran '
				Set _sCriacaoConexao = 'Default'
				! Set _nEstadoInicialForm = EF_RegistroExistente
				Set _bLimpaTelaAposInclusao = FALSE
				Call SalCenterWindow( hWndForm )
				!
				Call SalHideWindow( dfsNomeAssinatura )
				Call SalDisableWindow( pbNovo )
				Call SalDisableWindow( cmbGestores )
				Call SalSendMsg( cmbCargo, MSG_Habilita1, wParam, lParam )
				!
				Call SalSendClassMessage( SAM_Create, wParam, lParam )
			On SAM_CreateComplete
				!
				Set frmImagemAssinatura.dfsSituacao = 'A' 
				Call SalEnableWindow(cmbCargo)
				Call SalDisableWindow(pbArquivar)
				Call SalDisableWindow(rbAtivo)
				Call SalDisableWindow(rbInativo)
				Call SalDisableWindow(pbCapturarAssinatura)
				Set cmbOrgaoLotacao = STRING_Null
				Set cmbAgenteTransito = STRING_Null
				Set dfsUsuario = STRING_Null
				Call SalSendMsg( cmbOrgaoLotacao, MSG_Desabilita1, wParam, lParam )
				Call SalSendMsg( cmbAgenteTransito, MSG_Desabilita1, wParam, lParam )
				Call SalSendMsg( cmbCargo, MSG_Habilita1, wParam, lParam )
				! Call SalSendClassMessage( SAM_CreateComplete, wParam, lParam )
				! Call SalSendMsg( dfsUsuario, MSG_Desabilita1, wParam, lParam )
			On UDM_AposPesquisa
				! Variavel somente para verificar se há retorno de dados (no caso retorno do binario da Imagem)
				If psImagemAuxiliar = STRING_Null
					Call SalMessageBeep( 0 )
					Call SalMessageBox( 'Não há informação com os dados informados!', 'Atenção', MB_IconExclamation | MB_Ok )
					Call SalDisableWindow(pbArquivar)
					Call SalSendMsg(pbLimpar, SAM_Click, wParam,lParam)
					Return FALSE
				! Desabilitar Botões
				! Call SalDisableWindow(cmbCargo)
				Call SalDisableWindow(pbNovo)
				Call SalDisableWindow(pbArquivar)
				Call SalDisableWindow(pbPesquisar)
				Call SalDisableWindow(cmbGestores)
				Call SalDisableWindow(cmbGestores)
				Call SalDisableWindow(cmbOrgaoLotacao)
				Call SalDisableWindow(dfsNomeAssinatura)
				Call SalDisableWindow(cmbAgenteTransito)
				! Habilitar Botões
				Call SalEnableWindow(rbAtivo)
				Call SalEnableWindow(rbInativo)
				Call SalEnableWindow(pbArquivar)
				Call SalEnableWindow(pbCapturarAssinatura)
				! Validações
				If cmbAgenteTransito != STRING_Null
					Set dfsNomeAssinatura = cmbAgenteTransito
					Set cmbGestores = cmbAgenteTransito
				If frmImagemAssinatura.dfsSituacao = 'A'
					Set rbAtivo = TRUE
				Else
					Set rbInativo = TRUE
				! Outros
				! Call SalSendMsg(cmbCargo, SAM_Click, wParam,lParam)
				! Deixar aqui
				Set frmImagemAssinatura.dfsNomeAssinatura = sNomeAssinatura
				Set frmImagemAssinatura.cmbCargo = sCargoAssinatura
				Set cmbGestores = sNomeAssinatura
				!
				Call SalSendClassMessage( UDM_AposPesquisa, wParam, lParam )
	! Form Window: frmImagem
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accessories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left: 1.65"
				Top: 1.375"
				Width:  13.5"
				Width Editable? Yes
				Height: 6.844"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		Description: 
		Named Menus 
		Menu 
		Tool Bar 
.winattr
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
.end
			Contents 
				Data Field: dfLote
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left: Default
							Top: Default
							Width:  Default
							Width Editable? Yes
							Height: Default
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					Message Actions 
				Background Text: Lote:
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left: Default
						Top: Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
.end
				Child Table: tblImagens
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						Window Location and Size
							Left: Default
							Top: Default
							Width:  Default
							Width Editable? Yes
							Height: Default
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						View: Table
						Allow Row Sizing? No
						Lines Per Row: Default
					Memory Settings
						Maximum Rows in Memory: Default
						Discardable? Yes
.end
					Contents 
						Column: colNomeDaImagem
.winattr
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title:
							Visible? Yes
							Editable? Yes
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  Default
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
.end
							List Values 
							Message Actions 
					Functions 
					Window Variables 
					Message Actions 
						On SAM_RowSetContext
							Set sArquivo = sLocalImagem||tblImagens.colNomeDaImagem
							Set nPastas = 2
							If not SalFileOpen( hFile, sArquivo, OF_Exist )
								Loop 
									If nPastas > 7
										! Call SalPicClear( pic1 )
										! Call SalMessageBox('Arquivo de Imagem não encontrada','fafasfasdf',0)
										Break 
									Set sArquivo = sLocalImagem||tblImagens.colNomeDaImagem
									! aqui 04/09/2009
									If SalDateYear( dData ) != SalDateYear( SalDateCurrent( ) )
										Set sArquivo=SalStrMidX(sImagemAutoPastas,0,SalStrLength(sImagemAutoPastas)-2)||SalNumberToStrX(nPastas,0)|| '\\'||tblImagens.colNomeDaImagem
									Else 
										Set sArquivo=SalStrMidX(sImagemAutoPastas,0,SalStrLength(sImagemAutoPastas)-2)||SalNumberToStrX(nPastas,0)||'\\'||tblImagens.colNomeDaImagem
									If SalFileOpen( hFile, sArquivo, OF_Exist )
										Break 
									Set nPastas = nPastas + 1
							If nPastas > 7
								Call SalPicClear( pic1 )
								Call SalMessageBox('Arquivo de Imagem não encontrada','fafasfasdf',0)
								Return FALSE
							Call SalPicSetFile( pic1, sArquivo )
							Set hImg = MImgLoadFromFile( sArquivo , MIMG_TYPE_UNKNOWN, 0 )
							Call ccIMAGE.SetImage( hImg , TRUE )
							Call ccIMAGE.SetFitMode( MIMG_FIT_NONE )
				Pushbutton: pbImprime
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left: Default
						Top: Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name:
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
.end
					Message Actions 
						On SAM_Click
							Set nTipo =PIC_ImageTypeTIFF
							! Set nRet = SalPicGetImage( pic1, sFoto, nTipo )
							Call SalPicGetString( pic1, PIC_FormatObject  , sFoto )
							Set nFim = 0
							! Call SalReportView( frmImagem, hWndNULL, 'AutoDig.qrp', 'sFoto', 'Auto', nRet )
							Call SalReportPrint( frmImagem, 'Autodig.qrp', 'sFoto', 'Auto', 1,0,1,1,frmImagem.nRet )
				Pushbutton: pbSair
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left: Default
						Top: Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name:
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
.end
					Message Actions 
						On SAM_Click
							Call SalDestroyWindow(frmImagem)
				Data Field: dfnOrgao
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left: Default
							Top: Default
							Width:  Default
							Width Editable? Yes
							Height: Default
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					Message Actions 
				Data Field: dfsDescOrgao
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left: Default
							Top: Default
							Width:  Default
							Width Editable? Yes
							Height: Default
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					Message Actions 
				Data Field: dfsAuto
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left: Default
							Top: Default
							Width:  Default
							Width Editable? Yes
							Height: Default
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					Message Actions 
				Data Field: dfnInfracao
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left: Default
							Top: Default
							Width:  Default
							Width Editable? Yes
							Height: Default
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					Message Actions 
				Background Text: Orgão Autuante
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left: Default
						Top: Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
.end
				Background Text: Auto
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left: Default
						Top: Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
.end
				Background Text: Infração
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left: Default
						Top: Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
.end
				Data Field: dfsDescInfracao
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left: Default
							Top: Default
							Width:  Default
							Width Editable? Yes
							Height: Default
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					Message Actions 
				Background Text: Descrição da Infração
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left: Default
						Top: Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
.end
		Contents 
			! cMeter: dfmContador
				Message Actions
					On SAM_Validate
						! SetProgress - função para atualizar a porcentagem vista pelo usuário
						Select Case wParam
							Case 0
								Call cMeter.SetProgress (0)
								Break
							Case 65000
								Call cMeter.SetProgress (100)
								Break
							Default
								If nTotalRegistros <= 0
									Return FALSE
								Set nAux = SalNumberRound( wParam * 100 / nTotalRegistros )
								! Set nAux = SalNumberRound( wParam * 100 /( nTotalRegistros + 30 - SalNumberMod( nTotalRegistros, 30)) )
								! If nAux > 98
									Call SetProgress (98)
								! Else
								Call SetProgress ( nAux)
			Pushbutton: pbProcura
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left: Default
					Top: Default
					Width:  Default
					Width Editable? Yes
					Height: Default
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
.end
				Message Actions 
					On SAM_Click
						Call fPopularTabela()
			Picture: pic1
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: Default
					Top: Default
					Width:  Default
					Width Editable? Yes
					Height: Default
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Tile To Parent? No
				Border Color: Default
				Background Color: Default
.end
				Message Actions 
			Data Field: dfAltura
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: Default
						Top: Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
.end
				Message Actions 
					On SAM_Create
						Set dfAltura = 41
			Data Field: dfLargura
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: Default
						Top: Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
.end
				Message Actions 
					On SAM_Create
						Set dfLargura = 50
			Pushbutton: pbAmplia
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left: Default
					Top: Default
					Width:  Default
					Width Editable? Yes
					Height: Default
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
.end
				Message Actions 
					! call
					On SAM_Click
						! Set dfLargura = dfLargura + 5
						Set dfAltura =  dfAltura + 5
						Call SalPicSetFit( pic1, PIC_FitScale, dfLargura, dfAltura )
			Pushbutton: pbReduz
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left: Default
					Top: Default
					Width:  Default
					Width Editable? Yes
					Height: Default
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
.end
				Message Actions 
					! call
					! Set dfLargura = dfLargura - 5
					On SAM_Click
						! Set dfLargura = dfLargura - 5
						Set dfAltura =  dfAltura - 5
						Call SalPicSetFit( pic1, PIC_FitScale, dfLargura, dfAltura )
			Custom Control: ccIMAGE
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  0x00000000
					ExStyle:  0x00000000
					Title:
					Window Location and Size
						Left: Default
						Top: Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Border? No
					Etched Border? No
					Hollow? No
					Vertical Scroll? No
					Horizontal Scroll? No
					Tab Stop? None
					Tile To Parent? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					DLL Settings
.end
				Message Actions 
		Functions 
			Function: fPopularTabela
				Description: Popula a tabela com os arquivo do diretório selecionado.
				Returns 
					Boolean: 
				Parameters 
				Static Variables 
				Local variables 
					Number: nIndex
					String: sArquivo[*]
					Date/Time: dData[*]
					String: psDiretorio
					Boolean: bEncontrou
				Actions 
					Call SalTblReset( tblImagens )
					Set dfLote = SalStrToNumber(sLote)
					Set psDiretorio = sArquivosLotes||'*.txt'
					! Call SalFileSetCurrentDirectory( sImagemAuto )
					Call VisDosEnumFileInfo( psDiretorio, FA_Standard, sArquivo, nTamanho, dData, nAtributos )
					!
					!
					Call SalArrayGetUpperBound( nTamanho, 1, nTamVetor )
					Set frmConsAuto.nTotalRegistros = nTamVetor
					!
					Set nIndex = 0
					Set bEncontrou = FALSE
					Loop 
						Call SalSendMsg( frmConsAuto.dfmContador, SAM_Validate, nIndex, 0)
						If bEncontrou
							Break 
						If nIndex > nTamVetor
							Break 
						Else 
							Set dsArquivo = sArquivosLotes||sArquivo[nIndex]
							Call SalFileOpen( hFile, dsArquivo, OF_Read )
							!
							Set nRead =  SalFileGetStr(hFile, sTexto, 300 )
							Set nOffset =  SalStrScan( sTexto, ">" )
							Set sLote =    SalStrMidX(sTexto,nOffset+1,11)
							If dfLote =  SalStrToNumber(sLote)
								While SalFileGetStr(hFile, sTexto, 300 ) = TRUE
									Set nOffset = SalStrScan ( sTexto,'.TIF|V3')
									If nOffset > -1
										Set nRow = nRow + 1
										Call SalTblInsertRow( tblImagens, nRow )
										Set tblImagens.colNomeDaImagem =  SalStrMidX( sTexto, nOffset-8, 12 )
								Set bEncontrou = TRUE
							Set nOffset = SalStrScan ( sTexto,sLote )
							Call SalFileClose( hFile)
						Set nIndex = nIndex + 1
					If Not bEncontrou
						Call SalWaitCursor( FALSE )
						! Call SalSendMsg( frmConsAuto.dfmContador, SAM_Validate, 65000, 0 )
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( 'Auto Não Digitalizado!', 'Mensagem',0 )
						Call SalSendMsg(pbSair,SAM_Click,wParam,lParam)
						! Call SalSendMsg( frmConsAuto.dfmContador, SAM_Validate, 65000, 0 )
						Return FALSE
					Call SalTblSetFocusRow(  tblImagens, 0 )
					Call SalTblSetRowFlags( tblImagens, 0, ROW_Selected, TRUE )
					Call SalSendMsg(tblImagens,SAM_RowSetContext,wParam,lParam)
					!
					Call SalWaitCursor( FALSE )
					Call SalSendMsg( frmConsAuto.dfmContador, SAM_Validate, 65000, 0 )
					Call SalHideWindow( frmConsAuto.dfmContador )
					Call SalWaitCursor( FALSE )
		Window Parameters 
			String: sLote
			Date/Time: dData
		Window Variables 
			Number: nFim
			File Handle: hFile
			Number: nTipo
			Long String: sTexto
			Number: nRead
			Number: nOffset
			! String: sLote
			Number: nRow
			String: sArquivo
			Number: nRet
			Long String: sFoto
			String: dsArquivo
			! Date/Time: dData
			String: sData
			Sql Handle: hSqlApp
			Number: nAux
			Number: nPastas
			String: sImagemAutoPastas
			Number: nTamVetor
			Number: nTamanho[*]
			Number: nAtributos[*]
			String: sArquivoTiff[*]
			Date/Time: dDataTiff[*]
			! String: sLote
			String: sLocalImagem
			Number: hImg
		Message Actions 
			On SAM_Create
				! Set dfLote = 250321793
				Call SalSendMsg( frmConsAuto.dfmContador, SAM_Validate, 0, 0 )
				Set dfnOrgao = frmConsAuto.tblAuto.colnOrgaoAutuante
				Set dfnInfracao = frmConsAuto.tblAuto.colnInfracao
				Set dfsDescOrgao = frmConsAuto.tblAuto.colsOrgaoAutuante
				Set dfsAuto = frmConsAuto.tblAuto.colsSerie || SalNumberToStrX(frmConsAuto.tblAuto.colnCod,0)
				! Set dfsLocal = frmConsAuto.tblAuto.colsLocalInfracao
				Set dfsDescInfracao = frmConsAuto.tblAuto.colsInfracao
				Set dfnOrgao = frmConsAuto.tblAuto.colnOrgaoAutuante
				Set dfnOrgao = frmConsAuto.tblAuto.colnOrgaoAutuante
				Set dfnOrgao = frmConsAuto.tblAuto.colnOrgaoAutuante
				Set dfnOrgao = frmConsAuto.tblAuto.colnOrgaoAutuante
				Set dfnOrgao = frmConsAuto.tblAuto.colnOrgaoAutuante
				Set sLocalImagem = sImagemAuto
				Set sData = SalStrMidX(SalNumberToStrX( SalDateDay( dData)+100 ,0),1,2)||SalStrMidX(SalNumberToStrX( SalDateMonth( dData )+100,0),1,2)||SalNumberToStrX( SalDateYear( dData ),0)
				If SalDateYear( dData ) != SalDateYear( SalDateCurrent( ) )
					Set sArquivosLotes=sLocalImagem || 'INDEX' ||SalNumberToStrX( SalDateYear( dData ),0)||'\\'||sData||'\\Text\\00000001\\'
					Set sLocalImagem=sLocalImagem || 'INDEX' ||SalNumberToStrX( SalDateYear( dData ),0)||'\\'||sData||'\\Tiff\\00000001\\'
				Else 
					Set sArquivosLotes=sLocalImagem || 'INDEX\\'||sData||'\\Text\\00000001\\'
					Set sLocalImagem=sLocalImagem || 'INDEX\\'||sData||'\\Tiff\\00000001\\'
				!
				Set nPastas  = 1
				Set sImagemAutoPastas = sLocalImagem
				Call VisDosEnumFileInfo( sLocalImagem||'*.tif', FA_Standard, sArquivoTiff, nTamanho, dDataTiff, nAtributos )
				Call SalArrayGetUpperBound( nTamanho, 1, nTamVetor )
				Loop 
					If nTamVetor<255 or nPastas > 7
						Break 
					Set nPastas = nPastas + 1
					! aqui 04/09/2009
					If SalDateYear( dData ) != SalDateYear( SalDateCurrent( ) )
						Set sImagemAutoPastas=SalStrMidX(sImagemAutoPastas,0,SalStrLength(sImagemAutoPastas)-2)||SalNumberToStrX(nPastas,0)|| '\\'
						! Set sImagemAutoPastas=SalStrMidX(sImagemAutoPastas,0,47)||SalNumberToStrX(nPastas,0)|| '\\'
					Else 
						Set sImagemAutoPastas=SalStrMidX(sImagemAutoPastas,0,SalStrLength(sImagemAutoPastas)-2)||SalNumberToStrX(nPastas,0)||'\\'
						! Set sImagemAutoPastas=SalStrMidX(sImagemAutoPastas,0,43)||SalNumberToStrX(nPastas,0)||'\\'
					Call VisDosEnumFileInfo( sImagemAutoPastas||'*.tif', FA_Standard, sArquivoTiff, nTamanho, dDataTiff, nAtributos )
					Set nTamVetor = 0
					Set nTamanho[0]=0
					Call SalArrayGetUpperBound( nTamanho, 1, nTamVetor )
				Call SalSendMsg(pbProcura,SAM_Click,wParam,lParam)
			On SAM_ReportFetchNext
				Set nFim = nFim + 1
				If nFim = 1
					Return TRUE
				Return FALSE
  