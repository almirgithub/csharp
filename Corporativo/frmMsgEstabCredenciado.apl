.head 0 +  Application Description: **************************************************************************************
Projeto Divisão dos Sistemas em APL
Leandro Neves - 05.10.2005
*************************************************************************************
.head 1 -  Outline Version - 4.0.28
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B80000 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFF0FFFFF FFFCFFFFFF6E0300 00D4010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773166672
0080: 6D4D736745737461 6243726564656E63 6961646F
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: Tela_Corporativo.apl
.head 2 -  ! File Include: frmRelImpBatch.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Input: 9999999999999999999999
.head 3 -  Date/Time: dd/mm/yyyy
.head 3 -  Date/Time: dd/MM/yyyy hh:mm
.head 3 -  Input: 99/99/9999
.head 3 -  Date/Time: dd/MMyyyy
.head 3 -  Input: 99/99/9999 99:99
.head 3 -  Input: 999999999999999
.head 3 -  Number: #0
.head 3 -  Input: 99:99:99
.head 3 -  Input: 99999999999
.head 3 -  Number: #0
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 3 -  Enumerations
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 3553319825
0000: 2200000013000000 0000000000000000 0200000100000022 030000D019000000
0020: 01FE00FF03
.enddata
.head 2 +  Internal Functions
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 1810728310
0000: 840400002F020000 0000000000000000 0200000700FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666FC2003C00 000A630051434B31
0040: 47657261006C0202 00001100001E0004 0000C20003000000 FF7F048300190000
0060: 00F001000000FF1F 1D0000AC00190001 FD00FF0736000000 196B000100FFFFC1
0080: 4F00000019DA0001 00FF7F68B0000000 0400F4020000FF1F 6C0000AC00040002
00A0: FD00FF0770000000 046B000200FFFFC1 7400000004DA0002 00FF7F78B0000000
00C0: 0400F60200FF1F7C 0000AC00040002FD 00FF17800000046B 000200FFFFC18400
00E0: 000004DA000200FF 7F88B00000000400 F60200FF1F8C0000 AC00190001FD00FF
0100: 07A5000000196B00 0100FFFFC1BE0000 0004DA000200FF7F 0180803E00000001
0120: 0070000E63514340 6F6E7461696E7200 AA00000005000000 6F0400E801020000
0140: FFC18001000000BF 04190019000101FA 00007F80F2010000 0F08000000961900
0160: 0100FE00FF832100 000004B5000200FF FF60250000001900 ED0100FF3F018064
0180: 0800000200380863 514D44C049400000 0002DE0004DA0002 00FF7F04B3000400
01A0: F60200FF5F011D32 000003000C1C6351 466F72406D465450 400000F602009619
01C0: 000100FE00FF9B19 0004B5000200FFFF 9801801D0004E100 1063510F54616273
01E0: 2046747040000002 7B00194B00010000 FFFFCD190004DA00 0200FF7F01C88004
0200: 00000570000D6351 43006865636B426F 7822A00000000100 00B70400F60200FF
0220: 1F01800403000600 0000060063446164 6F732200D1000100 005B040002FB00FF
0240: 0F
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field: cQCK1DataField
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture: cQCK1Picture
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 -  Application Actions
.head 1 +  Form Window: frmMsgEstabCredenciado
.head 2 -  Class: cQCK1FormTabs
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Enviar Mensagem Eletrônica 
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left: -13.6"
.head 4 -  Top: 2.073"
.head 4 -  Width:  9.213"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.74"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74001000
0020: 7461624465737469 6E61746172696F00 0054616244726177 5374796C65000B00
0040: 57696E3935537479 6C65000054616255 7365466F6E740007 00437573746F6D00
0060: 00546162466F6E74 4E616D6500060041 7269616C00005461 6252696768744D61
0080: 7267696E00020030 00005461624E616D 6573002600746162 44657374696E6174
00A0: 6172696F09746162 4D656E736167656D 09746162416E6578 6F7300005461624C
00C0: 6162656C73002600 44657374696E6174 E172696F20263109 4D656E736167656D
00E0: 20263209416E6578 6F73202633000054 616250616765436F 756E740002003100
0100: 00546162426F7474 6F6D4D617267696E 0002003000005461 62466F6E7453697A
0120: 6500020039000054 6162466F726D5061 6765730003000909 0000546162546F70
0140: 4D617267696E0002 0030000000000000 0000000000000000 0000000000000000
0160: 000000000000
.enddata
.data CLASSPROPSSIZE
0000: 6601
.enddata
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1FormTabs
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.138"
.head 5 -  Top: 0.073"
.head 5 -  Width:  8.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 3.917"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: mlMensagem
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1MultilineText
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 500
.head 5 -  String Type: Long String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left: 1.788"
.head 6 -  Top: 2.656"
.head 6 -  Width:  7.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.167"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Mensagem'
.head 6 -  Set _sNomeParaMsgs = 'Conclusão'
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Set _bNaoTemDependentes = TRUE
.head 6 -  Set _bComponenteChave = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  ! Botões
.head 3 +  Pushbutton: pbPesquisar
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000100 00000000
.enddata
.data CLASSPROPSSIZE
0000: 1400
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Pesquisar
.head 4 -  Window Location and Size
.head 5 -  Left: 0.813"
.head 5 -  Top: 5.073"
.head 5 -  Width:  0.275"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Pesquisa os veiculos leiloados com comunicação de venda'
.head 6 -  Set _sTipoComando = 'TabelaPesquisa'
.head 6 -  Set _nPermissao = 15
.head 6 -  Set _sTabela = 'tblEstabelecimento'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  ! On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Efetua pesquisa no banco de dados'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bValidaCamposNulos = TRUE
.head 6 -  Set _sTipoComando = 'TabelaPesquisa'
.head 6 -  Set _sTabela = 'tblResultado'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  ! On SAM_Click
.head 6 -  Call SalTblReset( tblResultado )
.head 6 -  Call SWTabsEnable( picTabs, 1, FALSE )
.head 6 -  !
.head 6 +  If SalIsNull( dfsPlacaTela ) OR  SalIsNull( dfnRenavamTela )
.head 7 -  Call SalMessageBox( 'Os campos Placa e RENAVAM são obrigatórios!','Atenção', MB_IconStop | MB_Ok )
.head 7 -  Return FALSE
.head 6 +  ! If NOT ValidandoTelaCRV()
.head 7 -  Return FALSE
.head 6 -  Call SalSendClassMessage(SAM_Click, wParam,lParam)
.head 3 +  Pushbutton: pbEnviar
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002600 7461624465737469 6E61746172696F09
0020: 7461624D656E7361 67656D0974616241 6E65786F73000000 00
.enddata
.data CLASSPROPSSIZE
0000: 3900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Enviar
.head 4 -  Window Location and Size
.head 5 -  Left: 6.213"
.head 5 -  Top: 4.073"
.head 5 -  Width:  0.875"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Enviar mensagem'
.head 6 -  Set _sTipoComando = 'Comum'
.head 6 -  Set _nPermissao = 15
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  ! Call fEnviar()
.head 6 +  If NOT fEnviar()
.head 7 -  Return FALSE
.head 6 -  Call SalMessageBox( ' Envio Realizado com Sucesso!', 'Atenção', MB_IconInformation | MB_Ok )
.head 6 -  Call SalSendMsg( pbLimpar, SAM_Click, wParam, lParam )
.head 6 -  Call SalSendClassMessage(SAM_Click, wParam,lParam)
.head 3 +  Pushbutton: pbLimpar
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002600 7461624465737469 6E61746172696F09
0020: 7461624D656E7361 67656D0974616241 6E65786F73000000 00
.enddata
.data CLASSPROPSSIZE
0000: 3900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Limpar
.head 4 -  Window Location and Size
.head 5 -  Left: 7.075"
.head 5 -  Top: 4.073"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Limpa os dados da tela'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bValidaCamposNulos = FALSE
.head 6 -  Set _sTipoComando = 'Limpa'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SWTabsBringToTop( picTabs, 0, TRUE )
.head 6 -  ! Call SWTabsEnable( picTabs, 1, FALSE ) 
.head 6 -  Set dfnDiasBloq = 1
.head 6 -  Set rbInforme = TRUE
.head 6 -  Set nTipoMensagem = 1
.head 3 +  Pushbutton: pbSair
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002600 7461624465737469 6E61746172696F09
0020: 7461624D656E7361 67656D0974616241 6E65786F73000000 00
.enddata
.data CLASSPROPSSIZE
0000: 3900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Sair
.head 4 -  Window Location and Size
.head 5 -  Left: 8.038"
.head 5 -  Top: 4.073"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Sai desta tela'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bValidaCamposNulos = FALSE
.head 6 -  Set _sTipoComando = 'Sai'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  !
.head 3 -  Background Text: Tipo de Estabelecimento:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001000 7461624465737469 6E61746172696F00
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 4 -  Resource Id: 12373
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top: 0.563"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Combo Box: cmbTipoEstab
.data CLASSPROPSSIZE
0000: 2300
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001000 7461624465737469 6E61746172696F00
0020: 000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1ComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 2.338"
.head 5 -  Top: 0.49"
.head 5 -  Width:  6.45"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 3.271"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Tipo de Estabelecimento'
.head 6 -  ! Set _sNomeParaMsgs = 'Tipo de Estabelecimento'
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bPermiteNulos = FALSE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sValorDefault = ''
.head 6 -  !
.head 6 -  Set _sNomeCampoCodigo = 'dfnTipoEstabelecimento'
.head 6 -  Set _sConsultaBD = 'dbfisc01..TipoEstabelecimentoS'
.head 6 -  Set _sRefresh = 'Create'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalTblReset( tblEstabelecimento )
.head 6 -  Call SalSendMsg( pbPesquisar, SAM_Click, wParam, lParam )
.head 6 -  Call SalSendMsg( pbDesmarcar, SAM_Click, wParam, lParam )
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 3 +  Pushbutton: pbMarcar
.data CLASSPROPSSIZE
0000: 2300
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001000 7461624465737469 6E61746172696F00
0020: 000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK2PbComum
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Marcar Todos
.head 4 -  Window Location and Size
.head 5 -  Left: 5.738"
.head 5 -  Top: 3.635"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Marcar Todas as Mensagens'
.head 6 -  Set _nPermissao= EF_RegistroExistente
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call tblEstabelecimento.fMarcaTodos(hWndItem, pbDesmarcar)
.head 6 -  Call SalSendMsg( frmMsgEstabCredenciado, MSG_MudaSemaforo, S_Vermelho, lParam )
.head 3 +  Pushbutton: pbDesmarcar
.data CLASSPROPSSIZE
0000: 2300
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001000 7461624465737469 6E61746172696F00
0020: 000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK2PbComum
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Desmarcar Todos
.head 4 -  Window Location and Size
.head 5 -  Left: 7.138"
.head 5 -  Top: 3.635"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Desmarcar todas as Mensagens'
.head 6 -  Set _nPermissao= EF_RegistroExistente
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call tblEstabelecimento.fDesmarcaTodos(hWndItem, pbMarcar)
.head 6 -  Call SalSendMsg( frmMsgEstabCredenciado, MSG_MudaSemaforo, S_Vermelho, lParam )
.head 3 -  !
.head 3 -  Group Box: Tipo Mensagem:
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 40745
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top: 0.573"
.head 5 -  Width:  5.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbInforme 
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Informe
.head 4 -  Window Location and Size
.head 5 -  Left: 0.688"
.head 5 -  Top: 1.531"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sValorCampoFonte = '1'
.head 6 -  Set _sTextoStatusBar = 'Mensagem de Informação'
.head 6 -  Set _sNomeCampoFonte = 'nTipoMensagem'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Set nTipoMensagem = 1
.head 3 +  Radio Button: rbUrgente
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Urgente
.head 4 -  Window Location and Size
.head 5 -  Left: 1.888"
.head 5 -  Top: 1.531"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sTextoStatusBar = 'Mensagem Urgente'
.head 6 -  Set _sNomeCampoFonte = 'nTipoMensagem'
.head 6 -  Set _sValorCampoFonte = '2'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Set nTipoMensagem = 2
.head 3 +  Radio Button: rbNoticia
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Notícia
.head 4 -  Window Location and Size
.head 5 -  Left: 3.138"
.head 5 -  Top: 1.531"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sValorCampoFonte = '3'
.head 6 -  Set _sTextoStatusBar = 'Notícia'
.head 6 -  Set _sNomeCampoFonte = 'nTipoMensagem'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Set nTipoMensagem = 3
.head 3 +  Radio Button: rbContatar
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Contatar
.head 4 -  Window Location and Size
.head 5 -  Left: 4.238"
.head 5 -  Top: 1.531"
.head 5 -  Width:  1.25"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sValorCampoFonte = '4'
.head 6 -  Set _sTextoStatusBar = 'Contatar'
.head 6 -  Set _sNomeCampoFonte = 'nTipoMensagem'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Set nTipoMensagem = 4
.head 3 +  Picture: picInforme
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.788"
.head 5 -  Top: 0.906"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name: INFO4.bmp
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: No Border
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: Light Gray
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalPicSetFile(hWndItem, 'INFO4.bmp')
.head 3 +  Picture: picUrgente
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.988"
.head 5 -  Top: 0.906"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name: FASTFILE.bmp
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: No Border
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: Light Gray
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalPicSetFile(hWndItem, 'FASTFILE.bmp')
.head 3 +  Picture: picNoticia
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.188"
.head 5 -  Top: 0.906"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name: NEWS2.bmp
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: No Border
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: Light Gray
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalPicSetFile(hWndItem, 'NEWS2.bmp')
.head 3 +  Picture: picContatar
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.288"
.head 5 -  Top: 0.906"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name: PHONE6.bmp
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: No Border
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: Light Gray
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalPicSetFile(hWndItem, 'PHONE6.bmp')
.head 3 -  !
.head 3 +  Data Field: dfnSetor
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.788"
.head 6 -  Top: 1.99"
.head 6 -  Width:  0.75"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: 000000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: 99999-9
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Setor do Remetente'
.head 6 -  !
.head 6 -  Set _bVisivel = TRUE
.head 6 -  !
.head 6 -  Set _sNomeParaMsgs = 'Setor do Remetente'
.head 6 -  Set _sMsgValidacao = 'Dígito inválido!'
.head 6 -  Set _sTipoMsgValidacao = 'ESPECIFICA'
.head 6 -  !
.head 6 -  Set _sConsultaFrmOpcoesSQLOuSP = 'SP'
.head 6 -  Set _sConsultaFrmOpcoesCampo = 'SetorS_codreddesc'
.head 6 -  Set _sConsultaFrmOpcoesColunaOuParam = '@Descricao'
.head 6 -  !
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  ! On UDM_ValidaCampo
.head 6 +  If NOT SalIsNull( hWndItem )
.head 7 -  Set nSetor = SalNumberTruncate( dfnSetor/10, 5, 0 )
.head 7 +  If (SalNumberMod(dfnSetor, 10)  != DigitoModulo11( nSetor ) )
.head 8 -  Return FALSE
.head 6 -  Return TRUE
.head 3 +  Data Field: dfsSetor
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.588"
.head 6 -  Top: 1.99"
.head 6 -  Width:  6.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Left
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Descrição do setor'
.head 6 -  !
.head 6 -  Set _bVisivel = TRUE
.head 6 -  !
.head 6 -  Set _sValorDefault = ''
.head 6 -  !
.head 6 -  Set _bÉDependente = TRUE
.head 6 -  Set _bÉCampoDescrição = TRUE
.head 6 -  !
.head 6 -  Set _sCamposResponsaveis[0] = 'dfnSetor'
.head 6 -  Set _sConsultaDescrição = 'SetorS_desc @CodReduzido = :frmMsgEstabCredenciado.dfnSetor'
.head 6 -  !
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  !
.head 3 -  Background Text: Setor Remetente:
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 40746
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 2.05"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Background Text: Assunto:
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 40750
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.688"
.head 5 -  Top: 2.385"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfsAssunto
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.788"
.head 6 -  Top: 2.323"
.head 6 -  Width:  7.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Uppercase
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Assunto'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bPermiteNulos = FALSE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  !
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sNomeParaMsgs = 'Assunto'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Data Field: dfnTipoEstabelecimento
.data CLASSPROPSSIZE
0000: 2300
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001000 7461624465737469 6E61746172696F00
0020: 000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.488"
.head 6 -  Top: 4.99"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Nome do usuário'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bNuncaHabilitado = TRUE
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  !
.head 6 -  Set _bVisivel = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  Background Text: Mensagem: 
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 40749
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.688"
.head 5 -  Top: 3.135"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Group Box: Anexos :
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 746162416E65786F 7300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 40748
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top: 0.406"
.head 5 -  Width:  8.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Caminho completo e nome do arquivo ou clique em:
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 746162416E65786F 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 40747
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.688"
.head 5 -  Top: 0.677"
.head 5 -  Width:  5.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfsCaminho
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 746162416E65786F 7300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.488"
.head 6 -  Top: 0.906"
.head 6 -  Width:  5.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Uppercase
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Caminho do Anexo'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  ! Call SalStrSetBufferLength( dfsNome, 10000 )
.head 6 -  !
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bPermiteNulos = FALSE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  !
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sNomeParaMsgs = 'Nome'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  !
.head 3 +  Pushbutton: mdipbAnexar
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 746162416E65786F 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Anexar
.head 4 -  Window Location and Size
.head 5 -  Left: 7.688"
.head 5 -  Top: 0.573"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: CLIP03.ICO
.head 4 -  Picture Transparent Color: Cyan
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On WMSG_MOUSEMOVE
.head 6 -  Call SalStatusSetText( hWndMDI, 'Grava arquivo no Servido' )
.head 5 +  On SAM_Click
.head 6 -  Call fAnexar()   
.head 3 +  Pushbutton: mdipbProcurar
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 746162416E65786F 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Procurar
.head 4 -  Window Location and Size
.head 5 -  Left: 6.588"
.head 5 -  Top: 0.573"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: Jwprcein.ico
.head 4 -  Picture Transparent Color: Cyan
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On WMSG_MOUSEMOVE
.head 6 -  Call SalStatusSetText( hWndMDI, 'Acessa pastas para selecionar arquivo' )
.head 5 +  On SAM_Click
.head 6 -  Call fLocalizarArquivo()
.head 3 +  ! Pushbutton: mdipbExcluir
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 746162416E65786F 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Excluir
.head 4 -  Window Location and Size
.head 5 -  Left: 7.888"
.head 5 -  Top: 3.156"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: Exclui.ico
.head 4 -  Picture Transparent Color: Cyan
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On WMSG_MOUSEMOVE
.head 6 -  Call SalStatusSetText( hWndMDI, 'Excluir os arquivos do Servidor' )
.head 5 -  On SAM_Click
.head 3 -  !
.head 3 +  Data Field: dfnDiasBloq
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 7.688"
.head 6 -  Top: 1.656"
.head 6 -  Width:  1.063"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Dias de Bloqueio'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _bPermiteNulos = FALSE
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  !
.head 6 -  Set _sNomeParaMsgs = 'Matrícula'
.head 6 -  !
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  Background Text: Dias p/ Bloqueio:
.data CLASSPROPSSIZE
0000: 1F00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 7461624D656E7361 67656D00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 49694
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 5.888"
.head 5 -  Top: 1.729"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  ! Tabela 
.head 3 +  Child Table: tblEstabelecimento
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001000 7461624465737469 6E61746172696F00
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK2ChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 0.823"
.head 6 -  Width:  8.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.667"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 9999999
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colsPara
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Para
.head 6 -  Visible? Yes
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.663"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: S
.head 8 -  Uncheck Value: N
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bNuncaHabilitado = FALSE
.head 8 -  Set _bSempreHabilitado = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnCod
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Código
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.138"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsNome
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nome
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.725"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsCNPJ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CNPJ/CPF
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.563"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Class Default
.head 6 -  Country: Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsLogradouro
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Logradouro
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  12.575"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 +  Functions
.head 5 +  Function: fMarcaTodos
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: objButomDisable
.head 7 -  Window Handle: objButomEnabled
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 6 +  Actions
.head 7 -  Set nLinha = -1
.head 7 +  While SalTblFindNextRow( hWndItem, nLinha, 0, 0)
.head 8 -  Call SalTblSetContext( hWndItem, nLinha )
.head 8 -  ! If colsDescSituacao = STRING_Null
.head 8 -  Set colsPara = 'S'
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_Edited, TRUE )
.head 8 -  Call SalSendMsg( colsPara, SAM_AnyEdit, wParam, lParam )
.head 7 -  ! Call SalDisableWindow( objButomDisable )
.head 7 -  ! Call SalEnableWindow( objButomEnabled )
.head 5 +  Function: fDesmarcaTodos
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: objButomDisable
.head 7 -  Window Handle: objButomEnabled
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 6 +  Actions
.head 7 -  Set nLinha = -1
.head 7 +  While SalTblFindNextRow( hWndItem, nLinha, 0, 0)
.head 8 -  Call SalTblSetContext( hWndItem, nLinha )
.head 8 -  Set colsPara = 'N'
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_Edited, FALSE )
.head 8 -  Call SalSendMsg( colsPara, SAM_AnyEdit, wParam, lParam )
.head 7 -  ! Call SalDisableWindow( objButomDisable )
.head 7 -  ! Call SalEnableWindow( objButomEnabled )
.head 4 +  Window Variables
.head 5 -  Boolean: bImp
.head 5 -  String: sTmp
.head 5 -  Number: nLinha
.head 5 -  Boolean: bVeiculoBin
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = ''
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  ! Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bPesquisaCreate = FALSE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Set _sComandoPesquisa = 'exec dbvcen..EstabelecimentoTipoCodDescS
			@nTipoEstabelecimento = :frmMsgEstabCredenciado.dfnTipoEstabelecimento'
.head 6 -  Set _sIntoPesquisa = 
':frmMsgEstabCredenciado.tblEstabelecimento.colnCod,
:frmMsgEstabCredenciado.tblEstabelecimento.colsNome,
:frmMsgEstabCredenciado.tblEstabelecimento.colsCNPJ,
:frmMsgEstabCredenciado.tblEstabelecimento.colsLogradouro '
.head 6 -  ! Set _sComandoAtualiza = ''
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  ! On UDM_AntesPesquisa
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SalTblReset( tblResultado )
.head 6 -  Return TRUE
.head 5 +  ! On UDM_AposPesquisa
.head 6 -  Call SWTabsEnable( picTabs, 1, TRUE )
.head 6 -  Call SWTabsBringToTop( picTabs, 1, TRUE )
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Call SalDisableWindow(dfsPlacaTela)
.head 6 -  ! - - - - - -
.head 6 -  ! ! Chamando a segunda parte da procedure
.head 6 +  ! If SalTblAnyRows( tblResultado, 0, 0 )
.head 7 -  Call fSegundaLeituraNaQuery()
.head 6 -  ! ! - - - - - -
.head 6 -  Return TRUE
.head 5 +  ! On SAM_FetchRowDone
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsNumeroIdentProprietarioCRV = stcolsNumeroIdentProprietarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsNomeProprietarioCRV = stcolsNomeProprietarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsNomeLogradProprietarioCRV =stcolsNomeLogradProprietarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsNumeroImovelPropCRV = stcolsNumeroImovelPropCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsComplementoImovelPropCRV = stcolsComplementoImovelPropCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsBairroImovelProprietarioCRV = stcolsBairroImovelProprietarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colnMunicipioProprietarioCRV = stcolnMunicipioProprietarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsDescMunicipioPropCRV = stcolsDescMunicipioPropCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsUfImovelProprietarioCRV = stcolsUfImovelProprietarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colnCepImovelProprietarioCRV = stcolnCepImovelProprietarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colnTipoDocArrendatarioCRV = stcolnTipoDocArrendatarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsDescTipoArrendatarioCRV = stcolsDescTipoArrendatarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsNumeroIdentArrendatarioCRV = stcolsNumeroIdentArrendatarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsNomeArrendatarioCRV = stcolsNomeArrendatarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsNomeLograArrendatarioCRV = stcolsNomeLograArrendatarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsNumImovelArrendatarioCRV = stcolsNumImovelArrendatarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsComplementoImovelCRV = stcolsComplementoImovelCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsBairroImovelArrendatarioCRV = stcolsBairroImovelArrendatarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colnMunicipioImovelCRV = stcolnMunicipioImovelCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsDescMunicipioArrendatário = stcolsDescMunicipioArrendatário
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsUfImovelArrendatarioCRV = stcolsUfImovelArrendatarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colnCepImovelArrendatarioCRV = stcolnCepImovelArrendatarioCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colsIndicadorSituacaoCRV = stcolsIndicadorSituacaoCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.coldDataCancelamentoEmissaoCRV = stcoldDataCancelamentoEmissaoCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colnHoraCancelamentoEmissaoCRV = stcolnHoraCancelamentoEmissaoCRV
.head 6 -  Set frmConsHistAutorizaEmissaoCRV.tblResultado.colnIndicadorCrvEletronico = stcolnIndicadorCrvEletronico
.head 5 -  !
.head 5 +  ! On MSG_PesquisaTabela
.head 6 -  !
.head 6 -  Set _sComandoPesquisa = 'exec dbvcen..EstabelecimentoTipoCodDescS
	@nTipoEstabelecimento = :frmMsgEstabCredenciado.dfnTipoEstabelecimento'
.head 6 -  Return SalSendClassMessage( MSG_PesquisaTabela, wParam, lParam )
.head 6 -  !
.head 6 -  Call SWTabsEnable( picTabs, 1, TRUE )
.head 6 -  Call SWTabsBringToTop( picTabs, 1, TRUE )
.head 6 -  Return TRUE
.head 3 +  Child Table: tblArquivos
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 746162416E65786F 7300000000
.enddata
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK2ChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.288"
.head 6 -  Top: 1.49"
.head 6 -  Width:  8.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 32000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colsNomeArquivo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nome Arquivo
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnTamanho
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Tamanho
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: coldDataArquivo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Data Arquivo
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.188"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd/mm/yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsCaminho
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Caminho Origem
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.188"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Boolean: bImp
.head 5 -  String: sTmp
.head 5 -  Number: nLinha
.head 5 -  Boolean: bVeiculoBin
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = ''
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _sCriacaoConexao = 'Default'
.head 6 -  !
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bPesquisaCreate = FALSE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  Set _sComandoPesquisa = '?'
.head 6 -  !
.head 6 -  Set _sComandoAtualiza = ''
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  !
.head 3 +  Picture: picSemaforo
.data CLASSPROPSSIZE
0000: 3900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002600 7461624465737469 6E61746172696F09
0020: 7461624D656E7361 67656D0974616241 6E65786F73000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1FormTabs
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.05"
.head 5 -  Top: 4.073"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: fLocalizarArquivo
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! String: strFilters[0:3]
.head 5 -  String: strFilters[*]
.head 5 -  String: strFile
.head 5 -  String: strPath
.head 5 -  Number: nIndice
.head 4 +  Actions
.head 5 -  ! Set strFilters[0] = 'Arquivo BMP ou JPG'
.head 5 -  ! Set strFilters[1] = '*.bmp*'
.head 5 -  ! Set strFilters[2] = '*.jpg'
.head 5 -  ! Set strFilters[2] = '*.*'
.head 5 -  Set strFilters[0] = "Imagem JPG"
.head 5 -  Set strFilters[1] = "*.JPG"
.head 5 -  Set strFilters[2] = "Imagem JPEG"
.head 5 -  Set strFilters[3] = "*.JPEG"
.head 5 -  Set strFilters[4] = "Imagem BMP"
.head 5 -  Set strFilters[5] = "*.BMP"
.head 5 -  Set strFilters[6] = "Todos Arquivos"
.head 5 -  Set strFilters[7] = "*.*"
.head 5 +  If SalDlgOpenFile ( frmMsgEstabCredenciado, 'Anexar Arquivos', strFilters, 8, nIndice, strFile, strPath )
.head 6 -  Set dfsCaminho = strPath
.head 3 +  Function: fValidaCampos
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strFilters[0:1]
.head 5 -  String: strFile
.head 5 -  String: strPath
.head 5 -  Number: nIndice
.head 4 +  Actions
.head 5 -  Set strFilters[0] = 'Todos os Arquivos'
.head 5 -  Set strFilters[1] = '*.*'
.head 5 +  If SalDlgOpenFile ( frmMsgEstabCredenciado, 'Anexar Arquivos', strFilters, 2, nIndice, strFile, strPath )
.head 6 -  Set dfsCaminho = strPath
.head 3 +  Function: fAnexar
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bReturn
.head 5 -  File Handle: fhFile
.head 5 -  Number: nTamanho
.head 5 -  String: asArquivo [*]
.head 5 -  Number: anTamanho [*]
.head 5 -  Date/Time: adData [*]
.head 5 -  Number: nItem
.head 5 -  Number: anAtributo [*]
.head 5 -  Number: nAux
.head 4 +  Actions
.head 5 -  !
.head 5 -  Call VisDosEnumFileInfo( dfsCaminho, FA_Standard, asArquivo, anTamanho, adData, anAtributo )
.head 5 -  !
.head 5 +  ! If NOT fValidaNameFile(asArquivo[0])
.head 6 -  Call SalMessageBox( 'O nome do arquivo deve conter aperna letras e números, sem acentuação ou espaços em branco.','Atenção', MB_Ok | MB_IconInformation )
.head 6 -  Return FALSE
.head 5 +  If NOT fValidaNameFile(asArquivo[0])
.head 6 -  Return FALSE
.head 5 -  ! Call fValidaNameFile(asArquivo[0])
.head 5 -  Set nTamanho = anTamanho[0]
.head 5 -  Set nTamanho = SalNumberRound (nTamanho/1024)
.head 5 -  !
.head 5 -  Set nAux = TBL_MinRow
.head 5 +  While SalTblFindNextRow( tblArquivos, nAux, 0, 0)
.head 6 -  Call SalTblSetContext( tblArquivos, nAux )
.head 6 +  If tblArquivos.colsCaminho = dfsCaminho OR tblArquivos.colsNomeArquivo =  asArquivo[0]
.head 7 -  Call SalMessageBox( 'Esse arquivo já foi anexado! ','Atenção', MB_Ok | MB_IconInformation )
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  ! - Seta menor linha da tabela
.head 5 -  Set nLinhaAtual = TBL_MinRow
.head 5 -  ! - Cria uma linha
.head 5 -  Call SalTblInsertRow( tblArquivos, TBL_MaxRow )
.head 5 -  ! - Seta o contexto na linha da tabela
.head 5 -  Call SalTblSetContext(tblArquivos, nLinhaAtual)
.head 5 -  Set tblArquivos.colsNomeArquivo =  asArquivo[0]
.head 5 -  Set tblArquivos.colsCaminho =  dfsCaminho
.head 5 -  Set tblArquivos.coldDataArquivo = adData[0]
.head 5 -  Set tblArquivos.colnTamanho = anTamanho[0]
.head 5 -  !
.head 5 +  ! While SalTblFindNextRow( tblArquivos, nLinhaAtual, ROW_New, 0 )
.head 6 +  If SalTblFindNextRow( tblArquivos, nLinhaAtual, ROW_New, 0)
.head 7 -  Call SalTblSetContext( tblArquivos, nLinhaAtual )
.head 7 +  If tblArquivos.colsCaminho = dfsCaminho
.head 8 -  Call SalMessageBox( 'Esse arquivo já foi anexado! ','Atenção', MB_Ok | MB_IconInformation )
.head 8 -  Return FALSE
.head 7 +  Else 
.head 8 -  Call SalTblInsertRow( tblArquivos, TBL_MaxRow )
.head 8 -  !
.head 8 -  Set tblArquivos.colsNomeArquivo =  asArquivo[0]
.head 8 -  Set tblArquivos.colsCaminho =  dfsCaminho
.head 8 -  Set tblArquivos.coldDataArquivo = adData[0]
.head 8 -  Set tblArquivos.colnTamanho = nTamanho
.head 8 -  !
.head 8 -  Set dfsCaminho = ''
.head 7 +  ! Else 
.head 8 -  Call SalTblGetColumnText(tblArquivos,colsNomeArquivo, asArquivo[0] )
.head 8 -  Call SalTblGetColumnText(tblArquivos,colnTamanho, nTamanho )
.head 8 -  Call SalTblGetColumnText(tblArquivos,coldDataArquivo, adData[0] )
.head 8 -  Call SalTblGetColumnText(tblArquivos,colsCaminho, dfsCaminho )
.head 8 -  Set dfsCaminho = ''
.head 5 +  ! If SalFileOpen( fhFile, dfsCaminho, OF_Exist )
.head 6 -  Call VisDosEnumFileInfo( dfsCaminho, FA_Standard, asArquivo, anTamanho, adData, anAtributo )
.head 6 +  If NOT fValidaNameFile(asArquivo[0])
.head 7 -  Call SalMessageBox( 'O nome do arquivo deve conter aperna letras e números, sem acentuação ou espaços em branco.','Atenção', MB_Ok | MB_IconInformation )
.head 7 -  Return FALSE
.head 6 -  Set nTamanho = anTamanho[0]
.head 6 -  Set nTamanho = SalNumberRound (nTamanho/1024)
.head 6 +  ! If dfUsado + nTamanho > dfTotal4)
.head 7 -  Call SalMessageBox( 'Ultrapassado o limite de anexos para essa mensagem !!!', DEF_TITLE, MB_Ok)
.head 6 +  ! Else If lvAnexos.fFindItemText( dfsCaminho, -1 ) > -1
.head 7 -  Call SalMessageBox( 'Esse arquivo já foi anexado !!!','Atenção', MB_Ok | MB_IconInformation )
.head 6 +  While SalTblFindNextRow( tblArquivos, nAux, 0, 0 )
.head 7 +  If SalTblFindNextRow( tblArquivos, nLinhaAtual, ROW_New, 0)
.head 8 -  Call SalTblSetContext( tblArquivos, nLinhaAtual )
.head 8 +  If tblArquivos.colsNomeArquivo = dfsCaminho
.head 9 -  Call SalMessageBox( 'Esse arquivo já foi anexado! ','Atenção', MB_Ok | MB_IconInformation )
.head 9 -  Return FALSE
.head 8 +  Else 
.head 9 -  ! Set nItem = lvAnexos.GetItemCount()
.head 9 -  ! Call lvAnexos.colsNomeArquivo(nItem,dfsCaminho, 0)
.head 9 -  Set tblArquivos.colsNomeArquivo =  asArquivo[0]
.head 9 -  Set tblArquivos.colsCaminho =  dfsCaminho
.head 9 -  Set tblArquivos.coldDataArquivo = adData[0]
.head 9 -  Set tblArquivos.colnTamanho = nTamanho
.head 9 -  ! Set tblArquivos.colsTamanho = VisFileGetSize(dfsCaminho)
.head 9 -  ! Set dfUsado = dfUsado +  nTamanho
.head 9 -  ! Set dfDisp = dfDisp - nTamanho
.head 9 -  ! Call pgbDisp.SetProgress( 100 - ( (dfDisp/dfTotal ) *100 ) )
.head 9 +  ! If ( 100 - ( (dfDisp/dfTotal ) *100 ) ) > 100
.head 10 -  Call pgbDisp.SetProgress( 100 )
.head 9 +  ! If dfDisp < 0
.head 10 -  Set dfDisp = 0
.head 9 -  Set dfsCaminho = ''
.head 6 +  ! Else 
.head 7 -  Set nItem = lvAnexos.GetItemCount()
.head 7 -  Call lvAnexos.colsNomeArquivo(nItem,dfsCaminho, 0)
.head 7 -  Call lvAnexos.SetItemText(nItem, 1, SalNumberToStrX( nTamanho,0 ) )
.head 7 -  Call lvAnexos.SetItemText(nItem, 2, SalFmtFormatDateTime( adData[0], 'dd/MM/yyyy hhhh:mm' ) )
.head 7 -  Call lvAnexos.SetItemText(nItem, 3, asArquivo[0])
.head 7 -  ! Set dfUsado = dfUsado +  nTamanho
.head 7 -  ! Set dfDisp = dfDisp - nTamanho
.head 7 -  ! Call pgbDisp.SetProgress( 100 - ( (dfDisp/dfTotal ) *100 ) )
.head 7 +  If ( 100 - ( (dfDisp/dfTotal ) *100 ) ) > 100
.head 8 -  Call pgbDisp.SetProgress( 100 )
.head 7 +  If dfDisp < 0
.head 8 -  Set dfDisp = 0
.head 7 -  Set dfNomeArquivo = ''
.head 5 +  ! Else
.head 6 -  Call SalMessageBox( 'Arquivo para anexar não encontrado !!!', DEF_TITLE, MB_Ok )
.head 5 -  Set dfsCaminho = ''
.head 3 +  Function: fValidaNameFile
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sFile
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nCont
.head 5 -  String: sCaracter
.head 5 -  String: sCaracterValido
.head 5 -  String: sExtencao
.head 4 +  Actions
.head 5 -  Set nCont = 0
.head 5 -  Set sCaracterValido = 'abcdefghijklmnopqrstuvwxyz1234567890_'
.head 5 -  Set sExtencao = SalStrMidX( sFile, SalStrLength(sFile) - 4, 4 )
.head 5 -  Set sExtencao = SalStrLowerX( sExtencao )
.head 5 +  If sExtencao = '.bmp' OR sExtencao = '.jpg' OR sExtencao = '.pdf'
.head 6 -  Set sFile = SalStrLeftX( sFile, SalStrLength(sFile) - 4 )
.head 6 +  While nCont < SalStrLength(sFile)
.head 7 -  Set sCaracter = SalStrMidX( sFile, nCont, 1 )
.head 7 +  If SalStrScan( sCaracterValido, SalStrLowerX( sCaracter ) ) < 0
.head 8 -  Call SalMessageBox( 'O nome do arquivo deve conter apenas letras e números, sem acentuação ou espaços em branco.','Atenção', MB_Ok | MB_IconInformation )
.head 8 -  Return FALSE
.head 7 -  Set nCont = nCont + 1
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'São permitidos apenas arquivos dos formatos: JPG, BMP e PDF ','Atenção', MB_IconStop | MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: fValidarCampos
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPath
.head 5 -  Number: nContEstab
.head 5 -  Number: nLinhaEstab
.head 5 -  Number: nContArquivos
.head 5 -  Number: nLinhaArquivos
.head 4 +  Actions
.head 5 -  ! Verifica se algum Estabelecimento foi selecionado / se nenhum for selecionado, exibi mensagem exgindo
.head 5 -  Set nContEstab = 0
.head 5 -  Set nLinhaEstab = TBL_MinRow
.head 5 +  While SalTblFindNextRow( tblEstabelecimento, nLinhaEstab, 0, 0)
.head 6 -  Call SalTblSetContext( tblEstabelecimento, nLinhaEstab )
.head 6 +  If colsPara = 'S'
.head 7 -  Set nContEstab = nContEstab + 1
.head 5 +  If nContEstab = 0 
.head 6 -  Call SalMessageBox( ' Um ou mais estabelecimentos devem ser selecionados! ','Atenção', MB_IconStop | MB_Ok )
.head 6 -  Return FALSE
.head 5 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------
.head 5 -  ! Verifica se foi anexado algum arquivo / se nenhum aqrquivo foi anexado, exibi mensagem exgindo
.head 5 +  If SalTblAnyRows( tblArquivos, 0, 0 ) = 0
.head 6 -  Call SalMessageBox( ' Nenhum arquivo anexado! ','Atenção', MB_IconStop | MB_Ok )
.head 6 -  Return FALSE
.head 5 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------
.head 5 -  ! Controle dos campos mensagem
.head 5 +  If dfnTipoEstabelecimento = NUMBER_Null or dfnTipoEstabelecimento = 0
.head 6 -  Call SalMessageBox( ' Tipo Estabelecimento deve ser selecionado!  ','Atenção', MB_IconStop | MB_Ok )
.head 6 -  Return FALSE
.head 5 +  If dfnSetor = NUMBER_Null or dfnSetor = 0
.head 6 -  Call SalMessageBox( ' Setor Remetente deve ser informado!  ','Atenção', MB_IconStop | MB_Ok )
.head 6 -  Return FALSE
.head 5 +  If dfnDiasBloq = NUMBER_Null or dfnDiasBloq = 0
.head 6 -  Call SalMessageBox( ' Deve ser informado Dias p/ Bloqueio!  ','Atenção', MB_IconStop | MB_Ok )
.head 6 -  Return FALSE
.head 5 +  If dfsAssunto = STRING_Null or dfsAssunto = '' 
.head 6 -  Call SalMessageBox( ' Deve ser informado Assunto da Mensagem!  ','Atenção', MB_IconStop | MB_Ok )
.head 6 -  Return FALSE
.head 5 +  If mlMensagem = STRING_Null or mlMensagem = ''
.head 6 -  Call SalMessageBox( ' Deve ser informada a Mensagem!  ','Atenção', MB_IconStop | MB_Ok )
.head 6 -  Return FALSE
.head 5 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------
.head 5 -  Return TRUE
.head 3 +  Function: fMensagemI
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nTipo
.head 5 -  Date/Time: dEnvio
.head 5 -  Number: nSetorRemetende
.head 5 -  String: sAssunto
.head 5 -  String: sMensagem1
.head 5 -  String: sMensagem2
.head 5 -  String: sMensagem3
.head 5 -  String: sMensagem4
.head 5 -  Number: nDiasBloqueia
.head 5 -  String: siAtivo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlMsgI
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  If fMPSConnect( hSqlMsgI )
.head 6 +  If fMPSPrepareProc( hSqlMsgI, 'exec dbfisc01..MensagemI
@nTipo 		= :nTipo,
@dEnvio 		= :dEnvio,
@nSetor	 	= :nSetorRemetende,
@sAssunto 	= :sAssunto,
@sMensagem1 	= :sMensagem1,
@sMensagem2 	= :sMensagem2,
@sMensagem3 	= :sMensagem3,
@sMensagem4 	= :sMensagem4,
@nDiasBloqueia 	= :nDiasBloqueia,
@siAtivo		= :siAtivo', 
':frmMsgEstabCredenciado.nMensagem' )
.head 7 +  If SqlExecute( hSqlMsgI )
.head 8 -  While SqlFetchNext( hSqlMsgI, lParam )
.head 7 +  Else
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  Return FALSE
.head 8 -  ! Foi colocado o elsealmir 17-06-2022
.head 7 -  Call fMPSDisconnect( hSqlMsgI )
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  Return TRUE
.head 3 +  ! Function: fMensagemI
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: nTipo
.head 5 -  Date/Time: dEnvio
.head 5 -  Number: nSetorRemetende
.head 5 -  String: sAssunto
.head 5 -  String: sMensagem1
.head 5 -  String: sMensagem2
.head 5 -  String: sMensagem3
.head 5 -  String: sMensagem4
.head 5 -  Number: nDiasBloqueia
.head 5 -  String: siAtivo
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Sql Handle: hSqlMsgI
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Call fMPSConnect( hSqlMsgI )
.head 5 -  Call fMPSPrepareProc( hSqlMsgI, 'exec dbfisc01..MensagemI
@nTipo 		= :nTipo,
@dEnvio 		= :dEnvio,
@nSetor	 	= :nSetorRemetende,
@sAssunto 	= :sAssunto,
@sMensagem1 	= :sMensagem1,
@sMensagem2 	= :sMensagem2,
@sMensagem3 	= :sMensagem3,
@sMensagem4 	= :sMensagem4,
@nDiasBloqueia 	= :nDiasBloqueia,
@siAtivo		= :siAtivo', 
':frmMsgEstabCredenciado.nMensagem' )
.head 5 -  Call SqlExecute( hSqlMsgI )
.head 5 -  Call SqlFetchNext( hSqlApp, lParam )
.head 5 -  Call fMPSDisconnect( hSqlMsgI )
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  Function: fMsgEstabI
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nMensagem
.head 5 -  Number: nEstabelecimento
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlMsgEstabI
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  If fMPSConnect( hSqlMsgEstabI )
.head 6 +  If fMPSPrepareProc( hSqlMsgEstabI, 'exec dbfisc01..MensagemEstabelecimentoI
@nMensagem 	= :nMensagem,
@nEstabelecimento 	= :nEstabelecimento', 
':frmMsgEstabCredenciado.nMensagem' )
.head 7 +  If SqlExecute( hSqlMsgEstabI )
.head 8 -  While SqlFetchNext( hSqlMsgEstabI, lParam )
.head 6 -  Call fMPSDisconnect( hSqlMsgEstabI )
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  ! Function: fAnexoMensagemI
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Number: nMensagem
.head 5 -  Number: nSequencial
.head 5 -  String: sNomeArquivo
.head 5 -  String: sCaminho
.head 5 -  String: sExtensao
.head 5 -  Number: nTamanho
.head 5 -  String: sGuid
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Sql Handle: hSqlMsgAnexo
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  If fMPSConnect( hSqlMsgAnexo )
.head 6 +  If fMPSPrepareProc( hSqlMsgAnexo, 'exec dbfisc01..AnexoMensagemI
@nMensagem 	= :nMensagem,
@nSequencial 	= :nSequencial,
@sNomeArquivo 	= :sNomeArquivo,
@sCaminho 	= :sCaminho,
@sExtensao 	= :sExtensao,
@nTamanho 	= :nTamanho,
@sGuid 		= :sGuid', '' )
.head 7 +  ! If SqlExecute( hSqlMsgAnexo )
.head 8 -  While SqlFetchNext( hSqlMsgAnexo, lParam )
.head 6 -  Call fMPSDisconnect( hSqlMsgAnexo )
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  Function: fAnexoMensagemI
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nMensagem
.head 5 -  Number: nSequencial
.head 5 -  String: sNomeArquivo
.head 5 -  String: sCaminho
.head 5 -  String: sExtensao
.head 5 -  Number: nTamanho
.head 5 -  String: sGuid
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlMsgAnexo
.head 5 -  Number: nErro
.head 5 -  Number: nRetorno
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Call fMPSConnect( hSqlMsgAnexo )
.head 5 -  Call fMPSPrepareProc( hSqlMsgAnexo, 'exec dbfisc01..AnexoMensagemI
@nMensagem 	= :nMensagem,
@nSequencial 	= :nSequencial,
@sNomeArquivo 	= :sNomeArquivo,
@sCaminho 	= :sCaminho,
@sExtensao 	= :sExtensao,
@nTamanho 	= :nTamanho,
@sGuid 		= :sGuid', ':nRetorno' )
.head 5 -  Call SqlExecute( hSqlMsgAnexo )
.head 5 -  Call SqlFetchNext( hSqlMsgAnexo, nErro )
.head 5 -  Call fMPSDisconnect( hSqlMsgAnexo )
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  Function: fArquivoI
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sCaminho
.head 5 -  String: sExtensao
.head 5 -  String: sGuid
.head 5 -  String: sNomeArquivo
.head 5 -  Number: nTamanho
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlArquivo
.head 5 -  Number: nErro
.head 5 -  Number: nRetorno
.head 5 -  String: sDados
.head 5 -  Number: Ret
.head 4 +  Actions
.head 5 -  Set sDados = STRING_Null
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Call fMPSConnect( hSqlArquivo )
.head 5 -  Call fMPSPrepareProc( hSqlArquivo, 'exec MPS..ArquivoI
@Caminho 	= :sCaminho,
@Extensao 	= :sExtensao,
@Guid	 	= :sGuid,
@Nome 		= :sNomeArquivo,
@Peso 		= :nTamanho',
'' )
.head 5 -  Call SqlExecute( hSqlArquivo )
.head 5 -  ! Call SqlFetchNext( hSqlArquivo, nErro )
.head 5 -  Call fMPSDisconnect( hSqlArquivo )
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  Function: fAnexoConfigS
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlAnexoConfig
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  If fMPSConnect( hSqlAnexoConfig )
.head 6 +  If fMPSPrepareProc( hSqlAnexoConfig, 'exec dbfisc01..AnexoMensagemConfigS ', 
':frmMsgEstabCredenciado.sCaminho, :frmMsgEstabCredenciado.sGuid' )
.head 7 +  If SqlExecute( hSqlAnexoConfig )
.head 8 -  While SqlFetchNext( hSqlAnexoConfig, lParam )
.head 7 -  Call fMPSDisconnect( hSqlAnexoConfig )
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  Return TRUE
.head 3 +  Function: fEnviar
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLinhaEstab
.head 5 -  Number: nLinhaArquivo
.head 5 -  String: sTipoArq
.head 5 -  String: sCaminho1
.head 5 -  String: sCaminho2
.head 5 -  Number: nSequencial
.head 4 +  Actions
.head 5 +  If NOT fValidarCampos()
.head 6 -  Return FALSE
.head 5 -  ! Call fValidarCampos()
.head 5 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------
.head 5 +  If NOT SalIsNull(mlMensagem)
.head 6 -  Set sMensagem01 = SalStrLeftX( mlMensagem, 250 )
.head 6 -  Set sMensagem02 = SalStrMidX( mlMensagem, 250, 250)
.head 6 -  Set sMensagem03 = SalStrMidX( mlMensagem, 500, 250)
.head 6 -  Set sMensagem04 = SalStrMidX( mlMensagem, 750, 250)
.head 5 +  If NOT fMensagemI( nTipoMensagem, DATETIME_Null, dfnSetor, dfsAssunto, sMensagem01, sMensagem02, sMensagem03, sMensagem04, dfnDiasBloq,  'S'  )
.head 6 -  ! Call SalMessageBox( 'Problemas na gravação da Mensagem! Verificar com a DUI! ','Atenção', MB_IconStop | MB_Ok )
.head 6 -  Return FALSE
.head 5 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------
.head 5 -  Set nLinhaEstab = TBL_MinRow
.head 5 +  While SalTblFindNextRow( tblEstabelecimento, nLinhaEstab, 0, 0)
.head 6 -  Call SalTblSetContext( tblEstabelecimento, nLinhaEstab )
.head 6 +  If colsPara = 'S'
.head 7 +  ! If NOT fMsgEstabI( frmMsgEstabCredenciado.nMensagem, frmMsgEstabCredenciado.tblEstabelecimento.colnCod )
.head 8 -  Call SalMessageBox( 'Problemas na gravação do(s) Estabelecimento(s)! Verificar com a DUI! ','Atenção', MB_IconStop | MB_Ok )
.head 8 -  Return FALSE
.head 7 -  Call fMsgEstabI( frmMsgEstabCredenciado.nMensagem, frmMsgEstabCredenciado.tblEstabelecimento.colnCod )
.head 6 -  ! Call SalTblSetRowFlags( hWndItem, nLinha, ROW_Edited, TRUE )
.head 6 -  ! Call SalSendMsg( colsPara, SAM_AnyEdit, wParam, lParam )
.head 5 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------
.head 5 -  Set nSequencial = 1 
.head 5 -  Set nLinhaArquivo = TBL_MinRow
.head 5 +  While SalTblFindNextRow (tblArquivos, nLinhaArquivo, 0, 0 )
.head 6 -  Call SalTblSetContext( tblArquivos, nLinhaArquivo )
.head 6 -  Call fAnexoConfigS()
.head 6 +  If NOT VisDosExist( sCaminho )
.head 7 -  Call VisDosMakeAllDir( sCaminho )
.head 6 -  Call VisFileCopy( tblArquivos.colsCaminho, sCaminho )
.head 6 -  ! Set sTipoArq = VisFileGetType( tblArquivos.colsCaminho ) 
.head 6 -  Set sTipoArq = SalStrMidX( tblArquivos.colsNomeArquivo, SalStrLength(tblArquivos.colsNomeArquivo) - 4, 4 )
.head 6 -  Set sTipoArq = SalStrLowerX( sTipoArq )
.head 6 -  Set sCaminho1= sCaminho || '\\' || tblArquivos.colsNomeArquivo
.head 6 -  Set sCaminho2= sCaminho || '\\' || sGuid || sTipoArq
.head 6 -  Call VisFileRename( sCaminho1 , sCaminho2 )
.head 6 -  ! ------------------------------------------------------------------------------------------------------------------------------------------------ 
.head 6 -  ! Call fAnexoMensagemI ( nMensagem, nSequencial, tblArquivos.colsNomeArquivo, sCaminho2, sTipoArq, tblArquivos.colnTamanho, sGuid )
.head 6 -  ! Call fArquivoI (sCaminho, sTipoArq, sGuid,  tblArquivos.colsNomeArquivo, tblArquivos.colnTamanho )
.head 6 -  Call fAnexoMensagemI ( nMensagem, nSequencial, SalStrLeftX( tblArquivos.colsNomeArquivo, SalStrLength(tblArquivos.colsNomeArquivo) - 4 ), sCaminho2, sTipoArq, tblArquivos.colnTamanho, sGuid )
.head 6 -  Call fArquivoI (sCaminho, sTipoArq, sGuid,  SalStrLeftX( tblArquivos.colsNomeArquivo, SalStrLength(tblArquivos.colsNomeArquivo) - 4 ), tblArquivos.colnTamanho )
.head 6 -  ! ------------------------------------------------------------------------------------------------------------------------------------------------  
.head 6 -  Set nSequencial = nSequencial + 1 
.head 5 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------
.head 5 -  Return TRUE
.head 3 +  ! Function: fAnexoConfigS
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Sql Handle: hSqlAnexoConfig
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  If NOT fMPSConnect( hSqlAnexoConfig )
.head 6 -  Return FALSE
.head 5 +  If NOT fMPSPrepareProc( hSqlAnexoConfig, 'exec dbfisc01..AnexoMensagemConfigS ', 
':frmMsgEstabCredenciado.sCaminho, :frmMsgEstabCredenciado.nGuid  ' )
.head 6 -  Call fMPSDisconnect( hSqlAnexoConfig )
.head 6 -  Return FALSE
.head 5 +  If NOT SqlExecute( hSqlAnexoConfig )
.head 6 -  Call fMPSDisconnect( hSqlAnexoConfig )
.head 6 -  Return FALSE
.head 5 -  Call SqlFetchNext( hSqlAnexoConfig, lParam )
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  Return TRUE
.head 3 +  ! Function: fValidaTipoArquivo
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  String: sFile
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nCont
.head 5 -  String: sCaracter
.head 5 -  String: sCaracterValido
.head 5 -  String: sExtencao
.head 4 +  Actions 
.head 5 -  Set nCont = 0
.head 5 -  Set sCaracterValido = 'abcdefghijklmnopqrstuvwxyz1234567890_'
.head 5 -  Set sExtencao = SalStrMidX( sFile, SalStrLength(sFile) - 4, 4 )
.head 5 -  Set sExtencao = SalStrLowerX( sExtencao )
.head 5 +  If sExtencao != '.bmp' OR sExtencao != '.jpg' OR sExtencao != '.pdf'
.head 6 -  Call SalMessageBox( 'São permitidos apenas arquivos dos formatos: JPG, BMP e PDF ','Atenção', MB_IconStop | MB_Ok )
.head 6 -  Return FALSE
.head 5 -  ! Set sFile = SalStrLeftX( sFile, SalStrLength(sFile) - 5 )
.head 5 +  ! Else 
.head 6 -  Set sFile = SalStrLeftX( sFile, SalStrLength(sFile) - 4 )
.head 5 +  ! While nCont < SalStrLength(sFile)
.head 6 -  Set sCaracter = SalStrMidX( sFile, nCont, 1 )
.head 6 +  If SalStrScan( sCaracterValido, SalStrLowerX( sCaracter ) ) < 0
.head 7 -  Return 0
.head 6 -  Set nCont = nCont + 1
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nNumSeqTransacao
.head 3 -  Number: nResult
.head 3 -  Number: nTipoMensagem
.head 3 -  Number: nLinhaAtual
.head 3 -  String: sDestino
.head 3 -  Number: nTipoEstabelecimento
.head 3 -  Number: nMensagem
.head 3 -  String: sGuid
.head 3 -  String: sCaminho 
.head 3 -  String: sMensagem01
.head 3 -  String: sMensagem02
.head 3 -  String: sMensagem03
.head 3 -  String: sMensagem04
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set _sTextoStatusBar = ''
.head 4 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 4 -  Set _sCriacaoConexao = 'Default'
.head 4 -  Set _nEstadoInicialForm = EF_RegistroExistente
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SWTabsBringToTop( picTabs, 0, TRUE ) 
.head 4 -  Call SalSendMsg( pbPesquisar, MSG_Desabilita1, wParam, lParam )
.head 4 -  Set nTipoMensagem = 1
.head 4 -  Call SalSendClassMessage( SAM_CreateComplete, wParam, lParam )
.head 4 -  Set dfnDiasBloq = 1
.head 3 +  On MSG_Limpa
.head 4 -  Call SalSendClassMessage( MSG_Limpa, wParam, lParam )
.head 4 -  Call SalTblReset( tblEstabelecimento )
.head 4 -  Set dfnDiasBloq = 1
.head 0 -  




  