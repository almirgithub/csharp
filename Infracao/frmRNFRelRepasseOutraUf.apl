Application Description: Centura SQLWindows Standard Application Template
	Outline Version - 4.0.28
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000F00000 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left: -0.013"
			Top: 0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left: 4.15"
			Top: 1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left: 0.575"
			Top: 0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left: 6.388"
			Top: 0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: Tela_Arrecadacao.apl
		! File Include: frmRelRepasseInf.apl
		File Include: SaidaArquivo.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: Use Parent
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Input: 9999
			Number: #0
			Number: 0'%'
			Number: #0
			Input: 999999999
			Input: 999999
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
			Enumerations
		Resources
		Variables
.data RESOURCE 0 0 1 2997257639
0000: 2200000013000000 0000000000000000 020000010000005D 020000D019000000
0020: 01FE00FF03
.enddata
		Internal Functions
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 1443028049
0000: AC030000CA010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666FC2003C00 000A630051434B31
0040: 47657261006C0202 00001100001E0004 0000C20003000000 FF7F048300190000
0060: 00F001000000FF1F 1D0000AC00190001 FD00FF0736000000 196B000100FFFFC1
0080: 4F00000019DA0001 00FF7F68B0000000 0400F4020000FF1F 6C0000AC00040002
00A0: FD00FF0770000000 046B000200FFFFC1 7400000004DA0002 00FF7F78B0000000
00C0: 0400F60200FF1F7C 0000AC00040002FD 00FF17800000046B 000200FFFFC18400
00E0: 000004DA000200FF 7F88B00000000400 F60200FF1F8C0000 AC00190001FD00FF
0100: 07A5000000196B00 0100FFFFC1BE0000 0004DA000200FF7F 0180803E00000001
0120: 0070000E63514340 6F6E7461696E7220 AA0000000500006F 0400E801020000FF
0140: C18001000000BF04 190019000101FA00 007F80F20100000F 0800000096190001
0160: 00FE00FF83210000 0004B5000200FFFF 60250000001900ED 0100FF3F01806404
0180: 0000020038086351 4D44804922000000 0100DE0004DA0002 00FF7F01CC800400
01A0: 0370000D63514300 6865636B426F7822 A20000010000B704 00F60200FF1F0180
01C0: 0433000400060063 4461646F732200D1 000100005B040002 FB00FF0F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton:
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
			ActiveX:
		Application Actions
	Form Window: frmRNFRelRepasseOutraUf
		Class: cQCK1Form
		Property Template:
		Class DLL Name:
		Title: Repasse de Infrações RENAINF (Outras UF's) 
		Icon File:
		Accessories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? No
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left: 1.413"
				Top: 0.583"
				Width:  7.825"
				Width Editable? Class Default
				Height: 2.729"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
				Função      : Relatório de repasse dos valores das infrações RENAINF arrecadados em outras UFs e pagos ao DETRAN-PE
				Data-Autor: 11/12/2012 - [faml] FlavioLago@detran.pe.gov.br 
				------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
				Alteração  : Criar o relatório resumido
				Data-Autor: 07/05/2013 - [faml] FlavioLago@detran.pe.gov.br 
				------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
				Alteração  : Emitir o ordenador de despesa do parâmetro geral da Arrecadação no relatório resumido
				Data-Autor: 03/01/2014 - [faml] FlavioLago@detran.pe.gov.br 
				------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
		Contents
			Frame
				Resource Id: 19142
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.038"
					Top: 0.031"
					Width:  7.5"
					Width Editable? Yes
					Height: 2.177"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: 3D Face Color
			! --------- parâmetros
			Background Text: Vigência:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 44656269746F0000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
				Resource Id: 19145
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 0.188"
					Top: 0.125"
					Width:  1.063"
					Width Editable? Class Default
					Height: 0.167"
					Height Editable? Class Default
				Visible? Yes
				Justify: Left
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Data Field: dfdVigencia
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 44656269746F0000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Date/Time
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 1.513"
						Top: 0.083"
						Width:  1.05"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Right
					Format: MM-yyyy
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 99-9999
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Vigência'
						Set _sNomeParaMsgs = 'Vigência'
						Set _bVisivel = TRUE
						Set _bPermiteNulos = FALSE
						Set _sTipoMsgValidacao = 'ESPECIFICA'
						Set _sMsgValidacao = 'Data Inválida!'
						Set _bSempreHabilitado = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					! On UDM_ValidaCampo
						If NOT SalIsNull( hWndItem )
							Return dfnExercicio > 1900 and dfnExercicio < 2100
			Background Text: Município:
				Resource Id: 19144
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.2"
					Top: 0.427"
					Width:  0.875"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfnMunicipio
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Number
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 1.525"
						Top: 0.396"
						Width:  1.05"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Right
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 9999
				Message Actions
					On SAM_Create
						! ! ------------- código do município da tab Cadastro
						Set _sTextoStatusBar = 'Município'
						Set _sNomeParaMsgs = 'Município'
						!
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _bSempreHabilitado = TRUE
						! ! Dados para a pesquisa F2
						Set _sConsultaFrmOpcoesSQLOuSP = 'SP'
						Set _sConsultaFrmOpcoesCampo= 'Exec dbvcen..MunicipioS_codigodesc2 @UF = PE'
						Set _sConsultaFrmOpcoesColunaOuParam = '@Desc'
						! Set _sValorDefault= ' '
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Data Field: dfsMunicipio
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 2.613"
						Top: 0.396"
						Width:  3.813"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _bÉCampoDescrição = TRUE
						Set _bNuncaHabilitado = TRUE
						Set _bPermiteNulos = TRUE
						! ! Pesquisa da descrição
						Set _bÉDependente = TRUE
						Set _sCamposResponsaveis[0] = 'dfnMunicipio'
						Set _sConsultaDescrição = 'exec dbvcen..MunicipioS_descricao2  @Cod = :frmRNFRelRepasseOutraUf.dfnMunicipio'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_SetFocus
						If dfsSaida = 'I' 
							Call SalEnableWindow( pbImpressora )
						Else
							Call SalDisableWindow( pbImpressora )
						!
						Return TRUE
			Background Text: Órgão Autuante:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5469706F00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 36880
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 0.163"
					Top: 0.781"
					Width:  1.325"
					Width Editable? Class Default
					Height: 0.167"
					Height Editable? Class Default
				Visible? Yes
				Justify: Left
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Data Field: dfnOrgaoAutuante
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5469706F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Number
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 1.525"
						Top: 0.74"
						Width:  1.038"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Right
					Format: #0
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 999999
				Message Actions
					On SAM_Create
						! ------------- código do OrgaoAutuante da tab CADASTRO
						Set _sTextoStatusBar = 'Orgao Autuante Municipal'
						Set _sNomeParaMsgs =  'Orgao Autuante Municipal'
						!
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _bSempreHabilitado = TRUE
						Set _bDisparaConsultaEmValidate = FALSE
						! Dados para a pesquisa F2
						Set _sConsultaFrmOpcoesSQLOuSP = 'SP'
						Set _sConsultaFrmOpcoesCampo=  'Exec dbvcen..OrgaoAutuanteS_pordesc @UF=PE, @Acao=1'
						Set _sConsultaFrmOpcoesColunaOuParam =  '@Descricao'
						! ----
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Data Field: dfsOrgaoAutuante
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5469706F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 2.613"
						Top: 0.74"
						Width:  3.813"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						! ------------- descrição do OrgaoAutuante da tab CADASTRO
						Set _bVisivel = TRUE
						Set _bÉCampoDescrição = TRUE
						Set _bNuncaHabilitado = TRUE
						Set _bPermiteNulos = TRUE
						! Pesquisa da descrição
						Set _bÉDependente = TRUE
						Set _sCamposResponsaveis[0] = 'dfnOrgaoAutuante'
						Set _sConsultaDescrição = 'Exec dbvcen..OrgaoAutuanteS_desc_sint @Cod= :frmRNFRelRepasseOutraUf.dfnOrgaoAutuante'
						!
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Group Box: Relatório
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 476572616C0000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
				Resource Id: 19148
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.163"
					Top: 1.073"
					Width:  6.238"
					Width Editable? Yes
					Height: 0.542"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Radio Button: rbTipoRelAnalitico
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 44656269746F0000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Analítico
				Window Location and Size
					Left: 1.05"
					Top: 1.26"
					Width:  1.1"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Yes
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Relatório Analítico'
						Set _sNomeParaMsgs = 'Relatório Analítico'
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _sTipoMsgNulo = 'PADRAO'
						Set _bSempreHabilitado = TRUE
						! Variáveis para Check Box
						Set _sNomeCampoFonte = 'dfsTipoRel'
						Set _sValorCampoFonte = 'A'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Radio Button: rbTipoRelSintetico
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Sintético
				Window Location and Size
					Left: 3.15"
					Top: 1.271"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Relatório Sintético'
						Set _sNomeParaMsgs ='Relatório Sintético'
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _sTipoMsgNulo = 'PADRAO'
						Set _bSempreHabilitado = TRUE
						! Variáveis para Check Box
						Set _sNomeCampoFonte = 'dfsTipoRel'
						Set _sValorCampoFonte = 'S'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Radio Button: rbTipoRelResumido
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Resumido
				Window Location and Size
					Left: 5.05"
					Top: 1.271"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Relatório Resumido'
						Set _sNomeParaMsgs ='Relatório Resumido'
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _sTipoMsgNulo = 'PADRAO'
						Set _bSempreHabilitado = TRUE
						! Variáveis para Check Box
						Set _sNomeCampoFonte = 'dfsTipoRel'
						Set _sValorCampoFonte = 'R'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Group Box: Saída
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 476572616C0000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
				Resource Id: 19149
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.15"
					Top: 1.615"
					Width:  6.225"
					Width Editable? Yes
					Height: 0.542"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Radio Button: rbSaidaArquivo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Arquivo
				Window Location and Size
					Left: 1.05"
					Top: 1.823"
					Width:  1.0"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Relatório gerado em arquivo'
						Set _bVisivel = TRUE
						Set _bSempreHabilitado = TRUE
						! Variáveis para Check Box
						Set _sValorCampoFonte = 'A'
						Set _sNomeCampoFonte = 'dfsSaida'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call SalDisableWindow( pbImpressora )
			Radio Button: rbSaidaTela
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Tela
				Window Location and Size
					Left: 3.15"
					Top: 1.823"
					Width:  0.7"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Relatório exibido em tela'
						Set _bVisivel = TRUE
						Set _bSempreHabilitado = TRUE
						! Variáveis para Check Box
						Set _sValorCampoFonte = 'T'
						Set _sNomeCampoFonte = 'dfsSaida'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call SalDisableWindow( pbImpressora )
			Radio Button: rbSaidaImpressora
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Impressora
				Window Location and Size
					Left: 5.05"
					Top: 1.823"
					Width:  1.15"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Relatório exibido na impressora'
						Set _bVisivel = TRUE
						Set _bSempreHabilitado = TRUE
						Set _sTipoMsgNulo = 'PADRAO'
						! Variáveis para Check Box
						Set _sValorCampoFonte = 'I'
						Set _sNomeCampoFonte = 'dfsSaida'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call SalEnableWindow( pbImpressora )
			! -------- botões
			Pushbutton: pbImprimir
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: Im&primir
				Window Location and Size
					Left: 6.5"
					Top: 0.083"
					Width:  0.988"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sNroCamposIgnorados = 'NENHUM'
						Set _sTextoStatusBar = 'Imprime o relatório na saída escolhida'
						Set _sTipoComando = 'Comum'
						Set _bValidaCamposNulos = TRUE
						Set _nPermissao = EF_PesquisaHabilitada | EF_RegistroExistente | EF_RegistroNovo  | EF_Vazio
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						! ------ validar parâmetros
						If SalIsNull( frmRNFRelRepasseOutraUf.dfdVigencia)
							Call SalMessageBeep( MB_IconExclamation )
							Call SalMessageBox( 'Informe a vigência do repasse (mês/ano)!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfdVigencia )
							Return FALSE
							!
						If SalIsNull( frmRNFRelRepasseOutraUf.dfnMunicipio ) and SalIsNull( frmRNFRelRepasseOutraUf.dfnOrgaoAutuante )
							Call SalMessageBeep( MB_IconExclamation )
							Call SalMessageBox( 'Informe o município e/ou órgão autuante!', 'Atenção', MB_IconExclamation | MB_Ok )
							Set dfnMunicipio= NUMBER_Null
							Set dfsMunicipio= STRING_Null
							Set dfnOrgaoAutuante= NUMBER_Null
							Set dfsOrgaoAutuante= STRING_Null
							Call SalSetFocus( dfnMunicipio )
							Return FALSE
						! If dfnOrgaoAutuante = 117200 and Not SalIsNull( dfnMunicipio )
							Call SalMessageBeep( MB_IconExclamation )
							Call SalMessageBox( 'Para convênio DER-PE não precisa informar o município!', 'Atenção', MB_IconExclamation | MB_Ok )
							Set dfnMunicipio= NUMBER_Null
							Set dfsMunicipio= STRING_Null
							Call SalSetFocus( dfnOrgaoAutuante )
							Return FALSE
						! If dfnOrgaoAutuante != 117200 and SalIsNull( dfnMunicipio )
							Call SalMessageBeep( MB_IconExclamation )
							Call SalMessageBox( 'Informe o município!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfnMunicipio )
							Return FALSE
							!
						If frmRNFRelRepasseOutraUf.dfsTipoRel != 'A' and frmRNFRelRepasseOutraUf.dfsTipoRel != 'S' and frmRNFRelRepasseOutraUf.dfsTipoRel != 'R' 
							Call SalMessageBeep( MB_IconExclamation )
							Call SalMessageBox( 'Informe o tipo do relatório!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( rbTipoRelAnalitico )
							Return FALSE
							!
						If frmRNFRelRepasseOutraUf.dfsSaida != 'A' and frmRNFRelRepasseOutraUf.dfsSaida != 'I' and frmRNFRelRepasseOutraUf.dfsSaida != 'T' 
							Call SalMessageBeep( MB_IconExclamation )
							Call SalMessageBox( 'Informe a saída do relatório!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( rbSaidaImpressora )
							Return FALSE
							!
						!
						! ------ setar variável com retorno da procedure de impressão On SAM_ReportFetchInit
						!
						If frmRNFRelRepasseOutraUf.dfsTipoRel = 'A' 
							Set sRetornoPesquisa = ':frmRNFRelRepasseOutraUf.MunicipioD
									,	:frmRNFRelRepasseOutraUf.OrgaoAutuanteD
									,	:frmRNFRelRepasseOutraUf.CompetenciaD
									,	:frmRNFRelRepasseOutraUf.OrgaoRecebedorD
									,	:frmRNFRelRepasseOutraUf.TipoRepasseD
									,	:frmRNFRelRepasseOutraUf.TaxaAdm
									,	:frmRNFRelRepasseOutraUf.Qtde
									,	:frmRNFRelRepasseOutraUf.ValorRepasse'
							!
						If frmRNFRelRepasseOutraUf.dfsTipoRel = 'S' 
							Set sRetornoPesquisa = ':frmRNFRelRepasseOutraUf.MunicipioD
									,	:frmRNFRelRepasseOutraUf.OrgaoRecebedorD
									,	:frmRNFRelRepasseOutraUf.TipoRepasseD
									,	:frmRNFRelRepasseOutraUf.TaxaAdm
									,	:frmRNFRelRepasseOutraUf.Qtde
									,	:frmRNFRelRepasseOutraUf.ValorRepasse'
							!
						If frmRNFRelRepasseOutraUf.dfsTipoRel = 'R' 
							Set sRetornoPesquisa = ':frmRNFRelRepasseOutraUf.OrgaoRecebedorD
									,	:frmRNFRelRepasseOutraUf.ValorRepasse
									,	:frmRNFRelRepasseOutraUf.OrdenadorDespesaD'
							!
						!
						! ------ definir layout (qrp) do relatório On SAM_ReportFetchInit, exceto na dfsSaida = 'A'
						!
						If frmRNFRelRepasseOutraUf.dfsSaida = 'A'
							Call GerarArquivoRepasseRENAINFOutraUf( )
						Else
							If frmRNFRelRepasseOutraUf.dfsSaida = 'I'
								If frmRNFRelRepasseOutraUf.dfsTipoRel = 'A' 
									Call SalReportPrint( hWndForm, 'RNFRelRepasseOutraUfAnalitico.qrp',
													'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, SqlUser
											, 		frmRNFRelRepasseOutraUf.dCorrente
											, 		frmRNFRelRepasseOutraUf.dfdVigencia
											, 		frmRNFRelRepasseOutraUf.MunicipioD
											, 		frmRNFRelRepasseOutraUf.OrgaoAutuanteD
											, 		frmRNFRelRepasseOutraUf.CompetenciaD
											, 		frmRNFRelRepasseOutraUf.OrgaoRecebedorD
											, 		frmRNFRelRepasseOutraUf.TipoRepasseD
											,		frmRNFRelRepasseOutraUf.TaxaAdm
											, 		frmRNFRelRepasseOutraUf.Qtde
											,		frmRNFRelRepasseOutraUf.ValorRepasse',
													'Secretaria,Detran,Setor, NomeSetor, Usuario
											,		DataCorrente
											,		Vigencia
											, 		MunicipioD
											,		OrgaoAutuanteD
											,		CompetenciaD
											,		OrgaoRecebedorD
											,		TipoRepasseD
											,		TaxaAdm
											,		Qtde
											,		ValorRepasse', 
													1,RPT_PrintAll,0,0, nErro )
											! 
								If frmRNFRelRepasseOutraUf.dfsTipoRel = 'S' 
									Call SalReportPrint( hWndForm, 'RNFRelRepasseOutraUfSintetico.qrp',
													'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, SqlUser
											, 		frmRNFRelRepasseOutraUf.dCorrente
											, 		frmRNFRelRepasseOutraUf.MunicipioD
											, 		frmRNFRelRepasseOutraUf.OrgaoRecebedorD
											, 		frmRNFRelRepasseOutraUf.TipoRepasseD
											,		frmRNFRelRepasseOutraUf.TaxaAdm
											, 		frmRNFRelRepasseOutraUf.Qtde
											,		frmRNFRelRepasseOutraUf.ValorRepasse',
													'Secretaria,Detran,Setor, NomeSetor, Usuario
											,		DataCorrente
											, 		MunicipioD
											,		OrgaoRecebedorD
											,		TipoRepasseD
											,		TaxaAdm
											,		Qtde
											,		ValorRepasse', 
													1,RPT_PrintAll,0,0, nErro )
											! 
								If frmRNFRelRepasseOutraUf.dfsTipoRel = 'R' 
									Call SalReportPrint( hWndForm, 'RNFRelRepasseOutraUfResumido.qrp',
													'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, SqlUser
											, 		frmRNFRelRepasseOutraUf.dCorrente
											, 		frmRNFRelRepasseOutraUf.OrgaoRecebedorD
											, 		frmRNFRelRepasseOutraUf.ValorRepasse
											,		frmRNFRelRepasseOutraUf.OrdenadorDespesaD',
													'Secretaria,Detran,Setor, NomeSetor, Usuario
											,		DataCorrente
											, 		OrgaoRecebedorD
											,		ValorRepasse
											,		OrdenadorDespesaD', 
													1,RPT_PrintAll,0,0, nErro )
											! 
							If frmRNFRelRepasseOutraUf.dfsSaida = 'T'
								If frmRNFRelRepasseOutraUf.dfsTipoRel = 'A' 
									Set hWndReportView= SalCreateWindow( frmReportView, hWndForm )
									Call SalSetWindowText( hWndReportView, 'Relatório Analítico de Repasse RENAINF (Outra UF)' )
									! ----------------------------------------------------------- largura, altura
									Call SalSetWindowSize( hWndReportView,15,8 )
									Call SalReportView( hWndForm, hWndReportView,'RNFRelRepasseOutraUfAnalitico.qrp', 
													'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, SqlUser
											, 		frmRNFRelRepasseOutraUf.dCorrente
											, 		frmRNFRelRepasseOutraUf.dfdVigencia
											, 		frmRNFRelRepasseOutraUf.MunicipioD
											, 		frmRNFRelRepasseOutraUf.OrgaoAutuanteD
											, 		frmRNFRelRepasseOutraUf.CompetenciaD
											, 		frmRNFRelRepasseOutraUf.OrgaoRecebedorD
											, 		frmRNFRelRepasseOutraUf.TipoRepasseD
											,		frmRNFRelRepasseOutraUf.TaxaAdm
											, 		frmRNFRelRepasseOutraUf.Qtde
											,		frmRNFRelRepasseOutraUf.ValorRepasse',
													'Secretaria,Detran,Setor, NomeSetor, Usuario
											,		DataCorrente
											,		Vigencia
											, 		MunicipioD
											,		OrgaoAutuanteD
											,		CompetenciaD
											,		OrgaoRecebedorD
											,		TipoRepasseD
											,		TaxaAdm
											,		Qtde
											,		ValorRepasse', nErro )
									!
								If frmRNFRelRepasseOutraUf.dfsTipoRel = 'S' 
									Set hWndReportView= SalCreateWindow( frmReportView, hWndForm )
									Call SalSetWindowText( hWndReportView, 'Relatório Sintético de Repasse RENAINF (Outra UF)' )
									! ----------------------------------------------------------- largura, altura
									Call SalSetWindowSize( hWndReportView,15,8 )
									Call SalReportView( hWndForm, hWndReportView,'RNFRelRepasseOutraUfSintetico.qrp',  
													'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, SqlUser
											, 		frmRNFRelRepasseOutraUf.dCorrente
											, 		frmRNFRelRepasseOutraUf.dfdVigencia
											, 		frmRNFRelRepasseOutraUf.MunicipioD
											, 		frmRNFRelRepasseOutraUf.OrgaoRecebedorD
											, 		frmRNFRelRepasseOutraUf.TipoRepasseD
											,		frmRNFRelRepasseOutraUf.TaxaAdm
											, 		frmRNFRelRepasseOutraUf.Qtde
											,		frmRNFRelRepasseOutraUf.ValorRepasse',
													'Secretaria,Detran,Setor, NomeSetor, Usuario
											,		DataCorrente
											,		Vigencia
											, 		MunicipioD
											,		OrgaoRecebedorD
											,		TipoRepasseD
											,		TaxaAdm
											,		Qtde
											,		ValorRepasse', nErro )
											! 
								If frmRNFRelRepasseOutraUf.dfsTipoRel = 'R' 
									Set hWndReportView= SalCreateWindow( frmReportView, hWndForm )
									Call SalSetWindowText( hWndReportView, 'Relatório Resumido de Repasse RENAINF (Outra UF)' )
									! ----------------------------------------------------------- largura, altura
									Call SalSetWindowSize( hWndReportView,15,8 )
									Call SalReportView( hWndForm, hWndReportView,'RNFRelRepasseOutraUfResumido.qrp',  
													'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, SqlUser
											, 		frmRNFRelRepasseOutraUf.dCorrente
											, 		frmRNFRelRepasseOutraUf.dfdVigencia
											, 		frmRNFRelRepasseOutraUf.OrgaoRecebedorD
											,		frmRNFRelRepasseOutraUf.ValorRepasse
											,		frmRNFRelRepasseOutraUf.OrdenadorDespesaD',
													'Secretaria,Detran,Setor, NomeSetor, Usuario
											,		DataCorrente
											,		Vigencia
											, 		OrgaoRecebedorD
											,		ValorRepasse
											,		OrdenadorDespesaD', nErro )
											! 
							!
			Pushbutton: pbImpressora
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: Con&figurar
				Window Location and Size
					Left: 6.5"
					Top: 0.375"
					Width:  0.988"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Seleção da impressora'
						Set _sTipoComando = 'Comum'
						Set _nPermissao = EF_PesquisaHabilitada | EF_RegistroExistente | EF_RegistroNovo  | EF_Vazio
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalPrtGetDefault( sDeviceDef, sDriverDef, sPortaDef )
						Call SalPrtSetup(sDevice,sDriver,sPorta,FALSE)
			Pushbutton: pbLimpar
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Limpar
				Window Location and Size
					Left: 6.5"
					Top: 0.667"
					Width:  0.988"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Limpa os dados da tela'
						Set _sTipoComando = 'Limpa'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
			Pushbutton: pbSair
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Sair
				Window Location and Size
					Left: 6.5"
					Top: 0.958"
					Width:  0.988"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Sai desta tela'
						Set _sTipoComando = 'Sai'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			! -------- invisíveis
			Picture: picSemaforo
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQCK1Form
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 0.088"
					Top: 3.365"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
			Data Field: dfsSaida
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000100 00000000
.enddata
.data CLASSPROPSSIZE
0000: 1400
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 4.2"
						Top: 4.042"
						Width:  0.838"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? No
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = FALSE
						Set _bSempreHabilitado = FALSE
						Set _bPermiteNulos = TRUE
						Set _bNuncaHabilitado = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Data Field: dfsTipoRel
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000100 00000000
.enddata
.data CLASSPROPSSIZE
0000: 1400
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 4.2"
						Top: 4.042"
						Width:  0.838"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? No
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = FALSE
						Set _bSempreHabilitado = FALSE
						Set _bPermiteNulos = FALSE
						Set _bNuncaHabilitado = FALSE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
		Functions
			Function: GerarArquivoRepasseRENAINFOutraUf
				Description: --------- Gerar a saída do relatorio em arquivo do tipo "txt" com formato para importação em planilhas MS-Excel.
				Returns
				Parameters
				Static Variables
				Local variables
					! --------- dados do arquivo
					FunctionalVar: oArquivo
						Class: cArquivo
					Sql Handle: hSqlArquivo
					! --------- dados do relatório
					String: MunicipioD
					String: OrgaoAutuanteD
					String: CompetenciaD
					String: OrgaoRecebedorD
					String: TipoRepasseD
					Number: nTaxaAdm
					Number: nQtde
					Number: nValorRepasse
					String: OrdenadorDespesaD
				Actions
					Call SalWaitCursor( TRUE )
					!
					If fMPSConnect(  hSqlArquivo )
						If dfsTipoRel = 'A' 
							! -- início
							If fMPSPrepareProc( hSqlArquivo, 'Exec dbarrecadacao..RNFRelRepasseOutraUf  	
										@Vigencia 	= :frmRNFRelRepasseOutraUf.dfdVigencia
									,	@Municipio 	= :frmRNFRelRepasseOutraUf.dfnMunicipio
									,	@OrgaoAutuante	= :frmRNFRelRepasseOutraUf.dfnOrgaoAutuante
									,	@TipoRel		= :frmRNFRelRepasseOutraUf.dfsTipoRel',
										':MunicipioD
									,	:OrgaoAutuanteD
									,	:CompetenciaD
									,	:OrgaoRecebedorD
									,	:TipoRepasseD
									,	:nTaxaAdm
									,	:nQtde
									,	:nValorRepasse' )
								If SqlExecute( hSqlArquivo )
									Call oArquivo.IniciaLinha(  )
									Call oArquivo.NovaLinha(  )
									Call oArquivo.AddStr( MunicipioD, 'Municipio' )
									Call oArquivo.AddStr( OrgaoAutuanteD, 'Orgao Autuante' )
									Call oArquivo.AddStr( CompetenciaD, 'Competencia' )
									Call oArquivo.AddStr( OrgaoRecebedorD, 'Orgao Recebedor' )
									Call oArquivo.AddStr( TipoRepasseD, 'Tipo Repasse' )
									Call oArquivo.AddNumber( nTaxaAdm, 2, 'TaxaAdm' )
									Call oArquivo.AddNumber( nQtde, 0, 'Qtde' )
									Call oArquivo.AddNumber( nValorRepasse, 2, 'Valor Repasse' )
									!
									While SqlFetchNext( hSqlArquivo, lParam )
										Call oArquivo.NovaLinha(  )
										Call oArquivo.AddStr( MunicipioD, 'Municipio' )
										Call oArquivo.AddStr( OrgaoAutuanteD, 'Orgao Autuante' )
										Call oArquivo.AddStr( CompetenciaD, 'Competencia' )
										Call oArquivo.AddStr( OrgaoRecebedorD, 'Orgao Recebedor' )
										Call oArquivo.AddStr( TipoRepasseD, 'Tipo Repasse' )
										Call oArquivo.AddNumber( nTaxaAdm, 2, 'TaxaAdm' )
										Call oArquivo.AddNumber( nQtde, 0, 'Qtde' )
										Call oArquivo.AddNumber( nValorRepasse, 2, 'Valor Repasse' )
										!
									! -- fim
									Call oArquivo.GerarArquivo( 'RelRepasseAnaliticoRENAINFOutrasUfs' )
									!
						!
						If dfsTipoRel = 'S' 
							! -- início
							If fMPSPrepareProc( hSqlArquivo, 'Exec dbarrecadacao..RNFRelRepasseOutraUf  	
										@Vigencia 	= :frmRNFRelRepasseOutraUf.dfdVigencia
									,	@Municipio 	= :frmRNFRelRepasseOutraUf.dfnMunicipio
									,	@OrgaoAutuante	= :frmRNFRelRepasseOutraUf.dfnOrgaoAutuante
									,	@TipoRel		= :frmRNFRelRepasseOutraUf.dfsTipoRel',
										':MunicipioD
									,	:OrgaoRecebedorD
									,	:TipoRepasseD
									,	:nTaxaAdm
									,	:nQtde
									,	:nValorRepasse' )
								If SqlExecute( hSqlArquivo )
									Call oArquivo.IniciaLinha(  )
									Call oArquivo.NovaLinha(  )
									Call oArquivo.AddStr( MunicipioD, 'Municipio' )
									Call oArquivo.AddStr( OrgaoRecebedorD, 'Orgao Recebedor' )
									Call oArquivo.AddStr( TipoRepasseD, 'Tipo Repasse' )
									Call oArquivo.AddNumber( nTaxaAdm, 2, 'Taxa Adm' )
									Call oArquivo.AddNumber( nQtde, 0, 'Qtde' )
									Call oArquivo.AddNumber( nValorRepasse, 2, 'Valor Repasse' )
									!
									While SqlFetchNext( hSqlArquivo, lParam )
										Call oArquivo.NovaLinha(  )
										Call oArquivo.AddStr( MunicipioD, 'Municipio' )
										Call oArquivo.AddStr( OrgaoRecebedorD, 'Orgao Recebedor' )
										Call oArquivo.AddStr( TipoRepasseD, 'Tipo Repasse' )
										Call oArquivo.AddNumber( nTaxaAdm, 2, 'Taxa Adm' )
										Call oArquivo.AddNumber( nQtde, 0, 'Qtde' )
										Call oArquivo.AddNumber( nValorRepasse, 2, 'Valor Repasse' )
										!
									! -- fim
									Call oArquivo.GerarArquivo( 'RelRepasseSinteticoRENAINFOutrasUfs' )
									!
						!
						If dfsTipoRel = 'R' 
							! -- início
							If fMPSPrepareProc( hSqlArquivo, 'Exec dbarrecadacao..RNFRelRepasseOutraUf  	
										@Vigencia 	= :frmRNFRelRepasseOutraUf.dfdVigencia
									,	@Municipio 	= :frmRNFRelRepasseOutraUf.dfnMunicipio
									,	@OrgaoAutuante	= :frmRNFRelRepasseOutraUf.dfnOrgaoAutuante
									,	@TipoRel		= :frmRNFRelRepasseOutraUf.dfsTipoRel',
										':OrgaoRecebedorD
									,	:nValorRepasse
									,	:OrdenadorDespesaD' )
								If SqlExecute( hSqlArquivo )
									Call oArquivo.IniciaLinha(  )
									Call oArquivo.NovaLinha(  )
									Call oArquivo.AddStr( OrgaoRecebedorD, 'Orgao Recebedor' )
									Call oArquivo.AddNumber( nValorRepasse, 2, 'Valor Repasse' )
									Call oArquivo.AddStr( OrdenadorDespesaD, 'OrdenadorDespesa' )
									!
									While SqlFetchNext( hSqlArquivo, lParam )
										Call oArquivo.NovaLinha(  )
										Call oArquivo.AddStr( OrgaoRecebedorD, 'Orgao Recebedor' )
										Call oArquivo.AddNumber( nValorRepasse, 2, 'Valor Repasse' )
										Call oArquivo.AddStr( OrdenadorDespesaD, 'OrdenadorDespesa' )
										!
									! -- fim
									Call oArquivo.GerarArquivo( 'RelRepasseResumidoRENAINFOutrasUfs' )
									!
						!
						Call fMPSDisconnect( hSqlArquivo )
					!
					Call SalWaitCursor( FALSE )
			Function: SetInicial
				Description: --------- Definir opções 'default' da tela de parâmetros
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set frmRNFRelRepasseOutraUf.dfdVigencia= DATETIME_Null
					Set frmRNFRelRepasseOutraUf.dfnMunicipio= NUMBER_Null
					Set frmRNFRelRepasseOutraUf.dfsMunicipio= STRING_Null
					Set frmRNFRelRepasseOutraUf.dfnOrgaoAutuante= NUMBER_Null
					Set frmRNFRelRepasseOutraUf.dfsOrgaoAutuante= STRING_Null
					! ---- tipo do relatório (default = 1)
					Set frmRNFRelRepasseOutraUf.rbTipoRelAnalitico= 1
					Set frmRNFRelRepasseOutraUf.rbTipoRelSintetico= 0
					Set frmRNFRelRepasseOutraUf.rbTipoRelResumido= 0
					Set frmRNFRelRepasseOutraUf.dfsTipoRel = 'A'
					! ---- saída do relatório (default = 1)
					Set frmRNFRelRepasseOutraUf.rbSaidaArquivo= 0
					Set frmRNFRelRepasseOutraUf.rbSaidaImpressora= 1
					Set frmRNFRelRepasseOutraUf.rbSaidaTela= 0
					Set frmRNFRelRepasseOutraUf.dfsSaida= 'I'
					!
					Call SalEnableWindow( pbLimpar )
					Call SalEnableWindow( pbImpressora )
					Call SalSetFocus( dfdVigencia )
					!
		Window Parameters
		Window Variables
			! ---- variáveis de retorno do relatório pbImprimir.OnSAM_Click
			String: MunicipioD
			String: OrgaoAutuanteD
			String: Serie
			Number: Auto
			Number: Infracao
			String: CompetenciaD
			String: AutoRENAINF
			Number: ValorLiquido
			String: OrgaoRecebedorD
			String: TipoRepasseD
			Number: TaxaAdm
			Number: Qtde
			Number: ValorRepasse
			Date/Time: dCorrente
			Number: nResultado
			String: OrdenadorDespesaD
			! --------- Variáveis 'default' 
			Boolean: bAbortaImpressao
			String: sStored
			Number: nErro
			String: sDevice
			String: sDriver
			String: sPorta
			String: sDeviceDef
			String: sDriverDef
			String: sPortaDef
			Window Handle: hWndReportView
			!
			String: sRetornoPesquisa
			Number: nMunicipio
			Number: nDigito
			!
			! Number: nAux
			! Boolean: bAux
			! Number: nDia
			! Date/Time: dData
			! String: sBaixaManual
			! String: sBaixaBancaria
			! Window Handle: hWndRel
			! Number: nPorcenCompetencia
			! Number: nValorTotal
			! Number: nTipoDebito
			! Number: nOrgaoRecebedor
			! Number: nBanco
			! Number: nCodMunicipio
			! Number: nDigMunicipio
			! Number: nOrgaoAutuante
			! Number: nInfracao
			! String: sTipoDebito
			! String: sMunicipio
			! String: sInfracao
			! String: sOrgaoRecebedor
			! String: sOrgaoAutuante
			! String: sCompetencia
			! String: sBanco
			! String: sBancario
			! String: sManual
			! String: sTipoRepasse
			! String: sTituloInfracao
			! Number: nQuantidade
			! Number: nSpid
			! Number: nValorCheque
			! Number: nValorLiquido 
			! [faml] Valor da restituição a ser deduzido do valor de repasse
			! Number: nValorRestituicao 
			!
		Message Actions
			On SAM_Create
				Set _sTextoStatusBar = 'Tela do Relatório de Repasse RENAINF (Outras UFs).'
				Set _nEstadoInicialForm = EF_Vazio
				Call SalSendClassMessage( SAM_Create, wParam, lParam )
				Call SalCenterWindow( hWndForm )
			On SAM_CreateComplete
				Call SalSendClassMessage( SAM_CreateComplete, wParam, lParam )
				Call frmRNFRelRepasseOutraUf.SetInicial( )
			On SAM_ReportNotify
				If lParam = RPT_BeforePageHeader
					Call SalReportSetNumberVar( SalNumberToWindowHandle ( wParam ), 'nResultado', nResultado )
			On SAM_ReportStart
				If dfsTipoRel = 'A' 
					Call SalReportDlgOptions( SalNumberToWindowHandle( wParam ), 'Impressão', 'Imprimindo',
							'Relatório de Repasses RENAINF (Outras UFs)', 'Relatório Analitico de Repasses RENAINF (Outras UFs)' )
					!
				If dfsTipoRel = 'S' 
					Call SalReportDlgOptions( SalNumberToWindowHandle( wParam ), 'Impressão', 'Imprimindo',
							'Relatório de Repasses RENAINF (Outras UFs)', 'Relatório Sintetico de Repasses RENAINF (Outras UFs)' )
					!
				If dfsTipoRel = 'R' 
					Call SalReportDlgOptions( SalNumberToWindowHandle( wParam ), 'Impressão', 'Imprimindo',
							'Relatório de Repasses RENAINF (Outras UFs)', 'Relatório Resumido de Repasses RENAINF (Outras UFs)' )
					!
				!
				Call SqlImmediate( 'select getdate() into :frmRNFRelRepasseOutraUf.dCorrente' )
				!
				Return TRUE
			On SAM_ReportFetchInit
				! Call SalWaitCursor( TRUE )
				!
				Set nResultado = 0
				Call SalReportSetNumberVar( SalNumberToWindowHandle ( wParam ), 'nResultado', nResultado )
				If fMPSPrepareProc( hSql, 'Exec dbarrecadacao..RNFRelRepasseOutraUf
							@Vigencia 	= :frmRNFRelRepasseOutraUf.dfdVigencia
						,	@Municipio 	= :frmRNFRelRepasseOutraUf.dfnMunicipio
						,	@OrgaoAutuante	= :frmRNFRelRepasseOutraUf.dfnOrgaoAutuante
						,	@TipoRel		= :frmRNFRelRepasseOutraUf.dfsTipoRel',
							sRetornoPesquisa )
					If NOT SqlExecute( hSql )
						Return FALSE
					Return SqlGetResultSetCount( hSql, nErro )
				!
				! Call SalWaitCursor( FALSE )
				!
			On SAM_ReportFetchNext
				Call SalWaitCursor( FALSE )
				If SqlFetchNext( hSql, nErro )
					If bAbortaImpressao
						Return FALSE
						!
					Return TRUE
			On SAM_ReportFinish
				Return TRUE
			On MSG_Limpa
				Call frmRNFRelRepasseOutraUf.SetInicial( ) 

