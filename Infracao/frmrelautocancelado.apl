.head 0 +  Application Description: Centura SQLWindows Standard Application Template
.head 1 -  Outline Version - 4.0.28
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B50000 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D04000000075769 6E646F7773136672
0080: 6D52656C4175746F 43616E63656C6164 6F0946756E637469 6F6E731666476572
00A0: 614172717569766F 43616E63656C6164 6F73
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: detran_funcoes.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 3 -  Enumerations
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 3923359385
0000: 2200000012000000 0000000000000000 02008001000000B2 0100D01900000001
0020: FE00FF03
.enddata
.head 2 +  Internal Functions
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 1443028049
0000: AC030000CA010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666FC2003C00 000A630051434B31
0040: 47657261006C0202 00001100001E0004 0000C20003000000 FF7F048300190000
0060: 00F001000000FF1F 1D0000AC00190001 FD00FF0736000000 196B000100FFFFC1
0080: 4F00000019DA0001 00FF7F68B0000000 0400F4020000FF1F 6C0000AC00040002
00A0: FD00FF0770000000 046B000200FFFFC1 7400000004DA0002 00FF7F78B0000000
00C0: 0400F60200FF1F7C 0000AC00040002FD 00FF17800000046B 000200FFFFC18400
00E0: 000004DA000200FF 7F88B00000000400 F60200FF1F8C0000 AC00190001FD00FF
0100: 07A5000000196B00 0100FFFFC1BE0000 0004DA000200FF7F 0180803E00000001
0120: 0070000E63514340 6F6E7461696E7220 AA0000000500006F 0400E801020000FF
0140: C18001000000BF04 190019000101FA00 007F80F20100000F 0800000096190001
0160: 00FE00FF83210000 0004B5000200FFFF 60250000001900ED 0100FF3F01806404
0180: 0000020038086351 4D44804922000000 0100DE0004DA0002 00FF7F01CC800400
01A0: 0370000D63514300 6865636B426F7822 A20000010000B704 00F60200FF1F0180
01C0: 0433000400060063 4461646F732200D1 000100005B040002 FB00FF0F
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 -  Application Actions
.head 1 +  Form Window: frmRelAutoCancelado
.data INHERITPROPS
0000: 0100
.enddata
.head 2 -  Class: cQCK1Form
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Relatório de Autos Cancelados
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left: 8.775"
.head 4 -  Top: 0.354"
.head 4 -  Width:  7.013"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.156"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Relatório de Autos Cancelados
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Período:
.head 4 -  Resource Id: 28947
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.7"
.head 5 -  Top: 0.156"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: a
.head 4 -  Resource Id: 28948
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 2.7"
.head 5 -  Top: 0.156"
.head 5 -  Width:  0.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfdInicial
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.45"
.head 6 -  Top: 0.115"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: 99-99-9999
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sTextoStatusBar = 'Data Inicial do Intervalo, referentes às datas de Autos Cancelados, para a pesquisa.'
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Validate
.head 6 +  If NOT SalIsNull( dfdInicial )
.head 7 +  If NOT (SalIsValidDateTime( dfdInicial ))
.head 8 -  Call SalMessageBeep( 0 )
.head 8 -  Call SalMessageBox( 'Data inválida.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 8 -  Call SalClearField( dfdInicial )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else If (SalDateYear( dfdInicial ) < 1753)
.head 8 -  Call SalMessageBeep( 0 )
.head 8 -  Call SalMessageBox( 'Ano inválido.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 8 -  Call SalClearField( dfdInicial )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If dfdFinal < dfdInicial AND NOT SalIsNull( dfdFinal )
.head 8 -  Call SalMessageBeep( 0 )
.head 8 -  Call SalMessageBox( 'Data Inicial deve ser menor do que a data Final.', 'Atenção', MB_IconExclamation | MB_Ok )
.head 6 -  Call SalSendClassMessage( SAM_Validate, wParam, lParam )
.head 3 +  Data Field: dfdFinal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.05"
.head 6 -  Top: 0.115"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: 99-99-9999
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sTextoStatusBar = 'Data Final do Intervalo, referentes às datas de Autos Cancelados, para a pesquisa.'
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Validate
.head 6 +  If NOT SalIsNull( dfdFinal )
.head 7 +  If NOT (SalIsValidDateTime( dfdFinal ))
.head 8 -  Call SalMessageBeep( 0 )
.head 8 -  Call SalMessageBox( 'Data inválida.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 8 -  Call SalClearField( dfdFinal )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else If SalDateYear( dfdFinal ) < 1753
.head 8 -  Call SalMessageBeep( 0 )
.head 8 -  Call SalMessageBox( 'Ano inválido.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 8 -  Call SalClearField( dfdFinal )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else If dfdFinal < dfdInicial
.head 8 -  Call SalMessageBeep( 0 )
.head 8 -  Call SalMessageBox( 'Data Final do período deve ser maior ou igual à data Inicial.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 6 -  Call SalSendClassMessage( SAM_Validate, wParam, lParam )
.head 3 -  Background Text: Requisição:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 746162446F63756D 656E746F00000000
.enddata
.data CLASSPROPSSIZE
0000: 2000
.enddata
.head 4 -  Resource Id: 28949
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 2.938"
.head 5 -  Top: 1.635"
.head 5 -  Width:  1.05"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  ! cQCK2ChildTable: tblOrgaoAut
.data INHERITPROPS
0000: 0100
.enddata
.winattr class Child Table:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK2ChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 0.615"
.head 6 -  Width:  4.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.end
.head 4 +  Contents 
.head 5 +  Column: colnCodigo
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ag. Autuador
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.113"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnAgenteEquip
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Agente/Equip
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsDescricao
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Descrição
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Functions 
.head 4 +  Window Variables 
.head 5 -  Number: nAux
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sCriacaoConexao = 'FALSE'
.head 6 -  Set _bCriacaoConexaoAuxiliar = FALSE
.head 6 -  Set _sTextoStatusBar = 'Tabela de Órgãos Autuantes. CLICK - Marca o Órgão para Seleção. CLICK DUPLO - Desmarca Órgao Autuante.'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  Set nAux = TBL_MinRow
.head 6 +  If SalTblFindNextRow( hWndForm, nAux, ROW_Edited, 0)
.head 7 -  Set nAux = TBL_MinRow
.head 7 +  While SalTblFindNextRow( hWndForm, nAux, 0, 0)
.head 8 -  Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, FALSE )
.head 6 +  Else 
.head 7 -  Set nAux = TBL_MinRow
.head 7 +  While SalTblFindNextRow( hWndForm, nAux, 0, 0)
.head 8 -  Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, TRUE )
.head 5 +  On MSG_PopulaTabela
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SalTblReset( tblOrgaoAut )
.head 6 -  Call SybPrepareProc( hSqlApp, 'dbinfracao..AgenteEquipS_coddescOrgao @Setor=:frmRelAutoCancelado.nSetorUsuario',
                                ':tblOrgaoAut.colnCodigo,:tblOrgaoAut.colnAgenteEquip,  :tblOrgaoAut.colsDescricao' )
.head 6 +  If NOT  SalTblPopulate(tblOrgaoAut, hSqlApp, '', TBL_FillAll )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Return FALSE
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Return TRUE
.head 5 +  On MSG_AtualizaTabela
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  ! Primeiro Limpa os a Tabela de  Setores Selecionados para a Conexao
.head 6 -  Call SybPrepareProc( hSqlApp, 'exec tmpOrgaoAutSelecionadoD',':nID')
.head 6 -  Call SqlExecute( hSqlApp )
.head 6 -  Call SqlFetchNext( hSqlApp, lParam )
.head 6 -  Call SybPrepareProc( hSqlApp, 'exec tmpOrgaoAutSelecionadoI @ID = :nID, @Cod = :colnCodigo,@AgenteEquip = :colnAgenteEquip, @Descricao = :colsDescricao','')
.head 6 -  Call SalTblDoUpdates( tblOrgaoAut, hSqlApp, FALSE )
.head 6 -  Call SalWaitCursor( FALSE )
.head 3 +  ! cQCK2ChildTable: tblMotCancel
.data INHERITPROPS
0000: 0100
.enddata
.winattr class Child Table:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK2ChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 1.99"
.head 6 -  Width:  4.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.375"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.end
.head 4 +  Contents 
.head 5 +  Column: colnCodigo
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Código
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsDescricao
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nome
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Functions 
.head 4 +  Window Variables 
.head 5 -  Number: nAux
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sCriacaoConexao = 'FALSE'
.head 6 -  Set _bCriacaoConexaoAuxiliar = FALSE
.head 6 -  Set _sTextoStatusBar = 'Tabela de Funcionários. CLICK - Marca o Funcionário para Seleção. CLICK DUPLO - Desmarca Funcionário.'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  Set nAux = TBL_MinRow
.head 6 +  If SalTblFindNextRow( hWndForm, nAux, ROW_Edited, 0)
.head 7 -  Set nAux = TBL_MinRow
.head 7 +  While SalTblFindNextRow( hWndForm, nAux, 0, 0)
.head 8 -  Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, FALSE )
.head 6 +  Else 
.head 7 -  Set nAux = TBL_MinRow
.head 7 +  While SalTblFindNextRow( hWndForm, nAux, 0, 0)
.head 8 -  Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, TRUE )
.head 5 +  On MSG_PopulaTabela
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SalTblReset( tblMotCancel )
.head 6 -  Call SybPrepareProc( hSqlApp, 'exec MotivoCancelamentoS_cod_desc',
                                ':tblMotCancel.colnCodigo,  :tblMotCancel.colsDescricao' )
.head 6 +  If NOT  SalTblPopulate(tblMotCancel, hSqlApp, '', TBL_FillAll )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Return FALSE
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Return TRUE
.head 5 +  On MSG_AtualizaTabela
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  ! Primeiro Limpa os a Tabela de  Setores Selecionados para a Conexao
.head 6 -  Call SybPrepareProc( hSqlApp, 'exec tmpMotivoCancelSelecionadoD',':nID')
.head 6 -  Call SqlExecute( hSqlApp )
.head 6 -  Call SqlFetchNext( hSqlApp, lParam )
.head 6 -  Call SybPrepareProc( hSqlApp, 'exec tmpMotivoCancelSelecionadoI @ID = :nID, @Cod = :colnCodigo, @Descricao = :colsDescricao','')
.head 6 -  Call SalTblDoUpdates( tblMotCancel, hSqlApp, FALSE )
.head 6 -  Call SalWaitCursor( FALSE )
.head 3 +  Child Table: tblOrgaoAut
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK2ChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 0.615"
.head 6 -  Width:  4.95"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.167"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colnCodigo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ag. Autuador
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.113"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnAgenteEquip
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Agente/Equip
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsDescricao
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Descrição
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nAux
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sCriacaoConexao = 'FALSE'
.head 6 -  Set _bCriacaoConexaoAuxiliar = FALSE
.head 6 -  Set _sTextoStatusBar = 'Tabela de Órgãos Autuantes. CLICK - Marca o Órgão para Seleção. CLICK DUPLO - Desmarca Órgao Autuante.'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  Set nAux = TBL_MinRow
.head 6 +  If SalTblFindNextRow( hWndForm, nAux, ROW_Edited, 0)
.head 7 -  Set nAux = TBL_MinRow
.head 7 +  While SalTblFindNextRow( hWndForm, nAux, 0, 0)
.head 8 -  Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, FALSE )
.head 6 +  Else
.head 7 -  Set nAux = TBL_MinRow
.head 7 +  While SalTblFindNextRow( hWndForm, nAux, 0, 0)
.head 8 -  Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, TRUE )
.head 5 +  On MSG_PopulaTabela
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SalTblReset( tblOrgaoAut )
.head 6 -  Call SybPrepareProc( hSqlApp, 'dbinfracao..AgenteEquipS_coddescOrgao @Setor=:frmRelAutoCancelado.nSetorUsuario',
                                ':tblOrgaoAut.colnCodigo,:tblOrgaoAut.colnAgenteEquip,  :tblOrgaoAut.colsDescricao' )
.head 6 +  If NOT  SalTblPopulate(tblOrgaoAut, hSqlApp, '', TBL_FillAll )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Return FALSE
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Return TRUE
.head 5 +  On MSG_AtualizaTabela
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  ! Primeiro Limpa os a Tabela de  Setores Selecionados para a Conexao
.head 6 -  Call SybPrepareProc( hSqlApp, 'exec tmpOrgaoAutSelecionadoD',':nID')
.head 6 -  Call SqlExecute( hSqlApp )
.head 6 -  Call SqlFetchNext( hSqlApp, lParam )
.head 6 -  Call SybPrepareProc( hSqlApp, 'exec tmpOrgaoAutSelecionadoI @ID = :nID, @Cod = :colnCodigo,@AgenteEquip = :colnAgenteEquip, @Descricao = :colsDescricao','')
.head 6 -  Call SalTblDoUpdates( tblOrgaoAut, hSqlApp, FALSE )
.head 6 -  Call SalWaitCursor( FALSE )
.head 3 +  Child Table: tblMotCancel
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK2ChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 1.99"
.head 6 -  Width:  4.95"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.375"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colnCodigo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Código
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsDescricao
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nome
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nAux
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sCriacaoConexao = 'FALSE'
.head 6 -  Set _bCriacaoConexaoAuxiliar = FALSE
.head 6 -  Set _sTextoStatusBar = 'Tabela de Motivos de Cancelamento. CLICK - Marca o Motivo de Cancelamento para Seleção. CLICK DUPLO - Motivos de Cancelamento.'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  Set nAux = TBL_MinRow
.head 6 +  If SalTblFindNextRow( hWndForm, nAux, ROW_Edited, 0)
.head 7 -  Set nAux = TBL_MinRow
.head 7 +  While SalTblFindNextRow( hWndForm, nAux, 0, 0)
.head 8 -  Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, FALSE )
.head 6 +  Else
.head 7 -  Set nAux = TBL_MinRow
.head 7 +  While SalTblFindNextRow( hWndForm, nAux, 0, 0)
.head 8 -  Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, TRUE )
.head 5 +  On MSG_PopulaTabela
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SalTblReset( tblMotCancel )
.head 6 -  Call SybPrepareProc( hSqlApp, 'exec MotivoCancelamentoS_cod_desc',
                                ':tblMotCancel.colnCodigo,  :tblMotCancel.colsDescricao' )
.head 6 +  If NOT  SalTblPopulate(tblMotCancel, hSqlApp, '', TBL_FillAll )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Return FALSE
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Return TRUE
.head 5 +  On MSG_AtualizaTabela
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  ! Primeiro Limpa os a Tabela de  Setores Selecionados para a Conexao
.head 6 -  Call SybPrepareProc( hSqlApp, 'exec tmpMotivoCancelSelecionadoD',':nID')
.head 6 -  Call SqlExecute( hSqlApp )
.head 6 -  Call SqlFetchNext( hSqlApp, lParam )
.head 6 -  Call SybPrepareProc( hSqlApp, 'exec tmpMotivoCancelSelecionadoI @ID = :nID, @Cod = :colnCodigo, @Descricao = :colsDescricao','')
.head 6 -  Call SalTblDoUpdates( tblMotCancel, hSqlApp, FALSE )
.head 6 -  Call SalWaitCursor( FALSE )
.head 3 +  Child Table: tblAutoCancelado
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK2ChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.088"
.head 6 -  Top: 1.365"
.head 6 -  Width:  6.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.458"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colnCodigoOrgao
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Código Órgão
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = FALSE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsNomeOrgao
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nome Órgão
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsPlaca
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Placa
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsUF
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: UF
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsSerie
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Serie
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnAuto
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Auto
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnDigito
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Digito
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnNotificacao
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Notificação
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnProcesso
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Processo
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnInfracao
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Infração
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: coldData
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK2Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Data
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd-MMM-yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _sTextoStatusBar = 'Usuario'
.head 8 -  !
.head 8 -  Set _bComponenteChave = FALSE
.head 8 -  Set _bPermiteNulos = FALSE
.head 8 -  !
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _sNomeParaMsgs = 'Usuario'
.head 8 -  Set _sValorDefault = ''
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsUsuarioCancel
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Usuário Cancelamento
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnValor
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Valor
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsMotivo
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Motivo
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsNomeUsuarioCanc
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nome Usuário Cancelamento
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnMatriculaAgente
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Matricula Agente
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsNomeAgente
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nome Agente
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsNomeOrgaoLotacao
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Órgão Lotação
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsDataInfracao
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Data Infração
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nMaiorCodigo
.head 5 -  String: sTmp
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = ''
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _sCriacaoConexao = 'Default'
.head 6 -  !
.head 6 -  Set _sComandoPesquisa = 'exec dbinfracao..MovimentoAutoS_rel_cancel 
			@ID = :frmRelAutoCancelado.nID, 
			@DataI = :frmRelAutoCancelado.dfdInicial, 
			@DataF = :frmRelAutoCancelado.dfdFinal,
			@OrderBy = :frmRelAutoCancelado.sOrderBy'
.head 6 -  !
.head 6 -  Set _sIntoPesquisa =':frmRelAutoCancelado.tblAutoCancelado.colnCodigoOrgao,
		:frmRelAutoCancelado.tblAutoCancelado.colsNomeOrgao,
		:frmRelAutoCancelado.tblAutoCancelado.colsPlaca,
		:frmRelAutoCancelado.tblAutoCancelado.colsUF,
		:frmRelAutoCancelado.tblAutoCancelado.colsSerie,
		:frmRelAutoCancelado.tblAutoCancelado.colnAuto,
		:frmRelAutoCancelado.tblAutoCancelado.colnDigito,
		:frmRelAutoCancelado.tblAutoCancelado.colnNotificacao,
		:frmRelAutoCancelado.tblAutoCancelado.colnProcesso,
		:frmRelAutoCancelado.tblAutoCancelado.colnInfracao,
		:frmRelAutoCancelado.tblAutoCancelado.coldData,
		:frmRelAutoCancelado.tblAutoCancelado.colsUsuarioCancel,
		:frmRelAutoCancelado.tblAutoCancelado.colnValor,
		:frmRelAutoCancelado.tblAutoCancelado.colsMotivo,
		:frmRelAutoCancelado.tblAutoCancelado.colsNomeUsuarioCanc,
		:frmRelAutoCancelado.tblAutoCancelado.colnMatriculaAgente,
		:frmRelAutoCancelado.tblAutoCancelado.colsNomeAgente,
		:frmRelAutoCancelado.tblAutoCancelado.colsNomeOrgaoLotacao,
		:frmRelAutoCancelado.tblAutoCancelado.colsDataInfracao'
.head 6 -  !
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_ReportNotify
.head 6 +  If lParam = RPT_BeforePageHeader
.head 7 -  Call SalReportSetStringVar( SalNumberToWindowHandle( wParam ), 'Secretaria', sGlobalSecretaria)
.head 7 -  Call SalReportSetStringVar( SalNumberToWindowHandle( wParam ), 'Detran', sGlobalDetran)
.head 7 -  Call SalReportSetNumberVar( SalNumberToWindowHandle( wParam ), 'CodSetor', nGlobalSetor)
.head 7 -  Call SalReportSetStringVar( SalNumberToWindowHandle( wParam ), 'NomeSetor', sGlobalSetor)
.head 7 -  Call SalReportSetStringVar( SalNumberToWindowHandle( wParam ), 'Usuario', SqlUser)
.head 7 -  Call SalReportSetDateTimeVar( SalNumberToWindowHandle ( wParam ), 'DataInicial', dfdInicial )
.head 7 -  Call SalReportSetDateTimeVar( SalNumberToWindowHandle ( wParam ), 'DataFinal', dfdFinal )
.head 7 -  ! Call SalReportSetDateTimeVar( hWndReport, 'DataCorrente', dCorrente )
.head 3 +  Child Table: tblAutoArquivo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK2ChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.088"
.head 6 -  Top: 1.365"
.head 6 -  Width:  6.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.458"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colnCodigoOrgao
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Código
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = FALSE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsNomeOrgao
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Órgao Autuante
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsPlaca
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Placa
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsUF
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: UF
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsSerie
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Serie
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnAuto
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Auto
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnDigito
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Digito
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnNotificacao
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Notificação
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnProcesso
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Processo
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnInfracao
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Infração
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: coldData
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK2Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Data
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd-MMM-yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _sTextoStatusBar = 'Usuario'
.head 8 -  !
.head 8 -  Set _bComponenteChave = FALSE
.head 8 -  Set _bPermiteNulos = FALSE
.head 8 -  !
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _sNomeParaMsgs = 'Usuario'
.head 8 -  Set _sValorDefault = ''
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsUsuarioCancel
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Usuário Cancelamento
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnValor
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Valor
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsMotivo
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Motivo
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsNomeUsuarioCanc
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nome Usuário Cancelamento
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnMatriculaAgente
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Matricula Agente
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsNomeAgente
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nome Agente
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsNomeOrgaoLotacao
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Órgão Lotação
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsDataInfracao
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Data Infração
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 -  ! !!CB!! 73
Set sCabecalho = 'Codigo;Orgao Autuante                          ;Placa  ;UF;Notificacao;Processo  ;Serie; Auto      ;Infracao; DataCanc.;UsuCanc.; Valor; Valor em R$; Motivo     '

.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nMaiorCodigo
.head 5 -  String: sTmp
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = ''
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _sCriacaoConexao = 'Default'
.head 6 -  !
.head 6 -  Set _sComandoPesquisa = 'exec dbinfracao..MovimentoAutoS_rel_cancel 
			@ID = :frmRelAutoCancelado.nID, 
			@DataI = :frmRelAutoCancelado.dfdInicial, 
			@DataF = :frmRelAutoCancelado.dfdFinal,
			@OrderBy = :frmRelAutoCancelado.sOrderBy'
.head 6 -  !
.head 6 -  Set _sIntoPesquisa =':frmRelAutoCancelado.tblAutoCancelado.colnCodigoOrgao,
		:frmRelAutoCancelado.tblAutoCancelado.colsNomeOrgao,
		:frmRelAutoCancelado.tblAutoCancelado.colsPlaca,
		:frmRelAutoCancelado.tblAutoCancelado.colsUF,
		:frmRelAutoCancelado.tblAutoCancelado.colsSerie,
		:frmRelAutoCancelado.tblAutoCancelado.colnAuto,
		:frmRelAutoCancelado.tblAutoCancelado.colnDigito,
		:frmRelAutoCancelado.tblAutoCancelado.colnNotificacao,
		:frmRelAutoCancelado.tblAutoCancelado.colnProcesso,
		:frmRelAutoCancelado.tblAutoCancelado.colnInfracao,
		:frmRelAutoCancelado.tblAutoCancelado.coldData,
		:frmRelAutoCancelado.tblAutoCancelado.colsUsuarioCancel,
		:frmRelAutoCancelado.tblAutoCancelado.colnValor,
		:frmRelAutoCancelado.tblAutoCancelado.colsMotivo,
		:frmRelAutoCancelado.tblAutoCancelado.colsNomeUsuarioCanc,
		:frmRelAutoCancelado.tblAutoCancelado.colnMatriculaAgente,
		:frmRelAutoCancelado.tblAutoCancelado.colsNomeAgente,
		:frmRelAutoCancelado.tblAutoCancelado.colsNomeOrgaoLotacao,
		:frmRelAutoCancelado.tblAutoCancelado.colsDataInfracao'
.head 6 -  !
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_ReportNotify
.head 6 +  If lParam = RPT_BeforePageHeader
.head 7 -  Call SalReportSetStringVar( SalNumberToWindowHandle( wParam ), 'Secretaria', sGlobalSecretaria)
.head 7 -  Call SalReportSetStringVar( SalNumberToWindowHandle( wParam ), 'Detran', sGlobalDetran)
.head 7 -  Call SalReportSetNumberVar( SalNumberToWindowHandle( wParam ), 'CodSetor', nGlobalSetor)
.head 7 -  Call SalReportSetStringVar( SalNumberToWindowHandle( wParam ), 'NomeSetor', sGlobalSetor)
.head 7 -  Call SalReportSetStringVar( SalNumberToWindowHandle( wParam ), 'Usuario', SqlUser)
.head 7 -  Call SalReportSetDateTimeVar( SalNumberToWindowHandle ( wParam ), 'DataInicial', dfdInicial )
.head 7 -  Call SalReportSetDateTimeVar( SalNumberToWindowHandle ( wParam ), 'DataFinal', dfdFinal )
.head 7 -  ! Call SalReportSetDateTimeVar( hWndReport, 'DataCorrente', dCorrente )
.head 3 -  Group Box: Saída
.head 4 -  Resource Id: 28950
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.313"
.head 5 -  Top: 2.406"
.head 5 -  Width:  1.375"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbTela
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Tela
.head 4 -  Window Location and Size
.head 5 -  Left: 5.363"
.head 5 -  Top: 2.573"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalHideWindow(dfArquivo)
.head 6 -  Call SalHideWindow(dfMensagem)
.head 6 -  Call SalDisableWindow( pbImpressoras )
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sValorCampoFonte = 'T'
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Set _sNomeCampoFonte = 'dfsSaida'
.head 6 -  Set _bRadioButtonDefault = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Radio Button: rbImpressora
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Impressora
.head 4 -  Window Location and Size
.head 5 -  Left: 5.363"
.head 5 -  Top: 2.865"
.head 5 -  Width:  1.225"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalHideWindow(dfArquivo)
.head 6 -  Call SalHideWindow(dfMensagem)
.head 6 -  Call SalEnableWindow( pbImpressoras )
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sValorCampoFonte = 'I'
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Set _sNomeCampoFonte = 'dfsSaida'
.head 6 -  Set _bRadioButtonDefault = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Radio Button: rbArquivo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Arquivo
.head 4 -  Window Location and Size
.head 5 -  Left: 5.388"
.head 5 -  Top: 3.115"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalShowWindow(dfArquivo)
.head 6 -  Set dfMensagem = 'Digite o nome do arquivo:'
.head 6 -  Call SalShowWindow(dfMensagem)
.head 6 -  Call SalDisableWindow( pbImpressoras )
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sValorCampoFonte = 'A'
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Set _sNomeCampoFonte = 'dfsSaida'
.head 6 -  Set _bRadioButtonDefault = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Pushbutton: pbImprimir
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Im&primir
.head 4 -  Window Location and Size
.head 5 -  Left: 5.363"
.head 5 -  Top: 0.104"
.head 5 -  Width:  1.15"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTabela = ''
.head 6 -  Set _nPermissao = 15
.head 6 -  Set _sTipoComando = 'Comum'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Set nErro = 0
.head 6 -  Call SalWaitCursor( TRUE)
.head 6 +  If SalIsNull( dfdInicial)
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Call SalMessageBeep( 0 )
.head 7 -  Call SalMessageBox( 'Data Inicial é Obrigatória.', 'Atenção', MB_IconExclamation | MB_Ok )
.head 7 -  Call SalSetFocus( dfdInicial )
.head 7 -  Return FALSE
.head 6 +  If SalIsNull( dfdFinal)
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Call SalMessageBeep( 0 )
.head 7 -  Call SalMessageBox( 'Data Final é Obrigatória.', 'Atenção', MB_IconExclamation | MB_Ok )
.head 7 -  Call SalSetFocus( dfdFinal )
.head 7 -  Return FALSE
.head 6 +  If dfdFinal < dfdInicial AND NOT SalIsNull( dfdFinal )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Call SalMessageBeep( 0 )
.head 7 -  Call SalMessageBox( 'Data Inicial deve ser menor do que a data Final.', 'Atenção', MB_IconExclamation | MB_Ok )
.head 7 -  Return FALSE
.head 6 +  If NOT SalTblAnyRows( tblOrgaoAut, ROW_Edited, 0 )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Call SalMessageBeep( 0 )
.head 7 -  Call SalMessageBox( 'Selecione pelo menos um Orgão Autuante.', 'Atenção', MB_IconExclamation | MB_Ok )
.head 7 -  Call SalAbort( -1)
.head 6 +  If NOT SalTblAnyRows( tblMotCancel, ROW_Edited, 0 )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Call SalMessageBeep( 0 )
.head 7 -  Call SalMessageBox( 'Selecione pelo menos um Motivo.', 'Atenção', MB_IconExclamation | MB_Ok )
.head 7 -  Call SalAbort( -1)
.head 6 -  ! Atualiza Tabela de Setores e de Funcionários Selecionados
.head 6 -  Call SalSendMsg( tblOrgaoAut, MSG_AtualizaTabela, 0, 0 )
.head 6 -  Call SalSendMsg( tblMotCancel, MSG_AtualizaTabela, 0, 0 )
.head 6 +  If dfsSaida = 'A'
.head 7 -  Call fGeraArquivoCancelados()
.head 6 +  Else
.head 7 -  ! Call SalTblReset( tblAutoCancelado )
.head 7 -  Call SalSendMsg( tblAutoCancelado, MSG_PesquisaTabela, wParam, lParam )
.head 7 +  If SalTblFetchRow( tblAutoCancelado, 0 ) = 0
.head 8 -  Call SalWaitCursor( FALSE)
.head 8 -  Call SalMessageBeep( 0)
.head 8 -  Call SalMessageBox( 'Não existem dados para os parametros informados!', 'Mensagem', MB_IconAsterisk | MB_Ok)
.head 8 -  Return FALSE
.head 7 -  ! Mostra o relatório
.head 7 +  If rbOrgao
.head 8 -  Set sNomeQRP = 'autocanco.qrp'
.head 7 +  Else If rbMotivo
.head 8 -  Set sNomeQRP = 'autcancn.qrp'
.head 7 +  Else If rbUsuario
.head 8 -  Set sNomeQRP = 'autcancu.qrp'
.head 7 -  ! Mostra o relatório
.head 7 +  If dfsSaida='I'
.head 8 -  Call SalReportTablePrint( tblAutoCancelado, sNomeQRP,  nParamArray, lParam )
.head 8 -  Call SalWaitCursor( FALSE)
.head 7 +  Else If dfsSaida = 'T'
.head 8 +  If hWndReportView != hWndNULL
.head 9 -  Call SalReportClose( hWndReportView )
.head 9 -  Call SalDestroyWindow( hWndReportView )
.head 9 -  Set hWndReportView = hWndNULL
.head 8 -  Set hWndReportView= SalCreateWindow( frmReportView, hWndForm )
.head 8 -  Call SalSetWindowText( hWndReportView, 'Relatório de Autos Cancelados' )
.head 8 -  Call SalReportTableView( tblAutoCancelado, hWndReportView, sNomeQRP, lParam )
.head 8 -  Call SalWaitCursor( FALSE)
.head 7 +  !
.head 8 +  ! If dfsSaida='I'
.head 9 +  If rbOrgao
.head 10 -  Call SalReportPrint( hWndForm, 'autocanc.qrp',
'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, dfdInicial, dfdFinal, sNomeOrgao, sPlaca,
sUF, sSerie, nAuto, nDigito, nNotificacao, nProcesso, nInfracao, dData,
sUsuarioCancel, nValor, sMotivo, SqlUser',
'Secretaria, Detran, CodSetor, NomeSetor, DataInicial, DataFinal, NomeOrgao, Placa, UF, Serie,
Auto, Digito, Notificacao, Processo, Infracao, Data, UsuarioCanc, Valor,
Motivo, Usuario', 1,RPT_PrintAll,0,0, nErro )
.head 9 +  Else If rbMotivo
.head 10 -  Call SalReportPrint( hWndForm, 'autcancn.qrp',
'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, dfdInicial, dfdFinal, sNomeOrgao, sPlaca,
sUF, sSerie, nAuto, nDigito, nNotificacao, nProcesso, nInfracao, dData,
sUsuarioCancel, nValor, sMotivo, SqlUser',
'Secretaria, Detran, CodSetor, NomeSetor, DataInicial, DataFinal, NomeOrgao, Placa, UF, Serie,
Auto, Digito, Notificacao, Processo, Infracao, Data, UsuarioCanc, Valor,
Motivo, Usuario', 1,RPT_PrintAll,0,0, nErro )
.head 9 +  Else If rbUsuario
.head 10 -  Call SalReportPrint( hWndForm, 'autcancu.qrp',
'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, dfdInicial, dfdFinal, sNomeOrgao, sPlaca,
sUF, sSerie, nAuto, nDigito, nNotificacao, nProcesso, nInfracao, dData,
sUsuarioCancel, nValor, sMotivo, SqlUser,sNomeUsuarioCanc',
'Secretaria, Detran, CodSetor, NomeSetor, DataInicial, DataFinal, NomeOrgao, Placa, UF, Serie,
Auto, Digito, Notificacao, Processo, Infracao, Data, UsuarioCanc, Valor,
Motivo, Usuario,NomeUsuarioCanc', 1,RPT_PrintAll,0,0, nErro )
.head 8 +  ! Else If dfsSaida = 'T'
.head 9 +  If hWndReportView != hWndNULL
.head 10 -  Call SalReportClose( hWndReportView )
.head 10 -  Call SalDestroyWindow( hWndReportView )
.head 10 -  Set hWndReportView = hWndNULL
.head 9 -  Set hWndReportView= SalCreateWindow( frmReportView, hWndForm )
.head 9 -  Call SalSetWindowText( hWndReportView, 'Relatório de Autos Cancelados' )
.head 9 +  If rbOrgao
.head 10 -  Call SalReportView( hWndForm, hWndReportView, 'autocanc.qrp',
'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, dfdInicial, dfdFinal, sNomeOrgao, sPlaca,
sUF, sSerie, nAuto, nDigito, nNotificacao, nProcesso, nInfracao, dData,
sUsuarioCancel, nValor, sMotivo, SqlUser',
'Secretaria, Detran, CodSetor, NomeSetor, DataInicial, DataFinal, NomeOrgao, Placa, UF, Serie,
Auto, Digito, Notificacao, Processo, Infracao, Data, UsuarioCanc, Valor,
Motivo, Usuario',  nErro )
.head 9 +  Else If rbMotivo
.head 10 -  Call SalReportView( hWndForm, hWndReportView, 'autcancn.qrp',
'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, dfdInicial, dfdFinal, sNomeOrgao, sPlaca,
sUF, sSerie, nAuto, nDigito, nNotificacao, nProcesso, nInfracao, dData,
sUsuarioCancel, nValor, sMotivo, SqlUser',
'Secretaria, Detran, CodSetor, NomeSetor, DataInicial, DataFinal, NomeOrgao, Placa, UF, Serie,
Auto, Digito, Notificacao, Processo, Infracao, Data, UsuarioCanc, Valor,
Motivo, Usuario',  nErro )
.head 9 +  Else If rbUsuario
.head 10 -  Call SalReportView( hWndForm, hWndReportView, 'autcancu.qrp',
'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, dfdInicial, dfdFinal, sNomeOrgao, sPlaca,
sUF, sSerie, nAuto, nDigito, nNotificacao, nProcesso, nInfracao, dData,
sUsuarioCancel, nValor, sMotivo, SqlUser,sNomeUsuarioCanc',
'Secretaria, Detran, CodSetor, NomeSetor, DataInicial, DataFinal, NomeOrgao, Placa, UF, Serie,
Auto, Digito, Notificacao, Processo, Infracao, Data, UsuarioCanc, Valor,
Motivo, Usuario,NomeUsuarioCanc',  nErro )
.head 8 +  ! Else
.head 9 -  Call fGeraArquivoCancelados()
.head 3 +  Pushbutton: pbImpressoras
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Con&figurar
.head 4 -  Window Location and Size
.head 5 -  Left: 5.363"
.head 5 -  Top: 0.396"
.head 5 -  Width:  1.15"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalPrtGetDefault( sDeviceDef, sDriverDef, sPortaDef )
.head 6 -  Call SalPrtSetup(sDevice,sDriver,sPorta,FALSE)
.head 5 +  On SAM_Create
.head 6 -  Set _sTabela = ''
.head 6 -  Set _nPermissao = 15
.head 6 -  Set _sTipoComando = 'Comum'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Pushbutton: pbSair
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Sair
.head 4 -  Window Location and Size
.head 5 -  Left: 5.363"
.head 5 -  Top: 0.688"
.head 5 -  Width:  1.15"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTabela = ''
.head 6 -  Set _sTipoComando = 'Sai'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  Frame
.head 4 -  Resource Id: 28951
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.038"
.head 5 -  Top: 0.031"
.head 5 -  Width:  6.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.708"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dfsSaida
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 6.013"
.head 6 -  Top: 2.615"
.head 6 -  Width:  0.425"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = FALSE
.head 6 -  Set _sValorDefault = 'I'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  ! Frame
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.238"
.head 5 -  Top: 1.323"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Gray
.end
.head 3 -  Background Text: Motivos de Cancelamentos
.head 4 -  Resource Id: 28952
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 1.802"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Background Text: Orgão Autuante
.head 4 -  Resource Id: 28953
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 0.427"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfArquivo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.238"
.head 6 -  Top: 3.448"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfMensagem
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.888"
.head 6 -  Top: 3.469"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Picture: picSemaforo
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1Form
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: Class Default
.head 5 -  Top: Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbMotivo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Por Motivo
.head 4 -  Window Location and Size
.head 5 -  Left: 5.338"
.head 5 -  Top: 1.115"
.head 5 -  Width:  1.15"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sValorCampoFonte = 'I'
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  ! Set _sNomeCampoFonte = 'dfsSaida'
.head 6 -  Set _bRadioButtonDefault = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Radio Button: rbOrgao
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Por Orgão
.head 4 -  Window Location and Size
.head 5 -  Left: 5.338"
.head 5 -  Top: 1.365"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sValorCampoFonte = 'I'
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  ! Set _sNomeCampoFonte = 'dfsSaida'
.head 6 -  Set _bRadioButtonDefault = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Radio Button: rbUsuario
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Por Usuário
.head 4 -  Window Location and Size
.head 5 -  Left: 5.338"
.head 5 -  Top: 1.615"
.head 5 -  Width:  1.25"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sValorCampoFonte = 'I'
.head 6 -  Set _bNuncaHabilitado = FALSE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  ! Set _sNomeCampoFonte = 'dfsSaida'
.head 6 -  Set _bRadioButtonDefault = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  Group Box: Classificação
.head 4 -  Resource Id: 28954
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.238"
.head 5 -  Top: 0.948"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.958"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  ! Function: fGeraArquivoCancelados
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sArquivo
.head 5 -  Boolean: bok
.head 5 -  Number: nRegistros
.head 5 -  File Handle: hArquivo
.head 5 -  String: sTexto
.head 5 -  ! String:
.head 4 +  Actions 
.head 5 +  If dfArquivo = ''
.head 6 -  Call SalMessageBox( 'Informe o arquivo a ser gerado', 'Mensagem', MB_IconExclamation )
.head 6 -  Return FALSE
.head 5 -  Call SalHideWindow( dfArquivo )
.head 5 -  ! Call SalHideWindow( dfTexto )
.head 5 -  Call SalShowWindow( dfMensagem )
.head 5 -  Set sArquivo = 'C:\\RelatorioAutosCancelados\\'||dfArquivo||".txt"
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set dfMensagem = 'AGUARDE GERANDO O ARQUIVO'
.head 5 -  ! Call SalModalDialog( dlgEsperaGeracao, frmRelMultasPagas )
.head 5 -  ! Set dlgEsperaGeracao.dfArquivo = sArquivo
.head 5 -  !
.head 5 -  Set bok =  SalFileOpen( hArquivo, sArquivo,OF_Write|OF_Create )
.head 5 +  If not bok
.head 6 -  Call SalMessageBeep( 0 )
.head 6 -  Call SalMessageBox( 'Ocorreu um erro durante a abertura do arquivo txt.
Verifique a existência do diretório C:\\RelatorioAutosCancelados.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  Else 
.head 6 -  Set nRegistros = 0
.head 6 -  Call SalSendMsg( tblOrgaoAut, MSG_AtualizaTabela, 0, 0 )
.head 6 -  Call SalSendMsg( tblMotCancel, MSG_AtualizaTabela, 0, 0 )
.head 6 -  !
.head 6 -  Call SybPrepareProc( hSql,'exec dbinfracao..MovimentoAutoS_rel_cancel 
		@ID = :frmRelAutoCancelado.nID, 
		@DataI = :frmRelAutoCancelado.dfdInicial, 
		@DataF = :frmRelAutoCancelado.dfdFinal',
':nCodigoArgAut, :sNomeOrgao, :sPlaca, :sUF, :sSerie, :nAuto, :nDigito, :nNotificacao, :nProcesso, :nInfracao, :dData,
 :sUsuarioCancel, :nValor, :sMotivo' )
.head 6 -  Call SqlExecute( hSql )
.head 6 -  Call SqlFetchNext( hSql, nErro )
.head 6 +  If nErro = FETCH_EOF
.head 7 -  Return 0
.head 6 -  Set sCabecalho = 'Codigo;Orgao Autuante                          ;Placa  ;UF;Notificacao;Processo  ;Serie; Auto      ;Infracao; DataCanc.;UsuCanc.; Valor; Valor em R$; Motivo     '
.head 6 -  Set sTexto = sCabecalho
.head 6 -  Call SalFilePutStr( hArquivo, sTexto )
.head 6 -  ! Call SqlFetchNext( hSql, nErro )
.head 6 -  ! !!CB!! 174
Set _sIntoPesquisa =':frmRelAutoCancelado.tblAutoCancelado.colnCodigoOrgao,
				:frmRelAutoCancelado.tblAutoCancelado.colsNomeOrgao,
				:frmRelAutoCancelado.tblAutoCancelado.colsPlaca,
				:frmRelAutoCancelado.tblAutoCancelado.colsUF,
				:frmRelAutoCancelado.tblAutoCancelado.colsSerie,
				:frmRelAutoCancelado.tblAutoCancelado.colnAuto,
				:frmRelAutoCancelado.tblAutoCancelado.colnDigito,
				:frmRelAutoCancelado.tblAutoCancelado.colnNotificacao,
				:frmRelAutoCancelado.tblAutoCancelado.colnProcesso,
				:frmRelAutoCancelado.tblAutoCancelado.colnInfracao,
				:frmRelAutoCancelado.tblAutoCancelado.coldData,
				:frmRelAutoCancelado.tblAutoCancelado.colsUsuarioCancel,
				:frmRelAutoCancelado.tblAutoCancelado.colnValor,
				:frmRelAutoCancelado.tblAutoCancelado.colsMotivo,
				:frmRelAutoCancelado.tblAutoCancelado.colsNomeUsuarioCanc,
				:frmRelAutoCancelado.tblAutoCancelado.colnMatriculaAgente,
				:frmRelAutoCancelado.tblAutoCancelado.colsNomeAgente,
				:frmRelAutoCancelado.tblAutoCancelado.colsNomeOrgaoLotacao,
				:frmRelAutoCancelado.tblAutoCancelado.colsDataInfracao'

.head 6 -  !
.head 6 +  Loop 
.head 7 -  Set nNumero = (nValor*1.0641+1000000000)
.head 7 -  Set sTexto =  SalStrMidX(SalNumberToStrX(nCodigoArgAut+1000000,0),1,6) ||';'||
SalStrMidX(sNomeOrgao||'                                        ',0,40)||';'||
SalStrMidX(sPlaca||'        ',0,7)||';'||SalStrMidX(sUF||'  ',0,2)||';'||
SalStrMidX(SalNumberToStrX(nNotificacao+10000000000,0),1,10)||' ;'||
SalStrMidX(SalNumberToStrX(nProcesso+10000000000,0),1,10)||';'||
SalStrMidX(sSerie||' ',0,1)||'    ;'||
SalStrMidX( SalNumberToStrX(1000000000+nAuto,0),1,09)||'-'||
SalNumberToStrX(nDigito,0)||'; '||
SalStrMidX(SalNumberToStrX(nInfracao+10000000,0),1,7)||';'||
SalStrMidX(SalNumberToStrX(100+SalDateDay(dData),0),1,2)||'/'||
SalStrMidX(SalNumberToStrX(100+SalDateMonth(dData),0),1,2)||'/'||
SalNumberToStrX(SalDateYear(dData),0)||';'||
SalStrMidX(sUsuarioCancel||'        ',0,8)||';'||
SalStrMidX(SalNumberToStrX(nValor+1000000000,2),4,09)||'; '||
SalStrMidX(SalNumberToStrX(nNumero,2),4,09)||'; '||
SalStrMidX(sMotivo||'                              ',0,30)
.head 7 +  If nErro = FETCH_EOF
.head 8 -  Break 
.head 7 -  Call SalFilePutStr( hArquivo, sTexto )
.head 7 -  Call SqlFetchNext( hSql, nErro )
.head 6 -  Call SalFileClose( hArquivo )
.head 6 -  Call SalHideWindow(dfMensagem)
.head 6 -  Call SalMessageBox( 'ARQUIVO: ' || sArquivo || ' Gerado com sucesso ', 'Mensagem', MB_IconExclamation )
.head 3 +  Function: fGeraArquivoCancelados
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sArquivo
.head 5 -  Boolean: bok
.head 5 -  Number: nRegistros
.head 5 -  File Handle: hArquivo
.head 5 -  String: sTexto
.head 5 -  String: sNomeUsuarioCanc
.head 5 -  String: sNomeAgente
.head 5 -  String: sNomeOrgaoLotacao
.head 5 -  String: sDataInfracao
.head 5 -  Number: nMatriculaAgente
.head 5 -  Number: nMat
.head 5 -  String: sDirNome
.head 4 +  Actions
.head 5 +  If dfArquivo = ''
.head 6 -  Call SalMessageBox( 'Informe o arquivo a ser gerado', 'Mensagem', MB_IconExclamation )
.head 6 -  Return FALSE
.head 5 -  ! Criando o diretório
.head 5 -  ! Verificando a existência de um diretório
.head 5 -  Set sDirNome =   'C:\\RelatorioAutosCancelados\\'
.head 5 +  If NOT VisDosExist( sDirNome )
.head 6 -  !
.head 6 -  Call SalFileSetCurrentDirectory( sDirNome )
.head 6 -  ! Criando um diretório no raiz selecionado acima
.head 6 -  ! Call SalFileCreateDirectory ('C:\BaseConveniados')
.head 6 -  Call SalFileCreateDirectory (sDirNome)
.head 6 -  !
.head 5 -  !
.head 5 -  Call SalHideWindow( dfArquivo )
.head 5 -  ! Call SalHideWindow( dfTexto )
.head 5 -  Call SalShowWindow( dfMensagem )
.head 5 -  Set sArquivo = 'C:\\RelatorioAutosCancelados\\'||dfArquivo||".txt"
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set dfMensagem = 'AGUARDE GERANDO O ARQUIVO'
.head 5 -  ! Call SalModalDialog( dlgEsperaGeracao, frmRelMultasPagas )
.head 5 -  ! Set dlgEsperaGeracao.dfArquivo = sArquivo
.head 5 -  !
.head 5 -  Set bok =  SalFileOpen( hArquivo, sArquivo,OF_Write|OF_Create )
.head 5 +  If not bok
.head 6 -  Call SalMessageBeep( 0 )
.head 6 -  Call SalMessageBox( 'Ocorreu um erro durante a abertura do arquivo txt.
Verifique a existência do diretório C:\\RelatorioAutosCancelados.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  Else
.head 6 -  Set nRegistros = 0
.head 6 -  Call SalSendMsg( tblOrgaoAut, MSG_AtualizaTabela, 0, 0 )
.head 6 -  Call SalSendMsg( tblMotCancel, MSG_AtualizaTabela, 0, 0 )
.head 6 -  !
.head 6 -  Call SybPrepareProc( hSql,'exec dbinfracao..MovimentoAutoS_rel_cancel 
		@ID = :frmRelAutoCancelado.nID, 
		@DataI = :frmRelAutoCancelado.dfdInicial, 
		@DataF = :frmRelAutoCancelado.dfdFinal',
':nCodigoArgAut, 
:sNomeOrgao, 
:sPlaca, 
:sUF, 
:sSerie, 
:nAuto, 
:nDigito, 
:nNotificacao, 
:nProcesso, 
:nInfracao, 
:dData,
 :sUsuarioCancel, 
:nValor, 
:sMotivo,
:sNomeUsuarioCanc,
:nMatriculaAgente,
:sNomeAgente,
:sNomeOrgaoLotacao,
:sDataInfracao
' )
.head 6 -  Call SqlExecute( hSql )
.head 6 -  Call SqlFetchNext( hSql, nErro )
.head 6 +  If nErro = FETCH_EOF
.head 7 -  Return 0
.head 6 -  ! Set sCabecalho = 'Codigo;Orgao Autuante                          ;Placa  ;UF;Notificacao;Processo  ;Serie; Auto      ;Infracao; DataCanc.;UsuCanc.; Valor; Valor em R$; Motivo                         ;MatriculaAgente;NomeAgente                              ;NomeOrgaoLotacao                    DataInfracao'
.head 6 -  Set sCabecalho = 'Codigo;Orgao Autuante                          ;Placa  ;UF;Notificacao;Processo  ;Serie; Auto      ;Infracao; DataCanc.;UsuCanc.; Valor;  Valor em R$; Motivo                        '
.head 6 -  Set sCabecalho = sCabecalho || ';MatriculaAgente;NomeAgente                              ;NomeOrgaoLotacao                        ;DataInfracao'
.head 6 -  Set sTexto = sCabecalho
.head 6 -  Call SalFilePutStr( hArquivo, sTexto )
.head 6 -  ! Call SqlFetchNext( hSql, nErro )
.head 6 -  !
.head 6 +  Loop
.head 7 -  Set nNumero = (nValor*1.0641+1000000000)
.head 7 -  Set nMat =  (nMatriculaAgente+10000000000000000)
.head 7 -  Set sTexto =  SalStrMidX(SalNumberToStrX(nCodigoArgAut+1000000,0),1,6) ||';'||
SalStrMidX(sNomeOrgao||'                                        ',0,40)||';'||
SalStrMidX(sPlaca||'        ',0,7)||';'||SalStrMidX(sUF||'  ',0,2)||';'||
SalStrMidX(SalNumberToStrX(nNotificacao+10000000000,0),1,10)||' ;'||
SalStrMidX(SalNumberToStrX(nProcesso+10000000000,0),1,10)||';'||
SalStrMidX(sSerie||' ',0,2)||'   ;'||
SalStrMidX( SalNumberToStrX(1000000000+nAuto,0),1,09)||'-'||
SalNumberToStrX(nDigito,0)||'; '||
SalStrMidX(SalNumberToStrX(nInfracao+10000000,0),1,7)||';'||
SalStrMidX(SalNumberToStrX(100+SalDateDay(dData),0),1,2)||'/'||
SalStrMidX(SalNumberToStrX(100+SalDateMonth(dData),0),1,2)||'/'||
SalNumberToStrX(SalDateYear(dData),0)||';'||
SalStrMidX(sUsuarioCancel||'        ',0,8)||';'||
SalStrMidX(SalNumberToStrX(nValor+1000000000,2),4,09)||'; '||
SalStrMidX(SalNumberToStrX(nNumero,2),4,09)||'; '||
SalStrMidX(sMotivo||'                              ',0,30)||';'||
SalStrMidX(SalNumberToStrX(nMatriculaAgente+10000000000000000,0),2,15)||';'||
SalStrMidX(sNomeAgente||'                                                  ',0,40)||';'||
SalStrMidX(sNomeOrgaoLotacao||'                                        ',0,40)||';'||
SalStrMidX(sDataInfracao||'          ',0,10)
.head 7 -  ! 
 
 
.head 7 +  If nErro = FETCH_EOF
.head 8 -  Break
.head 7 -  Call SalFilePutStr( hArquivo, sTexto )
.head 7 -  Call SqlFetchNext( hSql, nErro )
.head 6 -  Call SalFileClose( hArquivo )
.head 6 -  Call SalHideWindow(dfMensagem)
.head 6 -  Call SalMessageBox( 'ARQUIVO: ' || sArquivo || ' Gerado com sucesso ', 'Mensagem', MB_IconExclamation )
.head 3 +  ! Function: fGeraArquivoCancelados
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Window Handle: hWndTable
.head 5 -  Number: nColumnLength
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sArquivo
.head 5 -  Boolean: bok
.head 5 -  Number: nRegistros
.head 5 -  File Handle: hArquivo
.head 5 -  String: sTexto
.head 5 -  Window Handle: hWndColumn
.head 5 -  Number: nRow
.head 5 -  Number: nNumberOfLoop
.head 5 -  String: sColumnTitle
.head 5 -  String: sColumnText
.head 5 -  FunctionalVar: oArquivo
.winattr class
.head 6 -  Class: cArquivo
.end
.head 5 -  ! String:
.head 4 +  Actions 
.head 5 +  If dfArquivo = ''
.head 6 -  Call SalMessageBox( 'Informe o arquivo a ser gerado', 'Mensagem', MB_IconExclamation )
.head 6 -  Return FALSE
.head 5 -  Call SalHideWindow( dfArquivo )
.head 5 -  ! Call SalHideWindow( dfTexto )
.head 5 -  Call SalShowWindow( dfMensagem )
.head 5 -  Set sArquivo = 'C:\\RelatorioAutosCancelados\\'||dfArquivo||".txt"
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set dfMensagem = 'AGUARDE GERANDO O ARQUIVO'
.head 5 -  ! Call SalModalDialog( dlgEsperaGeracao, frmRelMultasPagas )
.head 5 -  ! Set dlgEsperaGeracao.dfArquivo = sArquivo
.head 5 -  !
.head 5 -  ! ! - Inicializa o número das colunas que será utilizado nos loops para resgatar o titulo da coluna e os dados da linha
.head 5 -  Set nNumberOfLoop = 1
.head 5 -  ! ! - Inicializa a posição inicial da linha da tabela.
.head 5 -  Set nRow = -1
.head 5 -  ! ! - Inicia a linha, informa qual tipo de separador e pula uma linha
.head 5 -  Call oArquivo.IniciaLinha(  )
.head 5 -  Call oArquivo.setSeparador( ';' )
.head 5 -  Call oArquivo.NovaLinha(  )
.head 5 -  ! ! - Loop para escrever os titulos das colunas no arquivo texto
.head 5 +  Loop 
.head 6 -  ! - Recupera o handle da coluna baseado na posição que ela está.
.head 6 -  Set hWndColumn = SalTblGetColumnWindow( hWndTable, nNumberOfLoop, 0)
.head 6 -  ! - Recupera o titulo da coluna baseado no handle que foi pego, com um limite máximo de 80 caracteres.
.head 6 -  Call SalTblGetColumnTitle( hWndColumn, sColumnTitle, 80 )
.head 6 -  ! - Escreve no arquivo o titulo da coluna
.head 6 -  Call oArquivo.AddStr( sColumnTitle, sColumnTitle )
.head 6 -  ! - Incrementa o loop
.head 6 -  Set nNumberOfLoop = nNumberOfLoop + 1
.head 6 -  ! - Caso o número do giro do loop seja maior que a quantidade de colunas o loop é terminado
.head 6 +  If nNumberOfLoop > nColumnLength
.head 7 -  ! - Inicia novamente a contagem dos loops
.head 7 -  Set nNumberOfLoop = 1
.head 7 -  Break 
.head 5 -  ! ! - Loop para pegar todas as linhas da tabela (enquanto tiver linhas na tabela)
.head 5 +  While SalTblFindNextRow( hWndTable, nRow, 0, 0 )
.head 6 -  ! - Seta o contexto na linha da tabela
.head 6 -  Call SalTblSetContext( hWndTable, nRow )
.head 6 -  ! - Pula uma linha
.head 6 -  Call oArquivo.NovaLinha(  )
.head 6 -  ! - Loop para pegar o registro daquela coluna em uma determinada linha.
.head 6 +  Loop 
.head 7 -  ! - Pega o registro daquela linha
.head 7 -  Call SalTblGetColumnText( hWndTable, nNumberOfLoop, sColumnText )
.head 7 -  ! - Escrevo no arquivo
.head 7 -  Call oArquivo.AddStr( sColumnText, sColumnTitle )
.head 7 -  ! - Incrementa o loop
.head 7 -  Set nNumberOfLoop = nNumberOfLoop + 1
.head 7 -  ! - Caso o número do giro do loop seja maior que a quantidade de colunas o loop é terminado
.head 7 +  If nNumberOfLoop > nColumnLength
.head 8 -  ! - Inicia novamente a contagem dos loops
.head 8 -  Set nNumberOfLoop = 1
.head 8 -  Break 
.head 5 -  ! ! - Gera o arquivo texto com nome escolhido (já sai a data automaticamente depois do nome escolhido)
.head 5 -  Call oArquivo.GerarArquivo( 'Relatório de Autos Cancelados' )
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sPlaca
.head 3 -  String: sUF
.head 3 -  String: sNomeOrgao
.head 3 -  String: sSerie
.head 3 -  Number: nAuto
.head 3 -  Number: nDigito
.head 3 -  Number: nNotificacao
.head 3 -  String: sLocal
.head 3 -  Number: nProcesso
.head 3 -  Number: nInfracao
.head 3 -  Date/Time: dData
.head 3 -  String: sUsuarioCancel
.head 3 -  Number: nValor
.head 3 -  String: sMotivo
.head 3 -  Number: nNumero
.head 3 -  !
.head 3 -  String: sCabecalho
.head 3 -  Number: nErro
.head 3 -  String: sDevice
.head 3 -  String: sDriver
.head 3 -  String: sPorta
.head 3 -  String: sDeviceDef
.head 3 -  String: sDriverDef
.head 3 -  String: sPortaDef
.head 3 -  String: sOrderBy
.head 3 -  String: sNomeUsuarioCanc
.head 3 -  String: sNomeQRP
.head 3 -  !
.head 3 -  Number: nID
.head 3 -  Window Handle: hWndReportView
.head 3 -  Number: nSetorUsuario
.head 3 -  String: sSetorUsuarioN
.head 3 -  Number: nParamArray[*]
.head 3 -  Number: nCodigoArgAut
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set _nEstadoInicialForm = 1
.head 4 -  Set _sTextoStatusBar = 'Relatório de Autos Cancelados'
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Set sSetorUsuarioN = SalStrMidX(SalNumberToStrX(nGlobalSetor,0),0,SalStrLength( SalNumberToStrX(nGlobalSetor,0) )-1)
.head 4 -  Set nSetorUsuario = SalStrToNumber(sSetorUsuarioN)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendClassMessage( SAM_CreateComplete, wParam, lParam )
.head 4 -  Call SalSendMsg( tblOrgaoAut, MSG_PopulaTabela, wParam, lParam  )
.head 4 -  Call SalSendMsg( tblMotCancel, MSG_PopulaTabela, wParam, lParam  )
.head 4 -  Call SalEnableWindow( tblOrgaoAut )
.head 4 -  Call SalEnableWindow( tblMotCancel)
.head 4 -  Call SalDisableWindow( pbImpressoras )
.head 4 -  Call SalHideWindow(dfArquivo)
.head 4 -  Call SalHideWindow(dfMensagem)
.head 4 -  Set dfsSaida = 'T'
.head 4 -  Set rbTela = TRUE
.head 3 +  ! On SAM_ReportStart
.head 4 -  Call SalReportDlgOptions( SalNumberToWindowHandle( wParam ), 'Impressão', 'Imprimindo', 'Relatório de Autos Cancelados', 'Relatório de Autos Cancelados' )
.head 4 -  Return TRUE
.head 3 +  ! On SAM_ReportFetchInit
.head 4 -  ! Atualiza Tabela de Setores e de Funcionários Selecionados
.head 4 -  Call SalSendMsg( tblOrgaoAut, MSG_AtualizaTabela, 0, 0 )
.head 4 -  Call SalSendMsg( tblMotCancel, MSG_AtualizaTabela, 0, 0 )
.head 4 +  If rbUsuario
.head 5 -  Set sOrderBy  = 'Usuario'
.head 4 +  Else If rbMotivo
.head 5 -  Set sOrderBy = 'Motivo'
.head 4 +  Else 
.head 5 -  Set sOrderBy = 'Orgao'
.head 4 -  Call SybPrepareProc( hSql,'exec dbinfracao..MovimentoAutoS_rel_cancel 
			@ID = :nID, 
			@DataI = :dfdInicial, 
			@DataF = :dfdFinal,
			@OrderBy = :sOrderBy',
':sNomeOrgao, 
 :sPlaca, 
 :sUF, :sSerie, 
 :nAuto, 
 :nDigito, 
 :nNotificacao, 
 :nProcesso, 
 :nInfracao, 
 :dData,
 :sUsuarioCancel, 
 :nValor, 
 :sMotivo,
 :sNomeUsuarioCanc' )

.head 4 -  Return SqlExecute( hSql )
.head 3 +  ! On SAM_ReportFetchNext
.head 4 -  Call SqlFetchNext( hSql, nErro )
.head 4 +  If nErro != FETCH_EOF
.head 5 -  Return 1
.head 4 +  Else 
.head 5 -  Return 0
.head 3 +  ! On SAM_ReportFinish
.head 4 -  Call SalPrtSetDefault(sDeviceDef,sDriverDef,sPortaDef)
.head 4 -  ! Call SqlDisconnect( hSqlApp )
.head 4 -  ! Call SqlConnect( hSqlApp )
.head 4 -  ! Return FALSE
.head 3 +  On SAM_Destroy
.head 4 +  If hWndReportView != hWndNULL
.head 5 -  Call SalReportClose( hWndReportView )
.head 5 -  Call SalDestroyWindow( hWndReportView )
.head 5 -  Set hWndReportView = hWndNULL
.head 4 -  Call SalSendClassMessage( SAM_Destroy, wParam, lParam )
.head 0 -  
.head 0 -  
.head 0 -  

  