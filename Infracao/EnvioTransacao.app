.head 0 +  Application Description: ---------------------------------------------------------------------------------------------------------------------
Detran-PE Departamento de Trânsito do estado de Pernambuco
Sistema de Controle e Registro de Infrações
---------------------------------------------------------------------------------------------------------------------
Analista Responsável 	: Adilson Santos
Versão Liberada na Data	: 02-10-2002
---------------------------------------------------------------------------------------------------------------------
Migrado para versão CTD2000 em 19/08/2002 por Fernando Freitas
---------------------------------------------------------------------------------------------------------------------
.data CLASSPROPSSIZE
0000: 2700
.enddata
.data CLASSPROPS
0000: 4442475F504C4159 4241434B5F475549 440010001F466F46 6172864991303E7E
0020: 42A10E3C000000
.enddata
.head 1 -  Outline Version - 4.0.28
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B00000 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFF160000 0000000000D40200 007B010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D04000000075769 6E646F77730D6D64
0080: 69496E6672616361 6F20200D4368696C 642057696E646F77 731B66726D456E76
00A0: 69614E6F74696669 636163616F417574 756163616F
.enddata
.data DT_MAKERUNDLG
0000: 0900001000000000 0C496E6672616361 6F2E69636F12456E 76696F5472616E73
0020: 6163616F2E657865 0C494E4652414341 4F2E646C6C0C494E 46524143414F2E61
0040: 7063000001010100 6400000000000000 0001000000000000 000C494E46524143
0060: 414F2E6170640C49 4E46524143414F2E 646C6C0C494E4652 4143414F2E617063
0080: 0000010101006400 00000C494E465241 43414F2E61706C0C 494E46524143414F
00A0: 2E646C6C0C494E46 524143414F2E6170 6300000101010064 0000000C494E4652
00C0: 4143414F2E657865 0C494E4652414341 4F2E646C6C0C494E 46524143414F2E61
00E0: 7063000001010100 640000000C494E46 524143414F2E646C 6C0C494E46524143
0100: 414F2E646C6C0C49 4E46524143414F2E 6170630000010101 00640000000C494E
0120: 46524143414F2E64 6C6C0C494E465241 43414F2E646C6C0C 494E46524143414F
0140: 2E61706300000101 0100640000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0100000001000000 0100010000000000 0000000100001000
0180: 0000000000000000 000000
.enddata
.head 2 -  Outline Window State: Maximized
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600070003001B00 0200000000000000 00007920E0140500 1D00FFFF4D61696E
0020: 0032000000000000 001301E5009E2081 0F02000100FFFF6D 6469496E66726163
0040: 616F2E66726D4175 746F496E66726163 616F002D00000000 00000072065F0566
0060: 1FFB1302000100FF FF6D6469496E6672 6163616F2E66726D 43616E63656C6100
0080: 2E00000000000000 3903B002C4224B11 02000100FFFF6D64 69496E6672616361
00A0: 6F2E66726D436F6E 734175746F002E00 0000000000008507 44061027E0140200
00C0: 0100FFFF6D646949 6E66726163616F2E 66726D496E667261 63616F002F000000
00E0: 0000000072065F05 FD25FB1302000100 FFFF6D6469496E66 726163616F2E6672
0100: 6D42616978614175 746F002C00000000 0000004C049503D7 23301202000100FF
0120: FF6D6469496E6672 6163616F2E66726D 41636572746F00
.enddata
.data VIEWSIZE
0000: 3701
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4189806B80B2A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.2"
.head 3 -  Top: 0.042"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 1.5"
.head 3 -  Top: 5.677"
.head 2 -  Fully Qualified External References? No
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? No
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: vtfile.apl
.head 2 -  File Include: vtstr.apl
.head 2 -  File Include: vtdos.apl
.head 2 -  File Include: vtmeter.apl
.head 2 -  File Include: vtcomdlg.apl
.head 2 -  File Include: vtspin.apl
.head 2 -  File Include: Detran_Consultas.apl
.head 2 -  File Include: vt.apl
.head 2 -  File Include: vtcal.apl
.head 2 -  File Include: vtdebug.apl
.head 2 -  File Include: vtfontnm.apl
.head 2 -  File Include: vtlstvw.apl
.head 2 -  File Include: vtmenu.apl
.head 2 -  File Include: vtmsgbox.apl
.head 2 -  File Include: vtpal.apl
.head 2 -  File Include: vtsplit.apl
.head 2 -  File Include: vtwin.apl
.head 2 -  File Include: dlgBINConsAutEmissaoCrv.apl
.head 2 -  File Include: dlgBINConsHistEmissaoCrlv.apl
.head 2 -  File Include: dlgBINConsultaIntencaoVenda.apl
.head 2 -  File Include: frmVeiculoImagemAr.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Number: 00000000000
.head 3 -  Input: 9999999999-9
.head 3 -  Input: 99999999999-9
.head 3 -  Date/Time: dd-MM-yyyy hh:mm
.head 3 -  Date/Time: hh:mm
.head 3 -  Date/Time: hhhh:mm
.head 3 -  Number: 000000000
.head 3 -  Input: 99999999-9
.head 3 -  Number: #0
.head 3 -  Input: 999999999-9
.head 3 -  Number: 0000000000
.head 3 -  Input: 999999999
.head 3 -  Input: 99
.head 3 -  Input: 9999-9
.head 3 -  Input: 99-99-9999 99:99
.head 3 -  Input: 9999.999999
.head 3 -  Input: 99-99-9999
.head 3 -  Date/Time: dd-MM-yyyy
.head 3 -  Input: 9999
.head 3 -  Number: 0000000000
.head 3 -  Input: 999999999
.head 3 -  Number: 000000000
.head 3 -  Input: 999999999-9
.head 3 -  Number: 000000000
.head 3 -  Input: 9999999-9
.head 3 -  Number: 000000
.head 3 -  Input: 999999
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Input: 99-99-9999
.head 3 -  Number: ###000
.head 3 -  Number: ###0
.head 3 -  Number: ##0
.head 3 -  Input: 99999
.head 3 -  Number: 0000
.head 3 -  Number:
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 3 -  Enumerations
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 3025586986
0000: 2200000013000000 0000000000000000 0200000100000099 030000D019000000
0020: 01FE00FF03
.enddata
.head 3 -  Date/Time: dGlobalHoje
.head 3 -  Window Handle: hWndConsAutoDis
.head 3 -  Window Handle: hWndConsAutoFin
.head 3 -  Window Handle: hWndConsAutoLoca
.head 3 -  Window Handle: hWndConsAutoMov
.head 3 -  Window Handle: hWndAcertoAuto
.head 3 -  Window Handle: hWndBairro
.head 3 -  Window Handle: hWndConEntregaNotificacao
.head 3 -  Window Handle: hWndConMovtoAuto
.head 3 -  Window Handle: hWndConSituacaoAuto
.head 3 -  Window Handle: hWndComplementoCategoria
.head 3 -  Window Handle: hWndEnderProprietario
.head 3 -  Window Handle: hWndMunicipio
.head 3 -  Window Handle: hWndRelMulta
.head 3 -  Window Handle: hWndRelNotifi
.head 3 -  Window Handle: hWndConsAutoGeral
.head 3 -  Window Handle: hWndConHistAuto
.head 3 -  Window Handle: hWndHisInfracaoAuto
.head 3 -  String: sGlobalSecretaria
.head 3 -  String: sGlobalDetran
.head 3 -  Number: nAux
.head 3 -  Number: nInfracaoCTB
.head 3 -  Number: nCodConsultaRENAINF
.head 3 -  Number: nSeqTransacaoRENAINF
.head 2 +  Internal Functions
.head 3 +  ! Function: SerieDigitoModulo11
.head 4 -    Description: Inclue a série no cálculo do dígito
.head 4 +    Returns 
.head 5 -    Number: nRetorno
.head 4 +    Parameters 
.head 5 -    String: sSerie
.head 5 -    Number: nCodigo
.head 4 -    Static Variables 
.head 4 +    Local variables 
.head 5 -    Number: nSerie
.head 4 +    Actions 
.head 5 -  ! Faz o tratamento da série
.head 5 +    If sSerie ='*'
.head 6 -    Return -1
.head 5 +    If NOT ( sSerie >= 'A' AND sSerie <= 'Z' )
.head 6 -    Call SalMessageBeep( 0 )
.head 6 -    Call SalMessageBox( 'Deve ser informado uma série válida!', 'Atenção', MB_IconExclamation | MB_Ok )
.head 6 -    Return -1
.head 5 -    Set sSerie = SalStrUpperX( sSerie )
.head 5 -    Call SalStrFirstC( sSerie, nSerie )
.head 5 -    Set nSerie = SalNumberMod( nSerie - 64, 10 )
.head 5 -    Set nCodigo = SalStrToNumber( SalNumberToStrX( nSerie, 0 ) || SalStrRightX( SalNumberToStrX( 100000000 + nCodigo, 0 ), 8 ))
.head 5 -  !
.head 5 -    Return DigitoModulo11Inf( nCodigo )
.head 3 +  ! Function: fTransmiteRENAINF
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nLinha
.head 5 -  Long String: lsMensagem
.head 5 -  Long String: lsMensagem2
.head 5 -  Number: nSeqTransacao
.head 5 -  Number: nCodConsulta
.head 5 -  String: sMensagem
.head 4 +  Actions 
.head 5 -  Set nLinha = 0
.head 5 -  Call SalTblSetContext( tblReenvioRENAINF, 0 )
.head 5 +  While SalTblFetchRow( tblReenvioRENAINF, nLinha ) != TBL_NoMoreRows
.head 6 +  If fMPSPrepareProc( hSqlApp, 'exec dbinfracao..RNFTransmiteAuto @Serie = :frmReenvioRENAINF.tblReenvioRENAINF.colsSerie,
@OrgaoAutuante =:frmReenvioRENAINF.tblReenvioRENAINF.colnOrgaoAutuante, @Auto =:frmReenvioRENAINF.tblReenvioRENAINF.colnAuto,
@Infracao = :frmReenvioRENAINF.tblReenvioRENAINF.colnInfracao', ':lsMensagem,:lsMensagem2' )
.head 7 -  ! Call SqlExecute( hSqlApp )
.head 6 -  !
.head 6 +  If NOT SqlExecute( hSqlApp )
.head 7 -  Call fMPSDisconnect( hSqlApp )
.head 7 -  Return FALSE
.head 6 -  Call SqlFetchNext( hSqlApp, nRetorno )
.head 6 +  If nRetorno != FETCH_Ok
.head 7 -  Call fMPSDisconnect( hSqlApp )
.head 7 -  Return FALSE
.head 6 -  Set lsMensagem = lsMensagem || lsMensagem2
.head 6 -  Set nCodConsulta = SalStrToNumber( SalStrMidX( lsMensagem, 6, 3) )
.head 6 -  Set nSeqTransacao = SalStrToNumber( SalStrLeftX( lsMensagem, 6  ) )
.head 6 -  Call fMPSDisconnect( hSqlApp )
.head 6 -  ! Call SqlGetResultSetCount( hSqlApp, nRetorno )
.head 6 -  !
.head 6 +  If NOT FuncaoHelpCom( lsMensagem )
.head 7 -  Call fMPSDisconnect( hSqlApp )
.head 7 -  Return FALSE
.head 6 -  Set nLinha = nLinha + 1

.head 6 -  ! PAREI AQUI
.head 6 -  Call fMPSConnect( hSqlApp )
.head 6 +  If fMPSPrepareProc( hSqlApp, 'exec dbinfracao..RNFTrataRetorno @CodTransacao = :nCodConsulta,
@NumSeqTransacao =:nSeqTransacao', ':sMensagem' )
.head 7 -  ! Call SqlExecute( hSqlApp )
.head 6 +  If NOT SqlExecute( hSqlApp )
.head 7 -  ! Call fMPSDisconnect( hSqlApp )
.head 7 -  Return FALSE
.head 6 -  Call SqlFetchNext( hSqlApp, nRetorno )
.head 6 -  Set tblReenvioRENAINF.colsMensagem= sMensagem
.head 5 -  ! Call fMPSDisconnect( hSqlApp )
.head 3 +  Function: fInfracaoNovoCodigo
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nCodigo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nCodigo > 5000 and nCodigo < 6000
.head 6 -  Set nCodigo =  SalNumberTruncate( nCodigo/10, 10, 0 )
.head 5 -  Return nCodigo
.head 3 +  Function: fInfracaoInseriDigito
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nCodigo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nCodigo > 500 and nCodigo < 600
.head 6 -  Set nCodigo = nCodigo*10+DigitoModulo11( SalNumberTruncate( nCodigo, 10, 0 ))
.head 5 -  Return nCodigo
.head 3 +  Function: PreencheListaCombo
.head 4 -  Description: Preenche a lista e o array de codigos dos itens.
Esta função recebe um Sql Handle e uma string com o 
comando.
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: hCombo
.head 5 -  String: strComando
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! Flags de retorno de funcoes
.head 5 -  Boolean: bOk
.head 5 -  Number: nInd
.head 5 -  ! Contador
.head 5 -  Number: nCount
.head 5 -  ! Variaveis para codigos
.head 5 -  String: strNome
.head 5 -  ! Armazena temporariamente a string que sera´ jogada dentro da combo propriamente dita
.head 5 -  String: strItem
.head 5 -  ! car 21/06/96 - Armazena a selecao do combo para que nao se perca no drop-down
.head 5 -  String: strCampoCodigo
.head 5 -  Sql Handle: hSqlApoio
.head 4 +  Actions
.head 5 -  Call fMPSConnect( hSqlApoio )
.head 5 -  Set bOk = fMPSPrepareProc(hSqlApoio,strComando ,':strNome')
.head 5 -  Set bOk = SqlExecute(hSqlApoio)
.head 5 -  Set nCount = 0
.head 5 -  Call SqlFetchNext(hSqlApoio,nInd)
.head 5 +  While nInd != FETCH_EOF
.head 6 -  Set nCount = nCount + 1
.head 6 +  If nCount = 1
.head 7 -  Set strCampoCodigo = strNome
.head 6 -  Call SalListAdd(hCombo,strNome)
.head 6 -  Call SqlFetchNext(hSqlApoio,nInd)
.head 5 -  ! Call SalArraySetUpperBound( strCodigos, 1, nCount  -1 )
.head 5 -  ! Call SalArraySetUpperBound( strItens, 1, nCount -1 )
.head 5 -  ! Call SalListSelectString( hCombo, -1, strCampoCodigo)
.head 3 +  Function: fLimpa
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hHandle
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nType
.head 4 +  Actions
.head 5 -  Set nType = SalGetType( hHandle ) 
.head 5 +  If nType = TYPE_ChildTable
.head 6 -  Call SalTblReset( hHandle )
.head 5 +  Else If nType =  TYPE_ComboBox
.head 6 -  Call SalListSetSelect( hHandle, -1 )
.head 5 +  Else If nType = TYPE_DataField
.head 6 -  Call SalClearField( hHandle )
.head 5 +  Else If nType = TYPE_MultilineText
.head 6 -  Call SalClearField( hHandle )
.head 3 +  ! Function: SerieDigitoModulo11 VERSAO ANTERIOR
.head 4 -   Description: Inclue a série no cálculo do dígito
.head 4 +   Returns 
.head 5 -   Number: nRetorno
.head 4 +   Parameters 
.head 5 -   String: sSerie
.head 5 -   Number: nCodigo
.head 4 -   Static Variables 
.head 4 +   Local variables 
.head 5 -   Number: nSerie
.head 4 +   Actions 
.head 5 -  ! Faz o tratamento da série
.head 5 +   If sSerie = 'A'
.head 6 -   Set nSerie = 1
.head 5 +   Else If sSerie = 'B'
.head 6 -   Set nSerie = 2
.head 5 +   Else If sSerie = 'C'
.head 6 -   Set nSerie = 3
.head 5 +   Else If sSerie = 'D'
.head 6 -   Set nSerie = 4
.head 5 +   Else If sSerie = 'E'
.head 6 -   Set nSerie = 5
.head 5 +   Else If sSerie = 'F'
.head 6 -   Set nSerie = 6
.head 5 +   Else If sSerie = 'G'
.head 6 -   Set nSerie = 7
.head 5 +   Else If sSerie = 'H'
.head 6 -   Set nSerie = 8
.head 5 +   Else If sSerie = 'I'
.head 6 -   Set nSerie = 9
.head 5 +   Else If sSerie = 'J'
.head 6 -   Set nSerie = 1
.head 5 +   Else If sSerie = 'K'
.head 6 -   Set nSerie = 2
.head 5 +   Else If sSerie = 'L'
.head 6 -   Set nSerie = 3
.head 5 +   Else If sSerie = 'M'
.head 6 -   Set nSerie = 4
.head 5 +   Else If sSerie = 'N'
.head 6 -   Set nSerie = 5
.head 5 +   Else If sSerie = 'O'
.head 6 -   Set nSerie = 6
.head 5 +   Else If sSerie = 'P'
.head 6 -   Set nSerie = 7
.head 5 +   Else If sSerie = 'Q'
.head 6 -   Set nSerie = 8
.head 5 +   Else If sSerie = 'R'
.head 6 -   Set nSerie = 9
.head 5 +   Else If sSerie = 'S'
.head 6 -   Set nSerie = 2
.head 5 +   Else If sSerie = 'T'
.head 6 -   Set nSerie = 3
.head 5 +   Else If sSerie = 'U'
.head 6 -   Set nSerie = 4
.head 5 +   Else If sSerie = 'V'
.head 6 -   Set nSerie = 5
.head 5 +   Else If sSerie = 'W'
.head 6 -   Set nSerie = 6
.head 5 +   Else If sSerie = 'X'
.head 6 -   Set nSerie = 7
.head 5 +   Else If sSerie = 'Y'
.head 6 -   Set nSerie = 8
.head 5 +   Else If sSerie = 'Z'
.head 6 -   Set nSerie = 9
.head 5 +   Else If sSerie = '*'
.head 6 -   Return -1
.head 5 -   Set nCodigo = SalStrToNumber( SalNumberToStrX( nSerie, 0 ) || SalStrRightX( SalNumberToStrX( 100000000 + nCodigo, 0 ), 8 ))
.head 5 -  !
.head 5 -   Return DigitoModulo11Inf( nCodigo )
.head 3 +  ! Function: SerieDigitoModulo11
.head 4 -  Description: Inclue a série no cálculo do dígito
.head 4 +  Returns 
.head 5 -  Number: nRetorno
.head 4 +  Parameters 
.head 5 -  String: sSerie
.head 5 -  Number: nCodigo
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nSerie
.head 4 +  Actions 
.head 5 -  ! Faz o tratamento da série
.head 5 -  Set sSerie = SalStrMidX(sSerie||"    ",0,2)
.head 5 +  If SalStrMidX(sSerie,0,1) = 'A'
.head 6 -  Set nSerie = 1
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'B'
.head 6 -  Set nSerie = 2
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'C'
.head 6 -  Set nSerie = 3
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'D'
.head 6 -  Set nSerie = 4
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'E'
.head 6 -  Set nSerie = 5
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'F'
.head 6 -  Set nSerie = 6
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'G'
.head 6 -  Set nSerie = 7
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'H'
.head 6 -  Set nSerie = 8
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'I'
.head 6 -  Set nSerie = 9
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'J'
.head 6 -  Set nSerie = 1
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'K'
.head 6 -  Set nSerie = 2
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'L'
.head 6 -  Set nSerie = 3
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'M'
.head 6 -  Set nSerie = 4
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'N'
.head 6 -  Set nSerie = 5
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'O'
.head 6 -  Set nSerie = 6
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'P'
.head 6 -  Set nSerie = 7
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'Q'
.head 6 -  Set nSerie = 8
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'R'
.head 6 -  Set nSerie = 9
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'S'
.head 6 -  Set nSerie = 2
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'T'
.head 6 -  Set nSerie = 3
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'U'
.head 6 -  Set nSerie = 4
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'V'
.head 6 -  Set nSerie = 5
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'W'
.head 6 -  Set nSerie = 6
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'X'
.head 6 -  Set nSerie = 7
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'Y'
.head 6 -  Set nSerie = 8
.head 5 +  Else If SalStrMidX(sSerie,0,1) = 'Z'
.head 6 -  Set nSerie = 9
.head 5 +  Else If SalStrMidX(sSerie,0,1) = '*'
.head 6 -  Return -1
.head 5 -  !
.head 5 +  If SalStrMidX(sSerie,1,1) != ' '
.head 6 +  If SalStrIsValidNumber( SalStrMidX(sSerie,0,1))
.head 7 -  Set nSerie = SalStrToNumber( SalStrMidX(sSerie,0,1) )
.head 5 -  !
.head 5 +  If SalStrMidX(sSerie,1,1) = 'A'
.head 6 -  Set nSerie = nSerie * 10 + 1
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'B'
.head 6 -  Set nSerie = nSerie * 10 + 2
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'C'
.head 6 -  Set nSerie = nSerie * 10 + 3
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'D'
.head 6 -  Set nSerie = nSerie * 10 + 4
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'E'
.head 6 -  Set nSerie = nSerie * 10 + 5
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'F'
.head 6 -  Set nSerie = nSerie * 10 + 6
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'G'
.head 6 -  Set nSerie = nSerie * 10 + 7
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'H'
.head 6 -  Set nSerie = nSerie * 10 + 8
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'I'
.head 6 -  Set nSerie = nSerie * 10 + 9
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'J'
.head 6 -  Set nSerie = nSerie * 10 + 1
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'K'
.head 6 -  Set nSerie = nSerie * 10 + 2
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'L'
.head 6 -  Set nSerie = nSerie * 10 + 3
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'M'
.head 6 -  Set nSerie = nSerie * 10 + 4
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'N'
.head 6 -  Set nSerie = nSerie * 10 + 5
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'O'
.head 6 -  Set nSerie = nSerie * 10 + 6
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'P'
.head 6 -  Set nSerie = nSerie * 10 + 7
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'Q'
.head 6 -  Set nSerie = nSerie * 10 + 8
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'R'
.head 6 -  Set nSerie = nSerie * 10 + 9
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'S'
.head 6 -  Set nSerie = nSerie * 10 + 2
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'T'
.head 6 -  Set nSerie = nSerie * 10 + 3
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'U'
.head 6 -  Set nSerie = nSerie * 10 + 4
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'V'
.head 6 -  Set nSerie = nSerie * 10 + 5
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'W'
.head 6 -  Set nSerie = nSerie * 10 + 6
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'X'
.head 6 -  Set nSerie = nSerie * 10 + 7
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'Y'
.head 6 -  Set nSerie = nSerie * 10 + 8
.head 5 +  Else If SalStrMidX(sSerie,1,1) = 'Z'
.head 6 -  Set nSerie = nSerie * 10 + 9
.head 5 +  Else If SalStrMidX(sSerie,1,1) = '*'
.head 6 -  Return -1
.head 5 -  ! Verificar se existe numero na composição da serie -- adilson 
.head 5 +  If SalStrMidX(sSerie,1,1) != ' '
.head 6 +  If SalStrIsValidNumber( SalStrMidX(sSerie,1,1))
.head 7 -  Set nSerie = nSerie*10+SalStrToNumber( SalStrMidX(sSerie,1,1) )
.head 5 -  Set nCodigo = SalStrToNumber( SalNumberToStrX( nSerie, 0 ) || SalStrRightX( SalNumberToStrX( 100000000 + nCodigo, 0 ), 8 ))
.head 5 -  !
.head 5 -  Return DigitoModulo11Inf( nCodigo )
.head 3 +  ! Function: DigitoModulo11Inf
.head 4 -    Description: Consiste dígito módulo 11
.head 4 +    Returns 
.head 5 -    Number: nRetorno
.head 4 +    Parameters 
.head 5 -    Number: nCodigo
.head 4 -    Static Variables 
.head 4 +    Local variables 
.head 5 -    String: sCodigo
.head 5 -    Number: nIndice
.head 5 -    Number: nIndAux
.head 5 -    Number: nLength
.head 5 -    Number: nDigito
.head 5 -    Number: nSoma
.head 5 -    Number: nRetorno
.head 4 +    Actions 
.head 5 -    Set nLength = SalNumberToStr( nCodigo, 0, sCodigo )
.head 5 -    Set nIndice = 2
.head 5 -    Set nSoma = 0
.head 5 -    Set nIndAux = 0
.head 5 +    While nIndAux < nLength
.head 6 -    Set nSoma = nSoma + ( SalStrToNumber( SalStrMidX( sCodigo, nIndAux, 1) ) * nIndice )
.head 6 -    Set nIndice = nIndice + 1
.head 6 -    Set nIndAux = nIndAux + 1
.head 6 +    If nIndice > 9
.head 7 -    Set nIndice = 2
.head 5 -    Set nDigito = 11 - SalNumberMod( nSoma, 11 )
.head 5 +    If nDigito > 9
.head 6 -    Set nDigito = 0
.head 5 -    Set nRetorno = nDigito
.head 5 -    Return nRetorno
.head 3 +  ! Function: DigitoModulo11Inf
.head 4 -  Description: Consiste dígito módulo 11
.head 4 +  Returns 
.head 5 -  Number: nRetorno
.head 4 +  Parameters 
.head 5 -  Number: nCodigo
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCodigo
.head 5 -  String: sInverso
.head 5 -  Number: nIndice
.head 5 -  Number: nLength
.head 5 -  Number: nDigito
.head 5 -  Number: nSoma
.head 5 -  Number: nRetorno
.head 4 +  Actions 
.head 5 -  Set nLength = SalNumberToStr( nCodigo, 0, sCodigo )
.head 5 -  Set nIndice = 0
.head 5 -  Set sInverso = ''
.head 5 +  While nIndice <  nLength
.head 6 -  Set sInverso = SalStrMidX( sCodigo, nIndice, 1 ) || sInverso
.head 6 -  Set nIndice = nIndice + 1
.head 5 -  Set nIndice = 0
.head 5 -  Set nSoma = 0
.head 5 +  While nIndice <  nLength 
.head 6 -  Set nSoma = nSoma + ( SalStrToNumber( SalStrMidX( sInverso, nIndice, 1 ) ) * ( SalNumberMod( nIndice,8 ) + 2) )
.head 6 -  Set nIndice = nIndice + 1
.head 5 -  Set nDigito = 11 - SalNumberMod( nSoma, 11 )
.head 5 +  If nDigito > 9
.head 6 -  Set nDigito = 0
.head 5 -  Set nRetorno = nDigito
.head 5 -  Return nRetorno
.head 3 +  Function: DivideColPor100
.head 4 -  Description: Divide o conteúdo da coluna por 100.
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Receive Window Handle: hWndTabela
.head 5 -  Receive Window Handle: hWndColuna
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nAux
.head 5 -  String: sAux
.head 4 +  Actions
.head 5 +  ! Autor 
.head 6 -      Celso 1/11/95
.head 5 -  Call SalTblGetColumnText( hWndTabela, SalTblQueryColumnID( hWndColuna), sAux )
.head 5 -  Set nAux = SalStrToNumber( sAux) / 100
.head 5 -  Call SalTblSetColumnText( hWndTabela, SalTblQueryColumnID( hWndColuna), SalNumberToStrX( nAux , 2 ) )
.head 3 +  Function: ItensSelecionado
.head 4 -  Description: Seleciona os ítens seecionados de uma tabela
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTable
.head 5 -  Window Handle: hWndColuna
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLinhaAtual
.head 5 -  Number: nColumnID
.head 5 -  String: sItem
.head 5 -  String: sSelecionados
.head 4 +  Actions
.head 5 +  ! Observações:
.head 6 -      Autor: Celso - 07/05/1997
.head 5 -  Set nLinhaAtual = TBL_MinRow
.head 5 -  Set nColumnID = SalTblQueryColumnID( hWndColuna )
.head 5 +  If NOT SalTblFindNextRow( hWndTable, nLinhaAtual, ROW_Edited, 0)
.head 6 -  Return ''
.head 5 -  Call SalTblSetContext( hWndTable, nLinhaAtual )
.head 5 -  Call SalTblGetColumnText( hWndTable, nColumnID, sSelecionados )
.head 5 +  While SalTblFindNextRow( hWndTable, nLinhaAtual, ROW_Edited, 0)
.head 6 -  Call SalTblSetContext( hWndTable, nLinhaAtual )
.head 6 -  Call SalTblGetColumnText( hWndTable, nColumnID, sItem )
.head 6 -  Set sSelecionados = sSelecionados || ', ' || sItem
.head 5 -  Return sSelecionados
.head 3 +  Function: NomeArquivo
.head 4 -  Description: Retorna o nome do arquivo dentro de uma string que contém o path e o nome do mesmo.
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Long String: lsCaminho
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! Observacoes
.head 6 +      Autor
.head 7 -      Celso 1/11/95
.head 5 +  If VisStrScanReverse( lsCaminho, -1, '\\' ) = -1
.head 6 -  Return lsCaminho
.head 5 -  Return SalStrMidX( lsCaminho, VisStrScanReverse( lsCaminho, -1, '\\' ) +1 , 12 )
.head 3 +  Function: NomeDiretorio
.head 4 -  Description: Retorna o diretorio do arquivo dentro de uma string que contém o path e o nome do arquivo.
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Long String: lsCaminho
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! Observacoes
.head 6 +      Autor
.head 7 -      Celso 1/11/95
.head 5 +  If VisStrScanReverse( lsCaminho, -1, '\\' ) = -1
.head 6 -  Return ''
.head 5 -  Return SalStrLeftX( lsCaminho, VisStrScanReverse( lsCaminho, -1, '\\' )  + 1)
.head 3 +  Function: ProcuraDJaDigitado
.head 4 -  Description: Procura uma data numa tabela, verificando se o mesmo já existe (deletando a linha digitada).
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive Window Handle: hWndTabela
.head 5 -  Number: nColumnID
.head 5 -  Number: nLinhaDigitada
.head 5 -  Date/Time: dCodigoDigitado
.head 5 -  String: sMensagem
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLinha
.head 5 -  String: sCol
.head 4 +  Actions
.head 5 +  ! Observações
.head 6 -      Retorna TRUE se encontrou o código e foi deletado a Linha.
.head 6 +      Autor 
.head 7 -      Celso - 02/01/96
.head 6 -      O Código em comentário é o código escrito antigamente.
.head 6 +  ! Antigamente....
.head 7 +  ! Verifica se existe linha com Código do Título igual ao recém digitado.
.head 8 -      nColumnID	- Contém o Número do ColumnID da coluna colnTitulo.
.head 8 -      nLinha 	   	- Contém o número das linhas atuais em que se está fazendo a pesquisa.
.head 8 -      sCodigoDigitado  	- Código do Tipo de Venda que foi recém digitado.
.head 8 -      sCol 	   	- Usado para quardar temporariamente os códigos já existentes.
.head 7 -  ! Set nLinha = TBL_MinRow
.head 7 -  ! Set nColumnID = SalTblQueryColumnID( tblTitulosBordero.colnTitulo )
.head 7 -  ! Call SalTblGetColumnText( tblTitulosBordero, nColumnID, sCodigoDigitado )
.head 7 +  ! While SalTblFindNextRow( tblTitulosBordero, nLinha, 0, 0)
.head 8 -      Call SalTblSetContext( tblTitulosBordero, nLinha )
.head 8 -      Call SalTblGetColumnText( tblTitulosBordero, nColumnID, sCol)
.head 8 +      If (SalStrToNumber( sCol ) = SalStrToNumber( sCodigoDigitado)) AND (nLinha != lParam)
.head 9 -  ! Seta  focus na linha com a coluna do mesmo Código de Tipo de Venda.
.head 9 -      Call SalMessageBeep( 0 )
.head 9 -      Call SalMessageBox( 'Título já digitado', 'Atenção', MB_IconExclamation | MB_Ok )
.head 9 -      Call SalTblDeleteRow( tblTitulosBordero, lParam, TBL_NoAdjust )
.head 9 -      Set nLinhasInseridas = nLinhasInseridas - 1
.head 9 -      Return FALSE
.head 5 +  ! Verifica se existe linha com Código do Título igual ao recém digitado.
.head 6 -      nColumnID	- Contém o Número do ColumnID da coluna colnTitulo.
.head 6 -      nLinha 	   	- Contém o número das linhas atuais em que se está fazendo a pesquisa.
.head 6 -      sCodigoDigitado  	- Código do Tipo de Venda que foi recém digitado.
.head 6 -      sCol 	   	- Usado para quardar temporariamente os códigos já existentes.
.head 5 -  Set nLinha = TBL_MinRow
.head 5 +  While SalTblFindNextRow( hWndTabela, nLinha, 0, 0)
.head 6 -  Call SalTblSetContext( hWndTabela, nLinha )
.head 6 -  Call SalTblGetColumnText( hWndTabela, nColumnID, sCol)
.head 6 +  If (SalStrToDate( sCol ) = dCodigoDigitado) AND (nLinha != nLinhaDigitada)
.head 7 -  ! Seta  focus na linha com a coluna do mesmo Código de Tipo de Venda.
.head 7 -  Call SalMessageBeep( MB_IconExclamation )
.head 7 -  Call SalMessageBox( sMensagem, 'Atenção', MB_IconExclamation | MB_Ok )
.head 7 -  Call SalTblDeleteRow( hWndTabela, nLinhaDigitada, TBL_NoAdjust )
.head 7 -  Return TRUE
.head 5 -  Call SalTblSetContext( hWndTabela, nLinhaDigitada )
.head 5 -  Return FALSE
.head 3 +  Function: SetaFlagLinhaD
.head 4 -  Description: Seta Flag de todas Linhas de uma tabela de acordo com o valor de uma Coluna do tipo data.
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Receive Window Handle: hWndTabela
.head 5 -  Window Handle: hWndColuna
.head 5 -  Date/Time: dColuna
.head 5 -  ! Valores para a Linha
.head 5 -  Number: nFlags
.head 5 -  Boolean: bSetar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLinha
.head 5 -  String: sCol
.head 5 -  String: sAux
.head 5 -  Boolean: bEncontrou1
.head 4 +  Actions
.head 5 -  Set nLinha = TBL_MinRow
.head 5 -  Set bEncontrou1 = FALSE
.head 5 +  While SalTblFindNextRow( hWndTabela, nLinha, 0, 0 ) 
.head 6 -  Call SalTblSetContext( hWndTabela, nLinha )
.head 6 -  Call SalTblGetColumnText( hWndTabela, SalTblQueryColumnID( hWndColuna ), sCol )
.head 6 -  Call SalDateToStr( dColuna, sAux )
.head 6 +  If sCol = sAux
.head 7 -  Call SalTblSetRowFlags( hWndTabela, nLinha, nFlags, bSetar )
.head 7 -  Set bEncontrou1 = TRUE
.head 5 -  Return bEncontrou1
.head 3 +  Function: TiraFormatoNumero
.head 4 -  Description: Tira a máscara de um número.
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: sNumero
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nDigitos
.head 5 -  Number: nNumero
.head 5 -  Number: nPosicao
.head 5 -  String: sAux
.head 4 +  Actions
.head 5 +  ! Observações
.head 6 +      Autor
.head 7 -      Celso - 1/11/95
.head 5 +  If sNumero = ''
.head 6 -  Return FALSE
.head 5 -  Set nPosicao =  SalStrLength( sNumero ) -1
.head 5 -  Set nNumero = 0
.head 5 -  Set nDigitos = 0
.head 5 +  While nPosicao >= 0
.head 6 -  Set sAux = SalStrMidX( sNumero, nPosicao, 1 )
.head 6 +  If sAux = SalNumberToStrX( SalStrToNumber( sAux ), 0)
.head 7 -  Set nNumero = nNumero + (SalStrToNumber( sAux ) * SalNumberPower( 10, nDigitos))
.head 7 -  Set nDigitos = nDigitos + 1
.head 6 -  Set nPosicao = nPosicao - 1
.head 5 -  Return nNumero
.head 3 +  Function: TransfereLStrToTable
.head 4 -  Description: Coloca a String nas colunas de acordo com o tamanho das mesmas.
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Long String: lsString
.head 5 -  Receive Window Handle: hWndTabela
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndColuna
.head 5 -  Number: nTamanhoCol
.head 5 -  Number: nLinha
.head 5 -  Number: nSoma
.head 5 -  String: sColuna
.head 4 +  Actions
.head 5 +  ! Observações
.head 6 +      Local variables
.head 7 -      nLinha		- Número da Nova Linha.
.head 7 -      nTamanhoCol	- Tamanho da Coluna atual.
.head 7 -      nSoma		- Soma de Todas as colunas lidas até o momento.
.head 7 -      sColuna		- Valor da coluna atual.
.head 6 +      Autor
.head 7 -      Celso 1/11/95
.head 5 -  Set nLinha = SalSendMsg( hWndTabela, MSG_NovaLinha, 0, 0 )
.head 5 -  Set hWndColuna =  SalGetFirstChild( hWndTabela, TYPE_TableColumn )
.head 5 +  If hWndColuna = hWndNULL
.head 6 -  Return FALSE
.head 5 -  Set nSoma = 0
.head 5 +  While hWndColuna != hWndNULL
.head 6 -  Call SalTblSetContext( hWndTabela, nLinha )
.head 6 -  ! Call SalTblQueryColumnWidth( hWndColuna, nTamanhoCol )
.head 6 -  Set nTamanhoCol = SalGetMaxDataLength( hWndColuna )
.head 6 +  If nTamanhoCol > 0
.head 7 -  Set sColuna = SalStrMidX( lsString, nSoma, nTamanhoCol )
.head 7 -  ! Set sColuna = SalStrTrimX( SalStrMidX( lsString, nSoma, nTamanhoCol ))
.head 7 -  Set nSoma = nSoma + nTamanhoCol
.head 7 -  Call SalTblSetColumnText( hWndTabela, SalTblQueryColumnID( hWndColuna ), sColuna )
.head 7 +  ! If nTamanhoCol > 6
.head 8 -      Call VisTblAutoSizeColumn( hWndTabela, hWndColuna )
.head 6 -  Set hWndColuna = SalGetNextChild( hWndColuna, TYPE_TableColumn )
.head 5 -  Return nLinha
.head 3 +  Function: fTransmiteRENAINF
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sSerie
.head 5 -  Number: nOrgaoAutuante 
.head 5 -  Number: nAuto
.head 5 -  Number: nInfracao
.head 5 -  Number: nTransacao
.head 5 -  String: sTipoRegistroTransacao
.head 5 -  Sql Handle: phSqlApp
.head 5 -  String: sNumAutoInfracao
.head 5 -  String: sPlaca
.head 5 -  String: sCond
.head 5 -  String: sMotivoCancelamento
.head 5 -  Number: nTipoOcorrencia
.head 5 -  Number: nTipoLancamento
.head 5 -  String: sOrigemOcorrencia
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLinha
.head 5 -  Long String: lsMensagem
.head 5 -  Long String: lsMensagem2
.head 5 -  Number: nSeqTransacao
.head 5 -  Number: nCodConsulta
.head 5 -  String: sMensagem
.head 5 -  Number: nRetorno
.head 5 -  Number: nCodRetorno
.head 4 +  Actions
.head 5 +  If fMPSPrepareProc( phSqlApp, 'exec dbinfracao..RNFTransmiteAuto @Serie = :sSerie,
@CodigoOrgaoAut =:nOrgaoAutuante, @Auto =:nAuto,
@Infracao = :nInfracao,
@CodConsulta = :nTransacao, 
@TipoRegistroTransacao=:sTipoRegistroTransacao,
@NumAutoInfracao = :sNumAutoInfracao,
@Placa=:sPlaca,@Condicionalidade=:sCond,
@MotivoCancelamento=:sMotivoCancelamento,
@TipoOcorrencia=:nTipoOcorrencia,@TipoLancamento=:nTipoLancamento,@OrigemOcorrencia=:sOrigemOcorrencia', 
':lsMensagem,:lsMensagem2' )
.head 6 -  ! Call SqlExecute( hSqlApp )
.head 5 -  !
.head 5 +  If NOT SqlExecute( phSqlApp )
.head 6 -  ! Call fMPSDisconnect( phSqlApp )
.head 6 -  Return FALSE
.head 5 -  Call SqlFetchNext( phSqlApp, nRetorno )
.head 5 +  If nRetorno != FETCH_Ok
.head 6 -  ! Call fMPSDisconnect( phSqlApp )
.head 6 -  Return FALSE
.head 5 -  Set lsMensagem = lsMensagem || lsMensagem2
.head 5 -  Set nCodConsulta = SalStrToNumber( SalStrMidX( lsMensagem, 6, 3) )
.head 5 -  Set nSeqTransacao = SalStrToNumber( SalStrLeftX( lsMensagem, 6  ) )
.head 5 -  Set nSeqTransacaoRENAINF = nSeqTransacao
.head 5 -  Set nCodConsultaRENAINF = nCodConsulta
.head 5 -  Call fMPSDisconnect( phSqlApp )
.head 5 -  ! Call SqlGetResultSetCount( hSqlApp, nRetorno )
.head 5 -  !
.head 5 +  If NOT FuncaoHelpCom( lsMensagem )
.head 6 -  Call fMPSDisconnect( phSqlApp )
.head 6 -  Return FALSE
.head 5 -  Set nLinha = nLinha + 1

.head 5 -  ! PAREI AQUI
.head 5 -  Call fMPSConnect( phSqlApp )
.head 5 +  If fMPSPrepareProc( phSqlApp, 'exec dbinfracao..RNFTrataRetorno @CodTransacao = :nCodConsulta,
@NumSeqTransacao =:nSeqTransacao,@CodigoOrgaoAut=:nOrgaoAutuante,
@nAuto = :nAuto,@Serie=:sSerie,@TipoOcorrencia=:nTipoOcorrencia,
@TipoLancamento=:nTipoLancamento,
@OrigemOcorrencia=:sOrigemOcorrencia', ':nCodRetorno' )
.head 6 -  ! Call SqlExecute( hSqlApp )
.head 5 +  If NOT SqlExecute( phSqlApp )
.head 6 -  ! Call fMPSDisconnect( hSqlApp )
.head 6 -  Return FALSE
.head 5 -  Call SqlFetchNext( phSqlApp, nRetorno )
.head 5 -  ! Set tblReenvioRENAINF.colsMensagem= sMensagem
.head 5 -  ! Call fMPSDisconnect( hSqlApp )
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 113355639
0000: A9080000E9030000 0000000000000000 0200000C00FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F13013800 00000F6300446573
0040: 6B746F704C006973 74426F784E01C200 0B00000043190000 0001FA0000FF6F19
0060: 00D6190001FE00FF 833200000019B500 0100FFFF604B0000 001900ED0100FF3F
0080: 6400580000190001 FB00FF0F7D000000 D6190001FE00FF83 9600000019B50001
00A0: 00FFFF60AF000000 1900ED0100FF3FC8 00580000190001FB 00FF0FE1000000D6
00C0: 190001FE00FF83FA 00000019B5000100 FFFF100180640000 010001000B634469
00E0: 724C3E697C00C000 00040000005B1900 01FB00FF6F1900D6 190001FE00FF9B32
0100: 0019B5000100FFFF 664B001900ED0100 FF3F0180044B0000 020000001E0F5472
0120: 65F8654C69005E00 0000030000006F19 00E9010000FFBF19 5900190001FB00FF
0140: 6F3200D6190001FE 00FF430180AF0000 0603000C634669F8 6C654C01D6000000
0160: 070000DE0019D200 010000FF7F19B300 1900F60100FFDF32 AC00190001FD00FF
0180: 374B00196B000100 FFFFCD640019DA00 0100FF7F7DB30019 00F60100FFDF96AC
01A0: 00190001FD00FF87 01807D000C000400 0D6352C06164696F 4C69079A00000005
01C0: 78000000194B0001 0000FFFFCD190019 DA000100FF7F32B3 001900F60100FFDF
01E0: 4BAC00190001FD00 FF376400196B0001 00FFFF010180C200 00000503000A6351
0200: 434B003147657261 6C0202C200110000 005B040003FB00FF 6F04009619000100
0220: FE00FF831D000000 19B5000100FFFF60 360000001900ED01 00FF3F4F00580000
0240: 190001FB00FF0F68 000000D6040002FE 00FF836C00000004 B5000200FFFF6070
0260: 0000000400ED0200 FF3F740058000004 0002FB00FF0F7800 0000D6040002FE00
0280: FF937C000004B500 0200FFFF62800000 0400ED0200FF3F84 00580000040002FB
02A0: 00FF0F88000000D6 040002FE00FF838C 00000019B5000100 FFFF60A500000019
02C0: 00ED0100FF3FBE00 580000040002FB00 FF0F01803E000000 00060000000E630E
02E0: 51436F6E74086169 6E72AA0000EC0005 000D0400010200FD 003F8001F8000000
0300: 3704001943000101 0000FF4F800100FE 00C10800000019D2 00010000FF7F21B0
0320: 0000000400F60200 FF1F250000AC0019 0001FD00FF870180 08000C0007000863
0340: 51074D44494000D8 000002005B040002 FB00FF6F0400D604 0002FE00FF4B011D
0360: 0000A40800000C51 03466F726D4654C8 5040000002DE0019 D200010000FF7F19
0380: B3000400F60200FF 1F01801D03000900 000010FC63510154 6162734674706440
03A0: 000002006F1900E9 010000FFBF195900 040002FB00FF0F01 80040081000A0000
03C0: 000D0E5143686563 086B426F22000000 F4010000D6040002 FE00FF6301800400
03E0: 040B000006634461 20646F7322000001 7A0000046B000200 FFFF01
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cQCK1MDI
.head 3 -  Form Window:
.head 3 -  Dialog Box: cQCK1DialogBox
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field: cQuickMLField
.head 3 -  Pushbutton: cQCK2PbExcluir
.head 3 -  Radio Button: cQCK1RadioButton
.head 3 -  Option Button:
.head 3 -  ActiveX:
.head 3 -  Check Box: cQCK1CheckBox
.head 3 -  Child Table: cQCK2ChildTable
.head 3 -  Quest Child Window:
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text: cQCK1BackgroundText
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cQuickGraph
.head 2 +  Application Actions
.head 3 +  On SAM_SqlError
.head 4 -  Return TRUE
.head 3 -  On SAM_AppStartup
.head 1 +  MDI Window: mdiInfracao  
.data INHERITPROPS
0000: 0100
.enddata
.head 2 -  Class: cQCK1MDI
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Controle de Infrações - Envio das Transações do RENAINF
.head 2 -  Display Settings
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left: 1.3"
.head 4 -  Top: 0.792"
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.342"
.head 4 -  Height Editable? Class Default
.head 2 -  Icon File: LOTEAUTO.ICO
.data RESOURCE 2 0 1 458831676
0000: 00030000F2010000 0000000000000000 0200A20001000120 3010000000E80200
0020: 0000160000002800 0000002000000040 0008000001040000 00A380020000FFFF
0040: 8F80000003008080 0080006800008080 800D008000C0C080 C0000000FF000003
0060: 00FFFF00FF006800 00FFFFFF4D00FF00 00FFFF8780000000 FF83170FFFFFFFD7
0080: 0000BB17FF570000 0980191017077777 7750F707FF000091 80910017000000FF
00A0: 8DFF0000091090FF 00FFFF0000001088 880000000999340F FFFF8880940FFF00
00C0: 000957FF00009088 888800000907FFF8 0F0B0042FFF70000 0099060FFFF800B0
00E0: 80D0888888000005 FFFFF80B08F0C0FF F7770000000BFFF0 B08F08D088888800
0100: 00C30FFF0B08D377 0000031000B0FF08 88D588000003170B 0000FFF7D3770000
0120: 8310B0888888D700 00830B0FFFFFF7D5 770000A3B0088888 D70000410B070FFF
0140: 0000FF01B0170888 0999991E99900000 0200170FF0595959 1F00000003170880
0160: 9595951F00000003 170F095959590F50 0000000317080595 95954F9000008317
0180: 00595959AF00008B 17959595AF0000A3 18095959B7500003 0105001001008E10
01A0: 0000000301107007 0070C607000000FF FFFF3FFFFF06FF80 003FFF00211FE100
01C0: 00C0002380000000 00CC001F001F8C00 1F001F803BC0FC00 F200FF00FF3FFE00
01E0: 1BFC00F800000000 F9000001FF001F03 FF009F07FF5F0F80 1D0F1FFFF2A0493F
0200: FFFFFF00
.enddata
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: &RENAINF - Infrações Interestaduais
.head 4 -  Resource Id: 51613
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: Envio das Transações 
.head 5 -  Resource Id: 51614
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: Gerar Arquivo das Notificações de Multa
.head 5 +  Menu Settings
.head 6 -  Enabled when: MenuHabilitado('frmEnviaNotificacaoAutuacao')
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalCreateWindow( frmEnviaNotificacaoAutuacao, hWndMDI )
.head 5 -  Menu Item Name:
.head 3 +  Windows Menu: &Janela
.head 4 -  Resource Id: 17916
.head 4 -  Enabled when:
.head 4 -  Status Text: Selecionar e reagrupar as janelas do Aplicativo.
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Cascata
.head 5 -  Resource Id: 17917
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: Rearruma as janelas agrupando-as em forma de cascata.
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalMDICascade( hWndMDI )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Lado a Lado &Verticalmente
.head 5 -  Resource Id: 17918
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: Rearruma as janelas abertas agrupando-as lado a lado verticalmente.
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalMDITile( hWndMDI, TRUE )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Lado a Lado &Horizontalmente
.head 5 -  Resource Id: 17919
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: Rearruma as janelas abertas agrupando-as lado a lado horizontalmente.
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalMDITile( hWndMDI, FALSE )
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Reagrupa Ícones
.head 5 -  Resource Id: 17920
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: Reagrupa os ícones minimizados na aplicação.
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalMDIArrangeIcons( hWndMDI )
.head 5 -  Menu Item Name:
.head 3 +  Popup Menu: &?
.head 4 -  Resource Id: 17921
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Conteúdo
.head 5 -  Resource Id: 17922
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalWinHelp( hWndForm, 'infra.HLP', HELP_Index, 0, '' )
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Como Usar o &Help
.head 5 -  Resource Id: 17923
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalWinHelp( hWndForm, '', HELP_HelpOnHelp, 0, '' )
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Usuario
.head 5 -  Resource Id: 17924
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalModalDialog( dlgUsuario, hWndNULL, FALSE )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Sobre
.head 5 -  Resource Id: 17925
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg( hWndMDI, MSG_MostraInfo, 0, 0)
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.49"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Form Window: frmEnviaNotificacaoAutuacao
.head 4 -  Class: cQCK1Form
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Transmissão das Transações
.head 4 -  Icon File:
.head 4 -  Accessories Enabled? No
.head 4 -  Visible? Yes
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? No
.head 5 -  Automatically Created at Runtime? Class Default
.head 5 -  Initial State: Normal
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Yes
.head 5 -  Window Location and Size
.head 6 -  Left: 0.913"
.head 6 -  Top: 0.052"
.head 6 -  Width:  11.338"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 5.438"
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Description: Envia as transações 412 para a BINIT
.head 4 -  Named Menus
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Top
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 -  Contents
.head 4 +  Contents
.head 5 -  Frame
.head 6 -  Resource Id: 51360
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Window Location and Size
.head 7 -  Left: 0.088"
.head 7 -  Top: 0.073"
.head 7 -  Width:  10.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 3.917"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Corners: Square
.head 6 -  Border Style: Solid
.head 6 -  Border Thickness: 1
.head 6 -  Border Color: Default
.head 6 -  Background Color: 3D Face Color
.head 5 +  ! cQCK2ChildTable: tblAutos
.winattr class Child Table:
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK2ChildTable
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left: 0.238"
.head 8 -  Top: 0.281"
.head 8 -  Width:  8.65"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 3.542"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: Default
.head 7 -  View: Table
.head 7 -  Allow Row Sizing? No
.head 7 -  Lines Per Row: Default
.head 6 -  Memory Settings
.head 7 -  Maximum Rows in Memory: 10000
.head 7 -  Discardable? Yes
.end
.head 6 +  Contents 
.head 7 +  Column: colsDescMovimento
.winattr class
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Movimento
.head 8 -  Visible? Yes
.head 8 -  Editable? Yes
.head 8 -  Maximum Data Length: Default
.head 8 -  Data Type: String
.head 8 -  Justify: Left
.head 8 -  Width:  1.463"
.head 8 -  Width Editable? Yes
.head 8 -  Format: Unformatted
.head 8 -  Country: Default
.head 8 -  Input Mask: Unformatted
.head 8 -  Cell Options
.head 9 -  Cell Type? Standard
.head 9 -  Multiline Cell? No
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Yes
.head 10 -  Vertical Scroll? Yes
.head 10 -  Auto Drop Down? No
.head 10 -  Allow Text Editing? Yes
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Yes
.end
.head 8 -  List Values 
.head 8 +  Message Actions 
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colnTransacao
.winattr class
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Transacao
.head 8 -  Visible? Yes
.head 8 -  Editable? Yes
.head 8 -  Maximum Data Length: Default
.head 8 -  Data Type: Number
.head 8 -  Justify: Center
.head 8 -  Width:  0.538"
.head 8 -  Width Editable? Yes
.head 8 -  Format: Unformatted
.head 8 -  Country: Default
.head 8 -  Input Mask: Unformatted
.head 8 -  Cell Options
.head 9 -  Cell Type? Standard
.head 9 -  Multiline Cell? No
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Yes
.head 10 -  Vertical Scroll? Yes
.head 10 -  Auto Drop Down? No
.head 10 -  Allow Text Editing? Yes
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Yes
.end
.head 8 -  List Values 
.head 8 +  Message Actions 
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colnOrgaoAutuante
.winattr class
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Orgão Autuante
.head 8 -  Visible? Yes
.head 8 -  Editable? Yes
.head 8 -  Maximum Data Length: Default
.head 8 -  Data Type: Number
.head 8 -  Justify: Left
.head 8 -  Width:  1.4"
.head 8 -  Width Editable? Yes
.head 8 -  Format: Unformatted
.head 8 -  Country: Default
.head 8 -  Input Mask: Unformatted
.head 8 -  Cell Options
.head 9 -  Cell Type? Standard
.head 9 -  Multiline Cell? No
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Yes
.head 10 -  Vertical Scroll? Yes
.head 10 -  Auto Drop Down? No
.head 10 -  Allow Text Editing? Yes
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Yes
.end
.head 8 -  List Values 
.head 8 +  Message Actions 
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colsNumAutoInfracao
.winattr class
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Auto RENAINF
.head 8 -  Visible? Yes
.head 8 -  Editable? Yes
.head 8 -  Maximum Data Length: Default
.head 8 -  Data Type: String
.head 8 -  Justify: Left
.head 8 -  Width:  1.4"
.head 8 -  Width Editable? Yes
.head 8 -  Format: Unformatted
.head 8 -  Country: Default
.head 8 -  Input Mask: Unformatted
.head 8 -  Cell Options
.head 9 -  Cell Type? Standard
.head 9 -  Multiline Cell? No
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Yes
.head 10 -  Vertical Scroll? Yes
.head 10 -  Auto Drop Down? No
.head 10 -  Allow Text Editing? Yes
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Yes
.end
.head 8 -  List Values 
.head 8 +  Message Actions 
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colnInfracao
.winattr class
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Infração
.head 8 -  Visible? Yes
.head 8 -  Editable? Yes
.head 8 -  Maximum Data Length: Default
.head 8 -  Data Type: Number
.head 8 -  Justify: Center
.head 8 -  Width:  0.813"
.head 8 -  Width Editable? Yes
.head 8 -  Format: Unformatted
.head 8 -  Country: Default
.head 8 -  Input Mask: Unformatted
.head 8 -  Cell Options
.head 9 -  Cell Type? Standard
.head 9 -  Multiline Cell? No
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Yes
.head 10 -  Vertical Scroll? Yes
.head 10 -  Auto Drop Down? No
.head 10 -  Allow Text Editing? Yes
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Yes
.end
.head 8 -  List Values 
.head 8 +  Message Actions 
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colnCodigoRENAINF
.winattr class
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Codigo RENAINF
.head 8 -  Visible? Yes
.head 8 -  Editable? Yes
.head 8 -  Maximum Data Length: Default
.head 8 -  Data Type: Number
.head 8 -  Justify: Center
.head 8 -  Width:  1.4"
.head 8 -  Width Editable? Yes
.head 8 -  Format: Unformatted
.head 8 -  Country: Default
.head 8 -  Input Mask: Unformatted
.head 8 -  Cell Options
.head 9 -  Cell Type? Standard
.head 9 -  Multiline Cell? No
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Yes
.head 10 -  Vertical Scroll? Yes
.head 10 -  Auto Drop Down? No
.head 10 -  Allow Text Editing? Yes
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Yes
.end
.head 8 -  List Values 
.head 8 +  Message Actions 
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: coldDataLimiteDefesa
.winattr class
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Dt Limite Defesa
.head 8 -  Visible? No
.head 8 -  Editable? Yes
.head 8 -  Maximum Data Length: Default
.head 8 -  Data Type: Date/Time
.head 8 -  Justify: Left
.head 8 -  Width:  1.4"
.head 8 -  Width Editable? Yes
.head 8 -  Format: dd-MM-yyyy
.head 8 -  Country: Default
.head 8 -  Input Mask: 99-99-9999
.head 8 -  Cell Options
.head 9 -  Cell Type? Standard
.head 9 -  Multiline Cell? No
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Yes
.head 10 -  Vertical Scroll? Yes
.head 10 -  Auto Drop Down? No
.head 10 -  Allow Text Editing? Yes
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Yes
.end
.head 8 -  List Values 
.head 8 +  Message Actions 
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = FALSE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colsSerie
.winattr class
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Serie
.head 8 -  Visible? Yes
.head 8 -  Editable? Yes
.head 8 -  Maximum Data Length: Default
.head 8 -  Data Type: String
.head 8 -  Justify: Left
.head 8 -  Width:  0.488"
.head 8 -  Width Editable? Yes
.head 8 -  Format: Unformatted
.head 8 -  Country: Default
.head 8 -  Input Mask: Unformatted
.head 8 -  Cell Options
.head 9 -  Cell Type? Standard
.head 9 -  Multiline Cell? No
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Yes
.head 10 -  Vertical Scroll? Yes
.head 10 -  Auto Drop Down? No
.head 10 -  Allow Text Editing? Yes
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Yes
.end
.head 8 -  List Values 
.head 8 +  Message Actions 
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colnAuto
.winattr class
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Auto DETRAN
.head 8 -  Visible? Yes
.head 8 -  Editable? Yes
.head 8 -  Maximum Data Length: Default
.head 8 -  Data Type: Number
.head 8 -  Justify: Center
.head 8 -  Width:  1.263"
.head 8 -  Width Editable? Yes
.head 8 -  Format: Unformatted
.head 8 -  Country: Default
.head 8 -  Input Mask: Unformatted
.head 8 -  Cell Options
.head 9 -  Cell Type? Standard
.head 9 -  Multiline Cell? No
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Yes
.head 10 -  Vertical Scroll? Yes
.head 10 -  Auto Drop Down? No
.head 10 -  Allow Text Editing? Yes
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Yes
.end
.head 8 -  List Values 
.head 8 +  Message Actions 
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colsTipoMovimento
.winattr class
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Tipo Movimento
.head 8 -  Visible? Yes
.head 8 -  Editable? Yes
.head 8 -  Maximum Data Length: Default
.head 8 -  Data Type: String
.head 8 -  Justify: Left
.head 8 -  Width:  0.488"
.head 8 -  Width Editable? Yes
.head 8 -  Format: Unformatted
.head 8 -  Country: Default
.head 8 -  Input Mask: Unformatted
.head 8 -  Cell Options
.head 9 -  Cell Type? Standard
.head 9 -  Multiline Cell? No
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Yes
.head 10 -  Vertical Scroll? Yes
.head 10 -  Auto Drop Down? No
.head 10 -  Allow Text Editing? Yes
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Yes
.end
.head 8 -  List Values 
.head 8 +  Message Actions 
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = FALSE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colsMensagem
.winattr class
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Mensagem
.head 8 -  Visible? Yes
.head 8 -  Editable? Yes
.head 8 -  Maximum Data Length: Default
.head 8 -  Data Type: String
.head 8 -  Justify: Left
.head 8 -  Width:  3.225"
.head 8 -  Width Editable? Yes
.head 8 -  Format: Unformatted
.head 8 -  Country: Default
.head 8 -  Input Mask: Unformatted
.head 8 -  Cell Options
.head 9 -  Cell Type? Standard
.head 9 -  Multiline Cell? No
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Yes
.head 10 -  Vertical Scroll? Yes
.head 10 -  Auto Drop Down? No
.head 10 -  Allow Text Editing? Yes
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Yes
.end
.head 8 -  List Values 
.head 8 +  Message Actions 
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Functions 
.head 6 -  Window Variables 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _sTextoStatusBar = 'Selecione os órgãos autuantes dos autos a serem selecionados'
.head 8 -  Set _bPesquisaCreate = FALSE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Set _bSempreHabilitado = FALSE
.head 8 -  Set _sCriacaoConexao = 'FALSE'
.head 8 -  Set _sComandoPesquisa = 'exec dbinfracao..RNFEnvioTransacaoS'
.head 8 -  ! coluna para o retorno
.head 8 -  Set _sIntoPesquisa = ':frmEnviaNotificacaoAutuacao.tblAutos.colnOrgaoAutuante,
:frmEnviaNotificacaoAutuacao.tblAutos.colsNumAutoInfracao,
:frmEnviaNotificacaoAutuacao.tblAutos.colnInfracao,
:frmEnviaNotificacaoAutuacao.tblAutos.colnCodigoRENAINF,
:frmEnviaNotificacaoAutuacao.tblAutos.coldDataLimiteDefesa,
:frmEnviaNotificacaoAutuacao.tblAutos.colsSerie,
:frmEnviaNotificacaoAutuacao.tblAutos.colnAuto,
:frmEnviaNotificacaoAutuacao.tblAutos.colsTipoMovimento,:frmEnviaNotificacaoAutuacao.tblAutos.colnTransacao,
:frmEnviaNotificacaoAutuacao.tblAutos.colsMensagem,
:frmEnviaNotificacaoAutuacao.tblAutos.colsDescMovimento'
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  ! On SAM_FetchRowDone
.head 8 -  Call SalTblSetContext( hWndForm, lParam )
.head 8 +  If colsTipoMovimento = 'D'
.head 9 -  Set colnTransacao = 412
.head 8 +  Else If colsTipoMovimento = 'N'
.head 9 -  Set colnTransacao =413
.head 5 +  Child Table: tblAutos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK2ChildTable
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left: 0.238"
.head 8 -  Top: 0.281"
.head 8 -  Width:  10.6"
.head 8 -  Width Editable? Class Default
.head 8 -  Height: 3.542"
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  View: Class Default
.head 7 -  Allow Row Sizing? Class Default
.head 7 -  Lines Per Row: Class Default
.head 6 -  Memory Settings
.head 7 -  Maximum Rows in Memory: 20000
.head 7 -  Discardable? Class Default
.head 6 +  Contents
.head 7 +  Column: colsNumeroBancario
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Movimento
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Class Default
.head 8 -  Justify: Class Default
.head 8 -  Width:  1.463"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colnNumeroAutorizacao
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Movimento
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Number
.head 8 -  Justify: Class Default
.head 8 -  Width:  1.463"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colsMensagem
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Mensagem
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Class Default
.head 8 -  Justify: Class Default
.head 8 -  Width:  1.9"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colsDescMovimento
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Movimento
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Class Default
.head 8 -  Justify: Class Default
.head 8 -  Width:  1.463"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colnTransacao
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Transacao
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Number
.head 8 -  Justify: Center
.head 8 -  Width:  0.538"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colnOrgaoAutuante
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Orgão Autuante
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Number
.head 8 -  Justify: Class Default
.head 8 -  Width:  1.4"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colsNumAutoInfracao
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Auto RENAINF
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Class Default
.head 8 -  Justify: Class Default
.head 8 -  Width:  1.4"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colnInfracao
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Infração
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Number
.head 8 -  Justify: Center
.head 8 -  Width:  0.813"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colnCodigoRENAINF
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Codigo RENAINF
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Number
.head 8 -  Justify: Center
.head 8 -  Width:  1.4"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: coldDataLimiteDefesa
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Dt Limite Defesa
.head 8 -  Visible? No
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Date/Time
.head 8 -  Justify: Class Default
.head 8 -  Width:  1.4"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: dd-MM-yyyy
.head 8 -  Country: Class Default
.head 8 -  Input Mask: 99-99-9999
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = FALSE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colsSerie
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Serie
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Class Default
.head 8 -  Justify: Class Default
.head 8 -  Width:  0.488"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colnAuto
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Auto DETRAN
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Number
.head 8 -  Justify: Center
.head 8 -  Width:  1.263"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: colsTipoMovimento
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Tipo Movimento
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Class Default
.head 8 -  Justify: Class Default
.head 8 -  Width:  0.488"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = FALSE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  Column: coldDataMovimento
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 0
.head 8 -  Class: cQCK2Column
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title: Data Movto
.head 8 -  Visible? Yes
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Date/Time
.head 8 -  Justify: Class Default
.head 8 -  Width:  1.4"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: dd-MM-yyyy
.head 8 -  Country: Class Default
.head 8 -  Input Mask: 99-99-9999
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Create
.head 10 -  Set _bVisivel = TRUE
.head 10 -  Set _bPermiteNulos = TRUE
.head 10 -  Set _bNuncaHabilitado = TRUE
.head 10 -  Set _sTipoMsgNulo = 'PADRAO'
.head 10 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Functions
.head 6 -  Window Variables
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _sTextoStatusBar = 'Selecione os órgãos autuantes dos autos a serem selecionados'
.head 8 -  Set _bPesquisaCreate = FALSE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Set _bSempreHabilitado = FALSE
.head 8 -  Set _sCriacaoConexao = 'FALSE'
.head 8 -  Set _sComandoPesquisa = 'exec dbinfracao..RNFEnvioTransacaoS'
.head 8 -  ! coluna para o retorno
.head 8 -  Set _sIntoPesquisa = ':frmEnviaNotificacaoAutuacao.tblAutos.colnOrgaoAutuante,
:frmEnviaNotificacaoAutuacao.tblAutos.colsNumAutoInfracao,
:frmEnviaNotificacaoAutuacao.tblAutos.colnInfracao,
:frmEnviaNotificacaoAutuacao.tblAutos.colnCodigoRENAINF,
:frmEnviaNotificacaoAutuacao.tblAutos.coldDataLimiteDefesa,
:frmEnviaNotificacaoAutuacao.tblAutos.colsSerie,
:frmEnviaNotificacaoAutuacao.tblAutos.colnAuto,
:frmEnviaNotificacaoAutuacao.tblAutos.colsTipoMovimento,:frmEnviaNotificacaoAutuacao.tblAutos.colnTransacao,
:frmEnviaNotificacaoAutuacao.tblAutos.colsMensagem,
:frmEnviaNotificacaoAutuacao.tblAutos.colsDescMovimento,
:frmEnviaNotificacaoAutuacao.tblAutos.coldDataMovimento,
:frmEnviaNotificacaoAutuacao.tblAutos.colsNumeroBancario,
:frmEnviaNotificacaoAutuacao.tblAutos.colnNumeroAutorizacao'
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 +  On SAM_FetchRowDone
.head 8 -  Set dfnTransmitir = dfnTransmitir + 1
.head 5 +  Pushbutton: pbArquivar
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1PushButton
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: &Transmitir
.head 6 -  Window Location and Size
.head 7 -  Left: 9.088"
.head 7 -  Top: 3.99"
.head 7 -  Width:  0.95"
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Yes
.head 6 -  Keyboard Accelerator: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Image Style: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 8 -  Set _sTextoStatusBar = 'Cria o arquivo'
.head 8 -  Set _sTipoComando = 'Arquiva'
.head 8 -  Set _bValidaCamposNulos = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 -  ! Botões 
.head 5 +  Data Field: dfsNaoEnviado
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1DataField
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left: Default
.head 8 -  Top: Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? No
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = FALSE
.head 8 -  Set _bSempreHabilitado = FALSE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Set _sValorDefault = 'S'
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Pushbutton: pbSair
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1PushButton
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: &Sair
.head 6 -  Window Location and Size
.head 7 -  Left: 10.088"
.head 7 -  Top: 3.99"
.head 7 -  Width:  0.95"
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Keyboard Accelerator: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Image Style: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _sTextoStatusBar = 'Sai desta tela'
.head 8 -  Set _sTipoComando = 'Sai'
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 7 -  On MSG_Desabilita1
.head 5 +  Picture: picSemaforo
.head 6 -  Class Child Ref Key: 1
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1Form
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Window Location and Size
.head 7 -  Left: 0.088"
.head 7 -  Top: 3.99"
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  File Name:
.head 6 -  Storage: Class Default
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Fit: Class Default
.head 6 -  Scaling
.head 7 -  Width:  Class Default
.head 7 -  Height:  Class Default
.head 6 -  Corners: Class Default
.head 6 -  Border Style: Class Default
.head 6 -  Border Thickness: Class Default
.head 6 -  Tile To Parent? Class Default
.head 6 -  Border Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Message Actions
.head 5 -  Background Text: TOTAL:
.head 6 -  Resource Id: 43442
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1BackgroundText
.head 6 -  Window Location and Size
.head 7 -  Left: 0.638"
.head 7 -  Top: 4.073"
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 -  Background Text: TRANSMITIDOS:
.head 6 -  Resource Id: 43441
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK1BackgroundText
.head 6 -  Window Location and Size
.head 7 -  Left: 2.938"
.head 7 -  Top: 4.073"
.head 7 -  Width:  1.45"
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 +  Data Field: dfnTransmitir
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left: 1.538"
.head 8 -  Top: 4.031"
.head 8 -  Width:  0.9"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: Default
.head 7 -  Input Mask: Unformatted
.head 6 -  Message Actions
.head 5 +  Data Field: dfnTransmitido
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left: 4.438"
.head 8 -  Top: 4.031"
.head 8 -  Width:  0.8"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: Default
.head 7 -  Input Mask: Unformatted
.head 6 -  Message Actions
.head 5 +  Data Field: dfsMensagem
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Editable? Yes
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left: 5.638"
.head 8 -  Top: 4.031"
.head 8 -  Width:  3.3"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.25"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Border? Yes
.head 7 -  Justify: Left
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Text Color: Default
.head 7 -  Background Color: Default
.head 7 -  Input Mask: Unformatted
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: GeraArquivo
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  ! começa a verificação do Arquivo...
.head 7 -  Set nRow = 0
.head 7 -  Call SalTblSetContext( tblAutos, nRow )
.head 7 +  Loop
.head 8 +  If SalTblFetchRow( tblAutos, nRow ) = TBL_NoMoreRows
.head 9 -  Break
.head 8 -  Call SalTblSetRowFlags( tblAutos, ROW_Edited, nRow, TRUE )
.head 8 +  If tblAutos.colsTipoMovimento = 'E' 
.head 9 -  Call fComunicaBIN(tblAutos.colsSerie,tblAutos.colnOrgaoAutuante,
tblAutos.colnAuto,
tblAutos.colnInfracao,tblAutos.colnTransacao,'EV01',hSqlApp,'','','','',7,2,'3', tblAutos.colsNumeroBancario, tblAutos.colnNumeroAutorizacao)
.head 8 +  Else If tblAutos.colsTipoMovimento = 'M'
.head 9 -  Call fComunicaBIN(tblAutos.colsSerie,tblAutos.colnOrgaoAutuante,
tblAutos.colnAuto,
tblAutos.colnInfracao,tblAutos.colnTransacao,'EV01',hSqlApp,'','','','',8,1,'3', tblAutos.colsNumeroBancario, tblAutos.colnNumeroAutorizacao)
.head 8 +  Else If tblAutos.colsTipoMovimento = 'S'
.head 9 -  Call fComunicaBIN(tblAutos.colsSerie,tblAutos.colnOrgaoAutuante,
tblAutos.colnAuto,
tblAutos.colnInfracao,tblAutos.colnTransacao,'EV01',hSqlApp,'','','','',6,1,'3', tblAutos.colsNumeroBancario, tblAutos.colnNumeroAutorizacao)
.head 8 +  Else If tblAutos.colsTipoMovimento = 'T'
.head 9 -  Call fComunicaBIN(tblAutos.colsSerie,tblAutos.colnOrgaoAutuante,
tblAutos.colnAuto,
tblAutos.colnInfracao,tblAutos.colnTransacao,'EV01',hSqlApp,'','','','',8,9,'3', tblAutos.colsNumeroBancario, tblAutos.colnNumeroAutorizacao)
.head 8 +  Else If tblAutos.colsTipoMovimento = 'Y'
.head 9 -  Call fComunicaBIN(tblAutos.colsSerie,tblAutos.colnOrgaoAutuante,
tblAutos.colnAuto,
tblAutos.colnInfracao,tblAutos.colnTransacao,'EV01',hSqlApp,'','','','',8,9,'4', tblAutos.colsNumeroBancario, tblAutos.colnNumeroAutorizacao)
.head 8 +  Else If tblAutos.colsTipoMovimento = '4'
.head 9 -  Call fComunicaBIN(tblAutos.colsSerie,tblAutos.colnOrgaoAutuante,
tblAutos.colnAuto,
tblAutos.colnInfracao,tblAutos.colnTransacao,'EV01',hSqlApp,'','','','',7,1,'3', tblAutos.colsNumeroBancario, tblAutos.colnNumeroAutorizacao)
.head 8 +  Else If tblAutos.colsTipoMovimento = '5'
.head 9 -  Call fComunicaBIN(tblAutos.colsSerie,tblAutos.colnOrgaoAutuante,
tblAutos.colnAuto,
tblAutos.colnInfracao,tblAutos.colnTransacao,'EV01',hSqlApp,'','','','',7,2,'3', tblAutos.colsNumeroBancario, tblAutos.colnNumeroAutorizacao)
.head 8 +  Else
.head 9 -  Call fComunicaBIN(tblAutos.colsSerie,tblAutos.colnOrgaoAutuante,
tblAutos.colnAuto,
tblAutos.colnInfracao,tblAutos.colnTransacao,'EV01',hSqlApp,'','','','',7,1,'3', tblAutos.colsNumeroBancario, tblAutos.colnNumeroAutorizacao)
.head 8 -  Set nRow = nRow + 1
.head 7 -  Call GeraArquivoRENAINF()
.head 7 -  Call SalSendMsg( tblAutos, MSG_PesquisaTabela, 0 ,0)
.head 7 -  ! Call SalSendMsg( pbArquivar, SAM_Click, 0 ,0)
.head 7 +  If NOT GeraArquivo(  )
.head 8 -  Return TRUE
.head 7 -  ! Call SalModalDialog( dlgEnvioTransacao, hWndNULL )
.head 7 -  Return TRUE
.head 5 +  Function: fComunicaBIN
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sSerie
.head 7 -  Number: nOrgaoAutuante 
.head 7 -  Number: nAuto
.head 7 -  Number: nInfracao
.head 7 -  Number: nTransacao
.head 7 -  String: sTipoRegistroTransacao
.head 7 -  Sql Handle: phSqlApp
.head 7 -  String: sNumAutoInfracao
.head 7 -  String: sPlaca
.head 7 -  String: sCond
.head 7 -  String: sMotivoCancelamento
.head 7 -  Number: nTipoOcorrencia
.head 7 -  Number: nTipoLancamento
.head 7 -  String: sOrigemOcorrencia
.head 7 -  String: sNumeroBancario
.head 7 -  Number: nNumeroAutorizacao
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Long String: lsMensagem
.head 7 -  Long String: lsMensagem2
.head 7 -  Number: nSeqTransacao
.head 7 -  Number: nCodConsulta
.head 7 -  String: sMensagem
.head 7 -  Number: nRetorno
.head 7 -  Number: nCodRetorno
.head 6 +  Actions
.head 7 +  If fMPSPrepareProc( phSqlApp, 'exec dbinfracao..RNFTransmiteAuto @Serie = :sSerie,
@CodigoOrgaoAut =:nOrgaoAutuante, @Auto =:nAuto,
@Infracao = :nInfracao,
@CodConsulta = :nTransacao, 
@TipoRegistroTransacao=:sTipoRegistroTransacao,
@NumAutoInfracao = :sNumAutoInfracao,
@Placa=:sPlaca,@Condicionalidade=:sCond,
@MotivoCancelamento=:sMotivoCancelamento,
@TipoOcorrencia=:nTipoOcorrencia,@TipoLancamento=:nTipoLancamento,@OrigemOcorrencia=:sOrigemOcorrencia,
@NumeroBancario = :sNumeroBancario,
@NumeroAutorizacao=:nNumeroAutorizacao', 
':lsMensagem,:lsMensagem2' )
.head 8 -  ! Call SqlExecute( hSqlApp )
.head 7 -  !
.head 7 +  If NOT SqlExecute( phSqlApp )
.head 8 -  ! Call fMPSDisconnect( phSqlApp )
.head 8 -  Return FALSE
.head 7 -  Call SqlFetchNext( phSqlApp, nRetorno )
.head 7 +  If nRetorno != FETCH_Ok
.head 8 -  ! Call fMPSDisconnect( phSqlApp )
.head 8 -  Return FALSE
.head 7 -  Set lsMensagem = lsMensagem || lsMensagem2
.head 7 -  Set nCodConsulta = SalStrToNumber( SalStrMidX( lsMensagem, 6, 3) )
.head 7 -  Set nSeqTransacao = SalStrToNumber( SalStrLeftX( lsMensagem, 6  ) )
.head 7 -  Set nSeqTransacaoRENAINF = nSeqTransacao
.head 7 -  Set nCodConsultaRENAINF = nCodConsulta
.head 7 -  Call fMPSDisconnect( phSqlApp )
.head 7 -  ! Call SqlGetResultSetCount( hSqlApp, nRetorno )
.head 7 -  !
.head 7 -  Set dfsMensagem ='COMUNICANDO COM A BIN.............'
.head 7 +  ! If NOT FuncaoHelpCom( lsMensagem ) ----antes 08/06/2018 ---ajs
.head 8 -  Call fMPSDisconnect( phSqlApp )
.head 8 -  ! Return FALSE
.head 7 +  If NOT fFuncaoComunicacao( lsMensagem )
.head 8 -  Call fMPSDisconnect( phSqlApp )
.head 8 -  ! Return FALSE
.head 7 -  Set nLinha = nLinha + 1

.head 7 -  ! PAREI AQUI
.head 7 -  Set dfsMensagem = 'PROCESSANDO.............'
.head 7 -  Call fMPSConnect( phSqlApp )
.head 7 +  If fMPSPrepareProc( phSqlApp, 'exec dbinfracao..RNFTrataRetorno @CodTransacao = :nCodConsulta,
@NumSeqTransacao =:nSeqTransacao,@CodigoOrgaoAut=:nOrgaoAutuante,
@nAuto = :nAuto,@Serie=:sSerie,@TipoOcorrencia=:nTipoOcorrencia,
@TipoLancamento=:nTipoLancamento,
@OrigemOcorrencia=:sOrigemOcorrencia,
@NumeroBancario = :sNumeroBancario,
@NumeroAutorizacao=:nNumeroAutorizacao', ':nCodRetorno' )
.head 8 -  ! Call SqlExecute( hSqlApp )
.head 7 -  Set dfnTransmitido = dfnTransmitido + 1
.head 7 +  If NOT SqlExecute( phSqlApp )
.head 8 -  ! Call fMPSDisconnect( hSqlApp )
.head 8 -  Return FALSE
.head 7 -  Call SqlFetchNext( phSqlApp, nRetorno )
.head 7 -  ! Set tblReenvioRENAINF.colsMensagem= sMensagem
.head 7 -  ! Call fMPSDisconnect( hSqlApp )
.head 5 +  Function: fFuncaoComunicacao
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sTringEnvio
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sTipoTransacao
.head 7 -  String: sDestinoTransacao
.head 7 -  ! Long String: sTringRetorno
.head 7 -  Sql Handle: hSqlComunicacao
.head 7 -  Number: nFetch
.head 7 -  Number: nRetorno
.head 7 -  String: sParametro1
.head 7 -  String: sParametro2
.head 7 -  String: sParametro3
.head 7 -  Number: nNumseq
.head 7 -  Number: nCodTransacao
.head 6 +  Actions
.head 7 -  Call SalStrSetBufferLength( sTringEnvio, 4096 )
.head 7 -  Set dfsMensagem = 'COMUNICANDO COM BINIT.................'
.head 7 -  Set nRetorno = 20
.head 7 -  ! Recuperando o código da transação
.head 7 -  Set nCodTransacao = SalStrToNumber(SalStrMidX(sTringEnvio, 6, 3))
.head 7 -  Set sDestinoTransacao = SalStrMidX( sTringEnvio, 25, 2)
.head 7 -  ! Verifica o tipo de transação
.head 7 +  If fMPSConnect( hSqlComunicacao )
.head 8 +  If fMPSPrepareProc( hSqlComunicacao, 'exec ' || DATABASE_RENAVAM || '..TipoConsultaS @Transacao = :nCodTransacao', ':sTipoTransacao' )
.head 9 +  If SqlExecute( hSqlComunicacao )
.head 10 -  Call SqlFetchNext( hSqlComunicacao, nFetch )
.head 10 +  If nFetch = FETCH_Ok
.head 11 +  If SalStrUpperX( sTipoTransacao ) = 'R'
.head 12 -  Call SalSetWindowText( hWndForm, 'Comunicação BINIT' )
.head 12 -  Set nRetorno = _FSocket32( sGlbIPRENAVAM, nGlbPortaRENAVAM, 20, sTringEnvio, 4096 )
.head 11 -  Set sTringEnvio = SalStrMidX( sTringEnvio, 55, 4096 )
.head 11 +  If nRetorno != 55 And nRetorno > 0
.head 12 -  Set sParametro1 = SalStrMidX(sTringEnvio,0,255)
.head 12 -  Set sParametro2 = SalStrMidX(sTringEnvio,255,255)
.head 12 -  Set sParametro3 = SalStrMidX(sTringEnvio,510,255)
.head 12 -  Set nNumseq = SalStrToNumber(SalStrMidX(sTringEnvio, 0, 6))
.head 12 -  Set nCodTransacao = SalStrToNumber(SalStrMidX(sTringEnvio,6,3))
.head 12 +  If fMPSPrepareProc( hSqlComunicacao, 'exec ' || DATABASE_RENAVAM || '..RetRenavamI
@Parametro1 = :sParametro1, @Parametro2 = :sParametro2, @Parametro3=:sParametro3', '' )
.head 13 -  Call SqlExecute( hSqlComunicacao )
.head 13 -  Set nRetorno = 0
.head 12 -  Set dfsMensagem = 'PROCESSANDO.....'
.head 8 -  Call fMPSDisconnect( hSqlComunicacao )
.head 8 -  Return TRUE
.head 5 +  Function: GeraArquivoRENAINF
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nHora
.head 7 -  Boolean: JaGerou11a15
.head 7 -  Boolean: JaGerou18a20
.head 7 -  Boolean: bGerar
.head 6 +  Actions
.head 7 -  ! começa a verificação do Arquivo...
.head 7 -  Set nTipoArquivoAnt = 0
.head 7 -  Set nHora = SalDateHour(SalDateCurrent())
.head 7 -  Set bGerar = FALSE
.head 7 -  Set _sComandoPesquisa = 'exec dbinfracao..RNFGeraArquivoTransacaoS @Transacao =414 , @VerificaHora= 1'
.head 7 -  ! -
.head 7 -  !
.head 7 -  Call SybPrepareProc( hSqlApp,_sComandoPesquisa, ':bGerar')
.head 7 +  If NOT SqlExecute( hSqlApp )
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  Return FALSE
.head 7 -  ! 26/11/2004
.head 7 -  Call SqlFetchNext( hSqlApp, nProximo )
.head 7 +  If bGerar != TRUE
.head 8 -  Return TRUE
.head 7 -  ! Seleciona dados para o arquivo
.head 7 -  Set sArquivo = NomeArquivo( sArquivo)
.head 7 -  Set sCaminho = NomeDiretorio( sArquivo)
.head 7 -  !
.head 7 -  Set _sComandoPesquisa = 'exec dbinfracao..RNFGeraArquivoTransacaoS @Transacao =414'
.head 7 -  ! -
.head 7 -  !
.head 7 -  Call SybPrepareProc( hSqlApp,_sComandoPesquisa, ':frmEnviaNotificacaoAutuacao.sArquivo,:frmEnviaNotificacaoAutuacao.sRegistro1,:frmEnviaNotificacaoAutuacao.sRegistro2,:frmEnviaNotificacaoAutuacao.sRegistro8')
.head 7 +  If NOT SqlExecute( hSqlApp )
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  Return FALSE
.head 7 -  ! 26/11/2004
.head 7 -  Call SqlFetchNext( hSqlApp, nProximo )
.head 7 +  If nProximo != FETCH_EOF
.head 8 -  Set nRetomando =  SalFileOpen( hArquivo, sArquivo,OF_Write|OF_Create )
.head 8 -  !
.head 7 +  If NOT  MontaArquivoRENAINF( )
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  Return TRUE
.head 7 -  ! Fecha arquivo
.head 7 -  Return TRUE
.head 5 +  Function: MontaArquivoRENAINF
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bFimLeitura
.head 6 +  Actions
.head 7 -  Set bFimLeitura = FALSE
.head 7 -  ! Call SqlFetchNext( hSqlApp, nProximo )
.head 7 +  If nProximo = FETCH_EOF
.head 8 -  ! Call SalMessageBox( 'Não há Registros para transmitir', 'Atenção', MB_IconExclamation | MB_Ok )
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  Return FALSE
.head 7 +  Loop
.head 8 +  If NOT bFimLeitura
.head 9 -  Call SalFilePutStr( hArquivo,frmEnviaNotificacaoAutuacao.sRegistro1||frmEnviaNotificacaoAutuacao.sRegistro2||frmEnviaNotificacaoAutuacao.sRegistro8)
.head 9 +  If NOT  SqlFetchNext( hSqlApp, nProximo )
.head 10 -  Set bFimLeitura = TRUE
.head 10 -  Break
.head 7 -  Call SalFileClose( hArquivo )
.head 7 -  Call SalMessageBox("Envie o arquivo:"|| frmEnviaNotificacaoAutuacao.sArquivo || " pelo QWARE", 'Arquivo de pagamentos',MB_Ok )
.head 7 -  Return TRUE
.head 4 -  Window Parameters
.head 4 +  Window Variables
.head 5 -  Number: nRegistros
.head 5 -  Number: nTotalRegistros
.head 5 -  Number: nTipoArquivoAnt
.head 5 -  Number: nTipoArquivo
.head 5 -  ! Variaveis que conterao os dados do Arquivo de Remessa
.head 5 -  String: sHeader
.head 5 -  String: sUsuario
.head 5 -  Date/Time: dCriacao
.head 5 -  Long String: sRegistro1
.head 5 -  String: sRegistro2
.head 5 -  String: sRegistro3
.head 5 -  String: sRegistro4
.head 5 -  String: sRegistro5
.head 5 -  String: sRegistro6
.head 5 -  String: sRegistro7
.head 5 -  String: sRegistro8
.head 5 -  !
.head 5 -  Number: nRetomando
.head 5 -  Number: nProximo
.head 5 -  Number: nAux
.head 5 -  ! Handle do Arquivo de Remessa
.head 5 -  File Handle: hArquivo
.head 5 -  String: sArquivo
.head 5 -  String: sCaminho
.head 5 -  String: sTipo
.head 5 -  Number: nCod
.head 5 -  String: sDescricao
.head 4 +  Message Actions
.head 5 +  ! Comentários
.head 6 +      Autor
.head 7 -      Celso - 04/06/97
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Tela para geração do arquivo das notificações de multa para a FISEPE'
.head 6 -  Set _nEstadoInicialForm = EF_RegistroExistente
.head 6 -  Set _bLimpaTelaAposAtualizacao = FALSE
.head 6 -  Set _bLimpaTelaAposInclusao = TRUE
.head 6 -  Set _bLimpaTelaAposRemocao = TRUE
.head 6 -  Call SalCenterWindow( hWndForm )
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Call SalHideWindow( picSemaforo )
.head 5 +  On SAM_CreateComplete
.head 6 -  Call SalSendClassMessage( SAM_CreateComplete, 0, 0 )
.head 6 -  ! Call SalDisableWindow( pbArquivar )
.head 6 -  Set dfnTransmitido = 0
.head 6 -  Set dfnTransmitir = 0
.head 6 -  Call GeraArquivoRENAINF()
.head 6 -  Call SalPostMsg( tblAutos, SAM_CornerDoubleClick, 0 ,0)
.head 6 -  Call SalSendMsg( tblAutos, MSG_PesquisaTabela, 0 ,0)
.head 6 -  Call SalSendMsg( pbArquivar, SAM_Click, 0 ,0)
.head 5 +  On SAM_Destroy
.head 6 -  Call SalFileClose( hArquivo )
.head 6 -  Call SalSendClassMessage( SAM_Destroy, wParam, lParam )
.head 5 +  On MSG_Arquiva
.head 6 +  ! If NOT SalSendMsg( tblAutos, MSG_Arquiva, 0, 0 )
.head 7 -  Call SalTblSetFlagsAnyRows( tblAutos, ROW_Edited, TRUE, ROW_Edited |  ROW_MarkDeleted, 0 )
.head 7 -  Call SalTblSetFlagsAnyRows( tblAutos, ROW_MarkDeleted, FALSE, ROW_MarkDeleted, 0 )
.head 7 -  Return FALSE
.head 6 -  ! Call SalSendMsgToChildren( hWndForm, MSG_Desabilita1, 0, 0 )
.head 6 -  ! Cria o arquivo
.head 6 +  If NOT GeraArquivo(  )
.head 7 -  Return TRUE
.head 6 -  Call SalDisableWindow( pbArquivar )
.head 6 -  Return TRUE
.head 3 -  !
.head 2 +  Functions
.head 3 +  Function: AlteraNome
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sForm
.head 4 +  Actions
.head 5 -  Call SalGetWindowText( hWndMDI, sForm, 50 )
.head 5 -  Call SalSetWindowText( hWndMDI, sForm || ' - ' || SqlUser)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nAux
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set _sLoginCliente = 'DETRAN/PE'
.head 4 -  Set _bIgnoraPermissoes = 	TRUE
.head 4 -  Set _bNaoMostraFabricante = TRUE
.head 4 -  ! Set _sUsuarioTeste = 'ajs'
.head 4 -  Set _sSenhaTeste = '******'
.head 4 -  Set _nCodigoSistema = 106
.head 4 -  Set _sDatabase = 'dbvcen'
.head 4 -  Set _sDataVersao = '04/07/2007'
.head 4 -  Set _bNaoMostraLogon = FALSE
.head 4 -  Set _sLoginSistema = 'Controle de Infrações'
.head 4 -  Set _sLoginPicture = 'detran.bmp'
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  On SAM_CreateComplete
.head 4 -  Set nGlobalSetor = NUMBER_Null
.head 4 -  ! Call SalMessageBox( "LEMBRE DE TROCAR AS PERMISSOES", "MENSAGEM", TRUE )
.head 4 +  If SalSendClassMessage( SAM_CreateComplete, wParam, lParam )
.head 5 -  Call fMPSPrepareProc( hSqlApp, 'select NomeSecretaria, NomeDetran from ParametroGeral',':sGlobalSecretaria, :sGlobalDetran')
.head 5 -  Call SqlExecute( hSqlApp )
.head 5 -  Call SqlFetchNext( hSqlApp, nAux )
.head 5 -  Set sGlobalSetor = ''
.head 5 +  ! If NOT fVerificaVersao( )
.head 6 -  Call SalDestroyWindow( hWndMDI )
.head 6 -  Return FALSE
.head 5 -  Call SalModalDialog( dlgUsuario, hWndMDI, TRUE)
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  If NOT fMPSPrepareProc( hSqlApp, 'exec ParametroGeralS_UF', 
':sGlobalUF, :nGlobalPzDigAuto, :dGlobalHoje' )
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Return FALSE
.head 5 +  If NOT SqlExecute( hSqlApp )
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Return FALSE
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  Call SqlFetchNext( hSqlApp, nAux )
.head 1 +  Dialog Box: dlgEnvioTransacao
.head 2 -  Class:
.head 2 -  Property Template: ,,,,N,N
.head 2 -  Class DLL Name: QUIKPDLG.DLL
.head 2 -  Title: Envio Transação
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left: 3.575"
.head 4 -  Top: 1.844"
.head 4 -  Width:  3.675"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.521"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbCancela
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Cancelar
.head 4 -  Window Location and Size
.head 5 -  Left: 1.188"
.head 5 -  Top: 0.99"
.head 5 -  Width:  0.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgEnvioTransacao, FALSE )
.head 3 -  Background Text: Após 10 Segundos o Sistema Reinicia a Transmissão, Caso deseje interromper, Click em Cancelar
.head 4 -  Resource Id: 32298
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 0.135"
.head 5 -  Width:  3.25"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.521"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfnRelogio
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.438"
.head 6 -  Top: 0.698"
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nReturn
.head 2 +  Message Actions
.head 3 +  On SAM_Timer
.head 4 -  Set dfnRelogio = dfnRelogio + 1
.head 4 +  If dfnRelogio = 10
.head 5 -  Call SalEndDialog( dlgEnvioTransacao, nReturn )
.head 5 -  Call SalCreateWindow( frmEnviaNotificacaoAutuacao, mdiInfracao )
.head 3 +  On SAM_Create
.head 4 -  Call SalTimerSet( hWndForm, 1, 1000 )
.head 0 -  
  