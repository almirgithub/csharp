Application Description: MPS Informática Ltda.
		MPSINIT.APP - Arquivo de inicialização para uso da MPSCLAS.APL
		Versão 3.11 - Router SqlServer 4
		Author : Adilson Santos TD
	Outline Version - 4.0.28
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400800000
0020: 0000000000CA0000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE9FFFFFF160000 00160000009C0200 0060010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D04000000075769 6E646F7773124D44
0080: 4943617267614172 717569766F545854 0D4368696C642057 696E646F77731166
00A0: 726D436164617374 726F4C61796F7574
.enddata
		Outline Window State: Maximized
		Outline Window Location and Size
.data VIEWINFO
0000: 6600050003001B00 020000009C000000 0000651DC2120500 1D00FFFF4D61696E
0020: 00460000000600A2 004C0495036C2030 1202000100FFFF4D 4449436172676141
0040: 72717569766F5458 542E66726D50726F 6365737361417271 7569766F5265746F
0060: 726E6F524E430043 0000000600A10039 03B002401D4B1102 000100FFFF4D4449
0080: 4361726761417271 7569766F5458542E 66726D4765726141 72717569766F426C
00A0: 6F717565696F4330 3100290000000200 11003903B0021919 271000001300FFFF
00C0: 4D44494361726761 4172717569766F54 5854002B00000002 0011004C049503ED
00E0: 1730120000130002 004D444943617267 614172717569766F 5458542D3200
.enddata
.data VIEWSIZE
0000: FE00
.enddata
			Left: -0.013"
			Top: 0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: C438C407B80B2A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left: 4.15"
			Top: 1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left: 0.5"
			Top: 0.083"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? Yes
			Left: 1.338"
			Top: 5.438"
		Fully Qualified External References? No
		Reject Multiple Window Instances? Yes
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: Vtfile.Apl
		File Include: detran_Classes.Apl
		File Include: detran_funcoes.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: Use Parent
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Input: 99/99/9999
			Input: 99/99/9999 99:99:99
			Input: default
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				! Number: PAM_Calcula = SAM_User + 1
				! Number: PAM_Habilita = SAM_User + 2
				! Number: DISABLE = SAM_User + 3
				! Number: ENABLE = SAM_User + 4
				! Number: PAM_Limpa = SAM_User + 5
				! Number: WMSG_MOUSEMOVE = 0x0200
				! String: STRING_Null = ''
				! Number: PAM_PreencherComboBox = SAM_User + 10000
			Enumerations
		Resources
		Variables
.data RESOURCE 0 0 1 985445698
0000: 2200000012000000 0000000000000000 02008001000000D3 0100D01900000001
0020: FE00FF03
.enddata
			Number: nErro
			String: sMsg
			Sql Handle: hSqlApoio
		Internal Functions
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 3915204157
0000: D107000085030000 0000000000000000 0200000A00FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666FC2003C00 000A630051434B31
0040: 47657261006C0202 00001100001E0004 0000C20003000000 FF7F048300190000
0060: 00F001000000FF1F 1D0000AC00190001 FD00FF0736000000 196B000100FFFFC1
0080: 4F00000019DA0001 00FF7F68B0000000 0400F4020000FF1F 6C0000AC00040002
00A0: FD00FF0770000000 046B000200FFFFC1 7400000004DA0002 00FF7F78B0000000
00C0: 0400F60200FF1F7C 0000AC00040002FD 00FF17800000046B 000200FFFFC18400
00E0: 000004DA000200FF 7F88B00000000400 F60200FF1F8C0000 AC00190001FD00FF
0100: 07A5000000196B00 0100FFFFC1BE0000 0004DA000200FF7F 0180803E00000001
0120: 0070000E63514340 6F6E7461696E7200 AA00000005000000 6F0400E801020000
0140: FFC18001000000BF 04190019000101FA 00007F80F2010000 0F08000000961900
0160: 0100FE00FF832100 000004B5000200FF FF60250000001900 ED0100FF3F018064
0180: 0400000200380863 514D448049220000 000100DE0004DA00 0200FF7F01CC8004
01A0: 000370000D635143 006865636B426F78 22A20000010000B7 0400F60200FF1F01
01C0: 8004330004000600 634461646F732200 D1000100005B0400 02FB00FF0F018013
01E0: 011A0005000F6300 4465736B746F704C 20697374426F4E01 C2000B0000005B19
0200: 0001FA0000FF6F19 00D6190001FE00FF 833200000019B500 0100FFFF604B0000
0220: 001900ED0100FF3F 6400580000190001 FB00FF0F7D000000 D6190001FE00FF83
0240: 9600000019B50001 00FFFF60AF000000 1900ED0100FF3FC8 00580000190001FB
0260: 00FF0FE1000000D6 190001FE00FF83FA 00000019B5000100 FFFF100180640000
0280: 06000000000B6344 69724C3E697C00D9 0004005B190001FA 0000FF6F1900D619
02A0: 0001FE00FF9B3200 19B5000100FFFF66 4B001900ED0100FF 3F0180044B000007
02C0: 0000001E0F547265 F8654C69605E0000 0003006F1900E901 0000FFBF19590019
02E0: 0001FB00FF6F3200 D6190001FE00FF43 0180AF0000040800 000C634669F86C65
0300: 4CC1D600000007DE 0019D200010000FF 7F19B3001900F601 00FFDF32AC001900
0320: 01FD00FF374B0019 6B000100FFFFCD64 0019DA000100FF7F 7DB3001900F60100
0340: FFDF96AC00190001 FD00FF8701807D00 4000090000000D52 C06164696F4C6907
0360: 9A000000057B0019 4B00010000FFFFCD 190019DA000100FF 7F32B3001900F601
0380: 00FFDF4BAC001900 01FD00FF37640019 6B000100FFFF01
.enddata
			Dialog Box Class: DialogBoxLogin
				Title: Identificação do Usuário
				Accessories Enabled? No
				Visible? Yes
				Display Settings
					Display Style? Default
					Visible at Design time? Yes
					Type of Dialog: Modal
					Window Location and Size
						Left: 1.113"
						Top: 0.906"
						Width:  6.538"
						Width Editable? No
						Height: 2.833"
						Height Editable? No
					Absolute Screen Location? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Class Default
				Next Class Child Key: 32
				List in Tool Palette? Yes
				Property Template:
				Class DLL Name:
				Description: Classe de Janela de Login Padrão
				Tool Bar
					Display Settings
						Display Style? Default
						Location? Top
						Visible? Yes
						Size: Default
						Size Editable? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
					Contents
				Contents
					Background Text: Usuário
						Resource Id: 26328
						Class Child Ref Key: 0
						Class ChildKey: 1
						Class:
						Window Location and Size
							Left: 3.288"
							Top: 1.656"
							Width:  0.613"
							Width Editable? Yes
							Height: 0.188"
							Height Editable? Yes
						Visible? Yes
						Justify: Right
						Font Name: Arial
						Font Size: 9
						Font Enhancement: Bold-Italic
						Text Color: Black
						Background Color: Default
					Data Field: dfsUsuario
						Class Child Ref Key: 0
						Class ChildKey: 3
						Class:
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: 12
							Data Type: String
							Editable? Yes
						Display Settings
							Window Location and Size
								Left: 3.988"
								Top: 1.615"
								Width:  1.25"
								Width Editable? Yes
								Height: 0.229"
								Height Editable? Yes
							Visible? Yes
							Border? Yes
							Justify: Left
							Format: Unformatted
							Country: Default
							Font Name: Arial
							Font Size: 9
							Font Enhancement: Default
							Text Color: Default
							Background Color: Default
							Input Mask: Unformatted
						Message Actions
							On SAM_Create
								If SqlUser != ''
									Call SalSetWindowText( hWndItem, SqlUser )
									Call SalSetFocus( dfsSenha )
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
							On SAM_AnyEdit
								If NOT SalIsNull( dfsUsuario ) AND NOT SalIsNull( dfsSenha )
									Call SalEnableWindow(pbOk)
								Else
									Call SalDisableWindow(pbOk)
					Background Text: Senha
						Resource Id: 26329
						Class Child Ref Key: 0
						Class ChildKey: 2
						Class:
						Window Location and Size
							Left: 3.438"
							Top: 1.969"
							Width:  0.463"
							Width Editable? Yes
							Height: 0.208"
							Height Editable? Yes
						Visible? Yes
						Justify: Right
						Font Name: Arial
						Font Size: 9
						Font Enhancement: Bold-Italic
						Text Color: Black
						Background Color: Default
					Data Field: dfsSenha
						Class Child Ref Key: 0
						Class ChildKey: 4
						Class:
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: 16
							Data Type: String
							Editable? Yes
						Display Settings
							Window Location and Size
								Left: 3.988"
								Top: 1.948"
								Width:  1.25"
								Width Editable? Yes
								Height: 0.229"
								Height Editable? Yes
							Visible? Yes
							Border? Yes
							Justify: Left
							Format: Invisible
							Country: Default
							Font Name: Arial
							Font Size: 9
							Font Enhancement: Default
							Text Color: Black
							Background Color: Default
							Input Mask: Unformatted
						Message Actions
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
							On SAM_AnyEdit
								If NOT SalIsNull( dfsUsuario ) AND NOT SalIsNull( dfsSenha )
									Call SalMapEnterToTab( FALSE )
									Call SalEnableWindow( pbOk  )
								Else
									Call SalMapEnterToTab( TRUE )
									Call SalDisableWindow( pbOk  )
							On SAM_KillFocus
								Call SalMapEnterToTab( FALSE )
					Pushbutton: pbOk
						Class Child Ref Key: 0
						Class ChildKey: 5
						Class:
						Property Template:
						Class DLL Name:
						Title: &Ok
						Window Location and Size
							Left: 5.313"
							Top: 1.615"
							Width:  0.95"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Keyboard Accelerator: Enter
						Font Name: Arial
						Font Size: 9
						Font Enhancement: Default
						Picture File Name:
						Picture Transparent Color: None
						Image Style: Single
						Text Color: Default
						Background Color: Default
						Message Actions
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
							On SAM_Create
								Call SalDisableWindow( hWndItem )
							On SAM_Click
								Set SqlUser = dfsUsuario
								Set SqlPassword = dfsSenha
								Set SqlDatabase = "dbvcen"
								Call SalWaitCursor( TRUE )
								Set bConnect = SqlConnect( hSqlApoio)
								Call SalWaitCursor( FALSE)
								If bConnect
									Call SalEndDialog( hWndForm, TRUE)
									Call SalShowWindow( MDICargaArquivoTXT )
					Pushbutton: pbCancela
						Class Child Ref Key: 0
						Class ChildKey: 6
						Class:
						Property Template:
						Class DLL Name:
						Title: &Cancelar
						Window Location and Size
							Left: 5.313"
							Top: 1.948"
							Width:  0.95"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Keyboard Accelerator: Esc
						Font Name: Arial
						Font Size: 9
						Font Enhancement: Default
						Picture File Name:
						Picture Transparent Color: None
						Image Style: Single
						Text Color: Default
						Background Color: Default
						Message Actions
							On SAM_Click
								Call SalDestroyWindow( MDICargaArquivoTXT )
								Call SalEndDialog( hWndForm, FALSE )
							On SAM_SetFocus
								Call SalMapEnterToTab( FALSE )
					Line
						Resource Id: 26330
						Class Child Ref Key: 0
						Class ChildKey: 19
						Class:
						Coordinates
							Begin X:  0.088"
							Begin Y:  2.417"
							End X:  6.288"
							End Y:  2.417"
						Visible? Yes
						Line Style: Solid
						Line Thickness: 1
						Line Color: Royal Blue
					Picture: pic1
						Class Child Ref Key: 0
						Class ChildKey: 30
						Class:
						Property Template:
						Class DLL Name:
						Window Location and Size
							Left: 0.238"
							Top: 0.281"
							Width:  2.8"
							Width Editable? Yes
							Height: 2.0"
							Height Editable? Yes
						Visible? Yes
						Editable? No
						File Name: C:\PROJETO\GUPTA\APL\DETRAN.BMP
						Storage: External
						Picture Transparent Color: None
						Fit: Scale
						Scaling
							Width:  100
							Height:  100
						Corners: Square
						Border Style: Solid
						Border Thickness: 1
						Tile To Parent? No
						Border Color: Default
						Background Color: Default
						Message Actions
					Background Text: DETRAN - PE
						Resource Id: 26334
						Class Child Ref Key: 0
						Class ChildKey: 31
						Class:
						Window Location and Size
							Left: 4.338"
							Top: 0.552"
							Width:  1.15"
							Width Editable? Yes
							Height: 0.167"
							Height Editable? Yes
						Visible? Yes
						Justify: Left
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
					Background Text: Carga de Arquivos TXT
						Resource Id: 26335
						Class Child Ref Key: 0
						Class ChildKey: 32
						Class:
						Window Location and Size
							Left: 3.838"
							Top: 0.969"
							Width:  2.25"
							Width Editable? Yes
							Height: 0.229"
							Height Editable? Yes
						Visible? Yes
						Justify: Left
						Font Name: Arial
						Font Size: 12
						Font Enhancement: Bold-Italic
						Text Color: Default
						Background Color: Default
				Derived From
				Class Variables
				Instance Variables
					Boolean: bConnect
					! Sql Handle: hSqlApoio
				Functions
				Message Actions
					On SAM_Create
						Call SalCenterWindow( hWndForm )
		Default Classes
			MDI Window: cQCK1MDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field: cQCK1DataField
			Spin Field:
			Multiline Field:
			Pushbutton:
			Radio Button:
			Option Button:
			ActiveX:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control: cQuickGraph
		Application Actions
			On SAM_SqlError
				Call SqlGetError( hSqlApoio, nErro, sMsg )
				If nErro = 24002
					Set sMsg = "Usuario ou Senha incorretos."
				Else
					Set sMsg = SqlGetErrorTextX( nErro )
				Call fTratamentoErroSql( wParam, lParam, hSqlApoio, TRUE )
				! Call SalMessageBox( sMsg , "Erro", MB_Ok|MB_IconExclamation )
				Return FALSE
	MDI Window: MDICargaArquivoTXT
		Class:
		Property Template:
		Class DLL Name:
		Title: Sistema de Infrações - Módulo de Apoio
		Display Settings
			Visible at Design time? No
			Automatically Created at Runtime? Yes
			Initial State: Maximized
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left: 0.088"
				Top: 0.646"
				Width:  9.975"
				Width Editable? Yes
				Height: 5.552"
				Height Editable? Yes
		Icon File:
		Accessories Enabled? No
		Visible? Yes
		Description:
		Named Menus
		Menu
			Popup Menu: &Gerar tabela
				Resource Id: 52649
				Enabled when:
				Status Text:
				Menu Item Name:
				Popup Menu: &Cadastros
					Resource Id: 52650
					Enabled when:
					Status Text:
					Menu Item Name:
					Menu Item: &Tipos de Arquivos
						Resource Id: 52651
						Keyboard Accelerator: (none)
						Status Text:
						Menu Settings
							Enabled when:
							Checked when:
						Menu Actions
						Menu Item Name:
					Menu Item: &Layout´s
						Resource Id: 52652
						Keyboard Accelerator: (none)
						Status Text:
						Menu Settings
							Enabled when:
							Checked when:
						Menu Actions
							Call SalCreateWindow(frmCadastroLayout, hWndMDI)
							Call SalCenterWindow(frmCadastroLayout)
						Menu Item Name:
				Menu Separator
			Popup Menu: Atualizações
				Resource Id: 52654
				Enabled when:
				Status Text:
				Menu Item Name:
			Popup Menu: SIRECOM
				Resource Id: 52659
				Enabled when:
				Status Text:
				Menu Item Name:
				Menu Separator
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.26"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Form Window: frmCadastroLayout
				Class:
				Property Template:
				Class DLL Name:
				Title: Detran / PE - Cadastro de Layout´s
				Icon File:
				Accessories Enabled? No
				Visible? Yes
				Display Settings
					Display Style? Etched
					Visible at Design time? No
					Automatically Created at Runtime? No
					Initial State: Normal
					Maximizable? Yes
					Minimizable? Yes
					System Menu? Yes
					Resizable? Yes
					Window Location and Size
						Left: 0.25"
						Top: 0.052"
						Width:  7.2"
						Width Editable? Yes
						Height: 5.2"
						Height Editable? Yes
					Form Size
						Width:  Default
						Height: Default
						Number of Pages: Dynamic
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Description:
				Named Menus
				Menu
				Tool Bar
					Display Settings
						Display Style? Default
						Location? Top
						Visible? Yes
						Size: 0.219"
						Size Editable? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
					Contents
				Contents
					Child Table: tblColunas
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Display Settings
							Window Location and Size
								Left: 0.388"
								Top: 1.365"
								Width:  6.4"
								Width Editable? Yes
								Height: 2.75"
								Height Editable? Yes
							Visible? Yes
							Font Name: Default
							Font Size: Default
							Font Enhancement: Default
							Text Color: Default
							Background Color: Default
							View: Table
							Allow Row Sizing? No
							Lines Per Row: Default
						Memory Settings
							Maximum Rows in Memory: 0
							Discardable? No
						Contents
							Column: colNome
								Class Child Ref Key: 0
								Class ChildKey: 0
								Class:
								Property Template:
								Class DLL Name:
								Title: Colunas
								Visible? Yes
								Editable? Yes
								Maximum Data Length: Default
								Data Type: Long String
								Justify: Left
								Width:  5.925"
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Drop Down List
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
									! On SAM_Validate
										If fEncontrouDuplicidade()
											Return VALIDATE_Cancel
										Return VALIDATE_Ok
									! On SAM_AnyEdit
										Call SalSendMsgToChildren( hWndForm, PAM_Habilita,DISABLE, lParam )
									! On SAM_DropDown
									! On SAM_Click
										Call SqlPrepareAndExecute( hSqlApoio, 'Select Tamanho from dbinfracao..RNFCampos into :nTamanho where Descricao = :colNome'  )
										Call SqlFetchNext( hSqlApoio, nReturn )
										Set colPosicaoInicial = nTamanho + n 
									On SAM_Create
										Call SalListPopulate( colNome, hSqlApoio, 'Select Descricao from dbinfracao..RNFCampos a')
							Column: colPosicaoInicial
								Class Child Ref Key: 0
								Class ChildKey: 0
								Class:
								Property Template:
								Class DLL Name:
								Title: Posicao Inicial
								Visible? No
								Editable? Yes
								Maximum Data Length: 4
								Data Type: Number
								Justify: Left
								Width:  1.288"
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
									On SAM_Validate
										If colPosicaoInicial = NUMBER_Null 
											Call SalMessageBox( "Informe a posição inicial", "Mensagem", MB_IconExclamation )
											Return VALIDATE_Cancel
										Return VALIDATE_Ok
									On SAM_AnyEdit
										Call SalSendMsg( colPosicaoFinal, PAM_Calcula, wParam, lParam )
										Call SalSendMsgToChildren( hWndForm, PAM_Habilita,DISABLE, lParam )
									On WMSG_MOUSEMOVE
										! Mostra a mensagem de descrição do objeto em que o mouse está sobreposto.
										Call SalStatusSetText( tblColunas, "Posição inicial da coluna no arquivo TXT" )
							Column: colTamanho
								Class Child Ref Key: 0
								Class ChildKey: 0
								Class:
								Property Template:
								Class DLL Name:
								Title: Tamanho
								Visible? No
								Editable? Yes
								Maximum Data Length: 3
								Data Type: Number
								Justify: Left
								Width:  0.888"
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
									On SAM_AnyEdit
										Call SalSendMsg( colPosicaoFinal, PAM_Calcula, wParam, lParam )
										Call SalSendMsgToChildren( hWndForm, PAM_Habilita,DISABLE, lParam )
									On SAM_Validate
										If MyValue = NUMBER_Null or MyValue = 0 
											Call SalMessageBox( "Informe o tamanho do campo", "Mensagem", MB_IconExclamation )
											Return VALIDATE_Cancel
										Return VALIDATE_Ok
							Column: colTipoCaracter
								Class Child Ref Key: 0
								Class ChildKey: 0
								Class:
								Property Template:
								Class DLL Name:
								Title: Tipo de Dado
								Visible? No
								Editable? Yes
								Maximum Data Length: Default
								Data Type: String
								Justify: Left
								Width:  1.613"
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Drop Down List
									Multiline Cell? Yes
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
									Text: Alfanumérico
									Text: Numérico
								Message Actions
									On SAM_KillFocus
										Call SalPostMsg( colCasasDecimais, PAM_Habilita, 0, 0 )
									On SAM_SetFocus
										Set MyValue = "Alfanumérico"
										Call SalSetFocus( colTipoCaracter )
							Column: colCasasDecimais
								Class Child Ref Key: 0
								Class ChildKey: 0
								Class:
								Property Template:
								Class DLL Name:
								Title: Casas Decimais
								Visible? No
								Editable? Yes
								Maximum Data Length: Default
								Data Type: Number
								Justify: Left
								Width:  1.425"
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
									On PAM_Habilita
										If colTipoCaracter = "Alfanumérico"
											Call SalDisableWindow( hWndItem )
											Set MyValue = NUMBER_Null
										Else
											Call SalEnableWindow( hWndItem )
							Column: colPosicaoFinal
								Class Child Ref Key: 0
								Class ChildKey: 0
								Class:
								Property Template:
								Class DLL Name:
								Title: Posicao Final
								Visible? No
								Editable? No
								Maximum Data Length: 4
								Data Type: Number
								Justify: Left
								Width:  Default
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
									On PAM_Calcula
										Set MyValue = colPosicaoInicial + colTamanho - 1
									! On SAM_Validate
										If colPosicaoFinal = NUMBER_Null 
											Call SalMessageBox( "Informe a posição final", "Mensagem", MB_IconExclamation )
											Return VALIDATE_Cancel
										Else If colPosicaoFinal < colPosicaoInicial
											Call SalMessageBox( "Posição final < Posição inicial", "Mensagem", MB_IconExclamation )
										Call SalSendMsgToChildren( hWndForm, PAM_Habilita,ENABLE, lParam )
										Return VALIDATE_Ok
									On WMSG_MOUSEMOVE
										! Mostra a mensagem de descrição do objeto em que o mouse está sobreposto.
										Call SalStatusSetText( tblColunas, "Posição final da coluna no arquivo TXT" )
						Functions
						Window Variables
						Message Actions
							! On SAM_Create
								Call SalTblSetFocusCell( hWndItem, SalTblInsertRow( hWndItem, TBL_MaxRow ), tblColunas.colNome, 0, -1 )
							! On SAM_RowHeaderDoubleClick
								Call SalTblSetRowFlags( tblColunas, SalTblQueryContext( tblColunas ), ROW_Edited|ROW_MarkDeleted|ROW_New, FALSE )
							On WMSG_MOUSEMOVE
								! Mostra a mensagem de descrição do objeto em que o mouse está sobreposto.
								Call SalStatusSetText( tblColunas, "Monta o arquivo de acordo com os dados passados" )
							On PAM_Limpa
								Call fLimpa( hWndItem)
							On SAM_RowHeaderDoubleClick
								Call SalTblSetRowFlags( tblColunas, SalTblQueryContext( tblColunas ), ROW_MarkDeleted, TRUE )
							On SAM_RowHeaderClick
								Call SalTblSetRowFlags( tblColunas, SalTblQueryContext( tblColunas ), ROW_MarkDeleted, FALSE )
					Pushbutton: pbSair
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: &Sair
						Window Location and Size
							Left: 4.488"
							Top: 4.406"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.292"
							Height Editable? Yes
						Visible? Yes
						Keyboard Accelerator: (none)
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Picture File Name:
						Picture Transparent Color: None
						Image Style: Single
						Text Color: Default
						Background Color: Default
						Message Actions
							On WMSG_MOUSEMOVE
								! Mostra a mensagem de descrição do objeto em que o mouse está sobreposto.
								Call SalStatusSetText( tblColunas, "Sai da aplicação" )
							On SAM_Click
								Call SalDestroyWindow( hWndForm )
					Pushbutton: pbLimpa
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: &Limpar
						Window Location and Size
							Left: 3.288"
							Top: 4.406"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.292"
							Height Editable? Yes
						Visible? Yes
						Keyboard Accelerator: (none)
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Picture File Name:
						Picture Transparent Color: None
						Image Style: Single
						Text Color: Default
						Background Color: Default
						Message Actions
							On SAM_Click
								Call SalSendMsgToChildren( hWndForm, PAM_Limpa, wParam, lParam )
							On WMSG_MOUSEMOVE
								! Mostra a mensagem de descrição do objeto em que o mouse está sobreposto.
								Call SalStatusSetText( tblColunas, "Limpa a tela" )
					! Pushbutton: pbSelecao
.winattr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Selecao
						Window Location and Size
							Left: 2.438"
							Top: 1.531"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.292"
							Height Editable? Yes
						Visible? Yes
						Keyboard Accelerator: (none)
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Picture File Name:
						Picture Transparent Color: None
						Image Style: Single
						Text Color: Default
						Background Color: Default
.end
						Message Actions 
							On SAM_Click
								Set saFiltro [0] = 'Todos os Arquivos   (*.*)'
								Set saFiltro [1] = '*.*'
								Set saFiltro [2] = 'Arquivos Textos      (*.txt)'
								Set saFiltro [3] = '*.txt'
								! nIndice
								Set nIndice = 2
								Call SalDlgOpenFile( Teste, 'Seleção do arquivo de banco', saFiltro,8, nIndice, sArquivo, strArquivo )
					Frame
						Resource Id: 16247
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Window Location and Size
							Left: 0.238"
							Top: 1.156"
							Width:  6.65"
							Width Editable? Yes
							Height: 3.125"
							Height Editable? Yes
						Visible? Yes
						Corners: Square
						Border Style: Raised-Shadow
						Border Thickness: 1
						Border Color: Black
						Background Color: Gray
					Pushbutton: pbCancelar
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: &Cancelar
						Window Location and Size
							Left: 5.688"
							Top: 4.406"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.292"
							Height Editable? Yes
						Visible? Yes
						Keyboard Accelerator: (none)
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Picture File Name:
						Picture Transparent Color: None
						Image Style: Single
						Text Color: Default
						Background Color: Default
						Message Actions
							On SAM_Click
								Set bCancela = TRUE
					Background Text: Tipo de Arquivo:
						Resource Id: 16248
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Window Location and Size
							Left: 0.338"
							Top: 0.365"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.167"
							Height Editable? Yes
						Visible? Yes
						Justify: Left
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
					Combo Box: cmbTransacao
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Window Location and Size
							Left: 1.688"
							Top: 0.281"
							Width:  5.1"
							Width Editable? Yes
							Height: 1.104"
							Height Editable? Yes
						Visible? Yes
						Editable? Yes
						String Type: String
						Maximum Data Length: Default
						Sorted? Yes
						Always Show List? No
						Vertical Scroll? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
						List Initialization
						Message Actions
							On PAM_PreencherComboBox
								Call PreencheLista(cmbTransacao,"exec dbinfracao..RNFTransacaoS_Desc" )
							! On SAM_Click
								Call fInseriTableSertel()
								Call SalSendMsgToChildren( hWndForm, PAM_Habilita,DISABLE, lParam )
							On SAM_Click
								! Call fInseriTable()
								Call SalTblReset( tblColunas )
								Call SalListClear( cmbTipoRegistro )
								Call PreencheLista(cmbTipoRegistro,"exec dbinfracao..RNFTipoRegTransS_Cod @Transacao=:cmbTransacao" )
								Call SalSendMsgToChildren( hWndForm, PAM_Habilita,DISABLE, lParam )
							! On PAM_Limpa
								Set cmbTipoArquivo = ''
								Call SalSendMsgToChildren( hWndForm, PAM_Habilita,DISABLE, lParam )
							On PAM_Limpa
								Call fLimpa( hWndItem)
					Pushbutton: pbArquivar
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: &Arquivar
						Window Location and Size
							Left: 2.088"
							Top: 4.406"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.292"
							Height Editable? Yes
						Visible? Yes
						Keyboard Accelerator: (none)
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Picture File Name:
						Picture Transparent Color: None
						Image Style: Single
						Text Color: Default
						Background Color: Default
						Message Actions
							On SAM_Click
								Call fArquivaLayout()
					Frame
						Resource Id: 16249
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Window Location and Size
							Left: 0.238"
							Top: 0.24"
							Width:  6.65"
							Width Editable? Yes
							Height: 0.833"
							Height Editable? Yes
						Visible? Yes
						Corners: Square
						Border Style: Drop-Shadow
						Border Thickness: 1
						Border Color: Default
						Background Color: Gray
					Background Text: Tipo de Registro:
						Resource Id: 25221
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Window Location and Size
							Left: 0.338"
							Top: 0.698"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.167"
							Height Editable? Yes
						Visible? Yes
						Justify: Left
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
					Combo Box: cmbTipoRegistro
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Window Location and Size
							Left: 1.688"
							Top: 0.615"
							Width:  2.6"
							Width Editable? Yes
							Height: 1.104"
							Height Editable? Yes
						Visible? Yes
						Editable? Yes
						String Type: String
						Maximum Data Length: Default
						Sorted? Yes
						Always Show List? No
						Vertical Scroll? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
						List Initialization
						Message Actions
							! On PAM_PreencherComboBox
								Call PreencheLista(cmbTipoRegistro,"exec dbinfracao..RNFTipoRegTransS_Cod @Transacao=:cmbTransacao" )
							! On SAM_Click
								Call fInseriTableSertel()
								Call SalSendMsgToChildren( hWndForm, PAM_Habilita,DISABLE, lParam )
							On SAM_Click
								Call fInseriTable()
								Call SalSendMsgToChildren( hWndForm, PAM_Habilita,DISABLE, lParam )
							! On PAM_Limpa
								Set cmbTipoArquivo = ''
								Call SalSendMsgToChildren( hWndForm, PAM_Habilita,DISABLE, lParam )
							On PAM_Limpa
								Call fLimpa( hWndItem)
					! Data Field: dfNomeDaTabela
.winattr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Default
							Data Type: String
							Editable? Yes
						Display Settings
							Window Location and Size
								Left: 1.488"
								Top: 0.448"
								Width:  7.5"
								Width Editable? Yes
								Height: 0.25"
								Height Editable? Yes
							Visible? Yes
							Border? Yes
							Justify: Left
							Format: Unformatted
							Country: Default
							Font Name: Default
							Font Size: Default
							Font Enhancement: Default
							Text Color: Default
							Background Color: Default
							Input Mask: Unformatted
.end
						Message Actions 
							On PAM_Limpa
								Call fLimpa( hWndItem)
					! Data Field: dfStorageProcedure
.winattr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Default
							Data Type: String
							Editable? Yes
						Display Settings
							Window Location and Size
								Left: 1.488"
								Top: 0.781"
								Width:  7.5"
								Width Editable? Yes
								Height: 0.25"
								Height Editable? Yes
							Visible? Yes
							Border? Yes
							Justify: Left
							Format: Unformatted
							Country: Default
							Font Name: Default
							Font Size: Default
							Font Enhancement: Default
							Text Color: Default
							Background Color: Default
							Input Mask: Unformatted
.end
						Message Actions 
							On PAM_Limpa
								Call fLimpa( hWndItem)
				Functions
					! Function: fCriaTabelaNoBanco
						Description: 
						Returns 
							Boolean: 
						Parameters 
						Static Variables 
						Local variables 
							Number: nRow
							String: sColunas
							Boolean: bOk
							String: sTipoCaracter
						Actions 
							! When SqlError
								Call SalMessageBox( "Tabela já existe" , "ERRO", MB_IconExclamation )
								Return FALSE
							! Set sInsert = "Insert Into " || dfNomeDaTabela || " ( "
							Call SalTblSetFlagsAnyRows( tblColunas, ROW_New, FALSE, 0, 0 )
							Set nRow = 0
							Set nNumeroColunas =  0
							Set nIndice = 0
							Set sColunas = ''
							!
							! If Not SqlConnect( hSqlApoio )
								Return FALSE
							Loop 
								Set bOk = SalTblSetContext( tblColunas, nRow ) 
								If tblColunas.colNome = STRING_Null
									Break 
								If sColunas != ''
									Set sColunas = sColunas || ", "
								If tblColunas.colNome = STRING_Null or tblColunas.colPosicaoInicial = NUMBER_Null
										   or tblColunas.colTamanho = NUMBER_Null or tblColunas.colTipoCaracter = STRING_Null   
									Call SalMessageBox( "Existe dados incompletos na tabela", "Erro", MB_IconExclamation )
									Return FALSE
								If tblColunas.colTipoCaracter  = "Alfanumérico"
									Set sTipoCaracter = "    CHAR(" || SalNumberToStrX(tblColunas.colTamanho,0) || ")    null "
								Else 
									If tblColunas.colCasasDecimais = NUMBER_Null
										Set tblColunas.colCasasDecimais = 0
									Set sTipoCaracter = "   numeric (" || SalNumberToStrX(tblColunas.colTamanho,0) || ", " || 
											      SalNumberToStrX(tblColunas.colCasasDecimais,0) || " )    null "
								Set sColunas  = sColunas || tblColunas.colNome || sTipoCaracter
								Set nIndice = nIndice + 1
								Set nRow = nRow + 1
								Set nNumeroColunas = nNumeroColunas + 1
							!
							If Not fCriaTable(sColunas)
								Return FALSE
							Set sInsert = sInsert || ") Values ( "
							Return TRUE
					!
					! Function: fObrigatorio
						Description: 
						Returns 
							Boolean: 
						Parameters 
						Static Variables 
						Local variables 
						Actions 
							If Not SalTblAnyRows( tblColunas, ROW_Edited|ROW_New|ROW_Selected, ROW_MarkDeleted )
								Return FALSE
							Return TRUE
					!
					! Function: fCriaTable
						Description: 
						Returns 
							Boolean: 
						Parameters 
							String: sColunas
						Static Variables 
						Local variables 
							String: sSelect
							Boolean: bExists
						Actions 
							! When SqlError
								Call SalMessageBox( "Erro durante a criação da tabela", "Erro", MB_IconExclamation )
								Return FALSE
							If fExistsTable()
								Set sCreate = "Drop Table dbinfracao.." || sTabela 
								If Not SqlPrepareAndExecute( hSqlApoio, sCreate  )
									Return FALSE
							Set sCreate = "Create Table dbinfracao.." || sTabela || " (" || sColunas  || ")"
							If Not SqlPrepareAndExecute( hSqlApoio, sCreate  )
								Return FALSE
							Return TRUE
					!
					! Function: fExistsTable
						Description: 
						Returns 
							Boolean: 
						Parameters 
						Static Variables 
						Local variables 
							String: sSelect
							Boolean: bExists
							Boolean: bOk
						Actions 
							Set sSelect = "Select name  From dbinfracao..sysobjects Where name = '" || sTabela || "' 
									and type = 'U' " 
							Set bOk  = SqlExists( sSelect, bExists )
							If bExists
								Return TRUE
							Return FALSE
					!
					Function: fInseriTable
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set strComando = 'Exec dbinfracao..RNFRegistroTransacaoS @Transacao = :cmbTransacao, @TipoRegistro=:cmbTipoRegistro'
							Set bOK = fMPSPrepareProc(hSqlApoio,strComando ,':frmCadastroLayout.sCampo, 
										:frmCadastroLayout.sTipoCampo, :frmCadastroLayout.nPosicaoInic,
									                :frmCadastroLayout.nTamanho,:frmCadastroLayout.nCasasDecimais,
									                :frmCadastroLayout.sTabela,:frmCadastroLayout.sStorageProcedure,
									                :frmCadastroLayout.sLimparInicio')
							Set bOK = SqlExecute(hSqlApoio)
							If Not bOK
								Return FALSE
							Call SqlFetchNext(hSqlApoio,frmCadastroLayout.nInd)
							If Not bOK
								Call SalTblReset( tblColunas )
								Return FALSE
							Set nRow = 0
							Call SalTblReset( tblColunas )
							Set frmCadastroLayout.nTamanhoRegistro = 0
							While frmCadastroLayout.nInd != FETCH_EOF
								Call SalTblInsertRow( tblColunas, nRow )
								Set tblColunas.colNome = frmCadastroLayout.sCampo
								Set tblColunas.colPosicaoInicial = frmCadastroLayout.nPosicaoInic
								Set tblColunas.colTamanho = frmCadastroLayout.nTamanho
								Set tblColunas.colTipoCaracter = frmCadastroLayout.sTipoCampo
								Set tblColunas.colCasasDecimais = frmCadastroLayout.nCasasDecimais
								Set tblColunas.colPosicaoFinal= frmCadastroLayout.nPosicaoInic + frmCadastroLayout.nTamanho - 1
								Set nRow = nRow + 1
								Set frmCadastroLayout.nTamanhoRegistro=frmCadastroLayout.nTamanhoRegistro+frmCadastroLayout.nTamanho
								Call SqlFetchNext(hSqlApoio,frmCadastroLayout.nInd)
							While frmCadastroLayout.nRow <100
								Call SalTblInsertRow( tblColunas, nRow )
								Set nRow = nRow + 1
							! Call SalTblSetFlagsAnyRows ( tblColunas, ROW_New, FALSE, 0, 0 )
							! Set dfNomeDaTabela = sTabela
							! Set dfStorageProcedure = sStorageProcedure
					!
					Function: fArquivaLayout
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set nInd = 0
							! Set strComando = 'Exec dbinfracao..RNFArquivaLayout @TipoArquivo=:cmbTipoArquivo'
							! Set bOK = fMPSPrepareProc(hSqlApoio,strComando ,'')
							! Set bOK = SqlExecute(hSqlApoio)
							!
							Set strComando = 'Exec dbinfracao..RNFArquivaLayout
									 @Coluna = :frmCadastroLayout.tblColunas.colNome, @Sequencial=:frmCadastroLayout.nSequencial,
									@DescTransacao = :cmbTransacao, @TipoRegistroTransacao=:cmbTipoRegistro'
							Call SalTblSetContext( tblColunas, 0 )
							Set nSequencial =0
							Set nInd = 0
							!
							Loop
								If SalTblSetContext( tblColunas, nInd ) = FALSE
									Break
								If tblColunas.colNome = ''
									Break
								If Not SalTblQueryRowFlags( tblColunas, SalTblQueryContext( tblColunas ), ROW_MarkDeleted )
									Set nSequencial = nSequencial + 1
									Set bOK = fMPSPrepareProc(hSqlApoio,strComando ,'')
									Set bOK = SqlExecute(hSqlApoio)
									If Not bOK
										Call SalMessageBox( 'Erro durante inserção do campo: ' || tblColunas.colNome , 'Alerta', MB_IconExclamation )
										Break
								Set nInd = nInd + 1
							If Not bOK
								Call SalMessageBox( 'Ocorreu(ram) erro(s) durante inserção' , 'Alerta', MB_IconExclamation )
							Else
								! Call fCriaTabelaNoBanco()
								Call SalMessageBox( 'Arquivamento Realizado Com Sucesso' , 'Alerta', MB_IconExclamation )
								! Call SalSendMsgToChildren( hWndForm, PAM_Limpa, wParam, lParam )
							! While SalTblFetchRow( tblColunas, nInd ) !=TBL_NoMoreRows
								Set nSequencial = nInd + 1
								Set bOK = fMPSPrepareProc(hSqlApoio,strComando ,'')
								Set bOK = SqlExecute(hSqlApoio)
								If Not bOK
									Call SalMessageBox( 'Erro durante inserção', 'Alerta', MB_IconExclamation )
								Set nInd = nInd + 1
					!
				Window Parameters
				Window Variables
					File Handle: hFile
					! Boolean: bok
					String: strTexto
					String: strArquivo
					String: sArquivo
					Number: nIndice
					String: saFiltro[*]
					Number: nNewRow
					String: vColuna[*]
					Number: vPosicaoInicial[*]
					Number: vTamanho[*]
					String: vTipoCaracter[*]
					Number: vCasasDecimais[*]
					! Sql Handle: hSqlApoio
					String: sCreate
					String: sInsert
					Number: nNumeroColunas
					!
					Number: nIndex
					String: strFile
					String: strPath
					Boolean: bRet
					String: strFilters[0:5]
					Boolean: bCancela
					!
					String: strComando
					String: sCampo
					String: sTipoCampo
					Number: nPosicaoInic 
					Number: nTamanhoRegistro
					Number: nCasasDecimais
					Boolean: bOK
					Number: nInd
					String: sStorageProcedure
					String: sTabela
					String: sLimparInicio
					Number: nRow
					Number: nTamanho
					Number: nSequencial
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren( hWndForm, PAM_Habilita,DISABLE, lParam )
						Call SalSendMsgToChildren( hWndForm, PAM_PreencherComboBox,wParam, lParam )
						Call SalMapEnterToTab( TRUE )
			!
		Functions
			Function: fLimpa
				Description:
				Returns
				Parameters
					Window Handle: hHandle
				Static Variables
				Local variables
					Number: nType
				Actions
					Set nType = SalGetType( hHandle ) 
					If nType = TYPE_ChildTable
						Call SalTblReset( hHandle )
					Else If nType =  TYPE_ComboBox
						Call SalListSetSelect( hHandle, -1 )
					Else If nType = TYPE_DataField
						Call SalClearField( hHandle )
					Else If nType = TYPE_MultilineText
						Call SalClearField( hHandle )
			!
			Function: PreencheLista
				Description: Preenche a lista e o array de codigos dos itens.
						Esta função recebe um Sql Handle e uma string com o 
						comando.
				Returns
					Number:
				Parameters
					Window Handle: hCombo
					String: strComando
				Static Variables
				Local variables
					! Flags de retorno de funcoes
					Boolean: bOk
					Number: nInd
					! Contador
					Number: nCount
					! Variaveis para codigos
					String: strNome
					! Armazena temporariamente a string que sera´ jogada dentro da combo propriamente dita
					String: strItem
					! car 21/06/96 - Armazena a selecao do combo para que nao se perca no drop-down
					String: strCampoCodigo
				Actions
					Set bOk = fMPSConnect(hSqlApoio)
					Set bOk = fMPSPrepareProc(hSqlApoio,strComando ,':strNome')
					Set bOk = SqlExecute(hSqlApoio)
					Set nCount = 0
					Call SqlFetchNext(hSqlApoio,nInd)
					While nInd != FETCH_EOF
						Set nCount = nCount + 1
						If nCount = 1
							Set strCampoCodigo = strNome
						Call SalListAdd(hCombo,strNome)
						Call SqlFetchNext(hSqlApoio,nInd)
					! Call SalArraySetUpperBound( strCodigos, 1, nCount  -1 )
					! Call SalArraySetUpperBound( strItens, 1, nCount -1 )
					! Call SalListSelectString( hCombo, -1, strCampoCodigo)
			!
		Window Parameters
		Window Variables
			Boolean: bCreate
			String: strErro1
			String: strErro2
			String: strErro3
			String: strErro4
			String: strErro5
			String: strErro6
			String: strErro7
			String: _sDatabase
		Message Actions
			On SAM_Create
				Set bCreate = FALSE
				Call SalHideWindow( hWndMDI )
				Call SalModalDialog( dlgLogin1, hWndMDI )
			On SAM_Close
				Call SqlDisconnect( hSqlApoio )
	Dialog Box: dlgLogin1
		Class:
		Property Template:
		Class DLL Name:
		Title: Identificação do Usuário
		Accessories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Type of Dialog: Modal
			Window Location and Size
				Left: 0.988"
				Top: 1.281"
				Width:  6.538"
				Width Editable? No
				Height: 2.833"
				Height Editable? No
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: dfsLogin
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 12
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 3.163"
						Top: 0.594"
						Width:  2.213"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Arial
					Font Size: 9
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						If SqlUser != ''
							Call SalSetWindowText( hWndItem, SqlUser )
							Call SalSetFocus( dfsSenha )
					On SAM_AnyEdit
						If NOT SalIsNull( dfsLogin ) AND NOT SalIsNull( dfsSenha )
							Call SalEnableWindow(pbOk)
						Else
							Call SalDisableWindow(pbOk)
			Data Field: dfsSenha
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 16
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 3.163"
						Top: 1.135"
						Width:  2.213"
						Width Editable? Yes
						Height: 0.229"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Invisible
					Country: Default
					Font Name: Arial
					Font Size: 9
					Font Enhancement: Default
					Text Color: Black
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_AnyEdit
						If NOT SalIsNull( dfsLogin ) AND NOT SalIsNull( dfsSenha )
							Call SalEnableWindow( pbOk )
						Else
							Call SalDisableWindow( pbOk  )
			Combo Box: cmbAmbiente
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 3.163"
					Top: 1.667"
					Width:  2.213"
					Width Editable? Yes
					Height: 1.104"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				String Type: String
				Maximum Data Length: Default
				Sorted? Yes
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
				List Initialization
					Text: PRODUÇÃO
					Text: HOMOLOGAÇÃO
					Text: DESENVOLVIMENTO
				Message Actions
					On SAM_Create
						Call SalListSetSelect( cmbAmbiente, 2 )
						Set vgsAmbiente = cmbAmbiente
						Set _sDatabase = 'dbvcen'
						Set SqlDatabase = _sDatabase || SalStrMidX( cmbAmbiente, 0, 1 )
					On SAM_Click
						Set SqlDatabase = _sDatabase || SalStrMidX( cmbAmbiente, 0, 1 )
						Set vgsAmbiente = cmbAmbiente
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: &Ok
				Window Location and Size
					Left: 2.963"
					Top: 2.281"
					Width:  1.3"
					Width Editable? Yes
					Height: 0.292"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Arial
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Create
						Call SalDisableWindow( hWndItem )
					On SAM_Click
						Set SqlUser = dfsLogin
						Set SqlPassword = dfsSenha
						Call SalWaitCursor( TRUE )
						Set bConnect = SqlConnect( hSql)
						Call SalWaitCursor( FALSE)
						If bConnect
							Call SqlDisconnect( hSql)
							Call SalEndDialog( hWndForm, TRUE)
			Pushbutton: pbCancela
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: &Cancelar
				Window Location and Size
					Left: 4.3"
					Top: 2.281"
					Width:  1.288"
					Width Editable? Yes
					Height: 0.292"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, FALSE )
			Frame
				Resource Id: 20306
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.063"
					Top: 0.073"
					Width:  5.65"
					Width Editable? Yes
					Height: 2.104"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: 3D Face Color
			Background Text: Ambiente:
				Resource Id: 20307
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 3.15"
					Top: 1.427"
					Width:  0.713"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Arial
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: Dados
				Resource Id: 20308
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 2.95"
					Top: 0.135"
					Width:  2.588"
					Width Editable? Yes
					Height: 1.917"
					Height Editable? Yes
				Visible? Yes
				Font Name: Arial
				Font Size: 9
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Frame
				Resource Id: 20309
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.225"
					Top: 0.208"
					Width:  2.588"
					Width Editable? Yes
					Height: 1.385"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: System Window Color
			Picture: picImagen
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 0.288"
					Top: 0.271"
					Width:  2.45"
					Width Editable? Yes
					Height: 1.26"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name: Detran.bmp
				Storage: External
				Picture Transparent Color: Gray
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Tile To Parent? No
				Border Color: Default
				Background Color: Default
				Message Actions
			Data Field: dfsSistema
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 35
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left: 0.2"
						Top: 1.635"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.188"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Arial
					Font Size: 10
					Font Enhancement: None
					Text Color: Red
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Call SalDisableWindow( hWndItem )
						If SalIsNull( hWndItem )
							Call SalSetWindowText( hWndItem, 'Sistema')
			Data Field: dfdData
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 30
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left: 1.3"
						Top: 1.917"
						Width:  1.313"
						Width Editable? Yes
						Height: 0.188"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: dd-MM-yyyy
					Country: Default
					Font Name: Arial
					Font Size: 8
					Font Enhancement: None
					Text Color: Red
					Background Color: 3D Face Color
					Input Mask: 99-99-9999
				Message Actions
					On SAM_Create
						Call SalDisableWindow( hWndItem )
						If SalIsNull( hWndItem )
							Call SalSetWindowText( hWndItem, '99-99-9999')
			Background Text: Login:
				Resource Id: 20310
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 3.15"
					Top: 0.396"
					Width:  0.513"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Arial
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Data da Versão :
				Resource Id: 20311
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.263"
					Top: 1.917"
					Width:  1.225"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Arial
				Font Size: 8
				Font Enhancement: None
				Text Color: Blue
				Background Color: Default
			Background Text: Senha:
				Resource Id: 20312
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 3.15"
					Top: 0.917"
					Width:  0.513"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Arial
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Frame
				Resource Id: 20313
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.063"
					Top: 2.198"
					Width:  5.65"
					Width Editable? Yes
					Height: 0.458"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: 3D Face Color
		Functions
		Window Parameters
		Window Variables
			Number: nBytes
			String: _sDatabase
			Sql Handle: hSql
			Boolean: bConnect
		Message Actions
			On SAM_Create
				Set nBytes = SalGetProfileString ( 'MPS', 'login', '', dfsLogin, "win.ini" )

  