.head 0 +  Application Description: Centura SQLWindows Standard Application Template
.head 1 -  Outline Version - 4.0.28
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000BE0000 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D04000000075769 6E646F7773166672
0080: 6D52656C4D756C74 617343616E63656C 616461730D436869 6C642057696E646F
00A0: 77730A7062496D70 72696D6972
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: detran_funcoes.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 3 -  Enumerations
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 3923359385
0000: 2200000012000000 0000000000000000 02008001000000B2 0100D01900000001
0020: FE00FF03
.enddata
.head 2 +  Internal Functions
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 3915204157
0000: D107000085030000 0000000000000000 0200000A00FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666FC2003C00 000A630051434B31
0040: 47657261006C0202 00001100001E0004 0000C20003000000 FF7F048300190000
0060: 00F001000000FF1F 1D0000AC00190001 FD00FF0736000000 196B000100FFFFC1
0080: 4F00000019DA0001 00FF7F68B0000000 0400F4020000FF1F 6C0000AC00040002
00A0: FD00FF0770000000 046B000200FFFFC1 7400000004DA0002 00FF7F78B0000000
00C0: 0400F60200FF1F7C 0000AC00040002FD 00FF17800000046B 000200FFFFC18400
00E0: 000004DA000200FF 7F88B00000000400 F60200FF1F8C0000 AC00190001FD00FF
0100: 07A5000000196B00 0100FFFFC1BE0000 0004DA000200FF7F 0180803E00000001
0120: 0070000E63514340 6F6E7461696E7200 AA00000005000000 6F0400E801020000
0140: FFC18001000000BF 04190019000101FA 00007F80F2010000 0F08000000961900
0160: 0100FE00FF832100 000004B5000200FF FF60250000001900 ED0100FF3F018064
0180: 0400000200380863 514D448049220000 000100DE0004DA00 0200FF7F01CC8004
01A0: 000370000D635143 006865636B426F78 22A20000010000B7 0400F60200FF1F01
01C0: 8004330004000600 634461646F732200 D1000100005B0400 02FB00FF0F018013
01E0: 011A0005000F6300 4465736B746F704C 20697374426F4E01 C2000B0000005B19
0200: 0001FA0000FF6F19 00D6190001FE00FF 833200000019B500 0100FFFF604B0000
0220: 001900ED0100FF3F 6400580000190001 FB00FF0F7D000000 D6190001FE00FF83
0240: 9600000019B50001 00FFFF60AF000000 1900ED0100FF3FC8 00580000190001FB
0260: 00FF0FE1000000D6 190001FE00FF83FA 00000019B5000100 FFFF100180640000
0280: 06000000000B6344 69724C3E697C00D9 0004005B190001FA 0000FF6F1900D619
02A0: 0001FE00FF9B3200 19B5000100FFFF66 4B001900ED0100FF 3F0180044B000007
02C0: 0000001E0F547265 F8654C69605E0000 0003006F1900E901 0000FFBF19590019
02E0: 0001FB00FF6F3200 D6190001FE00FF43 0180AF0000040800 000C634669F86C65
0300: 4CC1D600000007DE 0019D200010000FF 7F19B3001900F601 00FFDF32AC001900
0320: 01FD00FF374B0019 6B000100FFFFCD64 0019DA000100FF7F 7DB3001900F60100
0340: FFDF96AC00190001 FD00FF8701807D00 4000090000000D52 C06164696F4C6907
0360: 9A000000057B0019 4B00010000FFFFCD 190019DA000100FF 7F32B3001900F601
0380: 00FFDF4BAC001900 01FD00FF37640019 6B000100FFFF01
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 -  Application Actions
.head 1 +  Form Window: frmRelMultasCanceladas
.head 2 -  Class: cQCK1Form
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Relatório de Multas Canceladas
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left: 1.438"
.head 4 -  Top: 1.323"
.head 4 -  Width:  7.05"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 3.313"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfnOrgao
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000800 7461624C6F746500 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.488"
.head 6 -  Top: 0.073"
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: 9999999999
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Órgão autuante responsável pelo lote'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bCompChaveOpcionalParaPesquisa = FALSE
.head 6 -  Set _bComponenteChave = TRUE
.head 6 -  Set _bDisparaConsultaEmValidate = FALSE
.head 6 -  Set _bPermiteNulos = FALSE
.head 6 -  !
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sNomeParaMsgs = 'Órgão autuante'
.head 6 -  ! Set _sConsultaFrmOpcoesSQLOuSP = 'SQL'
.head 6 -  ! Set _sConsultaFrmOpcoesCampo = 'select  distinct convert( varchar( 10), o.Cod), o.Descricao from ' || DATABASE_INFRACAO || '..AgenteEquip ae, '
		  || DATABASE_INFRACAO || '..OrgaoAutuante o, '
                                  || DATABASE_CENTRAL || '..OrgaoAutSetor oas , ' || DATABASE_CENTRAL
		  || '..Setor s Where s.CodReduzido =  :frmRelMultasCanceladas.nSetorUsuario and s.Cod = oas.Setor and
                                     oas.AgenteEquip = ae.Cod and ae.OrgaoAutuante =  oas.OrgaoAutuante
		     and ae.OrgaoAutuante = o.Cod'
.head 6 -  Set _sConsultaFrmOpcoesSQLOuSP = 'SP'
.head 6 -  Set _sConsultaFrmOpcoesCampo = 'exec dbinfracao..OrgaoAutuanteS_desc_Estan @Cod = :frmRelMultasCanceladas.dfnOrgao, @Setor=:frmRelMultasCanceladas.nSetorUsuario'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On UDM_ValidaCampo
.head 6 -  Return dfnOrgao <= 2147483647
.head 3 +  Data Field: dfnAgenteEquip
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000800 7461624C6F746500 000000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.488"
.head 6 -  Top: 0.365"
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: 9999999999
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Órgão autuante responsável pelo lote'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sNomeParaMsgs = 'Agente/Equipamentos'
.head 6 -  Set _sConsultaFrmOpcoesSQLOuSP = 'SP'
.head 6 -  Set _sConsultaFrmOpcoesCampo = 'exec dbinfracao..AgenteEquipS_desc_Estan @OrgaoAutuante = :frmRelMultasCanceladas.dfnOrgao, @Setor=:frmRelMultasCanceladas.nSetorUsuario'
.head 6 -  ! Variáveis para indentificar o Componente Chave
.head 6 -  Set _bComponenteChave = TRUE
.head 6 -  Set _bCompChaveGeradoPeloSistema = FALSE
.head 6 -  Set _bCompChaveOpcionalParaPesquisa = TRUE
.head 6 -  Set _bDisparaConsultaEmValidate = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On UDM_ValidaCampo
.head 6 -  Return dfnAgenteEquip <= 2147483647
.head 3 +  Data Field: dfnMunicipio
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.488"
.head 6 -  Top: 0.677"
.head 6 -  Width:  0.975"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: 9999
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sTextoStatusBar = 'Município'
.head 6 -  Set _sNomeParaMsgs = 'Município'
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  ! Set _sConsultaFrmOpcoesSQLOuSP = 'SQL'
.head 6 -  ! Set _sConsultaFrmOpcoesCampo = 'select Cod, Descricao from ' || DATABASE_CENTRAL || '..Municipio m,'
|| DATABASE_CENTRAL || '..ParametroGeral pg where pg.UF = m.UF order by Descricao'
.head 6 -  Set _sConsultaFrmOpcoesCampo = 'MunicipioS_coddesc'
.head 6 -  ! Set _sConsultaFrmOpcoesColunaOuParam = '@Desc'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Data Field: dfsMunicipio
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.513"
.head 6 -  Top: 0.677"
.head 6 -  Width:  3.025"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _bÉCampoDescrição = TRUE
.head 6 -  Set _bNuncaHabilitado = TRUE
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  ! Pesquisa da descrição
.head 6 -  Set _bÉDependente = TRUE
.head 6 -  Set _sCamposResponsaveis[0] = 'dfnMunicipio'
.head 6 -  Set _sConsultaDescrição = 'exec MunicipioS_descricao2  @Cod = :frmRelMultasCanceladas.dfnMunicipio'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Combo Box: cmbCompetencia
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.488"
.head 5 -  Top: 1.073"
.head 5 -  Width:  4.05"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.104"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 +  List Initialization
.head 5 -  Text: Municipal
.head 5 -  Text: Estadual
.head 5 -  Text: Dupla Competência
.head 4 -  Message Actions
.head 3 +  Data Field: dfdInicial
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.488"
.head 6 -  Top: 1.396"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: 99-99-9999
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sTextoStatusBar = 'Data Incial do Intervalo, referentes às datas de cadastramento da Restrição no Sistema, para a pesquisa.'
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Validate
.head 6 +  If NOT SalIsNull( dfdInicial )
.head 7 +  If NOT (SalIsValidDateTime( dfdInicial ))
.head 8 -  Call SalMessageBeep( 0 )
.head 8 -  Call SalMessageBox( 'Data inválida.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 8 -  Call SalClearField( dfdInicial )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else If (SalDateYear( dfdInicial ) < 1753)
.head 8 -  Call SalMessageBeep( 0 )
.head 8 -  Call SalMessageBox( 'Ano inválido.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 8 -  Call SalClearField( dfdInicial )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If dfdFinal < dfdInicial AND NOT SalIsNull( dfdFinal )
.head 8 -  Call SalMessageBeep( 0 )
.head 8 -  Call SalMessageBox( 'Data Inicial deve ser menor do que a data Final.', 'Atenção', MB_IconExclamation | MB_Ok )
.head 6 -  Call SalSendClassMessage( SAM_Validate, wParam, lParam )
.head 3 +  Data Field: dfdFinal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.013"
.head 6 -  Top: 1.396"
.head 6 -  Width:  1.025"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: 99-99-9999
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sTextoStatusBar = 'Data Final do Intervalo, referentes às datas de cadastramento da Restrição no Sistema, para a pesquisa.'
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Validate
.head 6 +  If NOT SalIsNull( dfdFinal )
.head 7 +  If NOT (SalIsValidDateTime( dfdFinal ))
.head 8 -  Call SalMessageBeep( 0 )
.head 8 -  Call SalMessageBox( 'Data inválida.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 8 -  Call SalClearField( dfdFinal )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else If SalDateYear( dfdFinal ) < 1753
.head 8 -  Call SalMessageBeep( 0 )
.head 8 -  Call SalMessageBox( 'Ano inválido.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 8 -  Call SalClearField( dfdFinal )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else If dfdFinal < dfdInicial
.head 8 -  Call SalMessageBeep( 0 )
.head 8 -  Call SalMessageBox( 'Data Final do período deve ser maior ou igual à data Inicial.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 6 -  Call SalSendClassMessage( SAM_Validate, wParam, lParam )
.head 3 -  Group Box: Saída
.head 4 -  Resource Id: 54584
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.488"
.head 5 -  Top: 1.979"
.head 5 -  Width:  2.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.52"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  ! cQCK1RadioButton: rbArquivo
.winattr class Radio Button:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Arquivo
.head 4 -  Window Location and Size
.head 5 -  Left: 1.65"
.head 5 -  Top: 2.167"
.head 5 -  Width:  0.988"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Clique para que o relatório seja gerado em arquivo'
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Set _sTipoMsgNulo = 'PADRAO'
.head 6 -  ! Variáveis para Check Box
.head 6 -  Set _bRadioButtonDefault = FALSE
.head 6 -  Set _sValorCampoFonte = 'I'
.head 6 -  Set _sNomeCampoFonte = 'dfsSaida'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalDisableWindow( pbImpressora )
.head 6 -  Call SalShowWindow( dfArquivo )
.head 6 -  Call SalShowWindow( dfTexto )
.head 6 -  Set dfTexto = 'Informe o Nome do Arquivo:'
.head 3 +  Radio Button: rbTela
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 746162496D707269 6D69720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Tela
.head 4 -  Window Location and Size
.head 5 -  Left: 1.588"
.head 5 -  Top: 2.156"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Clique para que o relatório saia na tela'
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  ! Variáveis para Check Box
.head 6 -  Set _sValorCampoFonte = 'T'
.head 6 -  Set _sNomeCampoFonte = 'dfsSaida'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalHideWindow( dfArquivo )
.head 6 -  ! Call SalHideWindow( dfTexto )
.head 6 -  Call SalDisableWindow( pbImpressora )
.head 3 +  Radio Button: rbImpressora
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000C00 746162496D707269 6D69720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Impressora
.head 4 -  Window Location and Size
.head 5 -  Left: 2.738"
.head 5 -  Top: 2.156"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Clique para que o relatório seje impresso'
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Set _sTipoMsgNulo = 'PADRAO'
.head 6 -  ! Variáveis para Check Box
.head 6 -  Set _bRadioButtonDefault = TRUE
.head 6 -  Set _sValorCampoFonte = 'I'
.head 6 -  Set _sNomeCampoFonte = 'dfsSaida'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalHideWindow( dfArquivo )
.head 6 -  ! Call SalHideWindow( dfTexto )
.head 6 -  Call SalEnableWindow( pbImpressora )
.head 3 -  Background Text: Período:
.head 4 -  Resource Id: 54585
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.713"
.head 5 -  Top: 1.438"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: a
.head 4 -  Resource Id: 54586
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 2.663"
.head 5 -  Top: 1.438"
.head 5 -  Width:  0.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Ag. Autuador:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000800 7461624C6F746500 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Resource Id: 54587
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top: 0.094"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Background Text: Competência:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000800 7461624C6F746500 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Resource Id: 59683
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top: 1.094"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Pushbutton: pbImprimir
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Im&primir
.head 4 -  Window Location and Size
.head 5 -  Left: 5.688"
.head 5 -  Top: 0.115"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Imprime o relatório'
.head 6 -  Set _nPermissao = 15
.head 6 -  Set _sTipoComando = 'Comum'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  ! Data Obrigatórias
.head 6 +  If SalIsNull( dfdInicial)
.head 7 -  Call SalMessageBeep( MB_IconExclamation )
.head 7 -  Call SalMessageBox( 'A data de inicial é obrigatória', 'Atenção', MB_IconExclamation | MB_Ok )
.head 7 -  Call SalSetFocus( dfdInicial)
.head 7 -  Return FALSE
.head 6 +  If SalIsNull( dfdFinal)
.head 7 -  Call SalMessageBeep( MB_IconExclamation )
.head 7 -  Call SalMessageBox( 'A data de final é obrigatória', 'Atenção', MB_IconExclamation | MB_Ok )
.head 7 -  Call SalSetFocus( dfdFinal)
.head 7 -  Return FALSE
.head 6 +  If dfdInicial > dfdFinal
.head 7 -  Call SalMessageBeep( MB_IconExclamation )
.head 7 -  Call SalMessageBox( 'A data de criação inicial deve ser menor do que a data de criação final', 'Atenção', MB_IconExclamation | MB_Ok )
.head 7 -  Call SalSetFocus( dfdInicial)
.head 7 -  Return FALSE
.head 6 +  ! If hWndReport != hWndNULL  
.head 7 -  Call SalSendMsg( hWndReport, SAM_Close, 0,0)
.head 6 -  !
.head 6 +  If NOT VerificaRelatório()
.head 7 -  Call SalMessageBeep( MB_IconExclamation )
.head 7 -  Call SalMessageBox( 'Sem dados para o filtro informado', 'Atenção',  MB_Ok | MB_IconInformation )
.head 7 -  Call SalSetFocus( dfdInicial)
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  !
.head 6 +  If rbImpressora
.head 7 -  Call SalReportPrint( hWndForm, 'autocanc.qrp',
'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, dfdInicial, dfdFinal, sNomeOrgao, sPlaca,
sUF, sSerie, nAuto, nDigito, nNotificacao, nProcesso, nInfracao, dData,
sUsuarioCancel, nValor, sMotivo, SqlUser,dfsMunicipio,cmbCompetencia,
nMatriculaAgente, sNomeAgente, sNomeOrgaoLotacao, sDataInfracao',
'Secretaria, Detran, CodSetor, NomeSetor, DataInicial, DataFinal, NomeOrgao, Placa, UF, Serie,
Auto, Digito, Notificacao, Processo, Infracao, Data, UsuarioCanc, Valor,
Motivo, Usuario,Municipio,Competencia,
MatriculaAgente, NomeAgente, NomeOrgaoLot, DataInfracao', 1,RPT_PrintAll,0,0, nErro )
.head 6 +  Else If rbTela
.head 7 -  Set hWndReportVw =  SalCreateWindow(frmReportView, hWndNULL )
.head 7 -  Call SalSetWindowText( hWndReportVw, 'Relatório de Multas Canceladas' )
.head 7 -  Call SalReportView( hWndForm, hWndReportVw, 'autocanc.qrp',
'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, dfdInicial, dfdFinal, sNomeOrgao, sPlaca,
sUF, sSerie, nAuto, nDigito, nNotificacao, nProcesso, nInfracao, dData,
sUsuarioCancel, nValor, sMotivo, SqlUser,dfsMunicipio,cmbCompetencia,
nMatriculaAgente, sNomeAgente, sNomeOrgaoLotacao, sDataInfracao',
'Secretaria, Detran, CodSetor, NomeSetor, DataInicial, DataFinal, NomeOrgao, Placa, UF, Serie,
Auto, Digito, Notificacao, Processo, Infracao, Data, UsuarioCanc, Valor,
Motivo, Usuario,Municipio,Competencia,
MatriculaAgente, NomeAgente, NomeOrgaoLot, DataInfracao',  nErro )
.head 7 -  ! Call SalReportView( hWndForm, hWndReportView, 'autocanc.qrp',
'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, dfdInicial, dfdFinal, sNomeOrgao, sPlaca,
sUF, sSerie, nAuto, nDigito, nNotificacao, nProcesso, nInfracao, dData,
sUsuarioCancel, nValor, sMotivo, SqlUser,dfsMunicipio,cmbCompetencia,
nMatriculaAgente, sNomeAgente, sNomeOrgaoLotacao, sDataInfracao',
'Secretaria, Detran, CodSetor, NomeSetor, DataInicial, DataFinal, NomeOrgao, Placa, UF, Serie,
Auto, Digito, Notificacao, Processo, Infracao, Data, UsuarioCanc, Valor,
Motivo, Usuario,Municipio,Competencia,
MatriculaAgente, NomeAgente, NomeOrgaoLot, DataInfracao',  nErro )
.head 3 +  Pushbutton: pbImpressora
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Con&figurar
.head 4 -  Window Location and Size
.head 5 -  Left: 5.688"
.head 5 -  Top: 0.406"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Configuração de impressoras'
.head 6 -  Set _nPermissao = EF_RegistroExistente | EF_PesquisaHabilitada | EF_Vazio
.head 6 -  Set _sTipoComando = 'Comum'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalPrtGetDefault( sDeviceDef, sDriverDef, sPortaDef )
.head 6 -  Call SalPrtSetup(sDevice,sDriver,sPorta,FALSE)
.head 3 +  Pushbutton: pbLimpar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Limpar
.head 4 -  Window Location and Size
.head 5 -  Left: 5.688"
.head 5 -  Top: 0.698"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Limpa os dados da tela'
.head 6 -  Set _sTipoComando = 'Limpa'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Pushbutton: pbSair
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Sair
.head 4 -  Window Location and Size
.head 5 -  Left: 5.688"
.head 5 -  Top: 0.99"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Sai desta tela'
.head 6 -  Set _sTipoComando = 'Sai'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Data Field: dfsAgenteEquip
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000800 7461624C6F746500 000000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.488"
.head 6 -  Top: 0.365"
.head 6 -  Width:  3.05"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  Set _bNuncaHabilitado = TRUE
.head 6 -  Set _bÉCampoDescrição = TRUE
.head 6 -  Set _sConsultaDescrição = 'exec dbinfracao..AgenteEquipS_desc_sint @Cod = :frmRelMultasCanceladas.dfnAgenteEquip,
                                             @OrgaoAutuante = :frmRelMultasCanceladas.dfnOrgao'
.head 6 -  Set _bÉDependente = TRUE
.head 6 -  Set _sCamposResponsaveis[0] = 'dfnAgenteEquip'
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sNomeParaMsgs = ''
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 -  On MSG_Habilita1
.head 3 +  Data Field: dfsOrgao
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000800 7461624C6F746500 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.5"
.head 6 -  Top: 0.073"
.head 6 -  Width:  3.05"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bNuncaHabilitado = TRUE
.head 6 -  Set _bÉCampoDescrição = TRUE
.head 6 -  Set _sConsultaDescrição ='exec OrgaoAutuanteS_desc_sintRest @Cod = :frmRelMultasCanceladas.dfnOrgao, @SetorReduzido=:frmRelMultasCanceladas.nSetorReduzido'
.head 6 -  Set _bÉDependente = TRUE
.head 6 -  Set _sCamposResponsaveis[0] = 'dfnOrgao'
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  !
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sNomeParaMsgs = ''
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 -  On MSG_Habilita1
.head 3 -  Frame
.head 4 -  Resource Id: 54588
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.038"
.head 5 -  Top: 0.031"
.head 5 -  Width:  6.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.542"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 -  Background Text: Município:
.head 4 -  Resource Id: 44865
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.413"
.head 5 -  Top: 0.74"
.head 5 -  Width:  0.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfsSaida
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.738"
.head 6 -  Top: 2.656"
.head 6 -  Width:  0.425"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = FALSE
.head 6 -  Set _sValorDefault = 'I'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  ! cQCK1DataField: dfnOrgao
.head 4 +    Message Actions
.head 5 +    On SAM_Create
.head 6 -    Set _bVisivel = FALSE
.head 6 -    Set _bPermiteNulos = TRUE
.head 6 -    Set _bNuncaHabilitado = TRUE
.head 6 -    Set _sTipoMsgNulo = 'PADRAO'
.head 6 -    Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  ! cQCK1DataField: dfMensagem
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.488"
.head 6 -  Top: 2.76"
.head 6 -  Width:  5.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Teal
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = ''
.head 6 -  Set _bNuncaHabilitado = TRUE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  ! cQCK1DataField: dfTexto
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.488"
.head 6 -  Top: 2.677"
.head 6 -  Width:  3.05"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.229"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Teal
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = ''
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bCompChaveOpcionalParaPesquisa = FALSE
.head 6 -  Set _bComponenteChave = TRUE
.head 6 -  Set _bDisparaConsultaEmValidate = FALSE
.head 6 -  Set _bPermiteNulos = FALSE
.head 6 -  !
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sNomeParaMsgs = ''
.head 6 -  Set _sConsultaFrmOpcoesSQLOuSP = ''
.head 6 -  Set _sConsultaFrmOpcoesCampo = ''
.head 6 -  Set _bNuncaHabilitado = TRUE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Data Field: dfArquivo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.738"
.head 6 -  Top: 2.656"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = ''
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bCompChaveOpcionalParaPesquisa = FALSE
.head 6 -  Set _bComponenteChave = TRUE
.head 6 -  Set _bDisparaConsultaEmValidate = FALSE
.head 6 -  Set _bPermiteNulos = FALSE
.head 6 -  !
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sNomeParaMsgs = ''
.head 6 -  Set _sConsultaFrmOpcoesSQLOuSP = ''
.head 6 -  Set _sConsultaFrmOpcoesCampo = ''
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  ! On PAM_SetaFoco
.head 6 -    Call SalSendClassMessage( PAM_SetaFoco, wParam, lParam )
.head 5 -  ! On PAM_SetaFoco
.head 3 +  Picture: picSemaforo
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1Form
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.038"
.head 5 -  Top: 2.656"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Agente/
Equipamentos:
.head 4 -  Resource Id: 54589
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1BackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 0.323"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 2 +  Functions
.head 3 +  ! Function: fMontaArquivo
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sTexto
.head 5 -  String: sArquivo
.head 5 -  Number: nRegistros
.head 5 -  File Handle: hArquivo
.head 5 -  Number: nProximo
.head 5 -  Boolean: bok
.head 5 -  String: sSequencial
.head 4 +  Actions 
.head 5 -  ! Set sArquivo = 'C:\\'||SalNumberToStrX(SalDateYear( SalDateCurrent(  )),0)||
SalNumberToStrX(SalDateMonth( SalDateCurrent(  )),0 )||SalNumberToStrX(SalDateDay( SalDateCurrent( )),0 )||"."||SalStrMidX( SalNumberToStrX(dfnOrgao,0), 0, 3 )
.head 5 -  Call SalHideWindow( dfArquivo )
.head 5 -  Call SalHideWindow( dfTexto )
.head 5 -  ! Call SalShowWindow( dfMensagem )
.head 5 -  Set sArquivo = 'C:\\'||dfArquivo||"."||SalStrMidX( SalNumberToStrX(dfnOrgao,0), 0, 3 )
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set dfMensagem = 'GERANDO O ARQUIVO: '||sArquivo
.head 5 -  ! Call SalModalDialog( dlgEsperaGeracao, frmRelMultasPagas )
.head 5 -  ! Set dlgEsperaGeracao.dfArquivo = sArquivo
.head 5 -  ! Call fMPSPrepareProc( hSql, 'exec RelMultasNPagas @OrgaoAutuante = :frmRelMultasPagas.dfnOrgao,
@DataI = :frmRelMultasPagas.dfdInicial,  @DataF = :frmRelMultasPagas.dfdFinal,@Saida="A"',

.head 5 -  ! Call fMPSPrepareProc( hSql, 'exec dbinfracao..RelMultasImplantadas @OrgaoAutuante = :frmRelMultasCanceladas.dfnOrgao,
@DataI = :frmRelMultasCanceladas.dfdInicial,  @AgenteEquip=:frmRelMultasCanceladas.dfnAgenteEquip,@DataF = :frmRelMultasCanceladas.dfdFinal,@Saida="A"',
':sTexto')
.head 5 -  Call SybPrepareProc( hSql,'exec dbinfracao..MovimentoAutoS_rel_cancel 
@OrgaoAutuante = :frmRelMultasCanceladas.dfnOrgao,
@DataI = :frmRelMultasCanceladas.dfdInicial,  @AgenteEquip=:frmRelMultasCanceladas.dfnAgenteEquip,
@DataF = :frmRelMultasCanceladas.dfdFinal,@TelaNova = "S",@Competencia = :frmRelMultasCanceladas.cmbCompetencia,
@Municipio = :frmRelMultasCanceladas.dfnMunicipio',
':sNomeOrgao, :sPlaca, :sUF, :sSerie, :nAuto, :nDigito, :nNotificacao, :nProcesso, :nInfracao, :dData,
 :sUsuarioCancel, :nValor, :sMotivo,:sNomeUsuarioCanc' )
.head 5 +  If NOT SqlExecute( hSql )
.head 6 -  Call SalMessageBeep( 0 )
.head 6 -  Call SalMessageBox( 'Ocorreu um erro durante a execução. Chame o Analista Responsável.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set bok =  SalFileOpen( hArquivo, sArquivo,OF_Write|OF_Create )
.head 5 +  If not bok
.head 6 -  Call SalMessageBeep( 0 )
.head 6 -  Call SalMessageBox( 'Ocorreu um erro durante a abertura do arquivo txt. Chame o Analista Responsável.', 'Atenção', MB_Ok | MB_IconExclamation )
.head 5 -  Set nRegistros = 0
.head 5 -  Call SqlFetchNext( hSql, nProximo )
.head 5 -  !
.head 5 +  Loop 
.head 6 +  If nProximo = FETCH_EOF
.head 7 -  Break 
.head 6 -  Set nRegistros = nRegistros + 1
.head 6 -  Set sSequencial = SalStrRepeatX( '0', 8-SalStrLength(SalNumberToStrX( nRegistros, 0 )))||SalNumberToStrX( nRegistros, 0 )
.head 6 -  Call SalFilePutStr( hArquivo, sSequencial||sTexto )
.head 6 -  Call SqlFetchNext( hSql, nProximo )
.head 5 -  Call SalFileClose( hArquivo )
.head 5 -  Call SalMessageBox(  'O ARQUIVO: '||sArquivo ||' FOI GERADO COM SUCESSO', 'ATENÇÃO', MB_IconExclamation )
.head 5 -  Set dfMensagem = ''
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 +  If SalMessageBox( 'Deseja visualizar o layout do arquivo gerado?', 'Atenção',MB_YesNo )=IDYES
.head 6 -  Set hWndReport = SalCreateWindow( frmReportView, hWndForm )
.head 6 -  Call SalReportView( frmRelMultasCanceladas, hWndReport, 'Mulimp.qrp',
'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, dCorrente, SqlUser,dfdInicial, dfdFinal, dfsOrgao',
'Secretaria, Detran, Setor, DesSetor, DataCorrente, Usuario, DataI, DataF, OrgaoAutuante', nErro)
.head 5 -  Call SalSendMsgToChildren( frmRelMultasCanceladas, MSG_Limpa,wParam,lParam )
.head 5 -  Return TRUE
.head 3 +  Function: VerificaRelatório
.head 4 -  Description: Verifica se existem dados para impressão
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bSaidaOk
.head 5 -  Sql Handle: SqlVerifica
.head 5 -  ! String: sNomeOrgao
.head 5 -  ! String: sPlaca
.head 5 -  ! String: sUF
.head 5 -  ! String: sSerie
.head 5 -  ! Number: nAuto
.head 5 -  ! Number: nDigito
.head 5 -  ! Number: nNotificacao
.head 5 -  ! Number: nProcesso
.head 5 -  ! Number: nInfracao
.head 5 -  ! Date/Time: dData
.head 4 +  Actions
.head 5 -  ! Limpando as variáveis
.head 5 -  Set sNomeOrgao = ''
.head 5 -  Set sPlaca = ''
.head 5 -  Set sUF = ''
.head 5 -  Set sSerie = ''
.head 5 -  Set nAuto = 0
.head 5 -  Set nDigito = 0
.head 5 -  Set nNotificacao = 0
.head 5 -  Set nProcesso = 0
.head 5 -  Set nInfracao = 0
.head 5 -  Set sUsuarioCancel = ''
.head 5 -  Set nValor = 0
.head 5 -  Set sMotivo = ''
.head 5 -  Set sNomeUsuarioCanc = ''
.head 5 -  Set nMatriculaAgente = 0
.head 5 -  Set sNomeAgente = ''
.head 5 -  Set sNomeOrgaoLotacao = ''
.head 5 -  Set sDataInfracao = ''
.head 5 -  !
.head 5 -  Set bSaidaOk = TRUE
.head 5 -  !
.head 5 -  !
.head 5 +  If NOT fMPSConnect (SqlVerifica)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If NOT fMPSPrepareProc (SqlVerifica,
		'exec dbinfracao..MovimentoAutoS_rel_cancel 
@OrgaoAutuante = :frmRelMultasCanceladas.dfnOrgao,
@DataI = :frmRelMultasCanceladas.dfdInicial,  @AgenteEquip=:frmRelMultasCanceladas.dfnAgenteEquip,
@DataF = :frmRelMultasCanceladas.dfdFinal,@TelaNova = "S",@Competencia = :frmRelMultasCanceladas.cmbCompetencia,
@Municipio = :frmRelMultasCanceladas.dfnMunicipio',
':sNomeOrgao, :sPlaca, :sUF, :sSerie, :nAuto, :nDigito, :nNotificacao, :nProcesso, :nInfracao, :dData,
 :sUsuarioCancel, :nValor, :sMotivo,:sNomeUsuarioCanc,
:nMatriculaAgente, :sNomeAgente, :sNomeOrgaoLotacao, :sDataInfracao' )
.head 6 -  Call SqlDisconnect(SqlVerifica)
.head 6 -  Set bSaidaOk =  FALSE
.head 5 +  If NOT SqlExecute (SqlVerifica)
.head 6 -  ! Call SqlDisconnect(SqlVerifica)
.head 6 -  ! Return FALSE
.head 6 -  Set bSaidaOk =  FALSE
.head 5 -  !
.head 5 -  Call SqlGetResultSetCount( SqlVerifica, nErro )
.head 5 -  Call SqlFetchNext( SqlVerifica, nErro )
.head 5 -  ! Call SqlDisconnect(SqlVerifica)
.head 5 -  Call fMPSDisconnect( SqlVerifica )
.head 5 -  !
.head 5 +  If sNomeOrgao = ''
.head 6 -  Set bSaidaOk =  FALSE
.head 5 -  !
.head 5 -  Return bSaidaOk
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  ! Variáveis para a impressão
.head 3 -  Date/Time: dCorrente
.head 3 -  String: sTipoArquivo
.head 3 -  Date/Time: dCriacao
.head 3 -  String: sArquivo
.head 3 -  Long String: lsDiretorio
.head 3 -  Date/Time: dPeriodoIni
.head 3 -  Date/Time: dPeriodoFin
.head 3 -  Number: nRegistros
.head 3 -  Number: nValor
.head 3 -  ! Adilson
.head 3 -  Number: nValorEmUFIR
.head 3 -  Number: nValorDaUFIR
.head 3 -  Number: nValorEmReal
.head 3 -  Number: nValorComDesconto
.head 3 -  ! adilson Fim
.head 3 -  String: sAuto
.head 3 -  String: sInfracao
.head 3 -  String: sSerie
.head 3 -  String: sOrgaoAutuante
.head 3 -  Date/Time: dDataImplantacao
.head 3 -  ! Para mais de um result set
.head 3 -  Boolean: bAux
.head 3 -  Boolean: bAbortaImpressao
.head 3 -  String: sStored
.head 3 -  ! Variáveis 'padrão' de relatório
.head 3 -  Number: nErro
.head 3 -  String: sDevice
.head 3 -  String: sDriver
.head 3 -  String: sPorta
.head 3 -  String: sDeviceDef
.head 3 -  String: sDriverDef
.head 3 -  String: sPortaDef
.head 3 -  Window Handle: hWndReport
.head 3 -  Number: nSetorReduzido
.head 3 -  Number: nSetorUsuario
.head 3 -  String: sSetorUsuarioN
.head 3 -  String: sPlaca
.head 3 -  String: sUF
.head 3 -  String: sNomeOrgao
.head 3 -  Number: nAuto
.head 3 -  Number: nDigito
.head 3 -  Number: nNotificacao
.head 3 -  String: sLocal
.head 3 -  Number: nProcesso
.head 3 -  Number: nInfracao
.head 3 -  Date/Time: dData
.head 3 -  String: sUsuarioCancel
.head 3 -  String: sMotivo
.head 3 -  String: sNomeUsuarioCanc
.head 3 -  Number: nMatriculaAgente
.head 3 -  String: sNomeAgente
.head 3 -  String: sNomeOrgaoLotacao
.head 3 -  String: sDataInfracao
.head 3 -  Sql Handle: hWndReportVw
.head 2 +  Message Actions
.head 3 +  ! Observações
.head 4 -    Autor: Roberto T. - 09/02/2000
.head 3 +  On SAM_Create
.head 4 -  Set _sTextoStatusBar = 'Tela de relatório de multas implantadas e não pagas'
.head 4 -  Set _nEstadoInicialForm = EF_Vazio
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call SalHideWindow( picSemaforo )
.head 4 -  Set nSetorReduzido=nGlobalSetor
.head 4 -  Set sSetorUsuarioN = SalStrMidX(SalNumberToStrX(nGlobalSetor,0),0,SalStrLength( SalNumberToStrX(nGlobalSetor,0) )-1)
.head 4 -  Set nSetorUsuario = SalStrToNumber(sSetorUsuarioN)
.head 3 +  ! On SAM_Destroy
.head 4 +  ! If hWndReport != hWndNULL
.head 5 -  Call SalSendMsg( hWndReport, SAM_Close, 0,0)
.head 4 -  Call SalSendClassMessage( SAM_Destroy, wParam, lParam )
.head 3 +  On SAM_ReportStart
.head 4 -  Call SalReportDlgOptions( SalNumberToWindowHandle( wParam ), 'Impressão', 'Imprimindo',
'Relatório de Multas Canceladas', 'Relatório de Multas Canceladas' )
.head 4 -  Return TRUE
.head 3 +  On SAM_ReportFetchInit
.head 4 -  Call SqlImmediate( 'select getdate() into :frmRelMultasCanceladas.dCorrente' )
.head 4 -  Call SybPrepareProc( hSql,'exec dbinfracao..MovimentoAutoS_rel_cancel 
@OrgaoAutuante = :frmRelMultasCanceladas.dfnOrgao,
@DataI = :frmRelMultasCanceladas.dfdInicial,  @AgenteEquip=:frmRelMultasCanceladas.dfnAgenteEquip,
@DataF = :frmRelMultasCanceladas.dfdFinal,@TelaNova = "S",@Competencia = :frmRelMultasCanceladas.cmbCompetencia,
@Municipio = :frmRelMultasCanceladas.dfnMunicipio',
':sNomeOrgao, :sPlaca, :sUF, :sSerie, :nAuto, :nDigito, :nNotificacao, :nProcesso, :nInfracao, :dData,
 :sUsuarioCancel, :nValor, :sMotivo,:sNomeUsuarioCanc,
:nMatriculaAgente, :sNomeAgente, :sNomeOrgaoLotacao, :sDataInfracao' )
.head 4 +  If NOT SqlExecute( hSql )
.head 5 -  Return FALSE
.head 4 -  Return SqlGetResultSetCount( hSql, nErro )
.head 3 +  On SAM_ReportFetchNext
.head 4 -  Call SqlFetchNext( hSql, nErro )
.head 4 +  If nErro != FETCH_EOF
.head 5 -  Return TRUE
.head 4 +  Else
.head 5 -  Return FALSE
.head 3 +  On SAM_ReportFinish
.head 4 -  Call SalPrtSetDefault(sDeviceDef,sDriverDef,sPortaDef)
.head 0 -  
  