Application Description: Centura SQLWindows Standard Application Template
	Outline Version - 4.0.28
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000002F0100 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77731B646C
0080: 674167656E746545 71756970436F6E76 44656C6567616361 6F
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left: -0.013"
			Top: 0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left: 4.15"
			Top: 1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left: 0.575"
			Top: 0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left: 6.388"
			Top: 0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: detran_funcoes.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Number: #000
			Number: #000
			Number: ###000
			Number: ###000;'($'###000')'
			Number: ###000
			Input: 9
			Input: 9,99
			Input: #9.99
			Input: 999.999.99
			Input: 999.999,99
			Input: 999.99
			Input: 999,99
			Input: 999999
			Number: ###000
			Number: ###000
			Input: 9.999,99
			Input: #.##9,99
			Number: ###000
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
			Enumerations
		Resources
		Variables
.data RESOURCE 0 0 1 2801029132
0000: 2200000013000000 0000000000000000 0200000100000005 020000D019000000
0020: 01FE00FF03
.enddata
		Internal Functions
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 1443028049
0000: AC030000CA010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666FC2003C00 000A630051434B31
0040: 47657261006C0202 00001100001E0004 0000C20003000000 FF7F048300190000
0060: 00F001000000FF1F 1D0000AC00190001 FD00FF0736000000 196B000100FFFFC1
0080: 4F00000019DA0001 00FF7F68B0000000 0400F4020000FF1F 6C0000AC00040002
00A0: FD00FF0770000000 046B000200FFFFC1 7400000004DA0002 00FF7F78B0000000
00C0: 0400F60200FF1F7C 0000AC00040002FD 00FF17800000046B 000200FFFFC18400
00E0: 000004DA000200FF 7F88B00000000400 F60200FF1F8C0000 AC00190001FD00FF
0100: 07A5000000196B00 0100FFFFC1BE0000 0004DA000200FF7F 0180803E00000001
0120: 0070000E63514340 6F6E7461696E7220 AA0000000500006F 0400E801020000FF
0140: C18001000000BF04 190019000101FA00 007F80F20100000F 0800000096190001
0160: 00FE00FF83210000 0004B5000200FFFF 60250000001900ED 0100FF3F01806404
0180: 0000020038086351 4D44804922000000 0100DE0004DA0002 00FF7F01CC800400
01A0: 0370000D63514300 6865636B426F7822 A20000010000B704 00F60200FF1F0180
01C0: 0433000400060063 4461646F732200D1 000100005B040002 FB00FF0F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton:
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
			ActiveX:
		Application Actions
	Dialog Box: dlgAgenteEquipConvDelegacao
		Class: cQCK1DialogBox
		Property Template:
		Class DLL Name:
		Title: Renovação do Convênio de Delegação
		Accessories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left: 3.825"
				Top: 1.271"
				Width:  7.283"
				Width Editable? Class Default
				Height: 1.69"
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: ------------------------------------------------------------------------------------------------------------------------------------------------------------------
				Autor-Data: [faml] - Flávio Lago - 04/05/2016 - SPRINT JUNHO/2016 
				#486-Associar o cadastro do agente equipamento com o cadastro da regra de repasse por convênio de delegação.
				------------------------------------------------------------------------------------------------------------------------------------------------------------------
				[faml] Flávio Lago SPRINT 18-01-2017 #5878 Corrigir a associação do agente equipamento na regra do repasse
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
		Contents
			Frame
				Resource Id: 15528
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: -0.033"
					Top: 0.024"
					Width:  7.217"
					Width Editable? Yes
					Height: 1.298"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: 3D Face Color
			Background Text: Município:
				Resource Id: 46466
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 0.033"
					Top: 0.083"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Justify: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Data Field: dfnMunicipioRen
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 496E66726163616F 00000000
.enddata
.data CLASSPROPSSIZE
0000: 1C00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Number
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 1.45"
						Top: 0.048"
						Width:  0.85"
						Width Editable? Class Default
						Height: 0.24"
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Right
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 9999
				Message Actions
					On SAM_Create
						! ------------- código do município da tab Renovação
						Set _sTextoStatusBar = 'Município'
						Set _sNomeParaMsgs = 'Município'
						Set _bSempreHabilitado = TRUE
						Set _bNuncaHabilitado = FALSE
						Set _bDisparaConsultaEmValidate = FALSE
						Set _bVisivel = TRUE
						! Dados para a pesquisa F2
						! Set _bComponenteChave = TRUE
						Set _bCompChaveGeradoPeloSistema = TRUE
						Set _bCompChaveOpcionalParaPesquisa = TRUE
						Set _sConsultaFrmOpcoesSQLOuSP = 'SP'
						Set _sConsultaFrmOpcoesColunaOuParam = '@Desc'
						Set _sConsultaFrmOpcoesCampo= 'Exec dbvcen..MunicipioS_codigodesc2 @UF = PE'
						Set _sValorDefault= ' '
						! ----
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On MSG_Limpa
						Call SalSendClassMessage( MSG_Limpa, wParam, lParam )
					On UDM_AposPesquisa
						Call SalEnableWindow( pbRenovar )
			Data Field: dfsMunicipioRen
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 496E66726163616F 00000000
.enddata
.data CLASSPROPSSIZE
0000: 1C00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? No
				Display Settings
					Window Location and Size
						Left: 2.283"
						Top: 0.048"
						Width:  4.775"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						! ------------- descrição do município da tab Renovação
						Set _bVisivel = TRUE
						Set _bÉCampoDescrição = TRUE
						Set _bSempreHabilitado = FALSE
						Set _bNuncaHabilitado = TRUE
						Set _bPermiteNulos = TRUE
						! Pesquisa da descrição
						Set _bÉDependente = TRUE
						Set _sCamposResponsaveis[0] = 'dfnMunicipioRen'
						Set _sConsultaDescrição = 'exec dbvcen..MunicipioS_descricao2  @Cod = :dlgAgenteEquipConvDelegacao.dfnMunicipioRen'
						!
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
						!
			Background Text: Valor da Taxa Administrativa:
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 496E66726163616F 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 15525
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 0.05"
					Top: 0.417"
					Width:  3.513"
					Width Editable? Class Default
					Height: 0.167"
					Height Editable? Class Default
				Visible? Yes
				Justify: Left
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Data Field: dfnValorRepasseRen
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 496E66726163616F 00000000
.enddata
.data CLASSPROPSSIZE
0000: 1C00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Number
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 3.65"
						Top: 0.357"
						Width:  0.833"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Right
					Format: ###000
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Valor da nova taxa administrativa'
						Set _sNomeParaMsgs = 'Valor da nova taxa administrativa'
						!
						Set _bVisivel = TRUE
						Set _bPermiteNulos = FALSE
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = TRUE
						!
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					! !---- [faml] 03/02/215 - On SAM_KillFocus
					On SAM_KillFocus
						! !---- no convênio que não tiver valor por infração, o valor da infração local ficará o mesmo da taxa administrativa
						If dfnValorRepasseInfLeveRen = NUMBER_Null
							Set dfnValorRepasseInfLeveRen= dfnValorRepasseRen
							!
			Background Text: Valor da Taxa Administrativa Infração Leve:
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 496E66726163616F 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 15526
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 0.05"
					Top: 0.75"
					Width:  3.713"
					Width Editable? Class Default
					Height: 0.167"
					Height Editable? Class Default
				Visible? Yes
				Justify: Left
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Data Field: dfnValorRepasseInfLeveRen
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 496E66726163616F 00000000
.enddata
.data CLASSPROPSSIZE
0000: 1C00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Number
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 3.65"
						Top: 0.69"
						Width:  0.875"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Right
					Format: ###000
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Valor da nova taxa administrativa para infração local'
						Set _sNomeParaMsgs = 'Valor da nova taxa administrativa para infração local'
						!
						Set _bVisivel = TRUE
						Set _bPermiteNulos = FALSE
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = TRUE
						!
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_KillFocus
						! !---- no convênio que não tiver valor por infração, o valor da infração local ficará o mesmo da taxa administrativa
						If dfnValorRepasseInfLeveRen = NUMBER_Null
							Set dfnValorRepasseInfLeveRen= dfnValorRepasseRen
							!
			Background Text: Vigência (repasse a partir de mês/ano):
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 496E66726163616F 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 15527
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 0.05"
					Top: 1.06"
					Width:  3.2"
					Width Editable? Class Default
					Height: 0.167"
					Height Editable? Class Default
				Visible? Yes
				Justify: Left
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Data Field: dfdDataInclusaoRen
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 496E66726163616F 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Date/Time
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 3.65"
						Top: 1.0"
						Width:  0.9"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Right
					Format: MM-yyyy
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 99-9999
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Mês/ano da nova vigência'
						Set _sNomeParaMsgs = 'Mês/ano da nova vigência'
						!
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = TRUE
						!
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Pushbutton: pbRenovar
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 496E66726163616F 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Renovar
				Window Location and Size
					Left: 4.7"
					Top: 0.905"
					Width:  0.975"
					Width Editable? Class Default
					Height: 0.298"
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Renovar vigência de repasse'
						Set _bValidaCamposNulos = FALSE
						Set _sTipoComando = 'Arquiva'
						Set _sNroCamposIgnorados = 'NENHUM'
						!
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						! Valida valor do campo 'Valor da taxa Administrativa'
						If dfnValorRepasseRen = NUMBER_Null or dfnValorRepasseRen <= 0
							Call SalMessageBeep( MB_IconExclamation )
							Call SalMessageBox( 'Taxa de administração inválida ou não informada!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfnValorRepasseRen )
							Return FALSE
						! No convênio que não tiver valor por infração, o valor da infração local ficará o mesmo da taxa administrativa
						If dfnValorRepasseInfLeveRen != NUMBER_Null and dfnValorRepasseInfLeveRen <= 0
							Call SalMessageBeep( MB_IconExclamation )
							Call SalMessageBox( 'Taxa de administração para infração leve inválida! Se não tiver, informe o mesmo valor do campo taxa administrativa.', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfnValorRepasseInfLeveRen )
							Return FALSE
						! Valida valor do campo 'Vigência'
						If SalIsNull( dfdDataInclusaoRen )
							Call SalMessageBeep( MB_IconExclamation )
							Call SalMessageBox( 'Informe o mês/ano da nova vigência do convênio!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfdDataInclusaoRen )
							Return FALSE
						! !------ [faml]  04/05/2016
						! If dfdDataInclusaoRen <= dtVigenciaAtual
							Call SalMessageBeep( MB_IconExclamation )
							Call SalMessageBox( 'Nova vigência tem que ser maior que a vigência atual!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfdDataInclusaoRen )
							Return FALSE
						Set nAno= SalDateYear( dtCorrente )
						Set nMes= SalDateMonth( dtCorrente )
						If nMes < 10
							Set sAnoMesAtual= SalNumberToStrX( nAno,0 ) || '0' || SalNumberToStrX( nMes,0 ) 
						Else
							Set sAnoMesAtual= SalNumberToStrX( nAno,0 ) || SalNumberToStrX( nMes,0 ) 
						!
						Set nAno= SalDateYear( dtVigenciaAtual )
						Set nMes= SalDateMonth( dtVigenciaAtual )
						If nMes < 10
							Set sVigenciaAtual= SalNumberToStrX( nAno,0 ) || '0' || SalNumberToStrX( nMes,0 ) 
						Else
							Set sVigenciaAtual= SalNumberToStrX( nAno,0 ) || SalNumberToStrX( nMes,0 ) 
						!
						Set nAno= SalDateYear( dfdDataInclusaoRen )
						Set nMes= SalDateMonth( dfdDataInclusaoRen )
						If nMes < 10
							Set sNovaVigencia= SalNumberToStrX( nAno,0 ) || '0' || SalNumberToStrX( nMes,0 ) 
						Else
							Set sNovaVigencia= SalNumberToStrX( nAno,0 ) || SalNumberToStrX( nMes,0 ) 
						! --- [faml]  18-01-2017 - comeitei para deixar a critica da vigência apenas na rotina de banco
						! If SalStrToNumber( sNovaVigencia ) <= SalStrToNumber( sAnoMesAtual )
								or SalStrToNumber( sNovaVigencia ) < SalStrToNumber( sVigenciaAtual )
								or ( SalStrToNumber( sNovaVigencia ) <= SalStrToNumber( sVigenciaAtual ) and  (dfnValorRepasseRen != nValorRepasseRen or dfnValorRepasseInfLeveRen != nValorRepasseInfLeveRen) )
								or ( SalStrToNumber( sNovaVigencia ) >= SalStrToNumber( sAnoMesAtual ) and SalStrToNumber( sNovaVigencia ) < SalStrToNumber( sVigenciaAtual ) )
							Call SalMessageBeep( MB_IconExclamation )
							! --- [faml] 18-01-2017 - antes:  a vigência atual
							Call SalMessageBox( 'Nova vigência tem que ser maior que o mês/ano atual!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfdDataInclusaoRen )
							Return FALSE
							!
						!
						If SalMessageBox( 'Confirma a renovação do cadastro?', 'Confirmação', MB_IconQuestion|MB_YesNo ) = IDYES
							Call SalWaitCursor( TRUE ) !! --- [faml] 18-01-2017 - E TAMBEM, enviar para a rotina o dado @OrgaoAutuante
							! ------ RENOVAR VIGÊNCIA DO CADASTRO
							Call fMPSPrepareProc( hSqlApp, 'Exec dbarrecadacao..DebitoRepasseInfMunicipioI
										@Municipio	       = :dfnMunicipioRen
									,	@OrgaoAutuante	       = :nOrgaoAutuante
									,	@ValorRepasse	       = :dfnValorRepasseRen
									,	@DataInclusao	       = :dfdDataInclusaoRen
									,	@Operacao	       = N
									,	@Usuario		       = :SqlUser
									, 	@Tela		       = 1
									,	@ValorRepasseInfLeve= :dfnValorRepasseInfLeveRen
									,	@NovoAgenteEquip       = :dlgAgenteEquipConvDelegacao.nNovoAgenteEquip'
									,	'' )
							If SqlExecute( hSqlApp )
								Call SalWaitCursor( FALSE ) !! --- [faml] 18-01-2017
								Call SalMessageBeep( MB_IconExclamation )
								Call SalMessageBox( 'Vigência de repasse renovada com sucesso!', 'Atenção', MB_IconExclamation | MB_Ok )
								! !------- [faml]  04/05/2016 - antes: Call SalSendMsg ( pbLimpar, SAM_Click, wParam, lParam )
								Set bSair= TRUE	 !!------- [faml]  04/05/2016
								Call SalEndDialog(hWndForm, lParam)
								Return TRUE
							Call SalWaitCursor( FALSE ) !! --- [faml] 18-01-2017
			! ----- [faml] 04/05/2016 - antes tinha o botão pbLimpar
			! cQCK1PushButton: pbLimpar
.data CLASSPROPSSIZE
0000: 3A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002700 5469706F09496E66 726163616F094361
0020: 64617374726F0952 6567726109486973 746F7269636F0000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr class Pushbutton:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Limpar
				Window Location and Size
					Left: 5.883"
					Top: 1.071"
					Width:  1.017"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
.end
				Message Actions 
					On SAM_Create
						Set _sTextoStatusBar = 'Limpar tela'
						Set _sTipoComando = 'Limpa'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					! ---- [faml]  04/05/2016 - o botão limpar não estava funcionando, por isso o evento Click foi comentado 
					! On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
			! ----- [faml] 04/05/2016 - antes tinha o botão pbSair
			! cQCK1PushButton: pbSair
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002700 5469706F09496E66 726163616F094361
0020: 64617374726F0952 6567726109486973 746F7269636F0000 0000
.enddata
.data CLASSPROPSSIZE
0000: 3A00
.enddata
.winattr class Pushbutton:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Sair
				Window Location and Size
					Left: 7.133"
					Top: 1.536"
					Width:  0.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
.end
				Message Actions 
					On SAM_Create
						Set _sTextoStatusBar = 'Sair da tela'
						Set _sTipoComando = 'Sai'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalEndDialog(hWndForm, lParam)
		Functions
		Window Parameters
			Number: nCodCidade
			Number: nOrgaoAutuante
			Date/Time: dtVigenciaAtual
			Number: nNovoAgenteEquip
			Number: nValorRepasseRen	        	!!---- [faml] 04/05/2016
			Number: nValorRepasseInfLeveRen	!!---- [faml] 04/05/2016
		Window Variables
			Date/Time: dtCorrente
			! !------ [faml]  04/05/2016 - ini
			Boolean: bSair 
			Number: nAno
			Number: nMes
			String: sAnoMesAtual
			String: sVigenciaAtual
			String: sNovaVigencia
			! !-- fim
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
			On SAM_CreateComplete
				! -- [faml] 18-01-2017 - ini
				! Set dfnMunicipioRen = nCodCidade
				! Call SalSendMsg(dfnMunicipioRen, SAM_Validate, 0,0)
				!
				Set dfnMunicipioRen = nCodCidade
				!
				! SE órgão autuante DETRAN, pode ou não inforrmar o município
				If nOrgaoAutuante = 117100
					Call SalEnableWindow( dfnMunicipioRen )
					Call SalSetFocus( dfnMunicipioRen )
				!
				! SE órgão autuante DER ou DNIT, não precisa de município; sempre vai atualizar todos
				Else If nOrgaoAutuante = 300 or nOrgaoAutuante = 117200 
					Set dfnMunicipioRen = NUMBER_Null
					Set dfsMunicipioRen = STRING_Null
					Call SalDisableWindow( dfnMunicipioRen )
					Call SalSetFocus( dfnValorRepasseRen )
				!
				! SE órgão autuante municipal, não pode mudar o município
				Else
					Call SalDisableWindow( dfnMunicipioRen )
					Call SalSendMsg(dfnMunicipioRen, SAM_Validate, 0,0)
					Call SalSetFocus( dfnValorRepasseRen )
				! ---fim
				!
				! !---- [faml] 04/05/2016 - ini
				Call SqlImmediate( 'select getdate() into :dlgAgenteEquipConvDelegacao.dtCorrente' )
				Set dfnValorRepasseRen= nValorRepasseRen
				Set dfnValorRepasseInfLeveRen= nValorRepasseInfLeveRen
				Set dfdDataInclusaoRen= dtVigenciaAtual
				! -- [faml] 18-01-2017 antees:     Call SalSetFocus( dlgAgenteEquipConvDelegacao.dfdDataInclusaoRen )
				! -- fim
			On SAM_Close	!!------ [faml]  04/05/2016
				If bSair != TRUE
					Call SalMessageBeep( MB_IconExclamation )
					Call SalMessageBox( 'A vigência de repasse precisa ser renovada para que todos os equipamentos existam em uma mesma regra (vigência e valores)!', 'Atenção', MB_IconExclamation | MB_Ok )
					Return FALSE
					!

  