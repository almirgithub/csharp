Application Description: **************************************************************************************
		Projeto Divisão dos Sistemas em APL
		Adilson Santos-30.05.2006
		*************************************************************************************
	Outline Version - 4.0.28
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000000B0100 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left: -0.013"
			Top: 0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left: 4.15"
			Top: 1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left: 0.575"
			Top: 0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left: 6.388"
			Top: 0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: dlgEsperaPay&Go.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: Use Parent
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Input: 99/99/9999
			Number: ###000
			Number: ###000
			Date/Time: dd/MM/yyyy
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				Number: UMD_Continua		= SAM_User + 6
			Enumerations
		Resources
		Variables
.data RESOURCE 0 0 1 1005900463
0000: 2200000013000000 0000000000000000 02000001000000EE 030000D019000000
0020: 01FE00FF03
.enddata
			String: sServidorPayGo
			Boolean: bok
			File Handle: hFile
			File Handle: hFileSts
			Number: nTotalSelecionadoIPVA
			Number: nTotalSelecionadoDETRAN
			Number: nTotalSelecionadoFENASEG
			Number: nUltimoSequencial
			Number: nSequencialIPVA
			Number: nSequencialDETRAN
			Number: nSequencialFENASEG
			Number: nNSU
			String: sTextoOperador
			String: sTextoCliente
			String: sTipo
			Number: nStatus
			String: sTextoImp
			Number: nErro
			String: sVariaveis
			String: sVarQRP
			String: sVarSQLWindows
			Number: nOrderBy
			Date/Time: dDataImp
			Number: nValor
			String: sOndeTermina
			Sql Handle: hSqlPayGo
			Sql Handle: hSqlPayGoImpressao
			Number: nRetorno
			String: strTexto
			String: sTransacao
			String: sTransacaoADM
			Number: nSequencialCancelamento
			Number: nRow
			Number: nTeste
			String: sRede
			Boolean: bEstornaDebito
			Boolean: bTelaCancelamento 
			String: sPermiteCancelar
		Internal Functions
			Function: fGravaArquivoIntPos
				Description:
				Returns
				Parameters
					Number: pTotalSelecionado
				Static Variables
				Local variables
					String: strTexto
				Actions
					Set sTransacao = 'CRT'
					If NOT fMPSConnect(hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Ocorreu um erro durante o processamento a transação não será concluída", "MENSAGEM", MB_IconExclamation )
						Call fFileDeleteIntPos()
						Return FALSE
					If SalFileOpen( hFile, SalStrMidX(sServidorPayGo,0,24)||'001', OF_Exist )
						Call SalMessageBox( "A transação com cartão anterior não foi completada, entre em contato com o CPD", "MENSAGEM", MB_IconExclamation )
						Return FALSE
					Set bok =  SalFileOpen( hFile, sServidorPayGo,OF_Write|OF_Create )
					If Not bok
						Call SalMessageBox( "Erro durante a abertura do arquivo de cartão de débito", "MENSAGEM", MB_IconExclamation )
						Return FALSE
					! If fMPSConnect (hSqlPayGo)
						! Call SqlSetInMessage( hSqlPayGo, 10000 )
					If NOT fMPSPrepareProc( hSqlPayGo, 'exec dbarrecadacao..CartaoCreditoUltSequencial',
							':nUltimoSequencial' )
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					If NOT SqlExecute( hSqlPayGo)
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					Call SqlFetchNext(hSqlPayGo,nRetorno)
					!
					If NOT fMPSPrepareProc( hSqlPayGo, 'exec dbarrecadacao..PGGeraIntPosI @Sequencial = :nUltimoSequencial, 
							            @Valor = :pTotalSelecionado, @Tipo = :sTipo, @Cartao = :sRede,@TipoOperacao = "CRT"',':strTexto,:sOndeTermina' )
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Return FALSE
					If NOT SqlExecute( hSqlPayGo)
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					Call SqlFetchNext(hSqlPayGo,nRetorno)
					While nRetorno != FETCH_EOF
						Call SalFilePutStr( hFile,strTexto)
						Call SqlFetchNext(hSqlPayGo,nRetorno)
					Call SalFileClose( hFile )
					If NOT fMPSDisconnect(hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Ocorreu um erro durante o processamento a transação não será concluída", "MENSAGEM", MB_IconExclamation )
						Call fFileDeleteIntPos()
						Return FALSE
					If sTipo	=	'0'
						Set nSequencialIPVA = nUltimoSequencial
					If sTipo	=	'1'
						Set nSequencialFENASEG = nUltimoSequencial
					If sTipo	=	'2'
						Set nSequencialDETRAN = nUltimoSequencial
					If VisFileRename(sServidorPayGo, SalStrMidX(sServidorPayGo,0,24)||'001' ) = TRUE
						Call VisFileDelete( sServidorPayGo )
					Else
						Call SalMessageBox( "Erro durante a rename do arquivo IntPos.tmp para IntPos.001, tente novamente", "MENSAGEM", MB_IconExclamation )
						Call VisFileDelete( sServidorPayGo )
						Return FALSE
					Return fEsperaArquivoRetorno(sRede) 
			Function: fEsperaArquivoRetorno
				Description:
				Returns
				Parameters
					String: psBandeiraCartao
				Static Variables
				Local variables
				Actions
					Set nStatus = 999
					! Set sTransacao = 'CRT'  30/05/2006
					Set nTeste = SalModalDialog( dlgEsperaPayGo, hWndForm, sOndeTermina )
					If nTeste = 0
						If NOT fGravaRespostaPayGo()
							Return FALSE
						Else
							If nStatus = 0 AND sTransacao = 'CRT'
								! Inserido aqui 19/12/2006
								If NOT fEfetuaBaixa(psBandeiraCartao)
									Return FALSE
								! fim 
							If not fGravaArquivoConfirmacao()
								Return FALSE
							Return fImprimeComprovante()  
					Else
						Return FALSE
					Return TRUE
			Function: fGravaRespostaPayGo
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTexto
					Number: nIndice
					Number: nNSU
				Actions
					Set bok =  SalFileOpen( hFile, 'C:\\TEF_DIAL\\RESP\\IntPos.001',OF_Read|OF_Share_Exclusive )
					If Not bok
						Call SalMessageBox( "Erro durante a abertura do arquivo C:\\TEF_DIAL\\RESP\\IntPos.001 a Transação não será concluída", "MENSAGEM", MB_IconExclamation )
						Call fFileDeleteIntPos()
						Return FALSE
					Set nIndice = 0
					Set nNSU = NUMBER_Null
					Set sTextoOperador = ''
					Set sTextoCliente = ''
					Set sTexto = ''
					Call fMPSConnect( hSqlPayGo )
					Loop
						If SalFileGetStr( hFile, sTexto, 200 )
							If NOT fMPSPrepareProc( hSqlPayGo, 'exec dbarrecadacao..PGRespTransacaoI  @Sequencial = :nUltimoSequencial, @Texto = :sTexto,@Tipo = :sTipo', 
									':nNSU,:sTextoOperador,:sTextoCliente')
								Call fMPSDisconnect( hSqlPayGo )
								Call SalWaitCursor( FALSE )
								Call SalMessageBox( "Ocorreu um erro ao tentar executar a procedure dbarrecadacao..PGRespTransacaoI", "MENSAGEM", MB_IconExclamation )
								Return FALSE
							If NOT SqlExecute( hSqlPayGo )
								Call fMPSDisconnect( hSqlPayGo )
								Call SalWaitCursor( FALSE )
								Call SalMessageBox( "Ocorreu um erro durante o processamento a transação não será concluída", "MENSAGEM", MB_IconExclamation )
								Call fFileDeleteIntPos()
								Return FALSE
						Else
							Break
					If NOT fMPSDisconnect(hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Ocorreu um erro durante o processamento a transação não será concluída", "MENSAGEM", MB_IconExclamation )
						Call fFileDeleteIntPos()
						Return FALSE
					Call fMPSConnect( hSqlPayGo )
					If NOT fMPSPrepareProc( hSqlPayGo, 'exec dbarrecadacao..PGRespTransacaoS  @Sequencial = :nUltimoSequencial', 
							':nNSU,:sTextoOperador,:sTextoCliente,:nStatus')
						Call fMPSDisconnect( hSqlPayGo )
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Ocorreu um erro ao tentar executar a procedure dbarrecadacao..PGRespTransacaoS", "MENSAGEM", MB_IconExclamation )
						Call fGravaArquivoCancelamento()
						Return FALSE
					If NOT SqlExecute( hSqlPayGo )
						Call fMPSDisconnect( hSqlPayGo )
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Ocorreu um erro durante o processamento a transação não será concluída", "MENSAGEM", MB_IconExclamation )
						Call fGravaArquivoCancelamento()
						Call fFileDeleteIntPos()
						Return FALSE
					Call SqlFetchNext( hSqlPayGo, nRetorno )
					If NOT fMPSDisconnect(hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Ocorreu um erro durante o processamento a transação não será concluída", "MENSAGEM", MB_IconExclamation )
						Call fFileDeleteIntPos()
						Return FALSE
					Call fFileDeleteIntPos()
					If nStatus !=0
						If sTextoOperador != ''
							Call SalMessageBox( sTextoOperador, "MENSAGEM", MB_IconExclamation )
						Return FALSE
					Return TRUE
			Function: fImprimeComprovante
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If fMPSConnect( hSqlPayGoImpressao )
						Call SqlSetInMessage( hSqlPayGoImpressao, 1000 )
						Call SalStrSetBufferLength( sTextoImp, 1000 )
						Call fMPSPrepareProc( hSqlPayGoImpressao, 'exec dbarrecadacao..PGImprimeComprovanteS @Sequencial =  :nUltimoSequencial, @Transacao = :sTransacaoADM',
								':sTextoImp,:nValor,:nOrderBy')
						If NOT SqlExecute( hSqlPayGoImpressao )
							Call fGravaArquivoCancelamento()
							Return FALSE
					! If rbImpressora
					Set sTransacao = 'CRT'
					! TESTE EM TELA
					! If sTransacaoADM = 'ADM'
						Call SalReportView( hWndMDI, hWndNULL, 'CompTef.qrp','sTextoImp,nValor',
								                               'Texto,Valor', nErro)
					! Else
						Call SalReportView( hWndForm, hWndNULL, 'CompTef.qrp','sGlobalSecretaria,sGlobalDetran,nGlobalSetor, sGlobalSetor, 
								                                dDataImp, SqlUser,hWndForm.dfsChassi, hWndForm.dfnRenavam, hWndForm.dfsPlaca,
								                                sTextoImp,nValor',
								                               'Secretaria,Detran,Setor, NomeSetor, DataImp, Usuario, Chassi, Renavam, Placa,Texto,Valor', nErro)
					! FIM TESTE EM TELA
					! Call SqlImmediate( 'select getdate() into :dDataImp' )
					! Call SqlClearImmediate(  )
					If sTransacaoADM = 'ADM'
						Call SalReportPrint( hWndMDI,  'CompTef.qrp','sTextoImp,nValor',
								                               'Texto,Valor',  1,RPT_PrintAll,0,0, nErro)
					Else
						Call SalReportPrint( hWndForm,'CompTef.qrp','sGlobalSecretaria,sGlobalDetran,nGlobalSetor, sGlobalSetor, 
								                                dDataImp, SqlUser,hWndForm.dfsChassi, hWndForm.dfnRenavam, hWndForm.dfsPlaca,
								                                sTextoImp,nValor',
								                               'Secretaria,Detran,Setor, NomeSetor, DataImp, Usuario, Chassi, Renavam, Placa,Texto,Valor', 1,RPT_PrintAll,0,0, nErro )
					Call SqlClose( hSqlPayGoImpressao )
					! Call SalPostMsg( hWndForm, UMD_Continua, wParam, lParam )
					Return TRUE
			Function: fReImprimeComprovante
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If fMPSConnect( hSqlPayGoImpressao )
						Call SqlSetInMessage( hSqlPayGoImpressao, 1000 )
						Call SalStrSetBufferLength( sTextoImp, 1000 )
						Call fMPSPrepareProc( hSqlPayGoImpressao, 'exec dbarrecadacao..PGConsultaTransacaoS @Sequencial =  :nUltimoSequencial, @Imprimir = "S"',
								':sTextoImp,:nValor,:nOrderBy')
						If NOT SqlExecute( hSqlPayGoImpressao )
							! Call fGravaArquivoCancelamento() 31/05/2006
							Return FALSE
					! If rbImpressora
					Set sTransacao = 'CRT'
					! Call SalReportView( hWndForm, hWndNULL, 'CompTef.qrp','sGlobalSecretaria,sGlobalDetran,nGlobalSetor, sGlobalSetor, 
							                                dDataImp, SqlUser,hWndForm.dfsChassi, hWndForm.dfnRenavam, hWndForm.dfsPlaca,
							                                sTextoImp,nValor',
							                               'Secretaria,Detran,Setor, NomeSetor, DataImp, Usuario, Chassi, Renavam, Placa,Texto,Valor', nErro)
					! Call SqlImmediate( 'select getdate() into :dDataImp' )
					! Call SqlClearImmediate(  )
					Call SalReportPrint( hWndForm,'CompTef.qrp','sGlobalSecretaria,sGlobalDetran,nGlobalSetor, sGlobalSetor, 
							                                dDataImp, SqlUser,hWndForm.dfsChassi, hWndForm.dfnRenavam, hWndForm.dfsPlaca,
							                                sTextoImp,nValor',
							                               'Secretaria,Detran,Setor, NomeSetor, DataImp, Usuario, Chassi, Renavam, Placa,Texto,Valor', 1,RPT_PrintAll,0,0, nErro )
					Call SqlClose( hSqlPayGoImpressao )
					! Call SalPostMsg( hWndForm, UMD_Continua, wParam, lParam )
					Return TRUE
			Function: fConsultaComprovante
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If fMPSConnect( hSqlPayGoImpressao )
						Call SqlSetInMessage( hSqlPayGoImpressao, 1000 )
						Call SalStrSetBufferLength( sTextoImp, 1000 )
						Call fMPSPrepareProc( hSqlPayGoImpressao, 'exec dbarrecadacao..PGImprimeComprovanteS @Sequencial =  :nUltimoSequencial',
								':sTextoImp,:nValor,:nOrderBy')
						If NOT SqlExecute( hSqlPayGoImpressao )
							Call fGravaArquivoCancelamento()
							Return FALSE
					! If rbImpressora
					Set sTransacao = 'CRT'
					! Call SalReportView( hWndForm, hWndNULL, 'CompTef.qrp','sGlobalSecretaria,sGlobalDetran,nGlobalSetor, sGlobalSetor, 
							                                dDataImp, SqlUser,hWndForm.dfsChassi, hWndForm.dfnRenavam, hWndForm.dfsPlaca,
							                                sTextoImp,nValor',
							                               'Secretaria,Detran,Setor, NomeSetor, DataImp, Usuario, Chassi, Renavam, Placa,Texto,Valor', nErro)
					Call SqlImmediate( 'select getdate() into :dDataImp' )
					Call SalReportPrint( hWndForm,'CompTef.qrp','sGlobalSecretaria,sGlobalDetran,nGlobalSetor, sGlobalSetor, 
							                                dDataImp, SqlUser,hWndForm.dfsChassi, hWndForm.dfnRenavam, hWndForm.dfsPlaca,
							                                sTextoImp,nValor',
							                               'Secretaria,Detran,Setor, NomeSetor, DataImp, Usuario, Chassi, Renavam, Placa,Texto,Valor', 1,RPT_PrintAll,0,0, nErro )
					Call SqlClose( hSqlPayGoImpressao )
					Return TRUE
			Function: fGravaArquivoConfirmacao
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					!
					Call fMPSConnect(hSqlPayGo)
					If NOT fMPSPrepareProc( hSqlPayGo, 'exec dbarrecadacao..PGGeraIntPosI @Sequencial = :nUltimoSequencial, 
							            @Valor = 0, @Tipo = :sTipo, @Cartao = :sRede, @TipoOperacao = "CNF"',':strTexto,:sOndeTermina' )
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					If NOT SqlExecute( hSqlPayGo)
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					Set bok =  SalFileOpen( hFile, sServidorPayGo,OF_Write|OF_Create )
					Call SqlFetchNext(hSqlPayGo,nRetorno)
					While nRetorno != FETCH_EOF
						Call SalFilePutStr( hFile,strTexto)
						Call SqlFetchNext(hSqlPayGo,nRetorno)
					!
					If NOT fMPSDisconnect(hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Ocorreu um erro durante o processamento a transação não será concluída", "MENSAGEM", MB_IconExclamation )
						Call fFileDeleteIntPos()
						Return FALSE
					Call SalFileClose( hFile )
					If VisFileRename(sServidorPayGo, SalStrMidX(sServidorPayGo,0,24)||'001' ) = TRUE
						Call VisFileDelete( sServidorPayGo )
					Else
						Call SalMessageBox( "Erro durante a rename do arquivo IntPos.tmp para IntPos.001, arquivo de confirmação", "MENSAGEM", MB_IconExclamation )
						Call VisFileDelete( sServidorPayGo )
						Return FALSE
					Return fEsperaArquivoRetornoConfirmacao()
			Function: fGravaArquivoADM
				Description:
				Returns
				Parameters
					String: psRede
				Static Variables
				Local variables
				Actions
					!
					Set sRede = psRede
					Call fMPSConnect(hSqlPayGo)
					If NOT fMPSPrepareProc( hSqlPayGo, 'exec dbarrecadacao..CartaoCreditoUltSequencial',
							':nUltimoSequencial' )
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					If NOT SqlExecute( hSqlPayGo)
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					Call SqlFetchNext(hSqlPayGo,nRetorno)
					If NOT fMPSPrepareProc( hSqlPayGo, 'exec dbarrecadacao..PGGeraIntPosI @Sequencial = :nUltimoSequencial, 
							            @Valor = 0, @Tipo = :sTipo, @Cartao = :sRede, @TipoOperacao = "ADM"',':strTexto,:sOndeTermina' )
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					If NOT SqlExecute( hSqlPayGo)
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					Set bok =  SalFileOpen( hFile, sServidorPayGo,OF_Write|OF_Create )
					Call SqlFetchNext(hSqlPayGo,nRetorno)
					While nRetorno != FETCH_EOF
						Call SalFilePutStr( hFile,strTexto)
						Call SqlFetchNext(hSqlPayGo,nRetorno)
					!
					If NOT fMPSDisconnect(hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Ocorreu um erro durante o processamento a transação não será concluída", "MENSAGEM", MB_IconExclamation )
						Call fFileDeleteIntPos()
						Return FALSE
					Call SalFileClose( hFile )
					If VisFileRename(sServidorPayGo, SalStrMidX(sServidorPayGo,0,24)||'001' ) = TRUE
						Call VisFileDelete( sServidorPayGo )
					Else
						Call SalMessageBox( "Erro durante a rename do arquivo IntPos.tmp para IntPos.001, arquivo de confirmação", "MENSAGEM", MB_IconExclamation )
						Call VisFileDelete( sServidorPayGo )
						Return FALSE
					Return fEsperaArquivoRetornoConfirmacao()
			Function: fEsperaArquivoRetornoConfirmacao
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nStatus = 999
					Set nTeste = SalModalDialog( dlgEsperaPayGo, hWndForm , sOndeTermina )
					If nTeste = 0
						! COMENTADO ABAIXO 19/12/2006
						! If sTransacao = 'CRT'
							If NOT fEfetuaBaixa()
								Return FALSE
						Return TRUE
					Else
						Return FALSE
					Return TRUE
			Function: fGravaArquivoCancelamento
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: strTexto
				Actions
					! Para obter os dados da transação que será cancelada
					Set nSequencialCancelamento = nUltimoSequencial
					!
					Call fMPSConnect(hSqlPayGo)
					Set sTransacao = 'CNC'
					If NOT fMPSPrepareProc( hSqlPayGo, 'exec dbarrecadacao..CartaoCreditoUltSequencial',
							':nUltimoSequencial' )
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					If NOT SqlExecute( hSqlPayGo)
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					Call SqlFetchNext(hSqlPayGo,nRetorno)
					If NOT fMPSDisconnect(hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Ocorreu um erro durante o processamento a transação não será concluída", "MENSAGEM", MB_IconExclamation )
						Call fFileDeleteIntPos()
						Return FALSE
					!
					Call fFileDeleteIntPos()
					!
					Call fMPSConnect(hSqlPayGo)
					If NOT fMPSPrepareProc( hSqlPayGo, 'exec dbarrecadacao..PGGeraIntPosI @Sequencial = :nSequencialCancelamento, 
							            @Valor = 0, @Tipo = :sTipo, @Cartao = :sRede, @TipoOperacao = "CNC"',':strTexto,:sOndeTermina' )
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					If NOT SqlExecute( hSqlPayGo)
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					Set bok =  SalFileOpen( hFile, sServidorPayGo,OF_Write|OF_Create )
					Call SqlFetchNext(hSqlPayGo,nRetorno)
					While nRetorno != FETCH_EOF
						Call SalFilePutStr( hFile,strTexto)
						Call SqlFetchNext(hSqlPayGo,nRetorno)
					Call SalFileClose( hFile )
					If NOT fMPSDisconnect(hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Ocorreu um erro durante o processamento a transação não será concluída", "MENSAGEM", MB_IconExclamation )
						Call fFileDeleteIntPos()
						Return FALSE
					If VisFileRename(sServidorPayGo, SalStrMidX(sServidorPayGo,0,24)||'001' ) = TRUE
						Call VisFileDelete( sServidorPayGo )
					Else
						Call SalMessageBox( "Erro durante a rename do arquivo IntPos.tmp para IntPos.001, arquivo de confirmação", "MENSAGEM", MB_IconExclamation )
						Call VisFileDelete( sServidorPayGo )
						Return FALSE
					Return fEsperaArquivoRetornoCancelamento()
			Function: fEsperaArquivoRetornoCancelamento
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nStatus = 999
					! Set sTransacao = 'CNC' 30/05/2006
					Set nTeste = SalModalDialog( dlgEsperaPayGo, hWndForm , sOndeTermina )
					If nTeste = 0
						If fGravaRespostaPayGo()
							Call fFileDeleteIntPos()
							If fGravaArquivoConfirmacao()
								If NOT bEstornaDebito 
									Return fImprimeComprovanteCancelamento()
								Else
									If fImprimeComprovanteCancelamento()
										Return fEstornaDebito()
					Else
						Return FALSE
					Return TRUE
			Function: fImprimeComprovanteCancelamento
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If fMPSConnect( hSqlPayGoImpressao )
						Call SqlSetInMessage( hSqlPayGoImpressao, 1000 )
						Call SalStrSetBufferLength( sTextoImp, 1000 )
						! se o cancelamento for pela tela de consulta e cancelamento, o comprovante será impresso a partir da table MovimentoBaixa
						If bTelaCancelamento  
							Call fMPSPrepareProc( hSqlPayGoImpressao, 'exec dbarrecadacao..PGConsultaTransacaoS @Sequencial =  :nUltimoSequencial, @SequencialCancelado =:nSequencialCancelamento,@Imprimir= "S" ',
									':sTextoImp,:nValor,:nOrderBy')
						! se o cancelamento for durante o pré-atendimento o comprovante será impresso a partir tabela tmpFicha
						Else
							Call fMPSPrepareProc( hSqlPayGoImpressao, 'exec dbarrecadacao..PGImprimeComprovanteS @Sequencial =  :nUltimoSequencial, @SequencialCancelado =:nSequencialCancelamento ',
									':sTextoImp,:nValor,:nOrderBy')
						If NOT SqlExecute( hSqlPayGoImpressao )
							Call fGravaArquivoCancelamento()
							Return FALSE
					! If rbImpressora
					Set sTransacao = 'CNC'
					! Call SalReportView( hWndForm, hWndNULL, 'CompTef.qrp','sGlobalSecretaria,sGlobalDetran,nGlobalSetor, sGlobalSetor, 
							                                dDataImp, SqlUser,hWndForm.dfsChassi, hWndForm.dfnRenavam, hWndForm.dfsPlaca,
							                                sTextoImp,nValor',
							                               'Secretaria,Detran,Setor, NomeSetor, DataImp, Usuario, Chassi, Renavam, Placa,Texto,Valor', nErro)
					! Call SqlImmediate( 'select getdate() into :dDataImp' )
					! Call SqlClearImmediate(  )
					Call SalReportPrint( hWndForm,'CancTef.qrp','sGlobalSecretaria,sGlobalDetran,nGlobalSetor, sGlobalSetor, 
							                                dDataImp, SqlUser,hWndForm.dfsChassi, hWndForm.dfnRenavam, hWndForm.dfsPlaca,
							                                sTextoImp,nValor',
							                               'Secretaria,Detran,Setor, NomeSetor, DataImp, Usuario, Chassi, Renavam, Placa,Texto,Valor', 1,RPT_PrintAll,0,0, nErro )
					Call SqlClose( hSqlPayGoImpressao )
					! Call SalPostMsg( hWndForm, UMD_Continua, wParam, lParam )
					Return TRUE
			Function: fEfetuaBaixa
				Description:
				Returns
				Parameters
					String: psBandeiraCartao
				Static Variables
				Local variables
				Actions
					Call fMPSConnect(hSqlPayGo)
					If NOT fMPSPrepareProc( hSqlPayGo, "exec dbarrecadacao..PGBaixaCartaoDebI @Sequencial = :nUltimoSequencial, @BandeiraCartao ='" || psBandeiraCartao || "'",'' )
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Erro durante a baixa dos débitos, a transação será cancelada", "MENSAGEM", MB_IconExclamation )
						Call SalMessageBox( "O COMPROVANTE DE PAGAMENTO NÃO DEVE SER ENTREGUE AO USUÁRIO APENAS O DE CANCELAMENTO DA TRANSAÇÃO", "MENSAGEM", MB_IconExclamation )
						Call fGravaArquivoCancelamento()
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					If NOT SqlExecute( hSqlPayGo)
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Erro durante a baixa dos débitos, a transação será cancelada", "MENSAGEM", MB_IconExclamation )
						Call SalMessageBox( "O COMPROVANTE DE PAGAMENTO NÃO DEVE SER ENTREGUE AO USUÁRIO APENAS O DE CANCELAMENTO DA TRANSAÇÃO", "MENSAGEM", MB_IconExclamation )
						Call fGravaArquivoCancelamento()
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					Call fFileDeleteIntPos()
					If NOT fMPSDisconnect(hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Ocorreu um erro durante o processamento a transação não será concluída", "MENSAGEM", MB_IconExclamation )
						Call fFileDeleteIntPos()
						Return FALSE
					Return TRUE
			Function: fEstornaDebito
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set bEstornaDebito = FALSE
					Call fMPSConnect(hSqlPayGo)
					If NOT fMPSPrepareProc( hSqlPayGo, 'exec dbarrecadacao..PGEstornoPagtoI @Sequencial = :nSequencialCancelamento','' )
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Erro durante o estorno do pagamento, verifique se o(s) pagamento(s) pagamento(s) foi(ram) estonado(s)", "MENSAGEM", MB_IconExclamation )
						Call SalMessageBox( "Vefirique no sistema do cartão se a transação foi concluída.", "MENSAGEM", MB_IconExclamation )
						Call fGravaArquivoCancelamento()
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					If NOT SqlExecute( hSqlPayGo)
						Call fMPSDisconnect (hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Erro durante o estorno do pagamento, verifique se o(s) pagamento(s) pagamento(s) foi(ram) estonado(s)", "MENSAGEM", MB_IconExclamation )
						Call SalMessageBox( "Vefirique no sistema do cartão se a transação foi concluída.", "MENSAGEM", MB_IconExclamation )
						Call fGravaArquivoCancelamento()
						Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
						Return FALSE
					Call fFileDeleteIntPos()
					If NOT fMPSDisconnect(hSqlPayGo)
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Ocorreu um erro durante o processamento a transação não será concluída", "MENSAGEM", MB_IconExclamation )
						Call fFileDeleteIntPos()
						Return FALSE
					Return TRUE
			Function: fFileDeleteIntPos
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalFileClose( hFile )
					Call VisFileDelete( 'C:\\TEF_DIAL\\RESP\\IntPos.001' )
					Call VisFileDelete( 'C:\\TEF_DIAL\\RESP\\IntPos.sts' )
					Return TRUE
			Function: fPGImprimeComprovante
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SqlFetchNext( hSqlPayGoImpressao, nErro )
					If nErro != FETCH_EOF
						Return TRUE
					Else
						Return FALSE
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 3915204157
0000: D107000085030000 0000000000000000 0200000A00FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666FC2003C00 000A630051434B31
0040: 47657261006C0202 00001100001E0004 0000C20003000000 FF7F048300190000
0060: 00F001000000FF1F 1D0000AC00190001 FD00FF0736000000 196B000100FFFFC1
0080: 4F00000019DA0001 00FF7F68B0000000 0400F4020000FF1F 6C0000AC00040002
00A0: FD00FF0770000000 046B000200FFFFC1 7400000004DA0002 00FF7F78B0000000
00C0: 0400F60200FF1F7C 0000AC00040002FD 00FF17800000046B 000200FFFFC18400
00E0: 000004DA000200FF 7F88B00000000400 F60200FF1F8C0000 AC00190001FD00FF
0100: 07A5000000196B00 0100FFFFC1BE0000 0004DA000200FF7F 0180803E00000001
0120: 0070000E63514340 6F6E7461696E7200 AA00000005000000 6F0400E801020000
0140: FFC18001000000BF 04190019000101FA 00007F80F2010000 0F08000000961900
0160: 0100FE00FF832100 000004B5000200FF FF60250000001900 ED0100FF3F018064
0180: 0400000200380863 514D448049220000 000100DE0004DA00 0200FF7F01CC8004
01A0: 000370000D635143 006865636B426F78 22A20000010000B7 0400F60200FF1F01
01C0: 8004330004000600 634461646F732200 D1000100005B0400 02FB00FF0F018013
01E0: 011A0005000F6300 4465736B746F704C 20697374426F4E01 C2000B0000005B19
0200: 0001FA0000FF6F19 00D6190001FE00FF 833200000019B500 0100FFFF604B0000
0220: 001900ED0100FF3F 6400580000190001 FB00FF0F7D000000 D6190001FE00FF83
0240: 9600000019B50001 00FFFF60AF000000 1900ED0100FF3FC8 00580000190001FB
0260: 00FF0FE1000000D6 190001FE00FF83FA 00000019B5000100 FFFF100180640000
0280: 06000000000B6344 69724C3E697C00D9 0004005B190001FA 0000FF6F1900D619
02A0: 0001FE00FF9B3200 19B5000100FFFF66 4B001900ED0100FF 3F0180044B000007
02C0: 0000001E0F547265 F8654C69605E0000 0003006F1900E901 0000FFBF19590019
02E0: 0001FB00FF6F3200 D6190001FE00FF43 0180AF0000040800 000C634669F86C65
0300: 4CC1D600000007DE 0019D200010000FF 7F19B3001900F601 00FFDF32AC001900
0320: 01FD00FF374B0019 6B000100FFFFCD64 0019DA000100FF7F 7DB3001900F60100
0340: FFDF96AC00190001 FD00FF8701807D00 4000090000000D52 C06164696F4C6907
0360: 9A000000057B0019 4B00010000FFFFCD 190019DA000100FF 7F32B3001900F601
0380: 00FFDF4BAC001900 01FD00FF37640019 6B000100FFFF01
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field: cQCK1DataField
			Spin Field:
			Multiline Field:
			Pushbutton: cQCK2PbSair
			Radio Button:
			Option Button:
			Check Box:
			Child Table: cQCK2ChildTable
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box: cQCK1ComboBox
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text: cQCK1BackgroundText
			Group Box:
			Line:
			Frame:
			Custom Control:
			ActiveX:
		Application Actions
	Form Window: frmPGConsultaTransacao
		Class: cQCK1Form
		Property Template:
		Class DLL Name:
		Title: Consulta de pagamento com cartão de débito
		Icon File:
		Accessories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left: 0.463"
				Top: 1.135"
				Width:  9.388"
				Width Editable? Yes
				Height: 4.729"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? No
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: dfnControle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625365727669 636F0000
.enddata
.data CLASSPROPSSIZE
0000: 1C00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 2.188"
						Top: 0.198"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Placa do veículo'
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _bSempreHabilitado = TRUE
						Set _sNomeParaMsgs = 'Controle'
						Set _sMsgValidacao = 'Controle inválido!'
						Set _sTipoMsgValidacao = 'ESPECIFICA'
						Set _bNaoTemDependentes = TRUE
						Set _bComponenteChave = TRUE
						Set _bDisparaConsultaEmValidate = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					! On SAM_Validate
						Call SalSendClassMessage( SAM_Validate, wParam, lParam )
			Data Field: dfsPlaca
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625365727669 636F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 7
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 0.638"
						Top: 0.531"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Uppercase
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					! On SAM_Create
						Set _sTextoStatusBar = 'Placa do veículo'
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _bSempreHabilitado = FALSE
						Set _sNomeParaMsgs = 'Placa'
						Set _sMsgValidacao = 'Placa inválida!'
						Set _sTipoMsgValidacao = 'ESPECIFICA'
						Set _bNaoTemDependentes = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sTextoStatusBar = 'Placa do veículo'
						Set _bComponenteChave = TRUE
						Set _sNomeParaMsgs = 'PLACA'
						Set _bDisparaConsultaEmValidate = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					! ----- Versão com previsão às consultas à BIN -----
			Data Field: dfsUFPlaca
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 2.188"
						Top: 0.531"
						Width:  0.6"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Placa do veículo'
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _bSempreHabilitado = FALSE
						Set _sNomeParaMsgs = 'Placa'
						Set _sMsgValidacao = 'Placa inválida!'
						Set _sTipoMsgValidacao = 'ESPECIFICA'
						Set _bNaoTemDependentes = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Data Field: dfnRenavam
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625365727669 636F0000
.enddata
.data CLASSPROPSSIZE
0000: 1C00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 12
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 4.088"
						Top: 0.531"
						Width:  1.35"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _sTextoStatusBar = 'Número do RENAVAM do veículo'
						Set _bSempreHabilitado = FALSE
						Set _sNomeParaMsgs = 'RENAVAM'
						Set _bNaoTemDependentes = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Data Field: dfsChassi
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625365727669 636F0000
.enddata
.data CLASSPROPSSIZE
0000: 1C00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 21
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 6.438"
						Top: 0.531"
						Width:  2.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Uppercase
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sTextoStatusBar = 'Chassi do veículo'
						Set _bSempreHabilitado = FALSE
						Set _sNomeParaMsgs = 'Chassi'
						Set _bNaoTemDependentes = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Child Table: tblTransacao
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625665696375 6C6F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK2ChildTable
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.138"
						Top: 0.948"
						Width:  8.85"
						Width Editable? Class Default
						Height: 2.792"
						Height Editable? Class Default
					Visible? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: coldDataPagamento
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK2Column
						Property Template:
						Class DLL Name:
						Title: Data Pagto
						Visible? Yes
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.05"
						Width Editable? Class Default
						Format: dd/MM/yyyy
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = TRUE
								Set _bNuncaHabilitado = TRUE
								Set _bSempreHabilitado = FALSE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
					Column: colsNumBancario
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK2Column
						Property Template:
						Class DLL Name:
						Title: Debitos
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  6.113"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = TRUE
								Set _bNuncaHabilitado = TRUE
								Set _bSempreHabilitado = FALSE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
					Column: colnValor
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK2Column
						Property Template:
						Class DLL Name:
						Title: Valor
						Visible? Yes
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.063"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = TRUE
								Set _bNuncaHabilitado = TRUE
								Set _bSempreHabilitado = FALSE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Set _sCriacaoConexao = 'FALSE'
						Set nRow = 0
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_FetchRowDone
						Set dfnTotal = dfnTotal + colnValor
					On MSG_PesquisaTabela
						! Call SalListClear( mlsRetornoTransacao )
						Set dfnTotal = 0
						If fMPSConnect( hSql )
							Call fMPSPrepareProc ( hSqlApp, 'exec dbarrecadacao..PGConsultaTransacaoS @Sequencial =  :dfnControle,@Placa= :frmPGConsultaTransacao.dfsPlaca', '
									               :frmPGConsultaTransacao.tblTransacao.colsNumBancario, 
									               :frmPGConsultaTransacao.tblTransacao.colnValor,
									               :frmPGConsultaTransacao.dfsPlaca,
									               :frmPGConsultaTransacao.dfsUFPlaca,
									               :frmPGConsultaTransacao.dfsChassi,
									               :frmPGConsultaTransacao.dfnRenavam,
									               :frmPGConsultaTransacao.tblTransacao.coldDataPagamento,
									               :sPermiteCancelar,
									               :dfnControle' )
							If SalTblPopulate ( tblTransacao, hSqlApp, '', TBL_FillAll )
								Call SalPostMsg( dfnControle, MSG_Desabilita1, wParam, lParam )
								Call SalPostMsg( pbImprimir, MSG_Habilita1, wParam, lParam )
								If sPermiteCancelar = 'S'
									Call SalPostMsg( pbCancelar, MSG_Habilita1, wParam, lParam )
						Return TRUE
					! On SAM_User
						Call SalWaitCursor ( TRUE )
						! Popula a tabela
						Set hSqlErro = hSqlApp
						Call fMPSPrepareProc ( hSqlApp, 'exec dbarrecadacao..PGConsultaTransacao @Sequencial =  :dfnControle', '
								               :frmPGConsultaTransacao.tblTransacao.colsNumBancario, :frmPGConsultaTransacao,
								               :frmPGConsultaTransacao.dfsPlaca,
								               :frmPGConsultaTransacao.dfsUFPlaca,
								               :frmPGConsultaTransacao.dfsChassi,
								               :frmPGConsultaTransacao.dfnRenavam,
								               :frmPGConsultaTransacao.tblTransacao.coldDataPagamento' )
						Call SalTblPopulate ( tblTransacao, hSqlApp, '', TBL_FillAll )
						Call SalWaitCursor ( FALSE )
						Call SalTblSetRowFlags( tblRoubo, 0, ROW_Selected, TRUE )
						Call SalTblSetFocusRow( tblRoubo, 0 )
						Call SalPostMsg( tblRoubo, SAM_Click, 0, 0 )
					! On SAM_Click
						Set nRow = SalTblQueryContext( tblRoubo )
						Set mlObsRoubo = colsObs
					! On SAM_DoubleClick
						If hWndDetalheRoubo != hWndNULL
							Call SalSendMsg( hWndDetalheRoubo, MSG_Sai, 0, 0 )
						Set hWndDetalheRoubo = SalCreateWindow( frmDetalheRoubo, hWndMDI, dfnRoubo,
								tblRoubo.colnTipoMov, tblRoubo.coldDataMov, rbBin, nCodConsultaBin, NUMBER_Null,
								sPlaca2, sUFPlaca, dfsChassi, '', '',  hWndDetalheRoubo )
					! On SAM_RowHeaderDoubleClick
						If hWndDetalheRoubo != hWndNULL
							Call SalSendMsg( hWndDetalheRoubo, MSG_Sai, 0, 0 )
						Set hWndDetalheRoubo = SalCreateWindow( frmDetalheRoubo, hWndMDI, dfnRoubo,
								tblRoubo.colnTipoMov, tblRoubo.coldDataMov, rbBin, nCodConsultaBin, NUMBER_Null,
								sPlaca2, sUFPlaca, dfsChassi, '', '',  hWndDetalheRoubo )
			!
			Background Text: Chassi:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625365727669 636F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Resource Id: 17469
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 5.8"
					Top: 0.594"
					Width:  0.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Placa:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625365727669 636F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Resource Id: 17470
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 0.088"
					Top: 0.594"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: RENAVAM:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625365727669 636F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Resource Id: 17471
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 3.125"
					Top: 0.594"
					Width:  0.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: UF:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625365727669 636F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Resource Id: 17472
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 1.838"
					Top: 0.594"
					Width:  0.3"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pbSair
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 546162656C610001 0000005461624368 696C644E616D6573 0028007461625665
0020: 6963756C6F097461 6250726F70726965 746172696F097461 624D6F76696D656E
0040: 746F00005469706F 436F6D616E646F00 0400536169000000 0000000000
.enddata
.data CLASSPROPSSIZE
0000: 5D00
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK2PbSair
				Property Template:
				Class DLL Name:
				Title: &Sair
				Window Location and Size
					Left: 8.088"
					Top: 4.073"
					Width:  0.95"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					! On SAM_Create
						Set _sTextoStatusBar = 'Sai desta tela'
						Set _sTipoComando = 'Sai'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Pushbutton: pbImprimir
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: Im&primir
				Window Location and Size
					Left: 6.038"
					Top: 4.073"
					Width:  0.95"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Imprime o relatório'
						Set _nPermissao = 15
						Set _sTipoComando = 'Comum'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Set nUltimoSequencial = dfnControle
						Return fReImprimeComprovante()
			Pushbutton: pbCancelar
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Cancelar Pagtos 
				Window Location and Size
					Left: 6.438"
					Top: 0.156"
					Width:  2.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Cancelamento de pagamento TEF'
						Set _nPermissao = 15
						Set _sTipoComando = 'Comum'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Set nUltimoSequencial = dfnControle
						If SalMessageBox( 'Ao executar essa função o sistema irá cancelar o pagamento efetuado, o cancelamento ficará registrado em seu login. Confirma o cancelamento?', "ATENÇÃO", MB_YesNo ) = IDYES
							Set bEstornaDebito = TRUE
							Call fGravaArquivoCancelamento()
							Call SalPostMsg( frmPGConsultaTransacao, MSG_Limpa, wParam, lParam )
						Set bEstornaDebito = FALSE
						Call SalSendMsg( frmPGConsultaTransacao, MSG_Limpa, wParam, lParam )
						Return TRUE
			Picture: picSemaforo
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQCK1Form
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 0.138"
					Top: 3.781"
					Width:  0.35"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name: Sinalvrd.Bmp
				Storage: External
				Picture Transparent Color: None
				Fit: Size to Fit
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Tile To Parent? No
				Border Color: Default
				Background Color: System Window Color
				Message Actions
			Background Text: Controle DETRAN-PE:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 7461625365727669 636F00000000
.enddata
.data CLASSPROPSSIZE
0000: 1E00
.enddata
				Resource Id: 17475
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: -0.025"
					Top: 0.26"
					Width:  1.813"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Total:
				Resource Id: 47132
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 6.838"
					Top: 3.76"
					Width:  0.6"
					Width Editable? Class Default
					Height: 0.208"
					Height Editable? Class Default
				Visible? Class Default
				Justify: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Data Field: dfnTotal
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Number
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 7.538"
						Top: 3.74"
						Width:  1.15"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Right
					Format: ###000
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _bPermiteNulos = TRUE
						Set _sTextoStatusBar = 'Número do RENAVAM do veículo'
						Set _bSempreHabilitado = FALSE
						Set _sNomeParaMsgs = 'RENAVAM'
						Set _bNaoTemDependentes = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Pushbutton: pbLimpar
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Limpar
				Window Location and Size
					Left: 7.038"
					Top: 4.073"
					Width:  1.0"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTextoStatusBar = 'Limpa os dados da tela'
						Set _sNroCamposIgnorados = 'NENHUM'
						!
						Set _bValidaCamposNulos = FALSE
						Set _sTipoComando = 'Limpa'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call SalPostMsg( dfnControle, MSG_Habilita1, wParam, lParam )
						Call SalPostMsg( pbImprimir, MSG_Desabilita1, wParam, lParam )
						Call SalPostMsg( pbCancelar, MSG_Desabilita1, wParam, lParam )
		Functions
		Window Parameters
		Window Variables
		Message Actions
			On SAM_Create
				Set _sTextoStatusBar = 'Tela de cadastrado de movimentação de roubo'
				Set _nEstadoInicialForm = EF_Vazio
				Set _sCriacaoConexao = 'Default'
				Call SalSendClassMessage( SAM_Create, wParam, lParam )
				Call SalCenterWindow ( hWndForm )
			On MSG_Pesquisa
				Set dfnTotal = 0
				Call SalSendMsg( tblTransacao, MSG_PesquisaTabela, wParam, lParam )
				Return TRUE
			On SAM_ReportFetchNext
				Return fPGImprimeComprovante(  )
			On SAM_CreateComplete
				Call SalSendClassMessage( SAM_CreateComplete, wParam, lParam )
				Set bTelaCancelamento = TRUE
				Call SalPostMsg( pbImprimir, MSG_Desabilita1, wParam, lParam )
				Call SalPostMsg( pbCancelar, MSG_Desabilita1, wParam, lParam )
				If fMPSConnect (hSql)
					If NOT fMPSPrepareProc( hSql, 'exec SetorS @CodReduzido = :nGlobalSetor,@PreAtendimento = "S"', ':sServidorPayGo' )
						Call fMPSDisconnect( hSql )
						Call SalWaitCursor( FALSE )
						Return FALSE
					If NOT SqlExecute( hSql )
						Call fMPSDisconnect( hSql )
						Call SalWaitCursor( FALSE )
						Return FALSE
					Call SqlFetchNext(hSql,bok)
					! Call fMPSDisconnect( hSql )
					! If sServidorPayGo = ''
						Call SalDisableWindow(cmbCartao)
			! On UDM_AposPesquisa
				Return TRUE
	! --------------------------------------------------------------------------  [faml]  06/05/2009  flaviolago@detran.pe.gov.br
	! 1. Criar relatório Análise da Arrecadação TEF - Por Ponto de Atendimento - Consolidado
	! 2. Corrgir erro na seleção dos setores da tblSetores, reproduzido durante testes da implementação 1.
	! --------------------------------------------------------------------------  [faml]  06/05/2009 end
	Form Window: frmPGRelTransacao
		Class: cQCK1Form
		Property Template:
		Class DLL Name:
		Title: Relatório de Pagamentos Efetuados com Cartão de Débito
		Icon File:
		Accessories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? No
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left: 1.538"
				Top: 1.583"
				Width:  7.425"
				Width Editable? Class Default
				Height: 5.552"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Relatório de Produção de Digitação de Autos
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
		Contents
			! -------------------------------------------------------------------------------
			Background Text: Período de Pagamento (transação):
				Resource Id: 42315
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.163"
					Top: 0.229"
					Width:  2.925"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: a
				Resource Id: 42316
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 4.563"
					Top: 0.229"
					Width:  0.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfdInicial
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 20
					Data Type: Date/Time
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 3.288"
						Top: 0.188"
						Width:  1.225"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Right
					Format: dd/MM/yyyy
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 99-99-9999
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sTextoStatusBar = 'Data Incial do Intervalo, referentes às datas de cadastramento da Restrição no Sistema, para a pesquisa.'
						Set _bSempreHabilitado = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Validate
						If NOT SalIsNull( dfdInicial )
							If NOT (SalIsValidDateTime( dfdInicial ))
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Data inválida.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( dfdInicial )
								Return VALIDATE_Cancel
							Else If (SalDateYear( dfdInicial ) < 1753)
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Ano inválido.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( dfdInicial )
								Return VALIDATE_Cancel
							If dfdFinal < dfdInicial AND NOT SalIsNull( dfdFinal )
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Data Inicial deve ser menor do que a data Final.', 'Atenção', MB_IconExclamation | MB_Ok )
						Call SalSendClassMessage( SAM_Validate, wParam, lParam )
			Data Field: dfdFinal
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: Date/Time
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 4.813"
						Top: 0.188"
						Width:  1.2"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Right
					Format: dd/MM/yyyy
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 99-99-9999
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sTextoStatusBar = 'Data Final do Intervalo, referentes às datas de cadastramento da Restrição no Sistema, para a pesquisa.'
						Set _bSempreHabilitado = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Validate
						If NOT SalIsNull( dfdFinal )
							If NOT (SalIsValidDateTime( dfdFinal ))
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Data inválida.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( dfdFinal )
								Return VALIDATE_Cancel
							Else If SalDateYear( dfdFinal ) < 1753
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Ano inválido.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( dfdFinal )
								Return VALIDATE_Cancel
							Else If dfdFinal < dfdInicial
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Data Final do período deve ser maior ou igual à data Inicial.', 'Atenção', MB_Ok | MB_IconExclamation )
						Call SalSendClassMessage( SAM_Validate, wParam, lParam )
			! -------------------------------------------------------------------------------
			Background Text: Requisição:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 746162446F63756D 656E746F00000000
.enddata
.data CLASSPROPSSIZE
0000: 2000
.enddata
				Resource Id: 42317
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 2.938"
					Top: 1.635"
					Width:  1.05"
					Width Editable? Class Default
					Height: 0.167"
					Height Editable? Class Default
				Visible? No
				Justify: Right
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			! -------------------------------------------------------------------------------
			Background Text: Setores:
				Resource Id: 42320
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 0.18"
					Top: 1.26"
					Width:  0.7"
					Width Editable? Class Default
					Height: 0.167"
					Height Editable? Class Default
				Visible? Class Default
				Justify: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Child Table: tblSetores
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1ChildTable
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.163"
						Top: 1.49"
						Width:  5.325"
						Width Editable? Class Default
						Height: 2.917"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 5000
					Discardable? No
				Contents
					Column: colsCodigo
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK1Column
						Property Template:
						Class DLL Name:
						Title: Setor
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  0.975"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = TRUE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
					Column: colsDescricao
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK1Column
						Property Template:
						Class DLL Name:
						Title: Descrição
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.763"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = TRUE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
					Column: colnCodRed
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK1Column
						Property Template:
						Class DLL Name:
						Title: Cod Red
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.05"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = FALSE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
				Functions
				Window Variables
					Number: nAux
					String: sSetor
					Number: nSetor
				Message Actions
					On SAM_Create
						Set _sCriacaoConexao = 'FALSE'
						Set _bCriacaoConexaoAuxiliar = FALSE
						Set _sTextoStatusBar = 'Click à esquerda do setor para marcar ou desmarcar o setor a ser impresso. Click no canto superior esquerdo (coluna sem título) para marcar ou desmarcar todos os setores.'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					! ............................................CLICK NA 1a. COLUNA À ESQUERDA DO GRID tblSetores (em cada linha exibida)
					On SAM_RowHeaderClick
						! Call SalTblGetColumnText( tblSetores, 3, sSetor )
						! Set nSetor = SalStrToNumber( sSetor )
						! -------------------------------- Se a linha estiver marcada, desmarca.
						If SalTblQueryRowFlags( tblSetores, lParam, ROW_Edited )
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoD  @ID= :nID, @CodRedSetor= :tblSetores.colnCodRed', '')
							Call SqlExecute( hSqlApp )
							! Call SalSendMsg( tblSetores, MSG_AtualizaTabela, wParam, lParam )
							! Call fMPSPrepareProc( hSqlApp, 'exec tmpUsuarioSelecionadoSetorD @SetorN = :frmRelProdDigitacao.tblSetores.nSetor', '' )
							! If NOT SqlExecute( hSqlApp )
								Call SalWaitCursor( FALSE )
								Return FALSE
							Return TRUE
						! -------------------------------- Se a linha estiver desmarcada, marca.
						Else
							! --
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
							Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoI  @ID= :nID, @CodRedSetor= :tblSetores.colnCodRed', '')
							Call SqlExecute( hSqlApp )
							Return TRUE
							! --
							! Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
							! Call SalSendMsg( tblSetores, MSG_AtualizaTabela, wParam, lParam )
					! .............................................CLICK NO (título da 1a. coluna) CANTO SUPERIOR ESQUERDO DO GRID tblSetores
					On SAM_CornerClick
						Call SalWaitCursor( TRUE )
						Set nAux = TBL_MinRow
						! ---------------------------- apagar seleção anterior dos setores do usuário e recuperar o seu @@spid
						Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoD',':nID')
						Call SqlExecute( hSqlApp )
						Call SqlFetchNext( hSqlApp, lParam )
						! -------------------------------- Se as linhas estiverem marcadas, desmarca todas.
						If SalTblFindNextRow( hWndForm, nAux, ROW_Edited, 0)
							Set nAux = TBL_MinRow
							While SalTblFindNextRow( hWndForm, nAux, 0, 0)
								Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, FALSE )
						! -------------------------------- Se as linhas estiverem desmarcadas, marca todas.
						Else
							Set nAux = TBL_MinRow
							While SalTblFindNextRow( hWndForm, nAux, 0, 0)
								Call SalTblSetContext(hWndForm,nAux)
								Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, TRUE )
								Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoI  @ID= :nID, @CodRedSetor= :tblSetores.colnCodRed', '')
								Call SqlExecute( hSqlApp )
						Call SalWaitCursor( FALSE )
					! [faml] On SAM_CornerDoubleClick
						Set nAux = TBL_MinRow
						If SalTblFindNextRow( hWndForm, nAux, ROW_Edited, 0)
							Set nAux = TBL_MinRow
							While SalTblFindNextRow( hWndForm, nAux, 0, 0)
								Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, FALSE )
						Else 
							Set nAux = TBL_MinRow
							While SalTblFindNextRow( hWndForm, nAux, 0, 0)
								Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, TRUE )
					! .............................................Popula tabela (grid) de setores
					On MSG_PopulaTabela
						Call SalWaitCursor( TRUE )
						Call SalTblReset( tblSetores )
						Call SybPrepareProc( hSqlApp, 'exec dbvcen..SetorS_codred_dig_desc',
								                                ':colnCodRed, :colsCodigo,  :colsDescricao' )
						If NOT  SalTblPopulate(tblSetores, hSqlApp, '', TBL_FillAll )
							Call SalWaitCursor( FALSE )
							Return FALSE
						Call SalWaitCursor( FALSE )
						Return TRUE
					! On MSG_AtualizaTabela
						Call SalWaitCursor( TRUE )
						! Primeiro Limpa os a Tabela de  Setores Selecionados para a Conexao
						Call SybPrepareProc( hSqlApp, 'exec tmpSetorSelecionadoD',':nID')
						Call SqlExecute( hSqlApp )
						Call SqlFetchNext( hSqlApp, lParam )
						Call SybPrepareProc( hSqlApp, 'exec tmpSetorSelecionadoI @ID = :nID, @CodRedSetor = :colnCodRed','')
						Call SalTblDoUpdates( tblSetores, hSqlApp, FALSE )
						Call SalWaitCursor( FALSE )
			! cQCK1ChildTable: tblFuncionario
				  Contents
					  Column: colsCodigo
						  List Values
						  Message Actions
							  On SAM_Create
								  Set _bVisivel = TRUE
								  Call SalSendClassMessage( SAM_Create, wParam, lParam )
					  Column: colsDescricao
						  List Values
						  Message Actions
							  On SAM_Create
								  Set _bVisivel = TRUE
								  Call SalSendClassMessage( SAM_Create, wParam, lParam )
				  Functions
				  Window Variables
					  Number: nAux
				  Message Actions
					  On SAM_Create
						  Set _sCriacaoConexao = 'FALSE'
						  Set _bCriacaoConexaoAuxiliar = FALSE
						  Set _sTextoStatusBar = 'Tabela de Funcionários. CLICK - Marca o Funcionário para Seleção. CLICK DUPLO - Desmarca Funcionário.'
						  Call SalSendClassMessage( SAM_Create, wParam, lParam )
					  On SAM_RowHeaderClick
						  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
					  On SAM_RowHeaderDoubleClick
						  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
					  On SAM_CornerDoubleClick
						  Set nAux = TBL_MinRow
						  If SalTblFindNextRow( hWndForm, nAux, ROW_Edited, 0)
							  Set nAux = TBL_MinRow
							  While SalTblFindNextRow( hWndForm, nAux, 0, 0)
								  Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, FALSE )
						  Else
							  Set nAux = TBL_MinRow
							  While SalTblFindNextRow( hWndForm, nAux, 0, 0)
								  Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, TRUE )
					  On MSG_PopulaTabela
						  Call SalWaitCursor( TRUE )
						  Call SalTblReset( tblFuncionario )
						  Call SybPrepareProc( hSqlApp, 'exec UsuarioS_cod_nome',
								                                ':colsCodigo,  :colsDescricao' )
						  If NOT  SalTblPopulate(tblFuncionario, hSqlApp, '', TBL_FillAll )
							  Call SalWaitCursor( FALSE )
							  Return FALSE
						  Call SalWaitCursor( FALSE )
						  Return TRUE
					  On MSG_AtualizaTabela
						  Call SalWaitCursor( TRUE )
						! Primeiro Limpa os a Tabela de  Setores Selecionados para a Conexao
						  Call SybPrepareProc( hSqlApp, 'exec tmpUsuarioSelecionadoD',':nID')
						  Call SqlExecute( hSqlApp )
						  Call SqlFetchNext( hSqlApp, lParam )
						  Call SybPrepareProc( hSqlApp, 'exec tmpUsuarioSelecionadoI @ID = :nID, @Cod = :colsCodigo, @Nome = :colsDescricao','')
						  Call SalTblDoUpdates( tblFuncionario, hSqlApp, FALSE )
						  Call SalWaitCursor( FALSE )
			!
			! -------------------------------------------------------------------------------
			Group Box: Saída
				Resource Id: 42318
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 5.638"
					Top: 3.698"
					Width:  1.35"
					Width Editable? Yes
					Height: 0.75"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfsSaida
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 6.488"
						Top: 3.823"
						Width:  0.425"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = FALSE
						! Set _sValorDefault = 'I'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Radio Button: rbTela
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Tela
				Window Location and Size
					Left: 5.738"
					Top: 3.865"
					Width:  0.9"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call SalDisableWindow( pbImpressoras )
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sValorCampoFonte = 'T'
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = TRUE
						Set _sNomeCampoFonte = 'dfsSaida'
						! ...................................saída default do relatório é a impressora
						Set _bRadioButtonDefault = FALSE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Radio Button: rbImpressora
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Impressora
				Window Location and Size
					Left: 5.738"
					Top: 4.156"
					Width:  1.15"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call SalEnableWindow( pbImpressoras )
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sValorCampoFonte = 'I'
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = TRUE
						Set _sNomeCampoFonte = 'dfsSaida'
						! ...................................saída default do relatório é a impressora
						Set _bRadioButtonDefault = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			! -------------------------------------------------------------------------------
			Pushbutton: pbImprimir
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: Im&primir
				Window Location and Size
					Left: 5.6"
					Top: 1.542"
					Width:  1.15"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTabela = ''
						Set _nPermissao = 15
						Set _sTipoComando = 'Comum'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						If SalIsNull( dfdInicial)
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Data Inicial é Obrigatória.', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfdInicial )
							Return FALSE
						If SalIsNull( dfdFinal)
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Data Final é Obrigatória.', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfdFinal )
							Return FALSE
						If dfdFinal < dfdInicial AND NOT SalIsNull( dfdFinal )
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Data Inicial deve ser menor do que a data Final.', 'Atenção', MB_IconExclamation | MB_Ok )
							Return FALSE
						! ..................................................................[faml] begin: se NÃO for consolidado, precisa selecionar um setor.
						! [faml] 20/05/2009 : mesmo no consolidadeo, precisa seleciona algum setor.   If not cbConsolidado
							! ..........................[faml] end
						If NOT SalTblAnyRows( tblSetores, ROW_Edited, 0 )
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Selecione pelo menos um Setor.', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalAbort( -1)
						Call SalSendMsg( tblSetores, MSG_AtualizaTabela, 0, 0 )
						! ........................SAÍDA IMPRESSORA
						If dfsSaida='I'
							If cbSintetico
								! ............................[faml] 06/05/2009 begin: incluída condição If cbConsolidado
								! ............................[faml] 01/07/2009 begin: mudou o nome do qrp
								! DE: RelAnaliseArrecadaTEFPontoAtendConsolidado.qrp PARA: AATEFPAC.qrp
								If cbConsolidado
									Call SalReportPrint( hWndForm, 'AATEFPAC.qrp',
											'sReportHeader, 
											dfdInicial, 
											dfdFinal, 
											sPontoAtendimento,
											nQtde,
											nValor,
											nQtde1,
											nValor1' 
											, 
											'Secretaria, 
											dDtInicial, 
											dDtFinal, 
											sPontoAtendimento,
											Qtde,
											Valor,
											Qtde1,
											Valor1' 
											, 
											1,RPT_PrintAll,0,0, nErro )
								Else
									! ....................... [faml] 06/05/2009 end
									Call SalReportPrint( hWndForm, 'RELTEFS.qrp',
											'sGlobalSecretaria, sGlobalDetran, dfdInicial, dfdFinal, 
											sDescricaoBandeira,
											nSetor, 
											sDescricaoSetor, 
											nQtde,
											nValor', 
											'Secretaria, Detran, DataInicial, DataFinal, 
											Bandeira,
											nSetor, 
											DescricaoSetor,
											Qtde,
											Valor', 1,RPT_PrintAll,0,0, nErro )
							Else
								Call SalReportPrint( hWndForm, 'RELTEF.qrp',
										'sGlobalSecretaria, sGlobalDetran, dfdInicial, dfdFinal, 
										nSetor, 
										sDescricaoSetor, 
										nSequencialTransacao,
										sPlaca,
										sNumBancario,
										sDescricaoDebito,
										sRede,
										dDataPagamento,
										nValorPago,
										sSituacao , 
										nGlobalSetor, 
										sGlobalSetor, 
										SqlUser',
										'Secretaria, Detran, DataInicial, DataFinal, 
										nSetor, 
										DescricaoSetor, 
										SequencialTransacao,
										Placa,
										NumBancario,
										DescricaoDebito,
										Rede,
										DataPagamento,
										ValorPago,
										Situacao , 
										SetorGlobal, 
										NomeSetorGlobal, 
										Usuario', 1,RPT_PrintAll,0,0, nErro )
						! ........................SAÍDA TELA
						Else
							If hWndReportView != hWndNULL
								Call SalReportClose( hWndReportView )
								Call SalDestroyWindow( hWndReportView )
								Set hWndReportView = hWndNULL
							Set hWndReportView= SalCreateWindow( frmReportView, hWndForm )
							Call SalSetWindowText( hWndReportView, 'Relatório de Pagamentos Efetuados com Cartão de Débito' )
							If cbSintetico
								! ...........................................................[faml] 06/05/2009 begin: incluída condição If cbConsolidado
								! ...........................................................[faml] 01/07/2009 begin: mudou o nome do qrp
								! DE: RelAnaliseArrecadaTEFPontoAtendConsolidado.qrp PARA: AATEFPAC.qrp
								If cbConsolidado
									Call SalSetWindowText( hWndReportView, 'Análise da Arrecadação TEF - Por Ponto de Atendimento - Consolidado' )
									Call SalReportView( hWndForm, hWndReportView, 'AATEFPAC.qrp',
											'sReportHeader, 
											dfdInicial, 
											dfdFinal, 
											sPontoAtendimento,
											nQtde,
											nValor,
											nQtde1,
											nValor1' 
											, 
											'sReportHeader, 
											dDtInicial, 
											dDtFinal, 
											sPontoAtendimento,
											nQtde,
											nValor,
											nQtde1,
											nValor1' 
											, 
											nErro )
								Else
									! ....................... [faml] 06/05/2009 end
									Call SalReportView( hWndForm, hWndReportView,'RELTEFS.qrp',
											'sGlobalSecretaria, sGlobalDetran, dfdInicial, dfdFinal, 
											sDescricaoBandeira
											nSetor, 
											sDescricaoSetor, 
											nQtde,
											nValor', 
											'Secretaria, Detran, DataInicial, DataFinal, 
											Bandeira,
											nSetor, 
											DescricaoSetor,
											Qtde,
											Valor', nErro )
							Else
								Call SalReportView( hWndForm, hWndReportView,'RELTEF.qrp',
										'sGlobalSecretaria, sGlobalDetran, dfdInicial, dfdFinal, 
										nSetor, 
										sDescricaoSetor, 
										nSequencialTransacao,
										sPlaca,
										sNumBancario,
										sDescricaoDebito,
										sRede,
										dDataPagamento,
										nValorPago,
										sSituacao , 
										nGlobalSetor, 
										sGlobalSetor, 
										SqlUser',
										'Secretaria, Detran, DataInicial, DataFinal, 
										nSetor, 
										DescricaoSetor, 
										SequencialTransacao,
										Placa,
										NumBancario,
										DescricaoDebito,
										Rede,
										DataPagamento,
										ValorPago,
										Situacao , 
										SetorGlobal, 
										NomeSetorGlobal, 
										Usuario', nErro )
			Pushbutton: pbImpressoras
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: Con&figurar
				Window Location and Size
					Left: 5.6"
					Top: 1.833"
					Width:  1.15"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalPrtGetDefault( sDeviceDef, sDriverDef, sPortaDef )
						Call SalPrtSetup(sDevice,sDriver,sPorta,FALSE)
					On SAM_Create
						Set _sTabela = ''
						Set _nPermissao = 15
						Set _sTipoComando = 'Comum'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Pushbutton: pbSair
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Sair
				Window Location and Size
					Left: 5.6"
					Top: 2.125"
					Width:  1.15"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! .............................................................. apagar seleção dos setores do usuário
						Call fLimparTmpSetorSelecionado( )
						!
						Set _sTabela = ''
						Set _sTipoComando = 'Sai'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			! -------------------------------------------------------------------------------
			! .......................................................................[faml] 06/05/2009 criado objeto cbConsolidado
			Check Box: cbConsolidado
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Consolidado (TEF)
				Window Location and Size
					Left: 3.288"
					Top: 0.99"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Check Box: cbSintetico
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Sintético
				Window Location and Size
					Left: 3.288"
					Top: 0.74"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					! ................................................................[faml] 06/05/2009 criado evento On SAM_Click
					On SAM_Click
						If cbSintetico
							Call SalEnableWindow ( cbConsolidado )
							Set cbConsolidado= TRUE
						Else
							Call SalDisableWindow( cbConsolidado )
			! Frame
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.238"
					Top: 1.323"
					Width:  5.1"
					Width Editable? Yes
					Height: 1.5"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Gray
.end
			Frame
				Resource Id: 42319
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: -0.163"
					Top: 0.115"
					Width:  7.25"
					Width Editable? Yes
					Height: 4.875"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: 3D Face Color
			Picture: picSemaforo
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQCK1Form
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 0.188"
					Top: 4.531"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
			Check Box: cbPendentes
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Pendentes de Confirmação
				Window Location and Size
					Left: 3.288"
					Top: 0.49"
					Width:  2.45"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
		Functions
			! ----------------------------------------------------- [faml  06/05/2009  apagar seleção dos setores na tmpSetorSelecionado
			Function: fLimparTmpSetorSelecionado
				Description: apagar seleção dos setores na tmpSetorSelecionado
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoD',':nID')
					Call SqlExecute( hSqlApp )
					Call SqlFetchNext( hSqlApp, lParam )
		Window Parameters
		Window Variables
			!
			Number: nErro
			String: sDevice
			String: sDriver
			String: sPorta
			String: sDeviceDef
			String: sDriverDef
			String: sPortaDef
			!
			Number: nID
			Window Handle: hWndReportView
			! Variáveis do relatório
			String: sDescricaoBandeira
			Number: nSetor
			String: sDescricaoSetor
			Number: nSequencialTransacao
			String: sPlaca
			String: sNumBancario
			String: sDescricaoDebito
			String: sRede
			Date/Time: dDataPagamento
			Number: nValorPago
			Number: nValor
			Number: nQtde
			! .............................[faml] 06/05/2009 begin: criadas as variáveis abaixo
			String: sReportHeader
			String: sPontoAtendimento
			Number: nValor1
			Number: nQtde1
			! .............................[faml] 06/05/2009 end
			String: sSituacao
			String: sPendentes
		Message Actions
			On SAM_Create
				Set _nEstadoInicialForm = 1
				Set _sTextoStatusBar = 'Relatório de Pagamentos Efetuados com Cartão de Débito'
				Call SalSendClassMessage( SAM_Create, wParam, lParam )
				Call SalCenterWindow( hWndForm )
				! ---------------------------- apagar seleção anterior dos setores do usuário e recuperar o seu @@spid
				Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoD',':nID')
				Call SqlExecute( hSqlApp )
				Call SqlFetchNext( hSqlApp, lParam )
				! ------------------------------------------------- nID é igual ao @@spid
			On SAM_CreateComplete
				Call SalSendClassMessage( SAM_CreateComplete, wParam, lParam )
				! ----------------------------------------------- Popula tabela (grid) de setores 
				Call SalSendMsg( tblSetores, MSG_PopulaTabela, wParam, lParam  )
				! ........................................................... habilita (edição) marcar/desmarcar linhas da tblSetores
				Call SalEnableWindow( tblSetores )
				! ....................................................................... [faml]  06/05/2009  desabilita edição nas colunas da tblSetores
				Call SalDisableWindow( tblSetores.colsCodigo )
				Call SalDisableWindow( tblSetores.colsDescricao )
				! ....................................................................... [faml]  06/05/2009  end
				! Apaga lixo da tabela temporária
				! Call fMPSPrepareProc( hSql, 'exec tmpUsuarioSelecionadoD', ':nID' )
				! If NOT SqlExecute( hSql )
					Call SalWaitCursor( FALSE )
					Return FALSE
				! Call SalEnableWindow( tblFuncionario)
				! Set dfsSaida = 'I'
				! ........................................................................[faml] 06/05/2009 begin: ao abrir a tela dos parâmetos do relatório, a opção 'Consolidado' fica desabilitada
				Call SalDisableWindow ( cbConsolidado )
				! ........................................................................[faml] 06/05/2009 end
			On SAM_ReportStart
				! ............................[faml] 20/05/2009 begin: incluída condição If cbConsolidado
				If cbConsolidado
					Call SalReportDlgOptions( SalNumberToWindowHandle( wParam ), 'Impressão', 'Imprimindo', 'Relatório  de Análise da Arrecadação TEF', 'Relatório  de Análise da Arrecadação TEF - Por Ponto de Atendimento - Consolidado' )
				Else
					! ....................... [faml] 20/05/2009 end
					Call SalReportDlgOptions( SalNumberToWindowHandle( wParam ), 'Impressão', 'Imprimindo', 'Relatório de Produçao de Digitação', 'Relatório de Produção de Digitação de Autos' )
				Return TRUE
			On SAM_ReportFetchInit
				Set sPendentes = ''
				If cbPendentes 
					Set sPendentes = 'S'
				If cbSintetico
					! ............................[faml] 06/05/2009 begin: incluída condição If cbConsolidado
					If cbConsolidado
						Call SybPrepareProc( hSql,'exec dbarrecadacao..PGRelTransacoesTEF 
								@ID = :nID, 
								@EntradaI = :dfdInicial, 
								@EntradaF = :dfdFinal , 
								@PendentesDeConf = :sPendentes,
								@Analitico="N", 
								@Consolidado=1'
								,
								':sPontoAtendimento,
								:nQtde,
								:nValor,
								 :nQtde1,
								 :nValor1' )
					Else
						! ....................... [faml] 06/05/2009 end
						Call SybPrepareProc( hSql,'exec dbarrecadacao..PGRelTransacoesTEF @ID = :nID, @EntradaI = :dfdInicial, @EntradaF = :dfdFinal , @PendentesDeConf = :sPendentes,@Analitico="N"',
								':sDescricaoBandeira,
								:sDescricaoSetor, 
								:nQtde,
								:nValor' )
				Else
					Call SybPrepareProc( hSql,'exec dbarrecadacao..PGRelTransacoesTEF @ID = :nID, @EntradaI = :dfdInicial, @EntradaF = :dfdFinal , @PendentesDeConf = :sPendentes,@Analitico= "S"',
							':nSetor, 
							:sDescricaoSetor, 
							:nSequencialTransacao,
							:sPlaca,
							:sNumBancario,
							:sDescricaoDebito,
							:sRede,
							:dDataPagamento,
							:nValorPago,
							:sSituacao' )
				Return SqlExecute( hSql )
			On SAM_ReportFetchNext
				Call SqlFetchNext( hSql, nErro )
				If nErro != FETCH_EOF
					Return 1
				Else
					Return 0
			On SAM_ReportFinish
				Call SalPrtSetDefault(sDeviceDef,sDriverDef,sPortaDef)
			On SAM_Destroy
				! .............................................................. apagar seleção dos setores do usuário
				Call fLimparTmpSetorSelecionado( )
				!
				If hWndReportView != hWndNULL
					Call SalReportClose( hWndReportView )
					Call SalDestroyWindow( hWndReportView )
					Set hWndReportView = hWndNULL
				Call SalSendClassMessage( SAM_Destroy, wParam, lParam )
	Form Window: frmPGRelTransNaoIdentif
		Class: cQCK1Form
		Property Template:
		Class DLL Name:
		Title: Relatório de Transações não Identificadas
		Icon File:
		Accessories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? No
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left: 1.538"
				Top: 1.583"
				Width:  4.65"
				Width Editable? Class Default
				Height: 2.219"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Autor		
			! Tela de Transações não Identificadas- Analista : Gerson Barreto Neto
									    Data : 16.05.2007
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
		Contents
			Frame
				Resource Id: 55663
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.05"
					Top: 0.031"
					Width:  4.413"
					Width Editable? Yes
					Height: 1.552"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: 3D Face Color
			Group Box: Período
				Resource Id: 55674
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.188"
					Top: 0.146"
					Width:  4.138"
					Width Editable? Yes
					Height: 0.719"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Inicial :
				Resource Id: 55659
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.35"
					Top: 0.438"
					Width:  0.7"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfdInicial
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 20
					Data Type: Date/Time
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 1.113"
						Top: 0.406"
						Width:  1.038"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Right
					Format: dd/MM/yyyy
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 99-99-9999
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sTextoStatusBar = 'Data incial do intervalo.'
						Set _bSempreHabilitado = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Validate
						If NOT SalIsNull( frmPGRelTransNaoIdentif.dfdInicial )
							If NOT (SalIsValidDateTime( frmPGRelTransNaoIdentif.dfdInicial ))
								Call SalMessageBox( 'Data inválida.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( frmPGRelTransNaoIdentif.dfdInicial )
								Return VALIDATE_Cancel
							If frmPGRelTransNaoIdentif.dfdFinal < frmPGRelTransNaoIdentif.dfdInicial AND NOT SalIsNull( frmPGRelTransNaoIdentif.dfdFinal )
								Call SalMessageBox( 'Data inicial deve ser menor do que a data final.', 'Atenção', MB_IconExclamation | MB_Ok )
								Call SalClearField( frmPGRelTransNaoIdentif.dfdInicial )
								Return VALIDATE_Cancel
						Call SalSendClassMessage( SAM_Validate, wParam, lParam )
			Background Text: Final :
				Resource Id: 55673
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 2.313"
					Top: 0.438"
					Width:  0.7"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfdFinal
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: Date/Time
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 3.088"
						Top: 0.406"
						Width:  1.038"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Right
					Format: dd/MM/yyyy
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 99-99-9999
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sTextoStatusBar = 'Data final do intervalo.'
						Set _bSempreHabilitado = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Validate
						If NOT SalIsNull( frmPGRelTransNaoIdentif.dfdFinal )
							If NOT (SalIsValidDateTime( frmPGRelTransNaoIdentif.dfdFinal ))
								Call SalMessageBox( 'Data inválida.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( frmPGRelTransNaoIdentif.dfdFinal )
								Return VALIDATE_Cancel
							If frmPGRelTransNaoIdentif.dfdFinal < frmPGRelTransNaoIdentif.dfdInicial AND NOT SalIsNull( frmPGRelTransNaoIdentif.dfdFinal )
								Call SalMessageBox( 'Data inicial deve ser menor do que a data final.', 'Atenção', MB_IconExclamation | MB_Ok )
								Call SalClearField( frmPGRelTransNaoIdentif.dfdFinal )
								Return VALIDATE_Cancel
						Call SalSendClassMessage( SAM_Validate, wParam, lParam )
			Group Box: Saída
				Resource Id: 55662
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.188"
					Top: 0.917"
					Width:  4.138"
					Width Editable? Yes
					Height: 0.531"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Radio Button: rbTela
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Tela
				Window Location and Size
					Left: 0.35"
					Top: 1.104"
					Width:  0.9"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sValorCampoFonte = 'T'
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = TRUE
						Set _sNomeCampoFonte = 'dfsSaida'
						Set _bRadioButtonDefault = FALSE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Radio Button: rbImpressora
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Impressora
				Window Location and Size
					Left: 2.75"
					Top: 1.104"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sValorCampoFonte = 'I'
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = TRUE
						Set _sNomeCampoFonte = 'dfsSaida'
						Set _bRadioButtonDefault = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Data Field: dfsSaida
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 0.45"
						Top: 1.615"
						Width:  0.425"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = FALSE
						Set _sValorDefault = 'I'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			! -----------Botões----------------
			Pushbutton: pbImprimir
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: Im&primir
				Window Location and Size
					Left: 2.138"
					Top: 1.625"
					Width:  1.15"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _nPermissao = 15
						Set _sTipoComando = 'Comum'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						If SalIsNull( frmPGRelTransNaoIdentif.dfdInicial)
							Call SalMessageBox( 'Data inicial é obrigatória.', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( frmPGRelTransNaoIdentif.dfdInicial )
							Return FALSE
						If SalIsNull( frmPGRelTransNaoIdentif.dfdFinal)
							Call SalMessageBox( 'Data final é obrigatória.', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( frmPGRelTransNaoIdentif.dfdFinal )
							Return FALSE
						If frmPGRelTransNaoIdentif.dfdFinal < frmPGRelTransNaoIdentif.dfdInicial AND NOT SalIsNull( frmPGRelTransNaoIdentif.dfdFinal )
							Call SalMessageBox( 'Data inicial deve ser menor do que a data final.', 'Atenção', MB_IconExclamation | MB_Ok )
							Return FALSE
						If dfsSaida='I'
							Call SalReportPrint( hWndForm, 'TransNaoIndent.qrp',
									'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, dfdInicial, dfdFinal, sArquivo, dCredito, sDescricao, sTipo, nValor', 
									'Secretaria, Detran, Setor, DescricaoSetor, Inicial, Final, Arquivo, Credito, Descricao, Tipo, Valor', 1,RPT_PrintAll, 0, 0, nErro )
						Else
							Call SalReportView( hWndForm, hWndNULL,'TransNaoIndent.qrp',
									'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, dfdInicial, dfdFinal, sArquivo, dCredito, sDescricao, sTipo, nValor', 
									'Secretaria, Detran, Setor, DescricaoSetor, Inicial, Final, Arquivo, Credito, Descricao, Tipo,Valor', nErro )
			Pushbutton: pbSair
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Sair
				Window Location and Size
					Left: 3.313"
					Top: 1.625"
					Width:  1.15"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTipoComando = 'Sai'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Picture: picSemaforo
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQCK1Form
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 0.05"
					Top: 1.604"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
		Functions
		Window Parameters
		Window Variables
			String: sTipo
			Number: nValor
			String: sArquivo
			Sql Handle: hSql
			String: sDescricao
			Date/Time: dCredito
		Message Actions
			On SAM_Create
				Set _nEstadoInicialForm = 1
				Set _sTextoStatusBar = 'Relatório de Transações não Identificadas'
				Call SalSendClassMessage( SAM_Create, wParam, lParam )
				Call SalCenterWindow( hWndForm )
			On SAM_ReportStart
				Call SalReportDlgOptions( SalNumberToWindowHandle( wParam ), 'Impressão', 'Imprimindo', 'Relatório de Transações não Identificadas', 'Relatório de Transações não Identificadas' )
				Return TRUE
			On SAM_ReportFetchInit
				If fMPSConnect( hSql )
					If fMPSPrepareProc( hSql, 'Exec dbarrecadacao..PGTransNaoIdentifS 
							@dInicial		=:frmPGRelTransNaoIdentif.dfdInicial,
							@dFinal		=:frmPGRelTransNaoIdentif.dfdFinal', '
							:frmPGRelTransNaoIdentif.sArquivo,
							:frmPGRelTransNaoIdentif.dCredito,
							:frmPGRelTransNaoIdentif.sDescricao,
							:frmPGRelTransNaoIdentif.sTipo,
							:frmPGRelTransNaoIdentif.nValor' )
						If SqlExecute( hSql )
							Return TRUE
				Return FALSE
			On SAM_ReportFetchNext
				Call SqlFetchNext( hSql, lParam )
				If lParam != FETCH_EOF
					Return TRUE
				Else
					Return FALSE
	! cQCK1TableWindow: tblImpressaoPayGo
.winattr class Table Window:
		Class: cQCK1TableWindow
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accessories Enabled? No
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left: Default
				Top: Default
				Width:  6.325"
				Width Editable? Yes
				Height: 3.063"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: Default
			Discardable? Yes
.end
		Description: 
		Named Menus 
		Menu 
		Tool Bar 
.winattr
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
.end
			Contents 
		Contents 
			Column: colsTexto
.winattr class
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1Column
				Property Template:
				Class DLL Name:
				Title:
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				List Values 
				Message Actions 
			Column: colnValor
.winattr class
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1Column
				Property Template:
				Class DLL Name:
				Title:
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				List Values 
				Message Actions 
			Column: colnOrder
.winattr class
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1Column
				Property Template:
				Class DLL Name:
				Title:
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				List Values 
				Message Actions 
			! !CB!! 114
					Combo Box: cmbCartao
					.data CLASSPROPSSIZE
					0000: 1D00
					.enddata
					.data CLASSPROPS
					0000: 5461624368696C64 4E616D6573000A00 7461624465626974 6F00000000
					.enddata
					.data INHERITPROPS
					0000: 0100
					.enddata
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK1ComboBox
						Property Template:
						Class DLL Name:
						Window Location and Size
							Left: 7.788"
							Top: 0.573"
							Width:  1.4"
							Width Editable? Class Default
							Height: 0.938"
							Height Editable? Class Default
						Visible? Yes
						Editable? No
						String Type: Class Default
						Maximum Data Length: Default
						Sorted? Class Default
						Always Show List? Class Default
						Vertical Scroll? Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
						List Initialization
						Message Actions
							On SAM_Create
								Set _bVisivel = TRUE
								Set _bPermiteNulos = TRUE
								Set _sTextoStatusBar = 'UF do veículo'
								Set _sNomeParaMsgs = 'UF'
								Set _bSempreHabilitado = TRUE
								Set _sNomeCampoCodigo = 'dfsCodCartao'
								Set _sConsultaBD = 'exec dbarrecadacao..CartaoCreditoS_Cod'
								Set _sRefresh = 'Create'
								Set _bNaoTemDependentes = TRUE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
							On SAM_Click
								Call fFileDeleteIntPos()
								Call SalSendClassMessage( SAM_Click, wParam, lParam )
								Set nTotalSelecionadoIPVA = 0
								Set nTotalSelecionadoDETRAN = 0
								Set nTotalSelecionadoFENASEG = 0
								If Not tblDebito.fPermitePagamentoComCartao()
									Return FALSE
								If fMPSConnect( hSql )
									If NOT MPSPrepareProc( hSql, 'exec tmpDebEmitirD', ':frmGuiaLicenciamento.nIDProcesso' )
										Call fMPSDisconnect( hSql )
										Call SalWaitCursor( FALSE )
										Call ErroForm( 5 )
										Return FALSE
									If NOT SqlExecute( hSql )
										Call fMPSDisconnect( hSql )
										Call SalWaitCursor( FALSE )
										Return FALSE
									Call SqlFetchNext( hSql, nRetorno )
									Call fMPSDisconnect( hSql )
								If SalTblAnyRows( tblDebito, ROW_Edited, 0 )
									If fMPSConnect( hSql )
										If NOT MPSPrepareProc( hSql, 'exec tmpDebEmitirI
												@ID = :frmGuiaLicenciamento.nIDProcesso,
												@SetorDebito = :frmGuiaLicenciamento.tblDebito.colsDeSetor,
												@CodDebito = :frmGuiaLicenciamento.tblDebito.colnDeCod,
												@Parcela = :frmGuiaLicenciamento.tblDebito.colnDePar', '' )
											Call fMPSDisconnect( hSql )
											Call SalWaitCursor( FALSE )
											Return FALSE
										If NOT SalTblDoUpdates( tblDebito, hSql, FALSE )
											Call fMPSDisconnect( hSql )
											Call SalWaitCursor( FALSE )
											Return FALSE
										Call fMPSDisconnect( hSql )
								If fMPSConnect (hSql)
									! Call SqlSetInMessage( hSql, 10000 )
									If NOT MPSPrepareProc( hSql, 'exec ImprimeFichaComp_Impressao_Feb
											@ID =  :frmGuiaLicenciamento.nIDProcesso, @CartaoDebito = "S"',':nTotalSelecionadoIPVA,:nTotalSelecionadoDETRAN,:nTotalSelecionadoFENASEG' )
										Call fMPSDisconnect (hSql)
										Call SalWaitCursor( FALSE )
										Call ErroForm( 0 )
										Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
										Return FALSE
									If NOT SqlExecute( hSql)
										Call fMPSDisconnect (hSql)
										Call SalWaitCursor( FALSE )
										Call SalSendMsg( hWndForm, MSG_Limpa, 0, 0 )
										Return FALSE
									Set sTipo = ''
									Call SqlFetchNext(hSql,nRetorno)
									Call fMPSDisconnect( hSql )
									!
									Set sRede = cmbCartao
									Call VisFileDelete( 'C:\\TEF_DIAL\\REQ\\IntPos.001' )
									Call VisFileDelete( 'C:\\TEF_DIAL\\REQ\\IntPos.tmp' )
									Call VisFileDelete('C:\\TEF_DIAL\\REQ\\Impr.txt')
									If nTotalSelecionadoIPVA > 0
										Set sTipo = '0'
										If fGravaArquivoIntPos(nTotalSelecionadoIPVA) = FALSE
											Return FALSE
									!
									Call VisFileDelete( 'C:\\TEF_DIAL\\REQ\\IntPos.001' )
									Call VisFileDelete( 'C:\\TEF_DIAL\\REQ\\IntPos.tmp' )
									!
									! Call SalPause(15000)
									If nTotalSelecionadoIPVA > 0
										Set dfsImpressao = 'AGUARDE... '||sTextoOperador
										Call SalPause(10000)
									Set dfsImpressao = ''
									If nTotalSelecionadoFENASEG > 0
										Set sTipo = '1'
										If fGravaArquivoIntPos(nTotalSelecionadoFENASEG) = FALSE
											Return FALSE
									!
									Call VisFileDelete( 'C:\\TEF_DIAL\\REQ\\IntPos.001' )
									Call VisFileDelete( 'C:\\TEF_DIAL\\REQ\\IntPos.tmp' )
									!
									If nTotalSelecionadoFENASEG > 0
										Set dfsImpressao = 'AGUARDE... '||sTextoOperador
										Call SalPause(10000)
									Set dfsImpressao = ''
									If nTotalSelecionadoDETRAN > 0
										Set sTipo = '2'
										If fGravaArquivoIntPos(nTotalSelecionadoDETRAN) =  FALSE
											Return FALSE
									If nTotalSelecionadoDETRAN > 0
										Set dfsImpressao = 'AGUARDE... '||sTextoOperador
										Call SalPause(3000)
									Set dfsImpressao = ''
					
		Functions 
		Window Parameters 
		Window Variables 
		Message Actions 
	! -----------------------------------------------------------------------------  [faml]  06/05/2009  flaviolago@detran.pe.gov.br
	! 1. Criar relatório Comaprativo de Arrecadação TEF - Por Ponto de Atendimento
	Form Window: frmComparativoArrecadaTEF
		Class: cQCK1Form
		Property Template:
		Class DLL Name:
		Title: Relatório Comparativo de Arrecadação TEF - Por Ponto de Atendimento
		Icon File:
		Accessories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? No
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left: 1.538"
				Top: 1.583"
				Width:  9.313"
				Width Editable? Class Default
				Height: 4.625"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Relatório Comaprativo de Arrecadação TEF - Por Ponto de Atendimento
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
		Contents
			! ----------------------------------------------------------------
			Background Text: Período de Atendimento: de
				Resource Id: 43489
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.163"
					Top: 0.229"
					Width:  2.325"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfdInicial
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 20
					Data Type: Date/Time
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 2.488"
						Top: 0.188"
						Width:  1.225"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Right
					Format: dd/MM/yyyy
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 99-99-9999
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sTextoStatusBar = 'Data incial do atendimento'
						Set _bSempreHabilitado = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Validate
						If NOT SalIsNull( dfdInicial )
							If NOT (SalIsValidDateTime( dfdInicial ))
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Data inválida.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( dfdInicial )
								Return VALIDATE_Cancel
							Else If (SalDateYear( dfdInicial ) < 1753)
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Ano inválido.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( dfdInicial )
								Return VALIDATE_Cancel
							If dfdFinal < dfdInicial AND NOT SalIsNull( dfdFinal )
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Data Inicial deve ser menor do que a data Final.', 'Atenção', MB_IconExclamation | MB_Ok )
						Call SalSendClassMessage( SAM_Validate, wParam, lParam )
			Background Text: a
				Resource Id: 43490
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 3.763"
					Top: 0.229"
					Width:  0.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfdFinal
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: Date/Time
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 4.013"
						Top: 0.188"
						Width:  1.2"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Right
					Format: dd/MM/yyyy
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 99-99-9999
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sTextoStatusBar = 'Data final do atendimento'
						Set _bSempreHabilitado = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Validate
						If NOT SalIsNull( dfdFinal )
							If NOT (SalIsValidDateTime( dfdFinal ))
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Data inválida.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( dfdFinal )
								Return VALIDATE_Cancel
							Else If SalDateYear( dfdFinal ) < 1753
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Ano inválido.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( dfdFinal )
								Return VALIDATE_Cancel
							Else If dfdFinal < dfdInicial
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Data Final do período deve ser maior ou igual à data Inicial.', 'Atenção', MB_Ok | MB_IconExclamation )
						Call SalSendClassMessage( SAM_Validate, wParam, lParam )
			! ---------------------------------------------------------------- 
			Background Text: Setores:
				Resource Id: 43491
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.163"
					Top: 0.563"
					Width:  2.325"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Child Table: tblSetores
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1ChildTable
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.163"
						Top: 0.823"
						Width:  7.325"
						Width Editable? Class Default
						Height: 2.917"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 5000
					Discardable? No
				Contents
					Column: colsCodigo
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK1Column
						Property Template:
						Class DLL Name:
						Title: Setor
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  0.975"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = TRUE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
					Column: colsDescricao
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK1Column
						Property Template:
						Class DLL Name:
						Title: Descrição
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  5.838"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = TRUE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
					Column: colnCodRed
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK1Column
						Property Template:
						Class DLL Name:
						Title: Cod Red
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.05"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = FALSE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
				Functions
				Window Variables
					Number: nAux
					String: sSetor
					Number: nSetor
				Message Actions
					On SAM_Create
						Set _sCriacaoConexao = 'FALSE'
						Set _bCriacaoConexaoAuxiliar = FALSE
						Set _sTextoStatusBar = 'Click à esquerda do setor para marcar ou desmarcar o setor a ser impresso. Click no canto superior esquerdo (coluna sem título) para marcar ou desmarcar todos os setores.'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					! ............................................CLICK NA 1a. COLUNA À ESQUERDA DO GRID tblSetores (em cada linha exibida)
					On SAM_RowHeaderClick
						! -------------------------------- Se a linha estiver marcada, desmarca.
						If SalTblQueryRowFlags( tblSetores, lParam, ROW_Edited )
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoD  @ID= :nID, @CodRedSetor= :tblSetores.colnCodRed', '')
							Call SqlExecute( hSqlApp )
							Return TRUE
						! -------------------------------- Se a linha estiver desmarcada, marca.
						Else
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
							Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoI  @ID= :nID, @CodRedSetor= :tblSetores.colnCodRed', '')
							Call SqlExecute( hSqlApp )
							Return TRUE
					! .............................................CLICK NO (título da 1a. coluna) CANTO SUPERIOR ESQUERDO DO GRID tblSetores
					On SAM_CornerClick
						Call SalWaitCursor( TRUE )
						Set nAux = TBL_MinRow
						! ---------------------------- apagar seleção anterior dos setores do usuário e recuperar o seu @@spid
						Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoD',':nID')
						Call SqlExecute( hSqlApp )
						Call SqlFetchNext( hSqlApp, lParam )
						! -------------------------------- Se as linhas estiverem marcadas, desmarca todas.
						If SalTblFindNextRow( hWndForm, nAux, ROW_Edited, 0)
							Set nAux = TBL_MinRow
							While SalTblFindNextRow( hWndForm, nAux, 0, 0)
								Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, FALSE )
						! -------------------------------- Se as linhas estiverem desmarcadas, marca todas.
						Else
							Set nAux = TBL_MinRow
							While SalTblFindNextRow( hWndForm, nAux, 0, 0)
								Call SalTblSetContext(hWndForm,nAux)
								Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, TRUE )
								Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoI  @ID= :nID, @CodRedSetor= :tblSetores.colnCodRed', '')
								Call SqlExecute( hSqlApp )
						Call SalWaitCursor( FALSE )
					! .............................................Popula tabela (grid) de setores
					On MSG_PopulaTabela
						Call SalWaitCursor( TRUE )
						Call SalTblReset( tblSetores )
						Call SybPrepareProc( hSqlApp, 'exec dbvcen..SetorS_codred_dig_desc',
								                                ':colnCodRed, :colsCodigo,  :colsDescricao' )
						If NOT  SalTblPopulate(tblSetores, hSqlApp, '', TBL_FillAll )
							Call SalWaitCursor( FALSE )
							Return FALSE
						Call SalWaitCursor( FALSE )
						Return TRUE
			Background Text: Setores kkkkk:
				Resource Id: 43492
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 5.563"
					Top: 0.229"
					Width:  3.325"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			! cQCK1BackgroundText: Requisição:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 746162446F63756D 656E746F00000000
.enddata
.data CLASSPROPSSIZE
0000: 2000
.enddata
.winattr class Background Text:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 2.938"
					Top: 1.635"
					Width:  1.05"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
.end
			! ----------------------------------------------------------------
			Group Box: Saída
				Resource Id: 43493
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 7.538"
					Top: 0.781"
					Width:  1.35"
					Width Editable? Yes
					Height: 1.042"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfsSaida
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 8.388"
						Top: 0.99"
						Width:  0.2"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = FALSE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Radio Button: rbTela
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Tela
				Window Location and Size
					Left: 7.638"
					Top: 1.031"
					Width:  0.9"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call SalDisableWindow( pbImpressoras )
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sValorCampoFonte = 'T'
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = TRUE
						Set _sNomeCampoFonte = 'dfsSaida'
						! ...................................saída default do relatório é a tela
						Set _bRadioButtonDefault = TRUE
						!
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Radio Button: rbImpressora
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Impressora
				Window Location and Size
					Left: 7.638"
					Top: 1.406"
					Width:  1.15"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call SalEnableWindow( pbImpressoras )
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sValorCampoFonte = 'I'
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = TRUE
						Set _sNomeCampoFonte = 'dfsSaida'
						Set _bRadioButtonDefault = FALSE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			! ----------------------------------------------------------------
			Pushbutton: pbImprimir
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: Im&primir
				Window Location and Size
					Left: 7.6"
					Top: 2.042"
					Width:  1.15"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTabela = ''
						Set _nPermissao = 15
						Set _sTipoComando = 'Comum'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						If SalIsNull(dfdInicial)
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Data inicial é obrigatória!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfdInicial )
							Return FALSE
						If SalIsNull(dfdFinal)
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Data final é obrigatória!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfdFinal )
							Return FALSE
						If dfdFinal < dfdInicial AND NOT SalIsNull( dfdFinal )
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Data inicial deve ser menor do que a data final.', 'Atenção', MB_IconExclamation | MB_Ok )
							Return FALSE
						! --------
						If NOT SalTblAnyRows( tblSetores, ROW_Edited, 0 )
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Selecione pelo menos um setor a ser impresso!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalAbort( -1)
						! ........................SAÍDA IMPRESSORA
						! ........................[faml] 01/07/2009 begin: mudou o nome do qrp
						! DE: RelComparativoArrecadaTEFPontoAtend.qrp PARA: CATEFPA.qrp
						If dfsSaida='I'
							Call SalReportPrint( hWndForm, 'CATEFPA.qrp',
									'sGlobalSecretaria,
									dfdInicial,
									dfdFinal,
									sPontoAtendimento,
									nQtdeAtend,
									nValorAtend,
									nQtdeTEF,
									nValorTEF'
									,
									'sReportHeader,
									dDtInicial,
									dDtFinal,
									sPontoAtendimento,
									nQtdeAtend,
									nValorAtend,
									nQtdeTEF,
									nValorTEF'
									, 1, RPT_PrintAll, 0, 0, nErro )
						! ........................SAÍDA TELA
						Else
							! ........................[faml] 01/07/2009 begin: mudou o nome do qrp
							! DE: RelComparativoArrecadaTEFPontoAtend.qrp PARA: CATEFPA.qrp
							If hWndReportView != hWndNULL
								Call SalReportClose( hWndReportView )
								Call SalDestroyWindow( hWndReportView )
								Set hWndReportView = hWndNULL
							Set hWndReportView= SalCreateWindow( frmReportView, hWndForm )
							Call SalSetWindowText( hWndReportView, 'Relatório Comparativo de Arrecadação TEF - Por Ponto de Atendimento' )
							Call SalReportView( hWndForm, hWndReportView,'CATEFPA.qrp',
									'sGlobalSecretaria, 
									dfdInicial, 
									dfdFinal, 
									sPontoAtendimento, 
									nQtdeAtend, 
									nValorAtend,
									nQtdeTEF, 
									nValorTEF'
									,
									'sReportHeader, 
									dDtInicial, 
									dDtFinal, 
									sPontoAtendimento, 
									nQtdeAtend, 
									nValorAtend,
									nQtdeTEF, 
									nValorTEF'
									, nErro )
			Pushbutton: pbImpressoras
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: Con&figurar
				Window Location and Size
					Left: 7.6"
					Top: 2.333"
					Width:  1.15"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalPrtGetDefault( sDeviceDef, sDriverDef, sPortaDef )
						Call SalPrtSetup(sDevice,sDriver,sPorta,FALSE)
					On SAM_Create
						Set _sTabela = ''
						Set _nPermissao = 15
						Set _sTipoComando = 'Comum'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Pushbutton: pbSair
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Sair
				Window Location and Size
					Left: 7.6"
					Top: 2.625"
					Width:  1.15"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! .............................................................. apagar seleção dos setores do usuário
						Call fLimparTmpSetorSelecionado( )
						!
						Set _sTabela = ''
						Set _sTipoComando = 'Sai'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			! ---------------------------------------------------------------- 
			Frame
				Resource Id: 43494
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: -0.013"
					Top: -0.427"
					Width:  9.0"
					Width Editable? Yes
					Height: 4.5"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: 3D Face Color
			Picture: picSemaforo
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQCK1Form
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 0.188"
					Top: 3.781"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
		Functions
			! ----------------------------------------------------- apagar seleção dos setores na tmpSetorSelecionado
			Function: fLimparTmpSetorSelecionado
				Description: apagar seleção dos setores na tmpSetorSelecionado
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoD',':nID')
					Call SqlExecute( hSqlApp )
					Call SqlFetchNext( hSqlApp, lParam )
		Window Parameters
		Window Variables
			! ................................................
			Number: nID
			String: sReportHeader
			String: sPontoAtendimento
			Number: nQtdeAtend
			Number: nValorAtend
			Number: nQtdeTEF
			Number: nValorTEF
			! ................................................
			Number: nErro
			String: sDevice
			String: sDriver
			String: sPorta
			String: sDeviceDef
			String: sDriverDef
			String: sPortaDef
			!
			Window Handle: hWndReportView
			! Variáveis do relatório
			String: sDescricaoBandeira
			Number: nSetor
			String: sDescricaoSetor
			Number: nSequencialTransacao
			String: sPlaca
			String: sNumBancario
			String: sDescricaoDebito
			String: sRede
			Date/Time: dDataPagamento
			Number: nValorPago
			! Number: nValor
			! Number: nQtde
			String: sSituacao
			String: sPendentes
		Message Actions
			On SAM_Create
				Set _nEstadoInicialForm = 1
				Set _sTextoStatusBar = 'Relatório Comparativo de Arrecadação TEF - Por Ponto de Atendimento'
				Call SalSendClassMessage( SAM_Create, wParam, lParam )
				Call SalCenterWindow( hWndForm )
				! ---------------------------- apagar seleção anterior dos setores do usuário e recuperar o seu @@spid
				Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoD',':nID')
				Call SqlExecute( hSqlApp )
				Call SqlFetchNext( hSqlApp, lParam )
				! ------------------------------------------------- nID é igual ao @@spid
			On SAM_CreateComplete
				Call SalSendClassMessage( SAM_CreateComplete, wParam, lParam )
				! ----------------------------------------------- Popula tabela (grid) de setores 
				Call SalSendMsg( tblSetores, MSG_PopulaTabela, wParam, lParam  )
				! .............................................................habilita (edição) marcar/desmarcar linhas da tblSetores
				Call SalEnableWindow( tblSetores )
				! ............................................................desabilita edição nas colunas da tblSetores
				Call SalDisableWindow( tblSetores.colsCodigo )
				Call SalDisableWindow( tblSetores.colsDescricao )
				! ................................... saída default do relatório é a tela; logo, o botão Configurar fica desativado ao abrir o form
				Call SalDisableWindow( pbImpressoras )
			On SAM_ReportStart
				Call SalReportDlgOptions( SalNumberToWindowHandle( wParam ), 'Impressão', 'Imprimindo', 'Relatório Comaprativo de Arrecadação TEF', 'Relatório Comaprativo de Arrecadação TEF - Por Ponto de Atendimento' )
				Return TRUE
			On SAM_ReportFetchInit
				Call SybPrepareProc( hSql,'exec dbarrecadacao..ComparaArrecadaTEFPontoAtend 
						@ID = :nID,
						@DtInicial = :dfdInicial, 
						@DtFinal = :dfdFinal'
						,
						':sPontoAtendimento, 
						:nQtdeAtend, 
						:nValorAtend,
						:nQtdeTEF, 
						:nValorTEF' )
				Return SqlExecute( hSql )
			On SAM_ReportFetchNext
				Call SqlFetchNext( hSql, nErro )
				If nErro != FETCH_EOF
					Return 1
				Else
					Return 0
			On SAM_ReportFinish
				Call SalPrtSetDefault(sDeviceDef,sDriverDef,sPortaDef)
			On SAM_Destroy
				! .............................................................. apagar seleção dos setores do usuário
				Call fLimparTmpSetorSelecionado( )
				!
				If hWndReportView != hWndNULL
					Call SalReportClose( hWndReportView )
					Call SalDestroyWindow( hWndReportView )
					Set hWndReportView = hWndNULL
				Call SalSendClassMessage( SAM_Destroy, wParam, lParam )
	! -----------------------------------------------------------------------------  [faml]  06/05/2009  end
	! --------------------------------------------------- [faml] 26/08/2009 begin: criação do form frmPGRelTefMaquineta
	Form Window: frmPGRelTefMaquineta
		Class: cQCK1Form
		Property Template:
		Class DLL Name:
		Title: Relatório TEF - Por Maquineta
		Icon File:
		Accessories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? No
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left: 1.538"
				Top: 1.583"
				Width:  11.7"
				Width Editable? Class Default
				Height: 4.635"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Relatório de Transação TEF - Por Maquineta
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
		Contents
			! ----------------------------------------------------------------
			Background Text: Período da Transação (venda):       de
				Resource Id: 48548
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.175"
					Top: 0.219"
					Width:  3.088"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfdInicial
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 20
					Data Type: Date/Time
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 3.288"
						Top: 0.188"
						Width:  1.225"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Right
					Format: dd/MM/yyyy
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 99-99-9999
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sTextoStatusBar = 'Data incial da transação (venda)'
						Set _bSempreHabilitado = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Validate
						If NOT SalIsNull( dfdInicial )
							If NOT (SalIsValidDateTime( dfdInicial ))
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Data inválida.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( dfdInicial )
								Return VALIDATE_Cancel
							Else If (SalDateYear( dfdInicial ) < 1753)
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Ano inválido.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( dfdInicial )
								Return VALIDATE_Cancel
							If dfdFinal < dfdInicial AND NOT SalIsNull( dfdFinal )
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Data Inicial deve ser menor do que a data Final.', 'Atenção', MB_IconExclamation | MB_Ok )
						Call SalSendClassMessage( SAM_Validate, wParam, lParam )
			Background Text: a
				Resource Id: 48549
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 4.563"
					Top: 0.229"
					Width:  0.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfdFinal
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: Date/Time
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 4.813"
						Top: 0.188"
						Width:  1.2"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Right
					Format: dd/MM/yyyy
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: 99-99-9999
				Message Actions
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sTextoStatusBar = 'Data final da transação (venda)'
						Set _bSempreHabilitado = TRUE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Validate
						If NOT SalIsNull( dfdFinal )
							If NOT (SalIsValidDateTime( dfdFinal ))
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Data inválida.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( dfdFinal )
								Return VALIDATE_Cancel
							Else If SalDateYear( dfdFinal ) < 1753
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Ano inválido.', 'Atenção', MB_Ok | MB_IconExclamation )
								Call SalClearField( dfdFinal )
								Return VALIDATE_Cancel
							Else If dfdFinal < dfdInicial
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Data Final do período deve ser maior ou igual à data Inicial.', 'Atenção', MB_Ok | MB_IconExclamation )
						Call SalSendClassMessage( SAM_Validate, wParam, lParam )
			! ---------------------------------------------------------------- 
			Child Table: tblSetores
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1ChildTable
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.15"
						Top: 0.854"
						Width:  9.675"
						Width Editable? Class Default
						Height: 2.917"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 5000
					Discardable? No
				Contents
					Column: colsDescricao
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK1Column
						Property Template:
						Class DLL Name:
						Title: Descrição
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  5.263"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = TRUE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
					Column: colsCodTefVisa
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK1Column
						Property Template:
						Class DLL Name:
						Title: CodTefVisanet
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.4"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = TRUE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
					Column: colsCodTefRede
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK1Column
						Property Template:
						Class DLL Name:
						Title: CodTefRedecard
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.463"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = TRUE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
					Column: colsCodigo
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK1Column
						Property Template:
						Class DLL Name:
						Title: Setor
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  0.975"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = TRUE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
					Column: colnCodRed
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cQCK1Column
						Property Template:
						Class DLL Name:
						Title: Cod Red
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.05"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								Set _bVisivel = FALSE
								Call SalSendClassMessage( SAM_Create, wParam, lParam )
				Functions
				Window Variables
					Number: nAux
					String: sSetor
					Number: nSetor
				Message Actions
					On SAM_Create
						Set _sCriacaoConexao = 'FALSE'
						Set _bCriacaoConexaoAuxiliar = FALSE
						Set _sTextoStatusBar = 'Click à esquerda do setor para marcar ou desmarcar o setor a ser impresso. Click no canto superior esquerdo (coluna sem título) para marcar ou desmarcar todos os setores.'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					! ............................................CLICK NA 1a. COLUNA À ESQUERDA DO GRID tblSetores (em cada linha exibida)
					On SAM_RowHeaderClick
						! -------------------------------- Se a linha estiver marcada, desmarca.
						If SalTblQueryRowFlags( tblSetores, lParam, ROW_Edited )
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoD  @ID= :nID, @CodRedSetor= :tblSetores.colnCodRed', '')
							Call SqlExecute( hSqlApp )
							Return TRUE
						! -------------------------------- Se a linha estiver desmarcada, marca.
						Else
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
							Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoI  @ID= :nID, @CodRedSetor= :tblSetores.colnCodRed
									, @CodTefVisa= :tblSetores.colsCodTefVisa
									, @CodTefRede= :tblSetores.colsCodTefRede', '')
							Call SqlExecute( hSqlApp )
							Return TRUE
					! .............................................CLICK NO (título da 1a. coluna) CANTO SUPERIOR ESQUERDO DO GRID tblSetores
					On SAM_CornerClick
						Call SalWaitCursor( TRUE )
						Set nAux = TBL_MinRow
						! ---------------------------- apagar seleção anterior dos setores do usuário e recuperar o seu @@spid
						Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoD',':nID')
						Call SqlExecute( hSqlApp )
						Call SqlFetchNext( hSqlApp, lParam )
						! -------------------------------- Se as linhas estiverem marcadas, desmarca todas.
						If SalTblFindNextRow( hWndForm, nAux, ROW_Edited, 0)
							Set nAux = TBL_MinRow
							While SalTblFindNextRow( hWndForm, nAux, 0, 0)
								Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, FALSE )
						! -------------------------------- Se as linhas estiverem desmarcadas, marca todas.
						Else
							Set nAux = TBL_MinRow
							While SalTblFindNextRow( hWndForm, nAux, 0, 0)
								Call SalTblSetContext(hWndForm,nAux)
								Call SalTblSetRowFlags( hWndForm, nAux, ROW_Edited, TRUE )
								Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoI  @ID= :nID, @CodRedSetor= :tblSetores.colnCodRed
										, @CodTefVisa= :tblSetores.colsCodTefVisa, @CodTefRede= :tblSetores.colsCodTefRede', '')
								Call SqlExecute( hSqlApp )
						Call SalWaitCursor( FALSE )
					! .............................................Popula tabela (grid) de setores
					On MSG_PopulaTabela
						Call SalWaitCursor( TRUE )
						Call SalTblReset( tblSetores )
						Call SybPrepareProc( hSqlApp, 'exec dbvcen..SetorS_PGTefMaq',
								                                ':colnCodRed, :colsCodigo,  :colsDescricao, :colsCodTefVisa, :colsCodTefRede' )
						If NOT  SalTblPopulate(tblSetores, hSqlApp, '', TBL_FillAll )
							Call SalWaitCursor( FALSE )
							Return FALSE
						Call SalWaitCursor( FALSE )
						Return TRUE
			! Background Text: Setores kkkkk:
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 5.563"
					Top: 0.229"
					Width:  3.325"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
.end
			! cQCK1BackgroundText: Requisição:
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 746162446F63756D 656E746F00000000
.enddata
.data CLASSPROPSSIZE
0000: 2000
.enddata
.winattr class Background Text:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1BackgroundText
				Window Location and Size
					Left: 2.938"
					Top: 1.635"
					Width:  1.05"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
.end
			! ----------------------------------------------------------------
			Group Box: Saída
				Resource Id: 48552
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 9.963"
					Top: 0.833"
					Width:  1.35"
					Width Editable? Yes
					Height: 1.042"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfsSaida
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 11.05"
						Top: 0.99"
						Width:  0.2"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = FALSE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Radio Button: rbTela
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Tela
				Window Location and Size
					Left: 10.063"
					Top: 1.083"
					Width:  0.9"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call SalDisableWindow( pbImpressoras )
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sValorCampoFonte = 'T'
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = TRUE
						Set _sNomeCampoFonte = 'dfsSaida'
						! ...................................saída default do relatório é a tela
						Set _bRadioButtonDefault = TRUE
						!
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Radio Button: rbImpressora
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Impressora
				Window Location and Size
					Left: 10.063"
					Top: 1.458"
					Width:  1.15"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call SalEnableWindow( pbImpressoras )
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sValorCampoFonte = 'I'
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = TRUE
						Set _sNomeCampoFonte = 'dfsSaida'
						Set _bRadioButtonDefault = FALSE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			! ---------------------------------------------------------------- 
			Group Box: Tipo
				Resource Id: 48554
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 9.975"
					Top: 2.104"
					Width:  1.35"
					Width Editable? Yes
					Height: 0.938"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfsTipo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 11.063"
						Top: 2.208"
						Width:  0.2"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Set _bVisivel = FALSE
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Radio Button: rbAnalitco
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Analítico
				Window Location and Size
					Left: 10.1"
					Top: 2.698"
					Width:  1.1"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call SalDisableWindow( pbImpressoras )
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sValorCampoFonte = 'A'
						! rel. criado apenas com o tipo sintético
						Set _bNuncaHabilitado = TRUE
						Set _bSempreHabilitado = FALSE
						Set _sNomeCampoFonte = 'dfsTipo'
						Set _bRadioButtonDefault = FALSE
						!
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Radio Button: rbSintetico
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1RadioButton
				Property Template:
				Class DLL Name:
				Title: Sintético
				Window Location and Size
					Left: 10.1"
					Top: 2.333"
					Width:  0.988"
					Width Editable? Class Default
					Height: 0.292"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call SalDisableWindow( pbImpressoras )
					On SAM_Create
						Set _bVisivel = TRUE
						Set _sValorCampoFonte = 'S'
						Set _bNuncaHabilitado = FALSE
						Set _bSempreHabilitado = TRUE
						Set _sNomeCampoFonte = 'dfsTipo'
						! ...................................tipo default do relatório é sintético
						Set _bRadioButtonDefault = TRUE
						!
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			! ---------------------------------------------------------------
			Pushbutton: pbImprimir
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: Im&primir
				Window Location and Size
					Left: 6.3"
					Top: 3.802"
					Width:  1.15"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set _sTabela = ''
						Set _nPermissao = 15
						Set _sTipoComando = 'Comum'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						If SalIsNull(dfdInicial)
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Data inicial é obrigatória!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfdInicial )
							Return FALSE
						If SalIsNull(dfdFinal)
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Data final é obrigatória!', 'Atenção', MB_IconExclamation | MB_Ok )
							Call SalSetFocus( dfdFinal )
							Return FALSE
						If dfdFinal < dfdInicial AND NOT SalIsNull( dfdFinal )
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Data inicial deve ser menor do que a data final.', 'Atenção', MB_IconExclamation | MB_Ok )
							Return FALSE
						If NOT SalTblAnyRows( tblSetores, ROW_Edited, 0 )
							Set nResposta= SalMessageBox ( 'Deseja imprimir todos os pontos de atendimento?', 'Confirmação', MB_IconQuestion | MB_YesNo )
							If nResposta = IDYES
								! usuário confirmou impressão (seleção) de todos os setores. Então..., 
								! ....simular click na coluna sem título da tabela setores para marcar todos os setores antes de imprimir
								Call SalSendMsg( tblSetores, SAM_CornerClick, wParam, lParam )
							Else
								Call SalMessageBeep( 0 )
								Call SalMessageBox( 'Selecione ao menos um ponto de atendimento!', 'Atenção', MB_IconExclamation | MB_Ok )
								Return FALSE
						! ........................SAÍDA IMPRESSORA
						If dfsSaida='I'
							Call SalReportPrint( hWndForm, 'PGTefMaq.qrp',
									'sGlobalSecretaria,
									dfdInicial,
									dfdFinal,
									sPontoAtendimento,
									sMaquinetaVisa,
									nQtdeVisa,
									sMaquinetaRede,
									nQtdeRede,
									dtVenda'
									,
									'sReportHeader,
									dDtInicial,
									dDtFinal,
									sPontoAtendimento,
									sMaquinetaVisa,
									nQtdeVisa,
									sMaquinetaRede,
									nQtdeRede,
									dDtVenda'
									, 1, RPT_PrintAll, 0, 0, nErro )
						! ........................SAÍDA TELA
						Else
							If hWndReportView != hWndNULL
								Call SalReportClose( hWndReportView )
								Call SalDestroyWindow( hWndReportView )
								Set hWndReportView = hWndNULL
							Set hWndReportView= SalCreateWindow( frmReportView, hWndForm )
							Call SalSetWindowText( hWndReportView, 'Relatório de Transações TEF - Por Maquineta' )
							Call SalReportView( hWndForm, hWndReportView,'PGTefMaq.qrp',
									'sGlobalSecretaria, 
									dfdInicial, 
									dfdFinal, 
									sPontoAtendimento, 
									sMaquinetaVisa, 
									nQtdeVisa,
									sMaquinetaRede, 
									nQtdeRede,
									dtVenda'
									,
									'sReportHeader, 
									dDtInicial, 
									dDtFinal, 
									sPontoAtendimento, 
									sMaquinetaVisa, 
									nQtdeVisa,
									sMaquinetaRede, 
									nQtdeRede,
									dDtVenda'
									, nErro )
			Pushbutton: pbImpressoras
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: Con&figurar
				Window Location and Size
					Left: 7.5"
					Top: 3.802"
					Width:  1.15"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalPrtGetDefault( sDeviceDef, sDriverDef, sPortaDef )
						Call SalPrtSetup(sDevice,sDriver,sPorta,FALSE)
					On SAM_Create
						Set _sTabela = ''
						Set _nPermissao = 15
						Set _sTipoComando = 'Comum'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			Pushbutton: pbSair
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1PushButton
				Property Template:
				Class DLL Name:
				Title: &Sair
				Window Location and Size
					Left: 8.7"
					Top: 3.802"
					Width:  1.15"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! .............................................................. apagar seleção dos setores do usuário
						Call fLimparTmpSetorSelecionado( )
						!
						Set _sTabela = ''
						Set _sTipoComando = 'Sai'
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
			! ---------------------------------------------------------------
			Frame
				Resource Id: 48553
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: -0.013"
					Top: -0.427"
					Width:  11.413"
					Width Editable? Yes
					Height: 4.531"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: 3D Face Color
			Background Text: Pontos de Atendimento TEF (Setores)
				Resource Id: 48555
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.175"
					Top: 0.615"
					Width:  3.45"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Picture: picSemaforo
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQCK1Form
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 0.188"
					Top: 3.781"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
		Functions
			! ----------------------------------------------------- apagar seleção dos setores na tmpSetorSelecionado
			Function: fLimparTmpSetorSelecionado
				Description: apagar seleção dos setores na tmpSetorSelecionado
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoD',':nID')
					Call SqlExecute( hSqlApp )
					Call SqlFetchNext( hSqlApp, lParam )
		Window Parameters
		Window Variables
			! ................................................
			Number: nID
			String: sReportHeader
			String: sPontoAtendimento
			String: sMaquinetaVisa
			Number: nQtdeVisa
			String: sMaquinetaRede
			Number: nQtdeRede
			Date/Time: dtVenda
			! ................................................
			Number: nResposta
			Number: nErro
			String: sDevice
			String: sDriver
			String: sPorta
			String: sDeviceDef
			String: sDriverDef
			String: sPortaDef
			!
			Window Handle: hWndReportView
			! Variáveis do relatório
			! String: sDescricaoBandeira
			! Number: nSetor
			! String: sDescricaoSetor
			! Number: nSequencialTransacao
			! String: sPlaca
			! String: sNumBancario
			! String: sDescricaoDebito
			! String: sRede
			! Date/Time: dDataPagamento
			! Number: nValorPago
			! Number: nValor
			! Number: nQtde
			! String: sSituacao
			! String: sPendentes
		Message Actions
			On SAM_Create
				Set _nEstadoInicialForm = 1
				Set _sTextoStatusBar = 'Relatório Comparativo de Arrecadação TEF - Por Ponto de Atendimento'
				Call SalSendClassMessage( SAM_Create, wParam, lParam )
				Call SalCenterWindow( hWndForm )
				! ---------------------------- apagar seleção anterior dos setores do usuário e recuperar o seu @@spid
				Call SybPrepareProc( hSqlApp, 'exec dbvcen..tmpSetorSelecionadoD',':nID')
				Call SqlExecute( hSqlApp )
				Call SqlFetchNext( hSqlApp, lParam )
				! ------------------------------------------------- nID é igual ao @@spid
			On SAM_CreateComplete
				Call SalSendClassMessage( SAM_CreateComplete, wParam, lParam )
				! ----------------------------------------------- Popula tabela (grid) de setores 
				Call SalSendMsg( tblSetores, MSG_PopulaTabela, wParam, lParam  )
				! .............................................................habilita (edição) marcar/desmarcar linhas da tblSetores
				Call SalEnableWindow( tblSetores )
				! ............................................................desabilita edição nas colunas da tblSetores
				Call SalDisableWindow( tblSetores.colsCodigo )
				Call SalDisableWindow( tblSetores.colsDescricao )
				Call SalDisableWindow( tblSetores.colsCodTefVisa )
				Call SalDisableWindow( tblSetores.colsCodTefRede )
				! ................................... saída default do relatório é a tela; logo, o botão Configurar fica desativado ao abrir o form
				Call SalDisableWindow( pbImpressoras )
			On SAM_ReportStart
				Call SalReportDlgOptions( SalNumberToWindowHandle( wParam ), 'Impressão', 'Imprimindo', 'Relatório de Transações TEF', 'Relatório de Transações TEF - Por Maquineta' )
				Return TRUE
			On SAM_ReportFetchInit
				Call SybPrepareProc( hSql,'exec dbvcen..PGRelTEFMaquineta 
						  @ID = :nID
						, @dtInicial = :dfdInicial
						, @dtFinal = :dfdFinal
						, @Tipo= :dfsTipo'
						,
						' :dtVenda
						, :sPontoAtendimento
						, :sMaquinetaVisa 
						, :nQtdeVisa
						, :sMaquinetaRede 
						, :nQtdeRede' )
				Return SqlExecute( hSql )
			On SAM_ReportFetchNext
				Call SqlFetchNext( hSql, nErro )
				If nErro != FETCH_EOF
					Return 1
				Else
					Return 0
			On SAM_ReportFinish
				Call SalPrtSetDefault(sDeviceDef,sDriverDef,sPortaDef)
			On SAM_Destroy
				! .............................................................. apagar seleção dos setores do usuário
				Call fLimparTmpSetorSelecionado( )
				!
				If hWndReportView != hWndNULL
					Call SalReportClose( hWndReportView )
					Call SalDestroyWindow( hWndReportView )
					Set hWndReportView = hWndNULL
				Call SalSendClassMessage( SAM_Destroy, wParam, lParam )
	! --------------------------------------------------- [faml] 26/08/2009 end
  