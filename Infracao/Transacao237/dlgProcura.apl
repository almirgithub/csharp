Application Description: Centura SQLWindows Standard Application Template
	Outline Version - 4.0.28
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400800000
0020: 0000000000A50000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE5FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730A646C
0080: 6750726F63757261
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left: -0.013"
			Top: 0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? No
			Left: 4.15"
			Top: 1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left: 0.575"
			Top: 0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left: 6.388"
			Top: 0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: detran_classes.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
			Enumerations
		Resources
		Variables
		Internal Functions
		Named Menus
		Class Definitions
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton:
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
			ActiveX:
		Application Actions
	Dialog Box: dlgProcura
		Class:
		Property Template:
		Class DLL Name:
		Title: Procura Instantânea
		Accessories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Type of Dialog: Modal
			Window Location and Size
				Left: 1.263"
				Top: 1.083"
				Width:  8.533"
				Width Editable? Yes
				Height: 3.417"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Tela de Procura Instantânea
				----------------------------------------------------------------------------------------------------------------------------------------------------------
				Alteração: [faml] Flávio Lago Spring Agosto/2020 #38133 Aumentar as colunas para visualizar o Cnpj e a Financeira
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Localizar:
				Resource Id: 1131
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.15"
					Top: 0.146"
					Width:  0.933"
					Width Editable? Yes
					Height: 0.188"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Arial
				Font Size: 9
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfsPalavra
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 1.083"
						Top: 0.115"
						Width:  2.583"
						Width Editable? Yes
						Height: 0.229"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Uppercase
					Country: Default
					Font Name: Arial
					Font Size: 9
					Font Enhancement: Default
					Text Color: Black
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_SetFocus
						Call SalMapEnterToTab(TRUE)
					On SAM_KillFocus
						Call SalMapEnterToTab(FALSE)
					On SAM_Validate
						If not SalIsWindowEnabled( cmbModo )
							Call SalSendMsg( tbl1, MSG_Refresh, wParam, lParam )
					On SAM_Create
						If sFiltro = ''
							Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Gray )
							Call SalDisableWindowAndLabel( hWndItem )
			Combo Box: cmbModo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 6.017"
					Top: 0.104"
					Width:  2.325"
					Width Editable? Yes
					Height: 0.833"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				String Type: String
				Maximum Data Length: Default
				Sorted? No
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Arial
				Font Size: 9
				Font Enhancement: Default
				Text Color: Black
				Background Color: Default
				Input Mask: Unformatted
				List Initialization
					Text:
					Text: Como sendo a descrição
					Text: No início da descrição
					Text: No meio da descrição
					Text: No final da descrição
				Message Actions
					On SAM_Create
						If sSQLouSP = 'SP' OR sFiltro = ''
							Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Gray )
							Call SalListSetSelect( hWndItem, 0 )
							Call SalDisableWindowAndLabel( hWndItem )
						Else
							Call SalListSetSelect( hWndItem, 1 )
					On SAM_SetFocus
						Call SalMapEnterToTab(TRUE)
					On SAM_KillFocus
						Call SalMapEnterToTab(FALSE)
					On SAM_Click
						If not SalIsNull(dfsPalavra)
							Call SalSendMsg( tbl1, MSG_Refresh, wParam, lParam )
			Child Table: tbl1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.138"
						Top: 0.396"
						Width:  8.25"
						Width Editable? Yes
						Height: 2.354"
						Height Editable? Yes
					Visible? Yes
					Font Name: Arial
					Font Size: 9
					Font Enhancement: Default
					Text Color: Black
					Background Color: White
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colCod
						Class Child Ref Key: 0
						Class ChildKey: 9
						Class:
						Property Template:
						Class DLL Name:
						Title: Código
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.883"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDescr
						Class Child Ref Key: 0
						Class ChildKey: 10
						Class:
						Property Template:
						Class DLL Name:
						Title: Descrição
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.867"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colAdicional1
						Class Child Ref Key: 0
						Class ChildKey: 11
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colAdicional2
						Class Child Ref Key: 0
						Class ChildKey: 12
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colAdicional3
						Class Child Ref Key: 0
						Class ChildKey: 13
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colAdicional4
						Class Child Ref Key: 0
						Class ChildKey: 14
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colAdicional5
						Class Child Ref Key: 0
						Class ChildKey: 15
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: fCriaColunasAdicionais
						Description: Cria (torna visíveis) as colunas adicionais  além das de código e descrição padrâo.
						Returns
							Boolean:
						Parameters
							Window Handle: hTabela
							Number: nColAdicionais
							String: sColAdicionais [*]
						Static Variables
						Local variables
							Number: nCont
							Window Handle: hColuna
						Actions
							Set hColuna = SalGetFirstChild( hTabela, TYPE_Any )
							Set hColuna = SalGetNextChild( hColuna, TYPE_Any )
							Set nCont = 0
							While nCont < nColAdicionais
								Set hColuna = SalGetNextChild( hColuna, TYPE_Any )
								Call SalShowWindow( hColuna )
								Call SalTblSetColumnTitle( hColuna, sColAdicionais [nCont])
								Set nCont = nCont + 1
							Return TRUE
					Function: fCriaListaINTO
						Description: Cria lista INTO da consulta
						Returns
							String:
						Parameters
							Window Handle: hTbl
							Number: nColAdicionais
						Static Variables
						Local variables
							String: strListaInto
							String: strNomeCol1
							String: strNomeCol2
							String: strNomeForm
							String: strNomeTabela
							String: strNomeCol
							Number: nCont
						Actions
							Call SalGetItemName( hWndForm, strNomeTabela )
							Call SalGetItemName( SalParentWindow(hWndForm), strNomeForm )
							Call SalGetItemName( SalTblGetColumnWindow(hTbl, 1, COL_GetID), strNomeCol1 )
							Call SalGetItemName( SalTblGetColumnWindow(hTbl, 2, COL_GetID), strNomeCol2 )
							Set strListaInto = ':' || strNomeForm || '.' || strNomeTabela || '.' || strNomeCol1 ||
									',:' || strNomeForm || '.' || strNomeTabela || '.' || strNomeCol2
							Set nCont = 0
							While nCont < nColAdicionais
								Call SalGetItemName(SalTblGetColumnWindow( hTbl, nCont+3, COL_GetID ),strNomeCol )
								Set strListaInto =  strListaInto || ',:' || strNomeForm || '.' || strNomeTabela || '.' || strNomeCol
								Set nCont = nCont + 1
							Return strListaInto
					Function: fMontaConsulta
						Description: Monta a consulta que será executada no Banco de Dados
						Returns
							String:
						Parameters
							String: sPalavra
							Number: nModo
							String: sConsulta
							String: sClausula
							String: sSQLouSP
						Static Variables
						Local variables
						Actions
							If sClausula !=  ''
								If sSQLouSP = 'SQL'
									If SalStrScan( sConsulta, 'WHERE' ) = -1
										Set sConsulta = sConsulta || ' where '
									Else
										Set sConsulta = sConsulta || ' AND '
									If nModo = 4
										Set sConsulta = sConsulta || 'upper(' || sClausula || ') like "%' || sPalavra || '"'
									Else If nModo = 3
										Set sConsulta = sConsulta || 'upper(' || sClausula || ') like "%' || sPalavra || '%"'
									Else If nModo = 2
										Set sConsulta = sConsulta || 'upper(' || sClausula || ') like "' || sPalavra || '%"'
									Else
										Set sConsulta = sConsulta || 'upper(' || sClausula || ') = "' || sPalavra || '"'
								Else
									! lms 20/03/96 - Teste do if passou para >=
									If SalStrScan( sConsulta, '@' ) >= 0
										Set sConsulta = sConsulta || ','
									Set sConsulta = sConsulta || ' ' || sClausula || ' = "' || sPalavra || '"'
							Return sConsulta
				Window Variables
					String: strConsulta
					Sql Handle: hSql
					Boolean: bConnect
				Message Actions
					On SAM_Create
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_SingleSelection, TRUE )
						If sFiltro = ''
							Call SalSendMsg( tbl1, MSG_Refresh, 0, 0 )
					On SAM_DoubleClick
						Call SalSendMsg ( pbOk, SAM_Click, wParam, lParam )
					On MSG_Refresh
						Set bConnect = fMPSConnect( hSql )
						If bConnect
							Call fCriaColunasAdicionais( hWndItem, nColAdicionais, sColAdicionais )
							Set strConsulta = fMontaConsulta( dfsPalavra, SalListQuerySelection(cmbModo), sComando, sFiltro, sSQLouSP )
							Call SalWaitCursor( TRUE )
							Call fMPSPrepareProc( hSql, strConsulta, fCriaListaINTO(hWndItem, nColAdicionais))
							Call SalTblPopulate( hWndItem, hSql, '', TBL_FillAll)
							Call SalWaitCursor( FALSE )
							! Posiciona na primeira linha da tabela
							Call SalTblSetRow(hWndItem, TBL_SetFirstRow )
						Else
							Call SalMessageBeep( 0 )
							Call SalMessageBox( 'Problema com a conexão ao Banco de Dados', 'Erro', MB_IconExclamation | MB_Ok )
							Call SalEndDialog( hWndForm, FALSE )
					On SAM_Destroy
						If bConnect
							Call fMPSDisconnect( hSql )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Se&lecionar
				Window Location and Size
					Left: 6.183"
					Top: 2.802"
					Width:  1.15"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Arial
				Font Size: 9
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalGetWindowText(SalTblGetColumnWindow( tbl1, 1, COL_GetID ), strEscolha, BUF_STR_MAX )
						Call SalSendMsg(hWndCampoOrigem, MSG_RecebeValor, wParam, SalHStringToNumber(strEscolha))
						Call SalEndDialog( hWndForm, TRUE )
			Pushbutton: pbCancela
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: &Sair
				Window Location and Size
					Left: 7.383"
					Top: 2.802"
					Width:  0.95"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial
				Font Size: 9
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, FALSE )
		Functions
		Window Parameters
			Window Handle: hWndCampoOrigem
			String: sComando
			String: sFiltro
			String: sSQLouSP
			Number: nColAdicionais
			String: sColAdicionais[*]
		Window Variables
			String: strEscolha
		Message Actions
			On SAM_Create
				Call SalMapEnterToTab(FALSE)
			On SAM_CreateComplete
				If sFiltro = ''
					! lms 18/03/97 - Verifica se a consulta permite parâmetros na tela de Procura
					Call SalDisableWindowAndLabel( dfsPalavra )
					Call SalDisableWindow( cmbModo )
					Call SalSendMsg( tbl1, MSG_Refresh, 0, 0 )
