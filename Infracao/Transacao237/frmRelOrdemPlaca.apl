Application Description: **************************************************************************************
		Projeto Divisão dos Sistemas em APL
		Leandro Neves - 05.10.2005
		*************************************************************************************
	Outline Version - 4.0.28
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000BC0000 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773106672
0080: 6D52656C4F726465 6D506C616361
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left: -0.013"
			Top: 0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left: 4.15"
			Top: 1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left: 0.575"
			Top: 0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left: 6.388"
			Top: 0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		! File Include: Tela_Veiculo.apl
		! File Include: frmConsultaHistVeiculo.apl
		File Include: detran_classes.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: System Default
				Font Size: System Default
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: Use Parent
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
			Enumerations
		Resources
		Variables
		Internal Functions
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 1443028049
0000: AC030000CA010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666FC2003C00 000A630051434B31
0040: 47657261006C0202 00001100001E0004 0000C20003000000 FF7F048300190000
0060: 00F001000000FF1F 1D0000AC00190001 FD00FF0736000000 196B000100FFFFC1
0080: 4F00000019DA0001 00FF7F68B0000000 0400F4020000FF1F 6C0000AC00040002
00A0: FD00FF0770000000 046B000200FFFFC1 7400000004DA0002 00FF7F78B0000000
00C0: 0400F60200FF1F7C 0000AC00040002FD 00FF17800000046B 000200FFFFC18400
00E0: 000004DA000200FF 7F88B00000000400 F60200FF1F8C0000 AC00190001FD00FF
0100: 07A5000000196B00 0100FFFFC1BE0000 0004DA000200FF7F 0180803E00000001
0120: 0070000E63514340 6F6E7461696E7220 AA0000000500006F 0400E801020000FF
0140: C18001000000BF04 190019000101FA00 007F80F20100000F 0800000096190001
0160: 00FE00FF83210000 0004B5000200FFFF 60250000001900ED 0100FF3F01806404
0180: 0000020038086351 4D44804922000000 0100DE0004DA0002 00FF7F01CC800400
01A0: 0370000D63514300 6865636B426F7822 A20000010000B704 00F60200FF1F0180
01C0: 0433000400060063 4461646F732200D1 000100005B040002 FB00FF0F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton:
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
			ActiveX:
		Application Actions
	Form Window: frmRelOrdemPlaca
		Class: cQCK1FormRel
		Property Template:
		Class DLL Name:
		Title: Discriminativo de infrações por documento de cobrança
		Icon File:
		Accessories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? No
			Automatically Created at Runtime? Class Default
			Initial State: Minimized
			Maximizable? No
			Minimizable? No
			System Menu? Class Default
			Resizable? No
			Window Location and Size
				Left: 0.075"
				Top: 0.063"
				Width:  1.738"
				Width Editable? Class Default
				Height: 1.365"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
		Contents
			Pushbutton: pbImprimir
				Class Child Ref Key: 3
				Class ChildKey: 0
				Class: cQCK1FormRel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left: 0.088"
					Top: 0.156"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If not bSegundaVia
							If fVerificaPergunta( ) and pnCodVeiculo !=9
								If SalMessageBox( 'A emissão da ordem de placa irá gerar uma pendência de lacração para o veículo. Deseja continuar a impressão?', 'Atenção', MB_IconExclamation | MB_YesNo ) = IDNO
									Return FALSE
								Else
									If fValidaEmissao( ) 
										Call SalSendClassMessage( SAM_Click, nParCopias, 0 )
									Else
										Call SalMessageBox( frmRelOrdemPlaca.sErro, 'Atenção', MB_IconHand )
							Else
								If fValidaEmissao( )
									Call SalSendClassMessage( SAM_Click, nParCopias, 0 )
								Else
									Call SalMessageBox( frmRelOrdemPlaca.sErro, 'Atenção', MB_IconHand )
						Else
							Call SalSendClassMessage( SAM_Click, nParCopias, 0 )
			Data Field: dfsDocFat
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQCK1DataField
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left: 0.088"
						Top: 0.448"
						Width:  1.1"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
		Functions
			Function: fVerificaPergunta
				Description: Verifica se faz a pergunta na emissão da ordem de placa.
				Returns
				Parameters
				Static Variables
				Local variables
					Sql Handle: hSql
				Actions
					If fMPSConnect( hSql )
						If fMPSPrepareProc( hSql, 	'Exec ParametroGeralS_ValAutLacre', 
											':frmRelOrdemPlaca.nValAutLacre' )
							If SqlExecute( hSql )
								If SqlFetchNext( hSql, lParam )
									If frmRelOrdemPlaca.nValAutLacre != 0
										Return TRUE
									Else
										Return FALSE
					Return FALSE
			Function: fValidaEmissao
				Description: Valida emissão da ordem de placa.
				Returns
				Parameters
				Static Variables
				Local variables
					Sql Handle: hSql
				Actions
					If pnCodVeiculo !=9
						If fMPSConnect( hSql )
							If fMPSPrepareProc( hSql, 	'Exec 	Atendimento_OrdPlaConsistir
													@nSetor		= :frmAtendimento.nProcessoSetor, 
													@nProcesso	= :frmAtendimento.dfnProcesso,
													@Vistoria 	= :frmAtendimento.dfnVistoria', 
												':frmRelOrdemPlaca.nErro, :frmRelOrdemPlaca.sErro' )
								If SqlExecute( hSql )
									If SqlFetchNext( hSql, lParam )
										If frmRelOrdemPlaca.nErro = 0
											Return TRUE
										Else
											Return FALSE
					Else
						Return TRUE
					Return FALSE
		Window Parameters
			Receive Window Handle: hWndJanela
			Number: nParCopias
			Boolean: bSegundaVia
			Boolean: pbVeiculoBin
			Number: pnCodVeiculo
		Window Variables
			Number: nRetorno
			! ----- Relatório de Ordem de Placa -----
			String: sCorLetra
			String: sCorFundo
			Date/Time: dDataImp
			String: sUsuNome
			Number: nUsuMatr
			String: sPlaca
			String: sMunicipio
			Number: nRenavam
			String: sChassi
			String: sMarcaModelo
			String: sTipoBin
			String: sEspBin
			String: sMarcaBin
			Number: nAnoFBin
			Number: nAnoMBin
			Number: nAnoFabricacao
			Number: nAnoModelo
			String: sTipo
			String: sEspecie
			String: sCategoria
			Number: nCategoria
			Number: nTipoDocFat
			! Dados dos Estabelecimentos Credenciados para fornecimento de Lacre
			String: sEstabCreden
			String: sLogradouro
			String: sComplemento
			Number: nCep
			String: sBairro
			String: sMunicipioEstab
			String: sTelefone
			String: sTitulo
			String: sTipoServico
			String: sProprietario
			String: sCgcCpf
			String: sUfEmpl
			String: sMsg1
			String: sMsg2
			String: sMsg3
			Number: nValAutLacre
			Number: nErro
			String: sErro
			String: sTipoEmplacamento
			Number: nSetor
			Number: nProcesso
		Message Actions
			On SAM_CreateComplete
				Set nProcesso = 0
				Set nSetor = 0
				! -
				Call SalFmtKeepMask( TRUE )
				! Pega caracteristicas da placa baseado na categoria.
				If pnCodVeiculo = 9 ! ( Placa Sigilosa - 2ª Via de Ordem Placa )
					Set _sStored = 'exec Atendimento_OrdemPlaca 	@VeiculoBin = :frmRelOrdemPlaca.pnCodVeiculo,
												@CodConsulta 		= Null,
												@NumSeqTransacao 	= Null,
												@Categoria 		= 0,
												@Processo		= 0,
												@Placa			= :frmPlacaReservada.dfsPlaca,
												@SetorN			= :nGlobalSetor'
					Set nProcesso = 0
					Set nSetor = 0
				Else
					If bSegundaVia ! ( Historico de Veiculo - 2ª Via de Ordem Placa )
						If pbVeiculoBin = 0 ! frmConsultaHistVeiculo.dfsCodUf = 'PE'
							Set _sStored = 'exec Atendimento_OrdemPlaca 	@Categoria = 0,
										         				@SetorN = :frmConsultaHistVeiculo.tblProcesso.colnSetor, 
														@Processo = :frmConsultaHistVeiculo.tblProcesso.colnProcesso'
						Else
							Set _sStored = 'exec Atendimento_OrdemPlaca 	@VeiculoBin 		= 1,
														@CodConsulta 		= Null, 
														@NumSeqTransacao 	= Null,
														@Categoria 		= 0,
														@SetorN			= :frmConsultaHistVeiculo.tblProcesso.colnSetor,
														@Processo		= :frmConsultaHistVeiculo.tblProcesso.colnProcesso'
					Else
						If frmRelOrdemPlaca.pbVeiculoBin
							Set _sStored = 'exec Atendimento_OrdemPlaca 	@VeiculoBin 		= :frmAtendimento.bVeiculoBin,
														@CodConsulta 		= :frmAtendimento.nCodConsultaBin, 
														@NumSeqTransacao 	= :frmAtendimento.nNumSeqTransacaoBin,
														@Categoria 		= :frmAtendimento.dfnCategoria,
														@SetorN			= :frmAtendimento.nProcessoSetor,
														@Processo		= :frmAtendimento.dfnProcesso'
						Else
							Set _sStored = 'exec Atendimento_OrdemPlaca 	@Categoria = :frmAtendimento.dfnCategoria,
										         				@SetorN = :frmAtendimento.nProcessoSetor, 
														@Processo = :frmAtendimento.dfnProcesso'
				Set _sNomeQRP = 'ordemp.QRP'
				Set _sTituloRelatório = 'Relatório de Ordem de Placa'
				Set _sPrimeiroRetorno = ':frmRelOrdemPlaca.sCorLetra, :frmRelOrdemPlaca.sCorFundo,
						:frmRelOrdemPlaca.dDataImp, :frmRelOrdemPlaca.sUsuNome, :frmRelOrdemPlaca.nUsuMatr,
						:frmRelOrdemPlaca.nTipoDocFat, :frmRelOrdemPlaca.dfsDocFat, :frmRelOrdemPlaca.sTipo,
						:frmRelOrdemPlaca.sEspecie, :frmRelOrdemPlaca.sMarcaModelo, :frmRelOrdemPlaca.nAnoFabricacao,
						:frmRelOrdemPlaca.nAnoModelo, :frmRelOrdemPlaca.sProprietario, :frmRelOrdemPlaca.sCgcCpf,
						:frmRelOrdemPlaca.sUfEmpl, :frmRelOrdemPlaca.sMunicipio, :frmRelOrdemPlaca.sEstabCreden, 
						:frmRelOrdemPlaca.sLogradouro, :frmRelOrdemPlaca.sComplemento, :frmRelOrdemPlaca.nCep, 
						:frmRelOrdemPlaca.sBairro, :frmRelOrdemPlaca.sMunicipioEstab, :frmRelOrdemPlaca.sTelefone,
						:frmRelOrdemPlaca.sTitulo, :frmRelOrdemPlaca.sTipoServico, :frmRelOrdemPlaca.sMsg1, 
						:frmRelOrdemPlaca.sMsg2, :frmRelOrdemPlaca.sMsg3, :frmRelOrdemPlaca.sTipoEmplacamento,
						:frmRelOrdemPlaca.sPlaca'
				If pnCodVeiculo = 9
					! Descobrir os dados do veículo, se possível
					!
					Set _sVarSQLWindows = 'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, 
							frmRelOrdemPlaca.sProprietario, frmRelOrdemPlaca.sCgcCpf, frmRelOrdemPlaca.sPlaca, 
							frmRelOrdemPlaca.sCorLetra, frmRelOrdemPlaca.sCorFundo, frmRelOrdemPlaca.sMunicipio,
							frmRelOrdemPlaca.sUfEmpl, frmRelOrdemPlaca.nAnoModelo, frmRelOrdemPlaca.sUfEmpl, 
							frmRelOrdemPlaca.sMarcaModelo, frmRelOrdemPlaca.nAnoFabricacao, frmRelOrdemPlaca.nAnoModelo, 
							frmRelOrdemPlaca.sTipo, frmRelOrdemPlaca.sEspecie, frmRelOrdemPlaca.sUfEmpl, 
							frmRelOrdemPlaca.pbVeiculoBin, frmRelOrdemPlaca.dDataImp, SqlUser, frmRelOrdemPlaca.sUsuNome, 
							frmRelOrdemPlaca.nUsuMatr, frmRelOrdemPlaca.dfsDocFat, frmRelOrdemPlaca.sEstabCreden, 
							frmRelOrdemPlaca.sLogradouro, frmRelOrdemPlaca.sComplemento, frmRelOrdemPlaca.nCep, 
							frmRelOrdemPlaca.sBairro, frmRelOrdemPlaca.sMunicipioEstab, frmRelOrdemPlaca.sTelefone, 
							frmRelOrdemPlaca.sTitulo, frmRelOrdemPlaca.sTipoServico, frmRelOrdemPlaca.sMsg1,
							frmRelOrdemPlaca.sMsg2, frmRelOrdemPlaca.sMsg3,:frmRelOrdemPlaca.sTipoEmplacamento'
				Else
					If bSegundaVia
						! Descobrir os dados do veículo, se possível
						If pnCodVeiculo  != NUMBER_Null 
							Call fMPSPrepareProc( hSqlApp, 'exec PreAtendimento_OP_veic
									@Veiculo = :frmConsultaHistVeiculo.dfnCodVeiculo',
									':frmRelOrdemPlaca.sMunicipio, :frmRelOrdemPlaca.nRenavam, :frmRelOrdemPlaca.sChassi,
									:frmRelOrdemPlaca.sMarcaModelo, :frmRelOrdemPlaca.nAnoFabricacao,
									:frmRelOrdemPlaca.nAnoModelo, :frmRelOrdemPlaca.sTipo, :frmRelOrdemPlaca.sEspecie,
									:frmRelOrdemPlaca.nCategoria, :frmRelOrdemPlaca.sCategoria' )
							Call SqlExecute( hSqlApp )
							Call SqlFetchNext( hSqlApp, nRetorno )
						!
						Set _sVarSQLWindows = 'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, 
								frmRelOrdemPlaca.sProprietario, frmRelOrdemPlaca.sCgcCpf, frmRelOrdemPlaca.sPlaca, 
								frmRelOrdemPlaca.sCorLetra, frmRelOrdemPlaca.sCorFundo, frmRelOrdemPlaca.sMunicipio,
								frmRelOrdemPlaca.sUfEmpl, frmConsultaHistVeiculo.dfnRenavam, frmConsultaHistVeiculo.dfsChassi, 
								frmRelOrdemPlaca.sMarcaModelo, frmRelOrdemPlaca.nAnoFabricacao, frmRelOrdemPlaca.nAnoModelo, 
								frmRelOrdemPlaca.sTipo, frmRelOrdemPlaca.sEspecie, frmConsultaHistVeiculo.dfsCategoria, 
								frmRelOrdemPlaca.pbVeiculoBin, frmRelOrdemPlaca.dDataImp, SqlUser, frmRelOrdemPlaca.sUsuNome, 
								frmRelOrdemPlaca.nUsuMatr, frmRelOrdemPlaca.dfsDocFat, frmRelOrdemPlaca.sEstabCreden, 
								frmRelOrdemPlaca.sLogradouro, frmRelOrdemPlaca.sComplemento, frmRelOrdemPlaca.nCep, 
								frmRelOrdemPlaca.sBairro, frmRelOrdemPlaca.sMunicipioEstab, frmRelOrdemPlaca.sTelefone, 
								frmRelOrdemPlaca.sTitulo, frmRelOrdemPlaca.sTipoServico, frmRelOrdemPlaca.sMsg1,
								frmRelOrdemPlaca.sMsg2, frmRelOrdemPlaca.sMsg3,:frmRelOrdemPlaca.sTipoEmplacamento'
					Else
						Set _sVarSQLWindows = 'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, 
								frmRelOrdemPlaca.sProprietario, frmRelOrdemPlaca.sCgcCpf, frmRelOrdemPlaca.sPlaca, 
								frmRelOrdemPlaca.sCorLetra, frmRelOrdemPlaca.sCorFundo, frmRelOrdemPlaca.sMunicipio, 
								frmRelOrdemPlaca.sUfEmpl,  frmAtendimento.dfnRenavam, frmAtendimento.dfsChassi, 
								frmAtendimento.dfsMarcaModelo, frmAtendimento.nAnoFabricacao, frmAtendimento.nAnoModelo, 
								frmAtendimento.dfsTipo, frmAtendimento.dfsEspecie, frmAtendimento.dfsCategoria, 
								frmAtendimento.bVeiculoBin, frmRelOrdemPlaca.dDataImp, SqlUser, frmRelOrdemPlaca.sUsuNome, 
								frmRelOrdemPlaca.nUsuMatr, frmRelOrdemPlaca.dfsDocFat, frmRelOrdemPlaca.sEstabCreden, 
								frmRelOrdemPlaca.sLogradouro, frmRelOrdemPlaca.sComplemento, frmRelOrdemPlaca.nCep, 
								frmRelOrdemPlaca.sBairro, frmRelOrdemPlaca.sMunicipioEstab, frmRelOrdemPlaca.sTelefone,
								frmRelOrdemPlaca.sTitulo, frmRelOrdemPlaca.sTipoServico, frmRelOrdemPlaca.sMsg1,
								frmRelOrdemPlaca.sMsg2, frmRelOrdemPlaca.sMsg3,:frmRelOrdemPlaca.sTipoEmplacamento'
						! If frmRelOrdemPlaca.pbVeiculoBin
						! Else
							Set _sVarSQLWindows = 'sGlobalSecretaria, sGlobalDetran, nGlobalSetor, sGlobalSetor, 
									frmAtendimento.dfsProp, frmAtendimento.dfsPropDoc, frmAtendimento.dfsPlaca, 
									frmRelOrdemPlaca.sCorLetra, frmRelOrdemPlaca.sCorFundo, frmAtendimento.dfsPropMunicipio, 
									frmAtendimento.sTmp, frmAtendimento.dfnRenavam, frmAtendimento.dfsChassi, 
									frmAtendimento.dfsMarcaModelo, frmAtendimento.nAnoFabricacao, frmAtendimento.nAnoModelo, 
									frmAtendimento.dfsTipo, frmAtendimento.dfsEspecie, frmAtendimento.dfsCategoria, 
									frmAtendimento.bVeiculoBin, frmRelOrdemPlaca.dDataImp, SqlUser, frmRelOrdemPlaca.sUsuNome, 
									frmRelOrdemPlaca.nUsuMatr, frmRelOrdemPlaca.dfsDocFat, frmRelOrdemPlaca.sEstabCreden, 
									frmRelOrdemPlaca.sLogradouro, frmRelOrdemPlaca.sComplemento, frmRelOrdemPlaca.nCep, 
									frmRelOrdemPlaca.sBairro, frmRelOrdemPlaca.sMunicipioEstab, frmRelOrdemPlaca.sTelefone, 
									frmRelOrdemPlaca.sTitulo, frmRelOrdemPlaca.sTipoServico, frmRelOrdemPlaca.sMsg1,
									frmRelOrdemPlaca.sMsg2, frmRelOrdemPlaca.sMsg3'
				Set _sVarQRP = 	'Secretaria, Detran, Setor, NomeSetor, PropNome, PropDoc, Placa, CorLetra, CorFundo, Municipio, 
								UF, Renavam, Chassi, Marca, AnoFabricacao, AnoModelo, Tipo, Especie, Categoria, VeiculoBin, 
								DataImp, Usuario, UsuNome, UsuMatr, DocFat, EstabCreden, Logradouro, Complemento, Cep, 
								Bairro, MunicipioEstab, Telefone, Titulo, TipoServico, MSG1, MSG2, MSG3, TipoEmplacamento'
				Call SalSendMsg( pbImprimir, SAM_Click, nParCopias, 0 )
			On SAM_Destroy
				Set hWndJanela = hWndNULL
				Call SalFmtKeepMask( FALSE )
				Call SalSendClassMessage( SAM_Destroy, wParam, lParam )
			On UDM_AposPesquisa
				If nTipoDocFat = 1
					Call SalFmtSetInputMask ( frmRelOrdemPlaca.dfsDocFat, '999.999.999-99' )
				Else If nTipoDocFat = 2
					Call SalFmtSetInputMask ( frmRelOrdemPlaca.dfsDocFat, '99.999.999/9999-99' )
				Else
					Call SalFmtSetInputMask ( frmRelOrdemPlaca.dfsDocFat, '999999999999999' )
				If sEspecie = ''
					Set sEspecie = sEspBin
				If sTipo = ''
					Set sTipo = sTipoBin
				If sMarcaModelo = ''
					Set sMarcaModelo = sMarcaBin
				If nAnoFabricacao = 0
					Set nAnoFabricacao = nAnoFBin
				If nAnoModelo = 0
					Set nAnoModelo = nAnoMBin
				Return TRUE
			On UDM_EnviaTransacao250
				Set nProcesso = wParam
				Set nSetor = lParam
				! - 
				If fVerificarEnvioTrans250(frmRelOrdemPlaca.nSetor, frmRelOrdemPlaca.nProcesso, 'C')
					! - Faz o processo de envio para cancelamento na BIN
					Call BINEnviaTransacaoPlacaEstampa(frmRelOrdemPlaca.sPlaca, 250, frmRelOrdemPlaca.nSetor, frmRelOrdemPlaca.nProcesso, 2)
				If fVerificarEnvioTrans250(frmRelOrdemPlaca.nSetor, frmRelOrdemPlaca.nProcesso, 'A')
					! - Faz o processo de envio para cancelamento na BIN
					Call BINEnviaTransacaoPlacaEstampa(frmRelOrdemPlaca.sPlaca, 250, frmRelOrdemPlaca.nSetor, frmRelOrdemPlaca.nProcesso, 1)



  