.head 0 +  Application Description:
.head 1 -  Outline Version - 4.0.28
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400800000
0020: 0000000000CA0000 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77731B6672
0080: 6D4C65696C616F44 6F63756D656E746F 73496D7072696D69 72
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  ! File Include: detran_funcoes.apl
.head 2 -  ! File Include: SaidaArquivo.apl
.head 2 -  ! File Include: frmRelVeicGeral.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Input: 9999999999999
.head 3 -  Number: #0
.head 3 -  Number: #0
.head 3 -  Number: #0
.head 2 -  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 -  System
.head 3 -  User
.head 3 -  Enumerations
.head 2 -  Resources
.head 2 -  Variables
.data RESOURCE 0 0 1 1508284981
0000: 2200000013000000 0000000000000000 0200000100000086 020000D019000000
0020: 01FE00FF03
.enddata
.head 2 -  Internal Functions
.head 2 -  Named Menus
.head 2 -  Class Definitions
.data RESOURCE 0 0 1 1284996853
0000: 2A04000012020000 0000000000000000 0200000700FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666FC2003C00 000A630051434B31
0040: 47657261006C0202 00001100001E0004 0000C20003000000 FF7F048300190000
0060: 00F001000000FF1F 1D0000AC00190001 FD00FF0736000000 196B000100FFFFC1
0080: 4F00000019DA0001 00FF7F68B0000000 0400F4020000FF1F 6C0000AC00040002
00A0: FD00FF0770000000 046B000200FFFFC1 7400000004DA0002 00FF7F78B0000000
00C0: 0400F60200FF1F7C 0000AC00040002FD 00FF17800000046B 000200FFFFC18400
00E0: 000004DA000200FF 7F88B00000000400 F60200FF1F8C0000 AC00190001FD00FF
0100: 07A5000000196B00 0100FFFFC1BE0000 0004DA000200FF7F 0180803E00000001
0120: 0070000E63514340 6F6E7461696E7200 AA00000005000000 6F0400E801020000
0140: FFC18001000000BF 04190019000101FA 00007F80F2010000 0F08000000961900
0160: 0100FE00FF832100 000004B5000200FF FF60250000001900 ED0100FF3F018064
0180: 0400000200380863 514D448049220000 000100DE0004DA00 0200FF7F01C88019
01A0: 00000370000C6351 46006F726D465450 2200D1000100005B 190001FB00FF8F01
01C0: 8019190004001063 FE51005461627346 747022A200000100 00B71900F60100FF
01E0: 1F01800433000500 0D1C635143686580 636B426F782200E8 00010000AD040002
0200: FD00FFC701800400 0006000000066344 4061646F73220000 F4010000D6040002
0220: FE00FF03
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: bPbArquivar
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 -  Application Actions
.head 1 +  ! cQCK1Form: frmLeilaoDocumentosImprimir
.head 2 -  Description: 
.head 2 -  Named Menus 
.head 2 -  Menu 
.head 2 +  Tool Bar 
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 -  Frame 
.head 3 -  ! ----------------------------------------------------------------
.head 3 -  Background Text: Leilão:
.head 3 +  Data Field: dfnLeilao
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 7461624170726565 6E73616F00000000
.enddata
.data CLASSPROPSSIZE
0000: 2000
.enddata
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sTextoStatusBar = 'CPF ou CGC proprietário do veículo'
.head 6 -  Set _sNomeParaMsgs = 'CPF / CGC do Proprietário'
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Set _bPermiteNulos = FALSE
.head 6 -  Set _sMsgValidacao = 'Número de CPF/CGC inválido!'
.head 6 -  Set _sTipoMsgValidacao = 'ESPECIFICA'
.head 6 -  Set _bNaoTemDependentes = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  ! ----------------------------------------------------------------
.head 3 -  Group Box: Tipo Impressão
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 746162526573756C 7461646F00000000
.enddata
.data CLASSPROPSSIZE
0000: 2000
.enddata
.head 3 +  Check Box: cbDebito
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Imprime o extrato dos débitos por CPF/CNPJ'
.head 6 -  Set _bComponenteChave = TRUE
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalEnableWindow( pbPesquisar )
.head 6 -  Set sUF = 'PE'
.head 6 -  Set sTipoImp = 'D'
.head 3 +  Check Box: cbRestricao
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Imprime o extrato das restrições por CPF/CNPJ'
.head 6 -  Set _bComponenteChave = TRUE
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalEnableWindow( pbPesquisar )
.head 6 -  Set sUF = 'PE'
.head 6 -  Set sTipoImp = 'R'
.head 3 +  Check Box: cbGeral
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Imprime o extrato geral por CPF/CNPJ'
.head 6 -  Set _bComponenteChave = TRUE
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalEnableWindow( pbPesquisar )
.head 6 -  Set sUF = STRING_Null
.head 6 -  Set sTipoImp = 'G'
.head 3 +  Check Box: cbSucata
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Imprime o extrato das restrições por CPF/CNPJ'
.head 6 -  Set _bComponenteChave = TRUE
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalEnableWindow( pbPesquisar )
.head 6 -  Set sUF = STRING_Null
.head 6 -  Set sTipoImp = 'S'
.head 3 -  ! ----------------------------------------------------------------
.head 3 -  Group Box: Saída
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 746162526573756C 7461646F00000000
.enddata
.data CLASSPROPSSIZE
0000: 2000
.enddata
.head 3 +  Radio Button: rbImpressora
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Set sSaida='I'
.head 6 -  Call SalEnableWindow( pbImpressoras )
.head 5 +  On SAM_Create
.head 6 -  Set _bComponenteChave = TRUE
.head 3 +  Radio Button: rbTela
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Set sSaida='T'
.head 6 -  Call SalDisableWindow(pbImpressoras)
.head 5 +  On SAM_Create
.head 6 -  Set _bComponenteChave = TRUE
.head 3 -  ! - Botões
.head 3 +  Pushbutton: pbPesquisar
.data CLASSPROPSSIZE
0000: 1E00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 7461624170726565 6E73616F0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Efetua a pesquisa no banco de dados'
.head 6 -  Set _sTipoComando = 'TabelaPesquisa'
.head 6 -  Set _sTabela = 'tblRetorno'
.head 6 -  Set _bValidaCamposNulos = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  ! On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 +  If (cbGeral and cbDebito) or (cbGeral and cbRestricao) or (cbDebito and cbRestricao) 
or (cbGeral and cbSucata) or (cbSucata and cbRestricao) or (cbDebito and cbSucata)
.head 7 -  Call SalMessageBox('Só é possível emitir um extrato por vez!', 'Atenção', MB_IconExclamation )
.head 7 -  Call SalSendMsg( hWndForm, MSG_Limpa, lParam, wParam )
.head 7 -  Return FALSE
.head 6 +  If NOT cbGeral and NOT cbRestricao and NOT cbDebito and NOT cbSucata 
.head 7 -  Call SalMessageBox('Deve ser escolhido um tipo de Impressão !', 'Atenção', MB_IconExclamation )
.head 7 -  Call SalSendMsg( hWndForm, MSG_Limpa, lParam, wParam )
.head 7 -  Return FALSE
.head 6 +  Else 
.head 7 -  Return TRUE
.head 6 -  ! -------------------------------------------------------------------------------------------------------------------------------
.head 6 +  If dfnLeilao = NUMBER_Null
.head 7 -  Call SalEnableWindow( cbDebito )
.head 7 -  Call SalEnableWindow( cbRestricao )
.head 7 -  Call SalEnableWindow( cbGeral )
.head 7 -  Call SalEnableWindow( cbSucata )
.head 7 -  Call SalDisableWindow( rbImpressora )
.head 7 -  Call SalDisableWindow( rbTela )
.head 7 -  Call SalDisableWindow( pbImprimir )
.head 7 -  Call SalDisableWindow( pbImpressoras )
.head 7 -  Call SalDisableWindow( tblRetorno )
.head 6 +  Else 
.head 7 -  Call SalDisableWindow( cbDebito )
.head 7 -  Call SalDisableWindow( cbRestricao )
.head 7 -  Call SalDisableWindow( cbGeral )
.head 7 -  Call SalDisableWindow( cbSucata )
.head 7 -  Call SalEnableWindow( rbImpressora )
.head 7 -  Call SalEnableWindow( rbTela )
.head 7 -  Call SalEnableWindow( pbImprimir )
.head 7 -  Call SalEnableWindow( pbImpressoras )
.head 7 -  Call SalEnableWindow( tblRetorno )
.head 3 +  Pushbutton: pbImprimir
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTabela = ''
.head 6 -  Set _nPermissao = 15
.head 6 -  Set _sTipoComando = 'Comum'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 +  If (cbGeral and cbDebito) or (cbGeral and cbRestricao) or (cbDebito and cbRestricao) 
or (cbGeral and cbSucata) or (cbSucata and cbRestricao) or (cbDebito and cbSucata)
.head 7 -  Call SalMessageBox('Só é possível emitir um extrato por vez!', 'Atenção', MB_IconExclamation )
.head 7 -  Return FALSE
.head 6 +  If rbImpressora
.head 7 -  Call SalMessageBeep( MB_Ok )
.head 7 +  If SalMessageBox( 'Certifique-se que a impressão esta configurada como PDF!
Para definir a impressão, clicar no botão "Configurar".  ', 'Atenção', MB_IconQuestion | MB_YesNo ) = IDNO
.head 8 -  Return FALSE
.head 6 -  Call SalWaitCursor ( TRUE )
.head 6 -  Call fVeiculoSelecionados(  )
.head 6 -  Call SalWaitCursor ( FALSE )
.head 6 +  ! ------------------------------------------------------------------------------------------------------------------------------
.head 7 +  ! If cbGeral = TRUE
.head 8 -  ! ! - Imprime o extrato geral ()
.head 8 -  Set nFlags = CREATE_AsChild
.head 8 +  If hWndRelVeicGeral  != hWndNULL
.head 9 -  Call SalSendMsg( hWndRelVeicGeral, SAM_Close, 0, 0)
.head 8 -  Set hWndRelVeicGeral = SalCreateWindowEx( frmRelVeicGeral, hWndForm, nLeft, nTop, nWidth, nHeight, nFlags, hWndRelVeicGeral, rbImpressora, NUMBER_Null, 0)
.head 8 -  ! Set hWndRelVeicGeral = SalCreateWindow( frmRelVeicGeral, hWndForm, hWndRelVeicGeral, rbTela, 0, nPermissaoExtratoDebito )
.head 7 +  ! If cbDebito = TRUE
.head 8 +  If hWndRelVeicDebito  != hWndNULL
.head 9 -  Call SalSendMsg( hWndRelVeicDebito, SAM_Close, 0, 0)
.head 8 -  Set hWndRelVeicDebito = SalCreateWindow( frmExtratoDebito, hWndMDI, hWndRelVeicDebito,
rbImpressora, 'LI' , nPermissaoExtratoDebito )
.head 7 +  ! If cbRestricao = TRUE
.head 8 +  If hWndRelVeicRestricao  != hWndNULL
.head 9 -  Call SalSendMsg( hWndRelVeicRestricao, SAM_Close, 0, 0)
.head 8 -  Set hWndRelVeicRestricao = SalCreateWindow( frmExtratoRestricao, hWndMDI,
hWndRelVeicRestricao, NUMBER_Null, 'LI', NUMBER_Null, STRING_Null, NUMBER_Null,
NUMBER_Null, NUMBER_Null, NUMBER_Null, NUMBER_Null )
.head 7 +  ! If cbSucata = TRUE
.head 8 -  Call fImpSucata ( )
.head 8 -  Call fDecSucata ( )
.head 7 -  !
.head 3 +  Pushbutton: pbImpressoras
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call SalPrtGetDefault( sDeviceDef, sDriverDef, sPortaDef )
.head 6 -  Call SalPrtSetup(sDevice,sDriver,sPorta,FALSE)
.head 5 +  On SAM_Create
.head 6 -  Set _sTabela = ''
.head 6 -  Set _nPermissao = 15
.head 6 -  Set _sTipoComando = 'Comum'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Pushbutton: pbLimpar
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001800 74616253656C6563 616F097461625265
0020: 73756C7461646F00 000000
.enddata
.data CLASSPROPSSIZE
0000: 2B00
.enddata
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Limpa os dados da tela'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bValidaCamposNulos = FALSE
.head 6 -  Set _sTipoComando = 'Limpa'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Set rbImpressora=1
.head 6 -  Set rbTela=0
.head 6 -  ! --- [faml] 22/02/2016 - ini
.head 6 -  Set frmLeilaoDocumentosImprimir.dfnLeilao = NUMBER_Null 
.head 6 -  ! --- fim
.head 6 -  Call SalFmtSetInputMask( dfnLeilao, '99999999999999' )
.head 6 +  If hWndRelVeicGeral != hWndNULL
.head 7 -  Call SalSendMsg( hWndRelVeicGeral, SAM_Close, 0, 0)
.head 6 +  If hWndRelVeicDebito != hWndNULL
.head 7 -  Call SalSendMsg( hWndRelVeicDebito, SAM_Close, 0, 0)
.head 6 +  If hWndRelVeicRestricao != hWndNULL
.head 7 -  Call SalSendMsg( hWndRelVeicRestricao, SAM_Close, 0, 0)
.head 6 +  If hWndSucata != hWndNULL
.head 7 -  Call SalSendMsg( hWndSucata, SAM_Close, 0, 0)
.head 3 +  Pushbutton: pbSair
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTabela = ''
.head 6 -  Set _sTipoComando = 'Sai'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  ! ----------------------------------------------------------------
.head 3 -  ! -Tabela Consulta
.head 3 +  Child Table: tblRetorno
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000800 7461624974656D00 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 +  Contents 
.head 5 +  ! cQCK2Column: colnSelecionar
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsPlaca
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsUFPlaca
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsChassi
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnCodVeiculo
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = FALSE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnRenavam
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsCodSetor
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnCodRecolhimento
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Functions 
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Tabela das diárias de congelamento'
.head 6 -  ! Set _bPesquisaCreate = TRUE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  !
.head 6 -  Set _sComandoPesquisa = 'exec dbvcen..LeilaoVeiculoSelecionar
		@nLeilao = :frmLeilaoDocumentosImprimir.dfnLeilao,
		@UF =  :frmLeilaoDocumentosImprimir.sUF,
		@TipoImpressao =  :frmLeilaoDocumentosImprimir.sTipoImp '
.head 6 -  Set _sIntoPesquisa = '
		:frmLeilaoDocumentosImprimir.tblRetorno.colsPlaca,
		:frmLeilaoDocumentosImprimir.tblRetorno.colsUFPlaca,
		:frmLeilaoDocumentosImprimir.tblRetorno.colsChassi,
		:frmLeilaoDocumentosImprimir.tblRetorno.colnCodVeiculo,
		:frmLeilaoDocumentosImprimir.tblRetorno.colnRenavam,
		:frmLeilaoDocumentosImprimir.tblRetorno.colsCodSetor,
		:frmLeilaoDocumentosImprimir.tblRetorno.colnCodRecolhimento,
		:frmLeilaoDocumentosImprimir.nOrgaoAutuante '
.head 6 -  !
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Set nPermissao = 15
.head 5 +  On UDM_AntesPesquisa
.head 6 -  ! -------------------------------------------------------------------------------------------------------------------------------
.head 6 +  If (cbGeral and cbDebito) or (cbGeral and cbRestricao) or (cbDebito and cbRestricao) 
or (cbGeral and cbSucata) or (cbSucata and cbRestricao) or (cbDebito and cbSucata)
.head 7 -  Call SalMessageBox('Só é possível emitir um extrato por vez!', 'Atenção', MB_IconExclamation )
.head 7 -  Call SalSendMsg( hWndForm, MSG_Limpa, lParam, wParam )
.head 7 -  Return FALSE
.head 6 +  If NOT cbGeral and NOT cbRestricao and NOT cbDebito and NOT cbSucata 
.head 7 -  Call SalMessageBox('Deve ser escolhido um tipo de Impressão !', 'Atenção', MB_IconExclamation )
.head 7 -  Call SalSendMsg( hWndForm, MSG_Limpa, lParam, wParam )
.head 7 -  Return FALSE
.head 6 +  Else 
.head 7 -  Return TRUE
.head 6 -  ! -------------------------------------------------------------------------------------------------------------------------------
.head 6 +  If dfnLeilao = NUMBER_Null
.head 7 -  Call SalEnableWindow( cbDebito )
.head 7 -  Call SalEnableWindow( cbRestricao )
.head 7 -  Call SalEnableWindow( cbGeral )
.head 7 -  Call SalEnableWindow( cbSucata )
.head 7 -  Call SalDisableWindow( rbImpressora )
.head 7 -  Call SalDisableWindow( rbTela )
.head 7 -  Call SalDisableWindow( pbImprimir )
.head 7 -  Call SalDisableWindow( pbImpressoras )
.head 7 -  Call SalDisableWindow( tblRetorno )
.head 6 +  Else 
.head 7 -  Call SalDisableWindow( cbDebito )
.head 7 -  Call SalDisableWindow( cbRestricao )
.head 7 -  Call SalDisableWindow( cbGeral )
.head 7 -  Call SalDisableWindow( cbSucata )
.head 7 -  Call SalEnableWindow( rbImpressora )
.head 7 -  Call SalEnableWindow( rbTela )
.head 7 -  Call SalEnableWindow( pbImprimir )
.head 7 -  Call SalEnableWindow( pbImpressoras )
.head 7 -  Call SalEnableWindow( tblRetorno )
.head 6 -  ! -------------------------------------------------------------------------------------------------------------------------------
.head 6 +  If cbDebito = TRUE
.head 7 -  Set sUF = 'PE'
.head 7 -  Set sTipoImp = 'D'
.head 6 +  If cbRestricao = TRUE
.head 7 -  Set sUF = 'PE'
.head 7 -  Set sTipoImp = 'R'
.head 6 +  If cbSucata = TRUE
.head 7 -  Set sUF = STRING_Null
.head 7 -  Set sTipoImp = 'S'
.head 6 +  If cbGeral = TRUE
.head 7 -  Set sUF = STRING_Null
.head 7 -  Set sTipoImp = 'G'
.head 6 -  ! -------------------------------------------------------------------------------------------------------------------------------
.head 5 +  On UDM_AposPesquisa
.head 6 -  Call SalDisableWindow( cbDebito )
.head 6 -  Call SalDisableWindow( cbRestricao )
.head 6 -  Call SalDisableWindow( cbGeral )
.head 6 -  Call SalDisableWindow( cbSucata )
.head 6 -  !
.head 6 -  Call SalEnableWindow( tblRetorno )
.head 6 -  Call SalDisableWindow( pbPesquisar )
.head 6 -  Call SalEnableWindow( rbImpressora )
.head 6 -  Call SalEnableWindow( rbTela )
.head 6 -  Call SalEnableWindow( pbImprimir )
.head 6 -  Call SalEnableWindow( pbImpressoras )
.head 6 -  ! Call SalDisableWindow( tblRetorno )
.head 6 +  ! If cbSucata = TRUE
.head 7 -  Call SalDisableWindow( tblRetorno )
.head 6 -  Return TRUE
.head 5 +  On SAM_RowHeaderClick
.head 6 +  ! If SalTblQueryRowFlags( hWndForm, lParam, ROW_Edited )
.head 7 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
.head 6 +  ! Else
.head 7 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
.head 6 -  Return TRUE
.head 5 +  ! On SAM_FetchRowDone
.head 6 -  Set nRowCount = nRowCount + 1
.head 3 +  Child Table: tblUF
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000800 7461624974656D00 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 +  Contents 
.head 5 +  Column: colsUFPlaca
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Functions 
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Tabela das diárias de congelamento'
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  !
.head 6 -  Set _sComandoPesquisa = 'exec dbvcen..LeilaoUfVeicSucataSelecionar
		@nLeilao = :frmLeilaoDocumentosImprimir.dfnLeilao'
.head 6 -  Set _sIntoPesquisa = ':frmLeilaoDocumentosImprimir.tblUF.colsUFPlaca'
.head 6 -  !
.head 6 -  Set nPermissao = 15
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  ! ----------------------------------------------------------------
.head 3 +  Picture: picSemaforo
.head 4 -  Message Actions 
.head 3 +  Picture: picFotoAssinatura
.head 4 -  Message Actions 
.head 3 -  ! ----------------------------------------------------------------
.head 2 +  Functions 
.head 3 +  Function: fConsultaBIN
.head 4 -  Description: Chama as tela dos extratos para fazer as impressões. Faz a criação da tela com ela escondida, já que ela contém todos os elementos necessários
para impressão dos extratos
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Window Handle: hWndDebito
.head 5 -  Window Handle: hWndRestricao
.head 5 -  Window Handle: hWndGeral
.head 4 +  Actions 
.head 5 -  ! -  Seta a menor linha da tabela
.head 5 -  Set nLinha = TBL_MinRow
.head 5 -  ! - Percorre a tabela linha por linha para impressão dos extratos
.head 5 +  While SalTblFindNextRow( tblRetorno, nLinha, 0, 0 )
.head 6 -  Call SalTblSetContext( tblRetorno, nLinha )
.head 6 -  ! - Pega os dados essências do veiculo para a impressao dos extratos
.head 6 -  Set nCodVeic = tblRetorno.colnCodVeiculo
.head 6 -  Set sChassi = tblRetorno.colsChassi
.head 6 -  Set sUFPlaca = tblRetorno.colsUFPlaca
.head 6 -  ! - Flag para criar tela escondida
.head 6 -  Set nFlags = NUMBER_Null
.head 6 -  ! - Se for de PE, consulta os extratos locais
.head 6 -  ! - Se for de outra UF faz a 912
.head 6 +  If (sUFPlaca != 'PE' ) and (sUFPlaca != STRING_Null OR sUFPlaca != '' )
.head 7 -  Set nCodConsultaBin = 912
.head 7 -  Call BINConsultaVeiculo(STRING_Null, sUFPlaca, NUMBER_Null, sChassi, STRING_Null, STRING_Null, STRING_Null, nCodConsultaBin, nNumSeqTransacaoBin)
.head 7 -  Set bVeiculoBin = 1
.head 6 -  ! - Se for sem primeiro emplacamento faz a 901
.head 6 +  Else 
.head 7 -  Set nCodConsultaBin = 901
.head 7 -  Call BINConsultaVeiculo(STRING_Null, STRING_Null, NUMBER_Null, sChassi, STRING_Null, STRING_Null, STRING_Null, nCodConsultaBin, nNumSeqTransacaoBin)
.head 7 -  Set bVeiculoBin = 1
.head 6 -  ! - Imprime o extrato geral (independe da UF)
.head 6 -  Set nFlags = CREATE_AsChild
.head 6 -  ! ------------------------------------------------------------------------------------------------------------------------
.head 5 -  ! - Ao fim da impressão limpa a tabela e pesquisa novamente
.head 5 -  Call SalTblReset( tblRetorno )
.head 5 -  Call SalSendMsg( tblRetorno, MSG_PesquisaTabela, 0, 0 )
.head 3 +  Function: fVeiculoSelecionados
.head 4 -  Description: Retorna os ítens selecionados de uma tabela
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Window Handle: hWndTabela
.head 5 -  String: sSelecionados
.head 5 -  Sql Handle: hSqlVeicSelec
.head 5 -  Number: nLinha
.head 5 -  Number: nLinha2
.head 5 -  Number: nLinha3
.head 5 -  Number: nSelecionados
.head 5 -  Number: nCodConsultaBin
.head 5 -  Number: nNumSeqTransacaoBin
.head 5 -  Number: nProc
.head 5 -  Number: nCont
.head 5 -  Number: nContLinha
.head 5 -  String: sAux
.head 5 -  Boolean: bTodos
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor ( TRUE )
.head 5 -  Call SalSendMsg( tblUF, MSG_PesquisaTabela, 0 ,0)
.head 5 -  Set nLinha   = TBL_MinRow
.head 5 -  Set nLinha2 = TBL_MinRow
.head 5 -  Set nLinha3 = TBL_MinRow
.head 5 -  Set nProc = 0
.head 5 -  Set nCont = 0
.head 5 -  Set nContLinha = -1
.head 5 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 5 +  While SalTblFindNextRow( tblRetorno, nLinha3, 0, 0 )
.head 6 -  Call SalWaitCursor ( TRUE )
.head 6 -  Call SalTblSetContext( tblRetorno, nLinha3 )
.head 6 -  Set nContLinha = nContLinha + 1
.head 5 +  If NOT fMPSConnect (hSqlVeicSelec) 
.head 6 -  Return FALSE
.head 5 +  If cbSucata = TRUE
.head 6 +  While SalTblFindNextRow( tblUF, nLinha2, 0, 0 )
.head 7 -  Call SalWaitCursor ( TRUE )
.head 7 -  Call SalTblSetContext( tblUF, nLinha2 )
.head 7 +  While SalTblFindNextRow( tblRetorno, nLinha, 0, 0 )
.head 8 -  ! If SalTblQueryRowFlags( tblRetorno, nLinha, 0, 0 )
.head 8 -  Call SalTblSetContext( tblRetorno, nLinha )
.head 8 +  If tblRetorno.colsUFPlaca = tblUF.colsUFPlaca
.head 9 +  If fMPSPrepareProc( hSqlVeicSelec, 'exec dbinfracao..tmpVeiculoSelecionadoProcessar
	@Setor 		= :frmLeilaoDocumentosImprimir.tblRetorno.colsCodSetor,
	@Apreensao 	= :frmLeilaoDocumentosImprimir.tblRetorno.colnCodRecolhimento ', 
	' :frmLeilaoDocumentosImprimir.nSpid ' )
.head 10 +  If SqlExecute( hSqlVeicSelec )
.head 11 -  Call SqlGetResultSetCount( hSqlVeicSelec, nResultSet )
.head 11 -  Call SqlFetchNext( hSqlVeicSelec, nErro )
.head 8 -  Set sUFSucata = tblUF.colsUFPlaca
.head 7 -  Call fImpSucata ( )
.head 7 -  Call fDecSucata ( )
.head 5 +  ! Else 
.head 6 +  ! If NOT fMPSConnect (hSqlVeicSelec)
.head 7 -  Return FALSE
.head 6 +  While SalTblFindNextRow( tblRetorno, nLinha, 0, 0 )
.head 7 +  If SalTblQueryRowFlags( tblRetorno, nLinha, ROW_Edited )
.head 8 -  Call SalTblSetContext( tblRetorno, nLinha )
.head 8 +  If cbGeral and ( tblRetorno.colsUFPlaca != 'PE' )
.head 9 -  Call BINConsultaVeiculo( tblRetorno.colsPlaca, tblRetorno.colsUFPlaca, tblRetorno.colnRenavam, tblRetorno.colsChassi, 
STRING_Null, STRING_Null, STRING_Null, nCodConsultaBin, nNumSeqTransacaoBin )
.head 9 -  ! Set bVeiculoBin = BINConsultaVeiculo( dfsPlaca, dfsUFPlaca, dfnRenavam, dfsChassi, '', '', 'N', nCodConsultaBin,
nNumSeqTransacaoBin )
.head 8 +  If fMPSPrepareProc( hSqlVeicSelec, 'exec dbinfracao..tmpVeiculoSelecionadoProcessar
	@Setor 		= :frmLeilaoDocumentosImprimir.tblRetorno.colsCodSetor,
	@Apreensao 	= :frmLeilaoDocumentosImprimir.tblRetorno.colnCodRecolhimento ', 
	' :frmLeilaoDocumentosImprimir.nSpid ' )
.head 9 +  If SqlExecute( hSqlVeicSelec )
.head 10 -  Call SqlGetResultSetCount( hSqlVeicSelec, nResultSet )
.head 10 -  Call SqlFetchNext( hSqlVeicSelec, nErro )
.head 7 +  Else 
.head 8 -  Return FALSE
.head 6 -  Call fMPSDisconnect( hSqlVeicSelec )
.head 5 +  Else 
.head 6 +  While SalTblFindNextRow( tblRetorno, nLinha, 0, 0 )
.head 7 -  Call SalWaitCursor ( TRUE )
.head 7 -  Call SalTblSetContext( tblRetorno, nLinha )
.head 7 -  ! Call SalTblSetFocusRow( tblRetorno, nLinha )
.head 7 +  If cbGeral and ( tblRetorno.colsUFPlaca != 'PE' )
.head 8 -  Call BINConsultaVeiculo( tblRetorno.colsPlaca, tblRetorno.colsUFPlaca, tblRetorno.colnRenavam, tblRetorno.colsChassi, 
STRING_Null, STRING_Null, STRING_Null, nCodConsultaBin, nNumSeqTransacaoBin )
.head 8 -  ! Set bVeiculoBin = BINConsultaVeiculo( dfsPlaca, dfsUFPlaca, dfnRenavam, dfsChassi, '', '', 'N', nCodConsultaBin,
nNumSeqTransacaoBin )
.head 7 +  If fMPSPrepareProc( hSqlVeicSelec, 'exec dbinfracao..tmpVeiculoSelecionadoProcessar
	@Setor 		= :frmLeilaoDocumentosImprimir.tblRetorno.colsCodSetor,
	@Apreensao 	= :frmLeilaoDocumentosImprimir.tblRetorno.colnCodRecolhimento ', 
	' :frmLeilaoDocumentosImprimir.nSpid ' )
.head 8 +  If SqlExecute( hSqlVeicSelec )
.head 9 -  Call SqlGetResultSetCount( hSqlVeicSelec, nResultSet )
.head 9 -  Call SqlFetchNext( hSqlVeicSelec, nErro )
.head 7 -  Set nCont = nCont + 1
.head 7 +  If (nCont = 100)  or ( nContLinha = nLinha )
.head 8 +  If cbGeral = TRUE
.head 9 -  ! ! - Imprime o extrato geral ()
.head 9 -  Set nFlags = CREATE_AsChild
.head 9 +  If hWndRelVeicGeral  != hWndNULL
.head 10 -  Call SalSendMsg( hWndRelVeicGeral, SAM_Close, 0, 0)
.head 9 -  Set hWndRelVeicGeral = SalCreateWindowEx( frmRelVeicGeral, hWndForm, nLeft, nTop, nWidth, nHeight, nFlags, hWndRelVeicGeral, rbImpressora, NUMBER_Null, 0)
.head 9 -  ! Set hWndRelVeicGeral = SalCreateWindow( frmRelVeicGeral, hWndForm, hWndRelVeicGeral, rbTela, 0, nPermissaoExtratoDebito )
.head 8 +  If cbDebito = TRUE
.head 9 +  If hWndRelVeicDebito  != hWndNULL
.head 10 -  Call SalSendMsg( hWndRelVeicDebito, SAM_Close, 0, 0)
.head 9 -  Set hWndRelVeicDebito = SalCreateWindow( frmExtratoDebito, hWndMDI, hWndRelVeicDebito,
rbImpressora, 'LI' , nPermissaoExtratoDebito )
.head 8 +  If cbRestricao = TRUE
.head 9 +  If hWndRelVeicRestricao  != hWndNULL
.head 10 -  Call SalSendMsg( hWndRelVeicRestricao, SAM_Close, 0, 0)
.head 9 -  Set hWndRelVeicRestricao = SalCreateWindow( frmExtratoRestricao, hWndMDI,
hWndRelVeicRestricao, rbImpressora, 'LI', NUMBER_Null, STRING_Null, NUMBER_Null,
NUMBER_Null, NUMBER_Null, NUMBER_Null, NUMBER_Null )
.head 8 -  Set nCont = 0
.head 7 +  ! If nCont = 100 or ((( nContLinha - nLinha ) < 100  ) and ( nContLinha = nLinha ))
.head 8 +  If cbGeral = TRUE
.head 9 -  ! ! - Imprime o extrato geral ()
.head 9 -  Set nFlags = CREATE_AsChild
.head 9 +  If hWndRelVeicGeral  != hWndNULL
.head 10 -  Call SalSendMsg( hWndRelVeicGeral, SAM_Close, 0, 0)
.head 9 -  Set hWndRelVeicGeral = SalCreateWindowEx( frmRelVeicGeral, hWndForm, nLeft, nTop, nWidth, nHeight, nFlags, hWndRelVeicGeral, rbImpressora, NUMBER_Null, 0)
.head 9 -  ! Set hWndRelVeicGeral = SalCreateWindow( frmRelVeicGeral, hWndForm, hWndRelVeicGeral, rbTela, 0, nPermissaoExtratoDebito )
.head 8 +  If cbDebito = TRUE
.head 9 +  If hWndRelVeicDebito  != hWndNULL
.head 10 -  Call SalSendMsg( hWndRelVeicDebito, SAM_Close, 0, 0)
.head 9 -  Set hWndRelVeicDebito = SalCreateWindow( frmExtratoDebito, hWndMDI, hWndRelVeicDebito,
rbImpressora, 'LI' , nPermissaoExtratoDebito )
.head 8 +  If cbRestricao = TRUE
.head 9 +  If hWndRelVeicRestricao  != hWndNULL
.head 10 -  Call SalSendMsg( hWndRelVeicRestricao, SAM_Close, 0, 0)
.head 9 -  Set hWndRelVeicRestricao = SalCreateWindow( frmExtratoRestricao, hWndMDI,
hWndRelVeicRestricao, rbImpressora, 'LI', NUMBER_Null, STRING_Null, NUMBER_Null,
NUMBER_Null, NUMBER_Null, NUMBER_Null, NUMBER_Null )
.head 8 -  Set nCont = 0
.head 5 -  Call fMPSDisconnect( hSqlVeicSelec )
.head 3 -  ! ----------------- Declaração Sucata -----------------
.head 3 +  Function: fImpSucata
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If fMPSConnect( hSqlSucata )
.head 6 +  If fMPSPrepareProc( hSqlSucata, 'exec dbvcen..LeilaoDocumentosImprimir
@nLeilao = :frmLeilaoDocumentosImprimir.dfnLeilao,
@TipoImpressao = "S", 
@UFDeclaracao = :frmLeilaoDocumentosImprimir.sUFSucata ,
@Spid = :frmLeilaoDocumentosImprimir.nSpid' ,

':frmLeilaoDocumentosImprimir.sPlaca,
:frmLeilaoDocumentosImprimir.sUFPlaca,
:frmLeilaoDocumentosImprimir.nRenavam,
:frmLeilaoDocumentosImprimir.sChassi,
:frmLeilaoDocumentosImprimir.sMarcaModelo,
:frmLeilaoDocumentosImprimir.sAnoFab,
:frmLeilaoDocumentosImprimir.sCor,
:frmLeilaoDocumentosImprimir.NumLeilao,
:frmLeilaoDocumentosImprimir.DataLeilao,
:frmLeilaoDocumentosImprimir.Lote,
:frmLeilaoDocumentosImprimir.nClassificacaoLeilao,
:frmLeilaoDocumentosImprimir.sClassificacaoLeilao,
:frmLeilaoDocumentosImprimir.Arrematante,
:frmLeilaoDocumentosImprimir.CPFCGC,
:frmLeilaoDocumentosImprimir.sNumDocArrematante,
:frmLeilaoDocumentosImprimir.nOrgaoAutuante,
:frmLeilaoDocumentosImprimir.sLinha' )
.head 7 +  If SqlExecute( hSqlSucata )
.head 8 -  Call SqlGetResultSetCount( hSqlSucata, nResultSet2 )
.head 8 -  Call SqlFetchNext( hSqlSucata, nErro )
.head 6 -  Call fMPSDisconnect( hSqlSucata )
.head 3 +  Function: fDecSucata
.head 4 -  Description: Veiculos selecionados na tabela 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Window Handle: hQrp
.head 4 +  Actions 
.head 5 -  !
.head 5 +  If nOrgaoAutuante = 117200
.head 6 -  Set sNomeQRP = 'leidecSucata_DER.qrp'
.head 6 +  If not SalFileOpen ( hWndSucata, sNomeQRP, OF_Exist )
.head 7 -  Set lParam = 5
.head 7 -  Call ValidarQRP(sNomeQRP, lParam)
.head 7 -  Return FALSE
.head 6 -  Call SalReportPrint( hWndForm, sNomeQRP,

'sGlobalSecretaria, 		sGlobalDetran, 	nGlobalSetor, 	sGlobalSetor,
SqlUser, 			sPlaca,		sChassi,		sMarcaModelo,
sAnoFab,			sCor,		Lote,		Arrematante,
sNomeUsuario, 		NumLeilao, 	DataLeilao,	CPFCGC,
Identidade,		sClassificacaoLeilao,sUFPlaca ' ,

'Secretaria, 		Detran, 		Setor, 		DescSetor,
Usuario,			Placa,		Chassi,		MarcaModelo,
AnoFab,			Cor,		Lote,		Arrematante,
 NomeUsuario,		NumLeilao, 	DataLeilao,	CPFCGC,
Identidade,		Classificacao	,UFPlaca '  ,
1, RPT_PrintAll,0,0,nErro)
.head 6 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------!
.head 5 +  Else If nOrgaoAutuante= 225210
.head 6 -  Set nRetorno = 1
.head 6 -  Set nControle = 2
.head 6 -  Set sNomeQRP = 'leidecSucata_Petro.qrp'
.head 6 +  If not SalFileOpen ( hWndSucata, sNomeQRP, OF_Exist )
.head 7 -  Set lParam = 5
.head 7 -  Call ValidarQRP(sNomeQRP, lParam)
.head 7 -  Return FALSE
.head 6 -  Call fCapturaDadosAssinatura( 	picFotoAssinatura, sFotoAssinatura, sNomeAssinatura, sCargoAssinatura, 
			sNomeQRP, 0, sSituacao)
.head 6 -  Call SalReportPrint( hWndForm, sNomeQRP,

'sGlobalSecretaria, 		sGlobalDetran, 	nGlobalSetor, 	sGlobalSetor,
SqlUser, 			sPlaca,		sChassi,		sMarcaModelo,
sAnoFab,			sCor,		Lote,		Arrematante,
sNomeUsuario, 		NumLeilao, 	DataLeilao,	CPFCGC,
Identidade,		sClassificacaoLeilao,sUFPlaca,		sLinha,
sFotoAssinatura,		sNomeAssinatura,	sCargoAssinatura',

'Secretaria, 		Detran, 		Setor, 		DescSetor,
Usuario,			Placa,		Chassi,		MarcaModelo,
AnoFab,			Cor,		Lote,		Arrematante,
NomeUsuario,		NumLeilao, 	DataLeilao,	CPFCGC,
Identidade,		Classificacao,	UFPlaca, 		Linha,
FotoAssinatura,		NomeAssinatura,	CargoAssinatura',
1, RPT_PrintAll,0,0,nErro)
.head 6 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------!
.head 5 +  Else 
.head 6 -  Set nRetorno = 1
.head 6 -  Set nControle = 2
.head 6 -  Set sNomeQRP = 'leidecSucata.qrp'
.head 6 +  If not SalFileOpen ( hWndSucata, sNomeQRP, OF_Exist )
.head 7 -  Set lParam = 5
.head 7 -  Call ValidarQRP(sNomeQRP, lParam)
.head 7 -  Return FALSE
.head 6 -  Call fCapturaDadosAssinatura( 	picFotoAssinatura, sFotoAssinatura, sNomeAssinatura, sCargoAssinatura, 
			sNomeQRP, 0, sSituacao)
.head 6 -  Call SalReportPrint( hWndForm, sNomeQRP,

'sGlobalSecretaria, 		sGlobalDetran, 	nGlobalSetor, 	sGlobalSetor,
SqlUser, 			sPlaca,		sChassi,		sMarcaModelo,
sAnoFab,			sCor,		Lote,		Arrematante,
sNomeUsuario, 		NumLeilao, 	DataLeilao,	CPFCGC,
Identidade,		sClassificacaoLeilao,sUFPlaca,		sLinha,
sFotoAssinatura,		sNomeAssinatura,	sCargoAssinatura',

'Secretaria, 		Detran, 		Setor, 		DescSetor,
Usuario,			Placa,		Chassi,		MarcaModelo,
AnoFab,			Cor,		Lote,		Arrematante,
 NomeUsuario ,		NumLeilao, 	DataLeilao,	CPFCGC,
Identidade,		Classificacao,	UFPlaca, 		Linha,
FotoAssinatura,		NomeAssinatura,	CargoAssinatura',
1, RPT_PrintAll,0,0,nErro)
.head 5 -  !
.head 2 -  Window Parameters 
.head 2 +  Window Variables 
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  Window Handle: hWndRelVeicGeral
.head 3 -  Window Handle: hWndRelVeicDebito
.head 3 -  Window Handle: hWndRelVeicRestricao
.head 3 -  Number: nErro
.head 3 -  String: sNomeQRP
.head 3 -  Number: nRetorno
.head 3 -  Number: nResultSet
.head 3 -  Number: nResultSet2
.head 3 -  String: sSaida
.head 3 -  String: sDeviceDef
.head 3 -  String: sDevice
.head 3 -  String: sDriverDef
.head 3 -  String: sDriver
.head 3 -  String: sPortaDef
.head 3 -  String: sPorta
.head 3 -  FunctionalVar: oArquivo
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  Window Handle: hWndRelatorio
.head 3 -  Window Handle: hWndRetorno
.head 3 -  Window Handle: hWndSucata
.head 3 -  Sql Handle: hSqlSucata
.head 3 -  Number: nParamArray[*]
.head 3 -  Number: nFlags
.head 3 -  Number: nLinha
.head 3 -  Number: nCodVeic
.head 3 -  String: sTipoPessoa
.head 3 -  Number: nCodConsultaBin
.head 3 -  String: sTotalizar
.head 3 -  Number: nRecurso
.head 3 -  Number: nNumSeqTransacaoBin
.head 3 -  Boolean: bVeiculoBin
.head 3 -  Number: nPermissaoExtratoDebito
.head 3 -  Number: nPermissaoExtratoGeral
.head 3 -  Number: nSpid
.head 3 -  String: sUF
.head 3 -  String: sUFSucata
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! ! -  Para criação das telas - - - - - - - - - - - - -
.head 3 -  Number: nLeft
.head 3 -  Number: nTop
.head 3 -  Number: nWidth
.head 3 -  Number: nHeight
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! ! -  Para criação das telas - - - - - - - - - - - - -
.head 3 -  String: sNomeVistoriador
.head 3 -  Number: nMatriculaVistoriador
.head 3 -  String: sLeiloeiro
.head 3 -  String: Deposito
.head 3 -  String: Identidade
.head 3 -  String: sNomeUsuario
.head 3 -  Sql Handle: hSqlRec
.head 3 -  Sql Handle: hSqlCaixa
.head 3 -  Number: nControle
.head 3 -  Number: nClassificacaoVeiculo
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! - - Foto assinatura gestor atual - - - - - - - - - - -
.head 3 -  Long String: sFotoAssinatura
.head 3 -  String: sNomeAssinatura
.head 3 -  String: sCargoAssinatura
.head 3 -  String: sSituacao
.head 3 -  String: sTipoImp
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! - - -SUCATA - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  String: sPlaca
.head 3 -  String: sUFPlaca
.head 3 -  Number: nRenavam
.head 3 -  String: sChassi
.head 3 -  String: sMarcaModelo
.head 3 -  String: sAnoFab
.head 3 -  String: sCor
.head 3 -  Number: NumLeilao
.head 3 -  Date/Time: DataLeilao
.head 3 -  Number: Lote
.head 3 -  Number: nClassificacaoLeilao
.head 3 -  String: sClassificacaoLeilao
.head 3 -  String: Arrematante
.head 3 -  String: CPFCGC
.head 3 -  String: sNumDocArrematante
.head 3 -  Number: nOrgaoAutuante
.head 3 -  String: sLinha
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendClassMessage( SAM_CreateComplete, wParam, lParam )
.head 4 -  !
.head 4 -  Call SalEnableWindow( cbDebito )
.head 4 -  Call SalEnableWindow( cbRestricao )
.head 4 -  Call SalEnableWindow( cbGeral )
.head 4 -  Call SalEnableWindow( cbSucata )
.head 4 -  !
.head 4 -  Call SalDisableWindow( pbPesquisar )
.head 4 -  Call SalDisableWindow( rbImpressora )
.head 4 -  Call SalDisableWindow( rbTela )
.head 4 -  Call SalDisableWindow( pbImprimir )
.head 4 -  Call SalDisableWindow( pbImpressoras )
.head 4 -  Call SalDisableWindow( tblRetorno )
.head 4 -  Set nPermissaoExtratoGeral = fObtemPermissao('frmConsultaVeiculoG')
.head 4 +  If nPermissaoExtratoGeral = 0
.head 5 -  Set nPermissaoExtratoGeral = 1
.head 3 +  On SAM_ReportFetchInit
.head 4 +  If cbSucata
.head 5 +  If fMPSConnect( hSqlSucata )
.head 6 -  Call fMPSPrepareProc( hSqlSucata, 'exec dbvcen..LeilaoDocumentosImprimir
@nLeilao    =  :frmLeilaoDocumentosImprimir.dfnLeilao,
@TipoImpressao  = "S", 
@UFDeclaracao = :frmLeilaoDocumentosImprimir.sUFSucata ,
@Spid = :frmLeilaoDocumentosImprimir.nSpid  ' ,
':frmLeilaoDocumentosImprimir.sPlaca,
:frmLeilaoDocumentosImprimir.sUFPlaca,
:frmLeilaoDocumentosImprimir.nRenavam,
:frmLeilaoDocumentosImprimir.sChassi,
:frmLeilaoDocumentosImprimir.sMarcaModelo,
:frmLeilaoDocumentosImprimir.sAnoFab,
:frmLeilaoDocumentosImprimir.sCor,
:frmLeilaoDocumentosImprimir.NumLeilao,
:frmLeilaoDocumentosImprimir.DataLeilao,
:frmLeilaoDocumentosImprimir.Lote,
:frmLeilaoDocumentosImprimir.nClassificacaoLeilao,
:frmLeilaoDocumentosImprimir.sClassificacaoLeilao,
:frmLeilaoDocumentosImprimir.Arrematante,
:frmLeilaoDocumentosImprimir.CPFCGC,
:frmLeilaoDocumentosImprimir.sNumDocArrematante,
:frmLeilaoDocumentosImprimir.nOrgaoAutuante,
:frmLeilaoDocumentosImprimir.sLinha' )
.head 6 -  ! Call fMPSDisconnect( hSqlSucata )
.head 6 -  Return SqlExecute( hSqlSucata )
.head 4 -  Return TRUE
.head 3 +  On MSG_Limpa
.head 4 -  Call SalSendClassMessage( MSG_Limpa, wParam, lParam )
.head 4 -  Call SalEnableWindow( cbDebito )
.head 4 -  Call SalEnableWindow( cbRestricao )
.head 4 -  Call SalEnableWindow( cbGeral )
.head 4 -  Call SalEnableWindow( cbSucata )
.head 4 -  !
.head 4 -  Call SalDisableWindow( pbPesquisar )
.head 4 -  Call SalDisableWindow( rbImpressora )
.head 4 -  Call SalDisableWindow( rbTela )
.head 4 -  Call SalDisableWindow( pbImprimir )
.head 4 -  Call SalDisableWindow( pbImpressoras )
.head 4 -  Call SalDisableWindow( tblRetorno )
.head 4 +  If hWndRelVeicDebito != hWndNULL
.head 5 -  Call SalSendMsg( hWndRelVeicDebito, MSG_Sai, 0, 0 )
.head 3 +  On SAM_ReportFetchNext
.head 4 -  Call SqlFetchNext( hSqlSucata, lParam )
.head 4 +  If lParam =FETCH_EOF
.head 5 -  Return FALSE
.head 4 -  Return TRUE
.head 3 +  On SAM_Destroy
.head 4 +  If hWndRelVeicGeral != hWndNULL
.head 5 -  Call SalSendMsg( hWndRelVeicGeral, MSG_Sai, 0, 0 )
.head 4 +  If hWndRelVeicDebito != hWndNULL
.head 5 -  Call SalSendMsg( hWndRelVeicDebito, MSG_Sai, 0, 0 )
.head 4 +  If hWndRelVeicRestricao != hWndNULL
.head 5 -  Call SalSendMsg( hWndRelVeicRestricao, MSG_Sai, 0, 0 )
.head 4 +  If hWndSucata != hWndNULL
.head 5 -  Call SalSendMsg( hWndSucata, MSG_Sai, 0, 0 )
.head 4 -  Call SalSendClassMessage( SAM_Destroy, wParam, lParam )
.head 4 -  Call HabilitacaoNome( 'mdipbConsVeiculo', TRUE )
.head 1 +  Form Window: frmLeilaoDocumentosImprimir
.head 2 -  Class: cQCK1Form
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Imprimir Documentos Leilão
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left: -11.425"
.head 4 -  Top: 3.115"
.head 4 -  Width:  7.933"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.488"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 49845
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top: 0.073"
.head 5 -  Width:  7.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 5.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: Dark Gray
.head 4 -  Background Color: 3D Face Color
.head 3 -  ! ----------------------------------------------------------------
.head 3 -  Background Text: Leilão:
.head 4 -  Resource Id: 49846
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.317"
.head 5 -  Top: 0.19"
.head 5 -  Width:  0.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfnLeilao
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 7461624170726565 6E73616F00000000
.enddata
.data CLASSPROPSSIZE
0000: 2000
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.083"
.head 6 -  Top: 0.155"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: 9999999999999
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sTextoStatusBar = 'Informar o número do Leilão'
.head 6 -  Set _sNomeParaMsgs = 'Número do leilão'
.head 6 -  Set _bSempreHabilitado = TRUE
.head 6 -  Set _bPermiteNulos = FALSE
.head 6 -  Set _sMsgValidacao = 'Número do leilão inválido!'
.head 6 -  Set _sTipoMsgValidacao = 'ESPECIFICA'
.head 6 -  Set _bNaoTemDependentes = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  Background Text: Total de Veículos:
.head 4 -  Resource Id: 49847
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.383"
.head 5 -  Top: 5.19"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfnTotVeic
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 7461624170726565 6E73616F00000000
.enddata
.data CLASSPROPSSIZE
0000: 2000
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1DataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.983"
.head 6 -  Top: 5.155"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: 9999999999999
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _bVisivel = TRUE
.head 6 -  Set _sTextoStatusBar = 'Total de Veículos do Leilão'
.head 6 -  Set _sNomeParaMsgs = 'Total de Veículos do Leilão'
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  Set _bPermiteNulos = TRUE
.head 6 -  Set _sMsgValidacao = 'Total de Veículos do Leilão inválido!'
.head 6 -  Set _sTipoMsgValidacao = 'ESPECIFICA'
.head 6 -  Set _bNaoTemDependentes = TRUE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  ! ----------------------------------------------------------------
.head 3 -  Group Box: Tipo Impressão
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 746162526573756C 7461646F00000000
.enddata
.data CLASSPROPSSIZE
0000: 2000
.enddata
.head 4 -  Resource Id: 49848
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.183"
.head 5 -  Top: 0.44"
.head 5 -  Width:  7.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: cbDebito
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1CheckBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ext.Débito
.head 4 -  Window Location and Size
.head 5 -  Left: 0.717"
.head 5 -  Top: 0.595"
.head 5 -  Width:  1.267"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Imprime o extrato dos débitos'
.head 6 -  Set _bComponenteChave = TRUE
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalEnableWindow( pbPesquisar )
.head 6 -  Set sUF = 'PE'
.head 6 -  Set sTipoImp = 'D'
.head 3 +  Check Box: cbRestricao
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1CheckBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ext. Restrição
.head 4 -  Window Location and Size
.head 5 -  Left: 1.983"
.head 5 -  Top: 0.595"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Imprime o extrato das restrições'
.head 6 -  Set _bComponenteChave = TRUE
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalEnableWindow( pbPesquisar )
.head 6 -  Set sUF = 'PE'
.head 6 -  Set sTipoImp = 'R'
.head 3 +  Check Box: cbGeral
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1CheckBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ext. Geral
.head 4 -  Window Location and Size
.head 5 -  Left: 3.85"
.head 5 -  Top: 0.595"
.head 5 -  Width:  1.133"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Imprime o extrato geral'
.head 6 -  Set _bComponenteChave = TRUE
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalEnableWindow( pbPesquisar )
.head 6 -  Set sUF = STRING_Null
.head 6 -  Set sTipoImp = 'G'
.head 3 +  Check Box: cbSucata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1CheckBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Declaração Sucata
.head 4 -  Window Location and Size
.head 5 -  Left: 5.15"
.head 5 -  Top: 0.595"
.head 5 -  Width:  1.933"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Imprime a declaração de Sucata'
.head 6 -  Set _bComponenteChave = TRUE
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalEnableWindow( pbPesquisar )
.head 6 -  Set sUF = STRING_Null
.head 6 -  Set sTipoImp = 'S'
.head 3 -  ! ----------------------------------------------------------------
.head 3 -  Group Box: Saída
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 746162526573756C 7461646F00000000
.enddata
.data CLASSPROPSSIZE
0000: 2000
.enddata
.head 4 -  Resource Id: 49849
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.217"
.head 5 -  Top: 5.167"
.head 5 -  Width:  2.167"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbImpressora
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Impressora
.head 4 -  Window Location and Size
.head 5 -  Left: 0.3"
.head 5 -  Top: 5.357"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Set sSaida='I'
.head 6 -  Call SalEnableWindow( pbImpressoras )
.head 5 +  On SAM_Create
.head 6 -  Set _bComponenteChave = TRUE
.head 3 +  Radio Button: rbTela
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1RadioButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Tela
.head 4 -  Window Location and Size
.head 5 -  Left: 1.617"
.head 5 -  Top: 5.357"
.head 5 -  Width:  0.733"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Black
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Set sSaida='T'
.head 6 -  Call SalDisableWindow(pbImpressoras)
.head 5 +  On SAM_Create
.head 6 -  Set _bComponenteChave = TRUE
.head 3 -  ! - Botões
.head 3 +  Pushbutton: pbPesquisar
.data CLASSPROPSSIZE
0000: 1E00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000D00 7461624170726565 6E73616F0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Pesquisar
.head 4 -  Window Location and Size
.head 5 -  Left: 2.8"
.head 5 -  Top: 5.5"
.head 5 -  Width:  0.95"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Efetua a pesquisa no banco de dados'
.head 6 -  Set _sTipoComando = 'TabelaPesquisa'
.head 6 -  Set _sTabela = 'tblRetorno'
.head 6 -  Set _bValidaCamposNulos = FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  ! On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 +  If (cbGeral and cbDebito) or (cbGeral and cbRestricao) or (cbDebito and cbRestricao)
or (cbGeral and cbSucata) or (cbSucata and cbRestricao) or (cbDebito and cbSucata)
.head 7 -  Call SalMessageBox('Só é possível emitir um extrato por vez!', 'Atenção', MB_IconExclamation )
.head 7 -  Call SalSendMsg( hWndForm, MSG_Limpa, lParam, wParam )
.head 7 -  Return FALSE
.head 6 +  If NOT cbGeral and NOT cbRestricao and NOT cbDebito and NOT cbSucata
.head 7 -  Call SalMessageBox('Deve ser escolhido um tipo de Impressão !', 'Atenção', MB_IconExclamation )
.head 7 -  Call SalSendMsg( hWndForm, MSG_Limpa, lParam, wParam )
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Return TRUE
.head 6 -  ! -------------------------------------------------------------------------------------------------------------------------------
.head 6 +  If dfnLeilao = NUMBER_Null
.head 7 -  Call SalEnableWindow( cbDebito )
.head 7 -  Call SalEnableWindow( cbRestricao )
.head 7 -  Call SalEnableWindow( cbGeral )
.head 7 -  Call SalEnableWindow( cbSucata )
.head 7 -  Call SalDisableWindow( rbImpressora )
.head 7 -  Call SalDisableWindow( rbTela )
.head 7 -  Call SalDisableWindow( pbImprimir )
.head 7 -  Call SalDisableWindow( pbImpressoras )
.head 7 -  Call SalDisableWindow( tblRetorno )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( cbDebito )
.head 7 -  Call SalDisableWindow( cbRestricao )
.head 7 -  Call SalDisableWindow( cbGeral )
.head 7 -  Call SalDisableWindow( cbSucata )
.head 7 -  Call SalEnableWindow( rbImpressora )
.head 7 -  Call SalEnableWindow( rbTela )
.head 7 -  Call SalEnableWindow( pbImprimir )
.head 7 -  Call SalEnableWindow( pbImpressoras )
.head 7 -  Call SalEnableWindow( tblRetorno )
.head 3 +  Pushbutton: pbImprimir
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Imprimir
.head 4 -  Window Location and Size
.head 5 -  Left: 3.75"
.head 5 -  Top: 5.5"
.head 5 -  Width:  0.95"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTabela = ''
.head 6 -  Set _nPermissao = 15
.head 6 -  Set _sTipoComando = 'Comum'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 +  If (cbGeral and cbDebito) or (cbGeral and cbRestricao) or (cbDebito and cbRestricao)
or (cbGeral and cbSucata) or (cbSucata and cbRestricao) or (cbDebito and cbSucata)
.head 7 -  Call SalMessageBox('Só é possível emitir um extrato por vez!', 'Atenção', MB_IconExclamation )
.head 7 -  Return FALSE
.head 6 +  If rbImpressora
.head 7 -  Call SalMessageBeep( MB_Ok )
.head 7 +  If SalMessageBox( 'Certifique-se que a impressão esta configurada como PDF!
Para definir a impressão, clicar no botão "Configurar".  ', 'Atenção', MB_IconQuestion | MB_YesNo ) = IDNO
.head 8 -  Return FALSE
.head 6 -  Call SalWaitCursor ( TRUE )
.head 6 -  Call fVeiculoSelecionados(  )
.head 6 -  Call SalWaitCursor ( FALSE )
.head 6 +  ! ------------------------------------------------------------------------------------------------------------------------------
.head 7 +  ! If cbGeral = TRUE
.head 8 -  ! ! - Imprime o extrato geral ()
.head 8 -  Set nFlags = CREATE_AsChild
.head 8 +  If hWndRelVeicGeral  != hWndNULL
.head 9 -  Call SalSendMsg( hWndRelVeicGeral, SAM_Close, 0, 0)
.head 8 -  Set hWndRelVeicGeral = SalCreateWindowEx( frmRelVeicGeral, hWndForm, nLeft, nTop, nWidth, nHeight, nFlags, hWndRelVeicGeral, rbImpressora, NUMBER_Null, 0)
.head 8 -  ! Set hWndRelVeicGeral = SalCreateWindow( frmRelVeicGeral, hWndForm, hWndRelVeicGeral, rbTela, 0, nPermissaoExtratoDebito )
.head 7 +  ! If cbDebito = TRUE
.head 8 +  If hWndRelVeicDebito  != hWndNULL
.head 9 -  Call SalSendMsg( hWndRelVeicDebito, SAM_Close, 0, 0)
.head 8 -  Set hWndRelVeicDebito = SalCreateWindow( frmExtratoDebito, hWndMDI, hWndRelVeicDebito,
rbImpressora, 'LI' , nPermissaoExtratoDebito )
.head 7 +  ! If cbRestricao = TRUE
.head 8 +  If hWndRelVeicRestricao  != hWndNULL
.head 9 -  Call SalSendMsg( hWndRelVeicRestricao, SAM_Close, 0, 0)
.head 8 -  Set hWndRelVeicRestricao = SalCreateWindow( frmExtratoRestricao, hWndMDI,
hWndRelVeicRestricao, NUMBER_Null, 'LI', NUMBER_Null, STRING_Null, NUMBER_Null,
NUMBER_Null, NUMBER_Null, NUMBER_Null, NUMBER_Null )
.head 7 +  ! If cbSucata = TRUE
.head 8 -  Call fImpSucata ( )
.head 8 -  Call fDecSucata ( )
.head 7 -  !
.head 3 +  Pushbutton: pbImpressoras
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Con&figurar
.head 4 -  Window Location and Size
.head 5 -  Left: 4.68"
.head 5 -  Top: 5.5"
.head 5 -  Width:  1.033"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalPrtGetDefault( sDeviceDef, sDriverDef, sPortaDef )
.head 6 -  Call SalPrtSetup(sDevice,sDriver,sPorta,FALSE)
.head 5 +  On SAM_Create
.head 6 -  Set _sTabela = ''
.head 6 -  Set _nPermissao = 15
.head 6 -  Set _sTipoComando = 'Comum'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  Pushbutton: pbLimpar
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001800 74616253656C6563 616F097461625265
0020: 73756C7461646F00 000000
.enddata
.data CLASSPROPSSIZE
0000: 2B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Limpar
.head 4 -  Window Location and Size
.head 5 -  Left: 5.7"
.head 5 -  Top: 5.5"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Limpa os dados da tela'
.head 6 -  Set _sNroCamposIgnorados = 'NENHUM'
.head 6 -  !
.head 6 -  Set _bValidaCamposNulos = FALSE
.head 6 -  Set _sTipoComando = 'Limpa'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Set rbImpressora=1
.head 6 -  Set rbTela=0
.head 6 -  ! --- [faml] 22/02/2016 - ini
.head 6 -  Set frmLeilaoDocumentosImprimir.dfnLeilao = NUMBER_Null
.head 6 -  ! --- fim
.head 6 -  Call SalFmtSetInputMask( dfnLeilao, '99999999999999' )
.head 6 +  If hWndRelVeicGeral != hWndNULL
.head 7 -  Call SalSendMsg( hWndRelVeicGeral, SAM_Close, 0, 0)
.head 6 +  If hWndRelVeicDebito != hWndNULL
.head 7 -  Call SalSendMsg( hWndRelVeicDebito, SAM_Close, 0, 0)
.head 6 +  If hWndRelVeicRestricao != hWndNULL
.head 7 -  Call SalSendMsg( hWndRelVeicRestricao, SAM_Close, 0, 0)
.head 6 +  If hWndSucata != hWndNULL
.head 7 -  Call SalSendMsg( hWndSucata, SAM_Close, 0, 0)
.head 3 +  Pushbutton: pbSair 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1PushButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Sair
.head 4 -  Window Location and Size
.head 5 -  Left: 6.533"
.head 5 -  Top: 5.5"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTabela = ''
.head 6 -  Set _sTipoComando = 'Sai'
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  ! ----------------------------------------------------------------
.head 3 -  ! -Tabela Consulta
.head 3 +  Child Table: tblRetorno
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000800 7461624974656D00 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK2ChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.283"
.head 6 -  Top: 0.988"
.head 6 -  Width:  6.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.083"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  ! cQCK2Column: colnSelecionar
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsPlaca
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK2Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Placa
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Center
.head 6 -  Width:  1.038"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsUFPlaca
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK2Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: UF
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Center
.head 6 -  Width:  1.038"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsChassi
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK2Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Chassi
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Center
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnCodVeiculo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK2Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CodVeic
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Unformatted
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = FALSE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnRenavam
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK2Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Renavam
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Unformatted
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colsCodSetor
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK2Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Setor
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  Column: colnCodRecolhimento
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK2Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Apreensão
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: #0
.head 6 -  Country: Class Default
.head 6 -  Input Mask: 9999999999999
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Veículos participantes do leilão'
.head 6 -  ! Set _bPesquisaCreate = TRUE
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  !
.head 6 -  Set _sComandoPesquisa = 'exec dbvcen..LeilaoVeiculoSelecionar
		@nLeilao = :frmLeilaoDocumentosImprimir.dfnLeilao,
		@UF =  :frmLeilaoDocumentosImprimir.sUF,
		@TipoImpressao =  :frmLeilaoDocumentosImprimir.sTipoImp '
.head 6 -  Set _sIntoPesquisa = '
		:frmLeilaoDocumentosImprimir.tblRetorno.colsPlaca,
		:frmLeilaoDocumentosImprimir.tblRetorno.colsUFPlaca,
		:frmLeilaoDocumentosImprimir.tblRetorno.colsChassi,
		:frmLeilaoDocumentosImprimir.tblRetorno.colnCodVeiculo,
		:frmLeilaoDocumentosImprimir.tblRetorno.colnRenavam,
		:frmLeilaoDocumentosImprimir.tblRetorno.colsCodSetor,
		:frmLeilaoDocumentosImprimir.tblRetorno.colnCodRecolhimento,
		:frmLeilaoDocumentosImprimir.nOrgaoAutuante '
.head 6 -  !
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Set nPermissao = 15
.head 5 +  On UDM_AntesPesquisa
.head 6 -  ! -------------------------------------------------------------------------------------------------------------------------------
.head 6 +  If (cbGeral and cbDebito) or (cbGeral and cbRestricao) or (cbDebito and cbRestricao)
or (cbGeral and cbSucata) or (cbSucata and cbRestricao) or (cbDebito and cbSucata)
.head 7 -  Call SalMessageBox('Só é possível emitir um extrato por vez!', 'Atenção', MB_IconExclamation )
.head 7 -  Call SalSendMsg( hWndForm, MSG_Limpa, lParam, wParam )
.head 7 -  Return FALSE
.head 6 +  If NOT cbGeral and NOT cbRestricao and NOT cbDebito and NOT cbSucata
.head 7 -  Call SalMessageBox('Deve ser escolhido um tipo de Impressão !', 'Atenção', MB_IconExclamation )
.head 7 -  Call SalSendMsg( hWndForm, MSG_Limpa, lParam, wParam )
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Return TRUE
.head 6 -  ! -------------------------------------------------------------------------------------------------------------------------------
.head 6 +  If dfnLeilao = NUMBER_Null
.head 7 -  Call SalEnableWindow( cbDebito )
.head 7 -  Call SalEnableWindow( cbRestricao )
.head 7 -  Call SalEnableWindow( cbGeral )
.head 7 -  Call SalEnableWindow( cbSucata )
.head 7 -  Call SalDisableWindow( rbImpressora )
.head 7 -  Call SalDisableWindow( rbTela )
.head 7 -  Call SalDisableWindow( pbImprimir )
.head 7 -  Call SalDisableWindow( pbImpressoras )
.head 7 -  Call SalDisableWindow( tblRetorno )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( cbDebito )
.head 7 -  Call SalDisableWindow( cbRestricao )
.head 7 -  Call SalDisableWindow( cbGeral )
.head 7 -  Call SalDisableWindow( cbSucata )
.head 7 -  Call SalEnableWindow( rbImpressora )
.head 7 -  Call SalEnableWindow( rbTela )
.head 7 -  Call SalEnableWindow( pbImprimir )
.head 7 -  Call SalEnableWindow( pbImpressoras )
.head 7 -  Call SalEnableWindow( tblRetorno )
.head 6 -  ! -------------------------------------------------------------------------------------------------------------------------------
.head 6 +  If cbDebito = TRUE
.head 7 -  Set sUF = 'PE'
.head 7 -  Set sTipoImp = 'D'
.head 6 +  If cbRestricao = TRUE
.head 7 -  Set sUF = 'PE'
.head 7 -  Set sTipoImp = 'R'
.head 6 +  If cbSucata = TRUE
.head 7 -  Set sUF = STRING_Null
.head 7 -  Set sTipoImp = 'S'
.head 6 +  If cbGeral = TRUE
.head 7 -  Set sUF = STRING_Null
.head 7 -  Set sTipoImp = 'G'
.head 6 -  ! -------------------------------------------------------------------------------------------------------------------------------
.head 5 +  On UDM_AposPesquisa
.head 6 -  Call SalDisableWindow( cbDebito )
.head 6 -  Call SalDisableWindow( cbRestricao )
.head 6 -  Call SalDisableWindow( cbGeral )
.head 6 -  Call SalDisableWindow( cbSucata )
.head 6 -  !
.head 6 -  Call SalEnableWindow( tblRetorno )
.head 6 -  Call SalDisableWindow( pbPesquisar )
.head 6 -  Call SalEnableWindow( rbImpressora )
.head 6 -  Call SalEnableWindow( rbTela )
.head 6 -  Call SalEnableWindow( pbImprimir )
.head 6 -  Call SalEnableWindow( pbImpressoras )
.head 6 -  ! Call SalDisableWindow( tblRetorno )
.head 6 +  ! If cbSucata = TRUE
.head 7 -  Call SalDisableWindow( tblRetorno )
.head 6 +  If nRowCount < 1
.head 7 -  Call SalMessageBox( 'Verifique o leilão informado, ele não possui dados.', 'Atenção', MB_Ok)
.head 7 -  Return FALSE
.head 6 -  Set dfnTotVeic = nRowCount
.head 6 -  Return TRUE
.head 5 +  On SAM_RowHeaderClick
.head 6 +  ! If SalTblQueryRowFlags( hWndForm, lParam, ROW_Edited )
.head 7 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
.head 6 +  ! Else
.head 7 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
.head 6 -  Return TRUE
.head 5 +  ! On SAM_FetchRowDone
.head 6 -  Set dfnTotVeic = nRowCount
.head 3 +  Child Table: tblUF
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000800 7461624974656D00 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK2ChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.283"
.head 6 -  Top: 0.988"
.head 6 -  Width:  6.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colsUFPlaca
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cQCK2Column
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: UF
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.038"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set _bVisivel = TRUE
.head 8 -  Set _bPermiteNulos = TRUE
.head 8 -  Set _bNuncaHabilitado = TRUE
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set _sTextoStatusBar = 'Tabela das diárias de congelamento'
.head 6 -  Set _bSempreHabilitado = FALSE
.head 6 -  !
.head 6 -  Set _sComandoPesquisa = 'exec dbvcen..LeilaoUfVeicSucataSelecionar
		@nLeilao = :frmLeilaoDocumentosImprimir.dfnLeilao'
.head 6 -  Set _sIntoPesquisa = ':frmLeilaoDocumentosImprimir.tblUF.colsUFPlaca'
.head 6 -  !
.head 6 -  Set nPermissao = 15
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 -  ! ----------------------------------------------------------------
.head 3 +  Picture: picSemaforo
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQCK1Form
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.233"
.head 5 -  Top: 5.5"
.head 5 -  Width:  0.383"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.28"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: picFotoAssinatura
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 7.238"
.head 5 -  Top: 4.531"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name: ImagemNaoDisponivel.jpg
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Size to Fit
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  ! ----------------------------------------------------------------
.head 2 +  Functions
.head 3 +  Function: fConsultaBIN
.head 4 -  Description: Chama as tela dos extratos para fazer as impressões. Faz a criação da tela com ela escondida, já que ela contém todos os elementos necessários
para impressão dos extratos
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndDebito
.head 5 -  Window Handle: hWndRestricao
.head 5 -  Window Handle: hWndGeral
.head 4 +  Actions
.head 5 -  ! -  Seta a menor linha da tabela
.head 5 -  Set nLinha = TBL_MinRow
.head 5 -  ! - Percorre a tabela linha por linha para impressão dos extratos
.head 5 +  While SalTblFindNextRow( tblRetorno, nLinha, 0, 0 )
.head 6 -  Call SalTblSetContext( tblRetorno, nLinha )
.head 6 -  ! - Pega os dados essências do veiculo para a impressao dos extratos
.head 6 -  Set nCodVeic = tblRetorno.colnCodVeiculo
.head 6 -  Set sChassi = tblRetorno.colsChassi
.head 6 -  Set sUFPlaca = tblRetorno.colsUFPlaca
.head 6 -  ! - Flag para criar tela escondida
.head 6 -  Set nFlags = NUMBER_Null
.head 6 -  ! - Se for de PE, consulta os extratos locais
.head 6 -  ! - Se for de outra UF faz a 912
.head 6 +  If (sUFPlaca != 'PE' ) and (sUFPlaca != STRING_Null OR sUFPlaca != '' )
.head 7 -  Set nCodConsultaBin = 912
.head 7 -  Call BINConsultaVeiculo(STRING_Null, sUFPlaca, NUMBER_Null, sChassi, STRING_Null, STRING_Null, STRING_Null, nCodConsultaBin, nNumSeqTransacaoBin)
.head 7 -  Set bVeiculoBin = 1
.head 6 -  ! - Se for sem primeiro emplacamento faz a 901
.head 6 +  Else
.head 7 -  Set nCodConsultaBin = 901
.head 7 -  Call BINConsultaVeiculo(STRING_Null, STRING_Null, NUMBER_Null, sChassi, STRING_Null, STRING_Null, STRING_Null, nCodConsultaBin, nNumSeqTransacaoBin)
.head 7 -  Set bVeiculoBin = 1
.head 6 -  ! - Imprime o extrato geral (independe da UF)
.head 6 -  Set nFlags = CREATE_AsChild
.head 6 -  ! ------------------------------------------------------------------------------------------------------------------------
.head 5 -  ! - Ao fim da impressão limpa a tabela e pesquisa novamente
.head 5 -  Call SalTblReset( tblRetorno )
.head 5 -  Call SalSendMsg( tblRetorno, MSG_PesquisaTabela, 0, 0 )
.head 3 +  Function: fVeiculoSelecionados
.head 4 -  Description: Retorna os ítens selecionados de uma tabela
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndTabela
.head 5 -  String: sSelecionados
.head 5 -  Sql Handle: hSqlVeicSelec
.head 5 -  Number: nLinha
.head 5 -  Number: nLinha2
.head 5 -  Number: nLinha3
.head 5 -  Number: nSelecionados
.head 5 -  Number: nCodConsultaBin
.head 5 -  Number: nNumSeqTransacaoBin
.head 5 -  Number: nProc
.head 5 -  Number: nCont
.head 5 -  Number: nContLinha
.head 5 -  String: sAux
.head 5 -  Boolean: bTodos
.head 4 +  Actions
.head 5 -  Call SalWaitCursor ( TRUE )
.head 5 -  Call SalSendMsg( tblUF, MSG_PesquisaTabela, 0 ,0)
.head 5 -  Set nLinha   = TBL_MinRow
.head 5 -  Set nLinha2 = TBL_MinRow
.head 5 -  Set nLinha3 = TBL_MinRow
.head 5 -  Set nProc = 0
.head 5 -  Set nCont = 0
.head 5 -  Set nContLinha = -1
.head 5 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 5 +  While SalTblFindNextRow( tblRetorno, nLinha3, 0, 0 )
.head 6 -  Call SalWaitCursor ( TRUE )
.head 6 -  Call SalTblSetContext( tblRetorno, nLinha3 )
.head 6 -  Set nContLinha = nContLinha + 1
.head 5 -  ! Set dfnTotVeic = nContLinha
.head 5 +  If NOT fMPSConnect (hSqlVeicSelec)
.head 6 -  Return FALSE
.head 5 +  If nSpid != NUMBER_Null
.head 6 +  If nSpid != 0 
.head 7 -  Call fLimpaTmpVeiculos()
.head 5 +  If cbSucata = TRUE
.head 6 +  While SalTblFindNextRow( tblUF, nLinha2, 0, 0 )
.head 7 -  Call SalWaitCursor ( TRUE )
.head 7 -  Call SalTblSetContext( tblUF, nLinha2 )
.head 7 -  Set nLinha   = TBL_MinRow
.head 7 +  While SalTblFindNextRow( tblRetorno, nLinha, 0, 0 )
.head 8 -  ! If SalTblQueryRowFlags( tblRetorno, nLinha, 0, 0 )
.head 8 -  Call SalTblSetContext( tblRetorno, nLinha )
.head 8 +  If tblRetorno.colsUFPlaca = tblUF.colsUFPlaca
.head 9 +  If fMPSPrepareProc( hSqlVeicSelec, 'exec dbinfracao..tmpVeiculoSelecionadoProcessar
	@Setor 		= :frmLeilaoDocumentosImprimir.tblRetorno.colsCodSetor,
	@Apreensao 	= :frmLeilaoDocumentosImprimir.tblRetorno.colnCodRecolhimento ',
	' :frmLeilaoDocumentosImprimir.nSpid ' )
.head 10 +  If SqlExecute( hSqlVeicSelec )
.head 11 -  Call SqlGetResultSetCount( hSqlVeicSelec, nResultSet )
.head 11 -  Call SqlFetchNext( hSqlVeicSelec, nErro )
.head 8 -  Set sUFSucata = tblUF.colsUFPlaca
.head 7 -  Call fImpSucata ( )
.head 7 -  Call fDecSucata( )
.head 5 +  Else
.head 6 +  While SalTblFindNextRow( tblRetorno, nLinha, 0, 0 )
.head 7 -  Call SalWaitCursor ( TRUE )
.head 7 -  Call SalTblSetContext( tblRetorno, nLinha )
.head 7 +  If cbGeral and ( tblRetorno.colsUFPlaca != 'PE' )
.head 8 -  Call BINConsultaVeiculo( tblRetorno.colsPlaca, tblRetorno.colsUFPlaca, tblRetorno.colnRenavam, tblRetorno.colsChassi,
STRING_Null, STRING_Null, STRING_Null, nCodConsultaBin, nNumSeqTransacaoBin )
.head 8 -  ! Set bVeiculoBin = BINConsultaVeiculo( dfsPlaca, dfsUFPlaca, dfnRenavam, dfsChassi, '', '', 'N', nCodConsultaBin,
nNumSeqTransacaoBin )
.head 7 +  If fMPSPrepareProc( hSqlVeicSelec, 'exec dbinfracao..tmpVeiculoSelecionadoProcessar
	@Setor 		= :frmLeilaoDocumentosImprimir.tblRetorno.colsCodSetor,
	@Apreensao 	= :frmLeilaoDocumentosImprimir.tblRetorno.colnCodRecolhimento ',
	' :frmLeilaoDocumentosImprimir.nSpid ' )
.head 8 +  If Not SqlExecute( hSqlVeicSelec )
.head 9 -  Return FALSE
.head 8 -  Call SqlGetResultSetCount( hSqlVeicSelec, nResultSet )
.head 8 -  Call SqlFetchNext( hSqlVeicSelec, nErro )
.head 7 -  Set nCont = nCont + 1
.head 7 +  If (nCont = 100)  or ( nContLinha = nLinha )
.head 8 +  If cbGeral = TRUE
.head 9 -  ! ! - Imprime o extrato geral ()
.head 9 -  Set nFlags = CREATE_AsChild
.head 9 +  If hWndRelVeicGeral  != hWndNULL
.head 10 -  Call SalSendMsg( hWndRelVeicGeral, SAM_Close, 0, 0)
.head 9 -  Set hWndRelVeicGeral = SalCreateWindowEx( frmRelVeicGeral, hWndForm, nLeft, nTop, nWidth, nHeight, nFlags, hWndRelVeicGeral, rbImpressora, NUMBER_Null, 0)
.head 9 -  ! Set hWndRelVeicGeral = SalCreateWindow( frmRelVeicGeral, hWndForm, hWndRelVeicGeral, rbTela, 0, nPermissaoExtratoDebito )
.head 8 +  If cbDebito = TRUE
.head 9 +  If hWndRelVeicDebito  != hWndNULL
.head 10 -  Call SalSendMsg( hWndRelVeicDebito, SAM_Close, 0, 0)
.head 9 -  Set hWndRelVeicDebito = SalCreateWindow( frmExtratoDebito, hWndMDI, hWndRelVeicDebito,
rbImpressora, 'LI' , nPermissaoExtratoDebito )
.head 8 +  If cbRestricao = TRUE
.head 9 +  If hWndRelVeicRestricao  != hWndNULL
.head 10 -  Call SalSendMsg( hWndRelVeicRestricao, SAM_Close, 0, 0)
.head 9 -  Set hWndRelVeicRestricao = SalCreateWindow( frmExtratoRestricao, hWndMDI,
hWndRelVeicRestricao, rbImpressora, 'LI', NUMBER_Null, STRING_Null, NUMBER_Null,
NUMBER_Null, NUMBER_Null, NUMBER_Null, NUMBER_Null )
.head 8 -  Set nCont = 0
.head 7 +  ! If nCont = 100 or ((( nContLinha - nLinha ) < 100  ) and ( nContLinha = nLinha ))
.head 8 +  If cbGeral = TRUE
.head 9 -  ! ! - Imprime o extrato geral ()
.head 9 -  Set nFlags = CREATE_AsChild
.head 9 +  If hWndRelVeicGeral  != hWndNULL
.head 10 -  Call SalSendMsg( hWndRelVeicGeral, SAM_Close, 0, 0)
.head 9 -  Set hWndRelVeicGeral = SalCreateWindowEx( frmRelVeicGeral, hWndForm, nLeft, nTop, nWidth, nHeight, nFlags, hWndRelVeicGeral, rbImpressora, NUMBER_Null, 0)
.head 9 -  ! Set hWndRelVeicGeral = SalCreateWindow( frmRelVeicGeral, hWndForm, hWndRelVeicGeral, rbTela, 0, nPermissaoExtratoDebito )
.head 8 +  If cbDebito = TRUE
.head 9 +  If hWndRelVeicDebito  != hWndNULL
.head 10 -  Call SalSendMsg( hWndRelVeicDebito, SAM_Close, 0, 0)
.head 9 -  Set hWndRelVeicDebito = SalCreateWindow( frmExtratoDebito, hWndMDI, hWndRelVeicDebito,
rbImpressora, 'LI' , nPermissaoExtratoDebito )
.head 8 +  If cbRestricao = TRUE
.head 9 +  If hWndRelVeicRestricao  != hWndNULL
.head 10 -  Call SalSendMsg( hWndRelVeicRestricao, SAM_Close, 0, 0)
.head 9 -  Set hWndRelVeicRestricao = SalCreateWindow( frmExtratoRestricao, hWndMDI,
hWndRelVeicRestricao, rbImpressora, 'LI', NUMBER_Null, STRING_Null, NUMBER_Null,
NUMBER_Null, NUMBER_Null, NUMBER_Null, NUMBER_Null )
.head 8 -  Set nCont = 0
.head 5 -  Call fMPSDisconnect( hSqlVeicSelec )
.head 3 -  ! ----------------- Declaração Sucata -----------------
.head 3 +  Function: fImpSucata
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If fMPSConnect( hSqlSucata )
.head 6 +  If fMPSPrepareProc( hSqlSucata, 'exec dbvcen..LeilaoDocumentosImprimir
@nLeilao = :frmLeilaoDocumentosImprimir.dfnLeilao,
@TipoImpressao = "S",
@UFDeclaracao = :frmLeilaoDocumentosImprimir.sUFSucata ,
@Spid = :frmLeilaoDocumentosImprimir.nSpid' ,

':frmLeilaoDocumentosImprimir.sPlaca,
:frmLeilaoDocumentosImprimir.sUFPlaca,
:frmLeilaoDocumentosImprimir.nRenavam,
:frmLeilaoDocumentosImprimir.sChassi,
:frmLeilaoDocumentosImprimir.sMarcaModelo,
:frmLeilaoDocumentosImprimir.sAnoFab,
:frmLeilaoDocumentosImprimir.sCor,
:frmLeilaoDocumentosImprimir.NumLeilao,
:frmLeilaoDocumentosImprimir.DataLeilao,
:frmLeilaoDocumentosImprimir.Lote,
:frmLeilaoDocumentosImprimir.nClassificacaoLeilao,
:frmLeilaoDocumentosImprimir.sClassificacaoLeilao,
:frmLeilaoDocumentosImprimir.Arrematante,
:frmLeilaoDocumentosImprimir.CPFCGC,
:frmLeilaoDocumentosImprimir.sNumDocArrematante,
:frmLeilaoDocumentosImprimir.nOrgaoAutuante,
:frmLeilaoDocumentosImprimir.sLinha' )
.head 7 +  If SqlExecute( hSqlSucata )
.head 8 -  Call SqlGetResultSetCount( hSqlSucata, nResultSet2 )
.head 6 -  ! Call fMPSDisconnect( hSqlSucata )
.head 3 +  Function: fDecSucata
.head 4 -  Description: Veiculos selecionados na tabela
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hQrp
.head 4 +  Actions
.head 5 -  !
.head 5 +  If nOrgaoAutuante = 117200
.head 6 -  Set sNomeQRP = 'leidecSucata_DER.qrp'
.head 6 +  If not SalFileOpen ( hWndSucata, sNomeQRP, OF_Exist )
.head 7 -  Set lParam = 5
.head 7 -  Call ValidarQRP(sNomeQRP, lParam)
.head 7 -  Return FALSE
.head 6 -  Call SalReportPrint( hWndForm, sNomeQRP,

'sGlobalSecretaria, 		sGlobalDetran, 	 nGlobalSetor, 	sGlobalSetor,
SqlUser, 			sPlaca,		 sChassi,		sMarcaModelo,
sAnoFab,			sCor,		 Lote,		Arrematante,
sNomeUsuario, 		NumLeilao, 	 DataLeilao,	CPFCGC,
Identidade,		sClassificacaoLeilao, sUFPlaca ' ,

'Secretaria, 		Detran, 		 Setor, 		DescSetor,
Usuario,			Placa,		 Chassi,		MarcaModelo,
AnoFab,			Cor,		 Lote,		Arrematante,
 NomeUsuario,		NumLeilao, 	 DataLeilao,	CPFCGC,
Identidade,		Classificacao,	 UFPlaca '  ,
1, RPT_PrintAll,0,0,nErro)
.head 6 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------!
.head 5 +  Else If nOrgaoAutuante= 225210
.head 6 -  Set nRetorno = 1
.head 6 -  Set nControle = 2
.head 6 -  Set sNomeQRP = 'leidecSucata_Petro.qrp'
.head 6 +  If not SalFileOpen ( hWndSucata, sNomeQRP, OF_Exist )
.head 7 -  Set lParam = 5
.head 7 -  Call ValidarQRP(sNomeQRP, lParam)
.head 7 -  Return FALSE
.head 6 -  Call fCapturaDadosAssinatura( 	picFotoAssinatura, sFotoAssinatura, sNomeAssinatura, sCargoAssinatura,
			sNomeQRP, 0, sSituacao)
.head 6 -  Call SalReportPrint( hWndForm, sNomeQRP,

'sGlobalSecretaria, 		sGlobalDetran, 	 nGlobalSetor, 	sGlobalSetor,
SqlUser, 			sPlaca,		 sChassi,		sMarcaModelo,
sAnoFab,			sCor,		 Lote,		Arrematante,
sNomeUsuario, 		NumLeilao, 	 DataLeilao,	CPFCGC,
Identidade,		sClassificacaoLeilao, sUFPlaca,	sLinha,
sFotoAssinatura,		sNomeAssinatura,	 sCargoAssinatura',

'Secretaria, 		Detran, 		 Setor, 		DescSetor,
Usuario,			Placa,		 Chassi,		MarcaModelo,
AnoFab,			Cor,		 Lote,		Arrematante,
NomeUsuario,		NumLeilao, 	 DataLeilao,	CPFCGC,
Identidade,		Classificacao,	 UFPlaca, 		Linha,
FotoAssinatura,		NomeAssinatura,	 CargoAssinatura',
1, RPT_PrintAll,0,0,nErro)
.head 6 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------!
.head 5 +  Else
.head 6 -  Set nRetorno = 1
.head 6 -  Set nControle = 2
.head 6 -  Set sNomeQRP = 'leidecSucata.qrp'
.head 6 +  If not SalFileOpen ( hWndSucata, sNomeQRP, OF_Exist )
.head 7 -  Set lParam = 5
.head 7 -  Call ValidarQRP(sNomeQRP, lParam)
.head 7 -  Return FALSE
.head 6 -  Call fCapturaDadosAssinatura( 	picFotoAssinatura, sFotoAssinatura, sNomeAssinatura, sCargoAssinatura,
			sNomeQRP, 0, sSituacao)
.head 6 -  Call SalReportPrint( hWndForm, sNomeQRP,

'sGlobalSecretaria, 		sGlobalDetran, 	nGlobalSetor, 	sGlobalSetor,
SqlUser, 			sPlaca,		sChassi,		sMarcaModelo,
sAnoFab,			sCor,		Lote,		Arrematante,
sNomeUsuario, 		NumLeilao, 	DataLeilao,	CPFCGC,
Identidade,		sClassificacaoLeilao,sUFPlaca,		sLinha,
sFotoAssinatura,		sNomeAssinatura,	sCargoAssinatura',

'Secretaria, 		Detran, 		Setor, 		DescSetor,
Usuario,			Placa,		Chassi,		MarcaModelo,
AnoFab,			Cor,		Lote,		Arrematante,
 NomeUsuario ,		NumLeilao, 	DataLeilao,	CPFCGC,
Identidade,		Classificacao,	UFPlaca, 		Linha,
FotoAssinatura,		NomeAssinatura,	CargoAssinatura',
1, RPT_PrintAll,0,0,nErro)
.head 5 -  !
.head 3 +  ! Function: fDecSucata
.head 4 -  Description: Veiculos selecionados na tabela
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Window Handle: hQrp
.head 4 +  Actions 
.head 5 -  !
.head 5 +  If nOrgaoAutuante = 117200
.head 6 -  Set sNomeQRP = 'leidecSucata_DER.qrp'
.head 6 +  If not SalFileOpen ( hWndSucata, sNomeQRP, OF_Exist )
.head 7 -  Set lParam = 5
.head 7 -  Call ValidarQRP(sNomeQRP, lParam)
.head 7 -  Return FALSE
.head 6 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------!
.head 6 -  Call SalReportPrintToFile( hWndForm, sNomeQRP, 'D:\\TESTE\\Relat', 
'sGlobalSecretaria, 		sGlobalDetran, 	 nGlobalSetor, 	sGlobalSetor,
SqlUser, 			sPlaca,		 sChassi,		sMarcaModelo,
sAnoFab,			sCor,		 Lote,		Arrematante,
sNomeUsuario, 		NumLeilao, 	 DataLeilao,	CPFCGC,
Identidade,		sClassificacaoLeilao, sUFPlaca ' ,

'Secretaria, 		Detran, 		 Setor, 		DescSetor,
Usuario,			Placa,		 Chassi,		MarcaModelo,
AnoFab,			Cor,		 Lote,		Arrematante,
 NomeUsuario,		NumLeilao, 	 DataLeilao,	CPFCGC,
Identidade,		Classificacao,	 UFPlaca ' , 
 1, RPT_PrintAll, 1, 9999999, TRUE, nErro )
.head 6 -  ! ---------
.head 6 -  ! ---------
.head 6 -  ! ---------
.head 6 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------!
.head 5 +  Else If nOrgaoAutuante= 225210
.head 6 -  Set nRetorno = 1
.head 6 -  Set nControle = 2
.head 6 -  Set sNomeQRP = 'leidecSucata_Petro.qrp'
.head 6 +  If not SalFileOpen ( hWndSucata, sNomeQRP, OF_Exist )
.head 7 -  Set lParam = 5
.head 7 -  Call ValidarQRP(sNomeQRP, lParam)
.head 7 -  Return FALSE
.head 6 -  Call fCapturaDadosAssinatura( 	picFotoAssinatura, sFotoAssinatura, sNomeAssinatura, sCargoAssinatura,
			sNomeQRP, 0, sSituacao)
.head 6 -  Call SalReportPrintToFile( hWndForm, sNomeQRP, 'D:\\TESTE\\Relat', 
'sGlobalSecretaria, 		sGlobalDetran, 	 nGlobalSetor, 	sGlobalSetor,
SqlUser, 			sPlaca,		 sChassi,		sMarcaModelo,
sAnoFab,			sCor,		 Lote,		Arrematante,
sNomeUsuario, 		NumLeilao, 	 DataLeilao,	CPFCGC,
Identidade,		sClassificacaoLeilao, sUFPlaca,	sLinha,
sFotoAssinatura,		sNomeAssinatura,	 sCargoAssinatura',

'Secretaria, 		Detran, 		 Setor, 		DescSetor,
Usuario,			Placa,		 Chassi,		MarcaModelo,
AnoFab,			Cor,		 Lote,		Arrematante,
NomeUsuario,		NumLeilao, 	 DataLeilao,	CPFCGC,
Identidade,		Classificacao,	 UFPlaca, 		Linha,
FotoAssinatura,		NomeAssinatura,	 CargoAssinatura',
 1, RPT_PrintAll, 1, 9999999, TRUE, nErro )
.head 6 -  ! ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------!
.head 5 +  Else 
.head 6 -  Set nRetorno = 1
.head 6 -  Set nControle = 2
.head 6 -  Set sNomeQRP = 'leidecSucata.qrp'
.head 6 +  If not SalFileOpen ( hWndSucata, sNomeQRP, OF_Exist )
.head 7 -  Set lParam = 5
.head 7 -  Call ValidarQRP(sNomeQRP, lParam)
.head 7 -  Return FALSE
.head 6 -  Call fCapturaDadosAssinatura( 	picFotoAssinatura, sFotoAssinatura, sNomeAssinatura, sCargoAssinatura,
			sNomeQRP, 0, sSituacao)
.head 6 -  Call SalReportPrintToFile( hWndForm, sNomeQRP, 'D:\\TESTE\\Relat', 
'sGlobalSecretaria, 		sGlobalDetran, 	nGlobalSetor, 	sGlobalSetor,
SqlUser, 			sPlaca,		sChassi,		sMarcaModelo,
sAnoFab,			sCor,		Lote,		Arrematante,
sNomeUsuario, 		NumLeilao, 	DataLeilao,	CPFCGC,
Identidade,		sClassificacaoLeilao,sUFPlaca,		sLinha,
sFotoAssinatura,		sNomeAssinatura,	sCargoAssinatura',

'Secretaria, 		Detran, 		Setor, 		DescSetor,
Usuario,			Placa,		Chassi,		MarcaModelo,
AnoFab,			Cor,		Lote,		Arrematante,
 NomeUsuario ,		NumLeilao, 	DataLeilao,	CPFCGC,
Identidade,		Classificacao,	UFPlaca, 		Linha,
FotoAssinatura,		NomeAssinatura,	CargoAssinatura',
 1, RPT_PrintAll, 1, 9999999, TRUE, nErro )
.head 5 -  !
.head 3 +  Function: fLimpaTmpVeiculos
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If fMPSConnect( hSqlSucataE )
.head 6 +  If fMPSPrepareProc( hSqlSucataE, 'exec dbvcen..tmpVeiculoSelecionadoE
		@Spid = :frmLeilaoDocumentosImprimir.nSpid' , '' )
.head 7 +  Call SqlExecute( hSqlSucataE )
.head 8 -  ! Call SqlGetResultSetCount( hSqlSucataE, nResultSet2 )
.head 8 -  ! Call SqlFetchNext( hSqlSucataE, nErro )
.head 6 -  Call fMPSDisconnect( hSqlSucataE )
.head 5 -  Set nSpid = NUMBER_Null
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  Window Handle: hWndRelVeicGeral
.head 3 -  Window Handle: hWndRelVeicDebito
.head 3 -  Window Handle: hWndRelVeicRestricao
.head 3 -  Number: nErro
.head 3 -  String: sNomeQRP
.head 3 -  Number: nRetorno
.head 3 -  Number: nResultSet
.head 3 -  Number: nResultSet2
.head 3 -  String: sSaida
.head 3 -  String: sDeviceDef
.head 3 -  String: sDevice
.head 3 -  String: sDriverDef
.head 3 -  String: sDriver
.head 3 -  String: sPortaDef
.head 3 -  String: sPorta
.head 3 -  FunctionalVar: oArquivo
.head 4 -  Class: cArquivo
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  Window Handle: hWndRelatorio
.head 3 -  Window Handle: hWndRetorno
.head 3 -  Window Handle: hWndSucata
.head 3 -  Sql Handle: hSqlSucata
.head 3 -  Sql Handle: hSqlSucataE
.head 3 -  Number: nParamArray[*]
.head 3 -  Number: nFlags
.head 3 -  Number: nLinha
.head 3 -  Number: nCodVeic
.head 3 -  String: sTipoPessoa
.head 3 -  Number: nCodConsultaBin
.head 3 -  String: sTotalizar
.head 3 -  Number: nRecurso
.head 3 -  Number: nNumSeqTransacaoBin
.head 3 -  Boolean: bVeiculoBin
.head 3 -  Number: nPermissaoExtratoDebito
.head 3 -  Number: nPermissaoExtratoGeral
.head 3 -  Number: nSpid
.head 3 -  String: sUF
.head 3 -  String: sUFSucata
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! ! -  Para criação das telas - - - - - - - - - - - - -
.head 3 -  Number: nLeft
.head 3 -  Number: nTop
.head 3 -  Number: nWidth
.head 3 -  Number: nHeight
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! ! -  Para criação das telas - - - - - - - - - - - - -
.head 3 -  String: sNomeVistoriador
.head 3 -  Number: nMatriculaVistoriador
.head 3 -  String: sLeiloeiro
.head 3 -  String: Deposito
.head 3 -  String: Identidade
.head 3 -  String: sNomeUsuario
.head 3 -  Sql Handle: hSqlRec
.head 3 -  Sql Handle: hSqlCaixa
.head 3 -  Number: nControle
.head 3 -  Number: nClassificacaoVeiculo
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! - - Foto assinatura gestor atual - - - - - - - - - - -
.head 3 -  Long String: sFotoAssinatura
.head 3 -  String: sNomeAssinatura
.head 3 -  String: sCargoAssinatura
.head 3 -  String: sSituacao
.head 3 -  String: sTipoImp
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! - - -SUCATA - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  String: sPlaca
.head 3 -  String: sUFPlaca
.head 3 -  Number: nRenavam
.head 3 -  String: sChassi
.head 3 -  String: sMarcaModelo
.head 3 -  String: sAnoFab
.head 3 -  String: sCor
.head 3 -  Number: NumLeilao
.head 3 -  Date/Time: DataLeilao
.head 3 -  Number: Lote
.head 3 -  Number: nClassificacaoLeilao
.head 3 -  String: sClassificacaoLeilao
.head 3 -  String: Arrematante
.head 3 -  String: CPFCGC
.head 3 -  String: sNumDocArrematante
.head 3 -  Number: nOrgaoAutuante
.head 3 -  String: sLinha
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 3 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendClassMessage( SAM_CreateComplete, wParam, lParam )
.head 4 -  !
.head 4 -  Call SalEnableWindow( cbDebito )
.head 4 -  Call SalEnableWindow( cbRestricao )
.head 4 -  Call SalEnableWindow( cbGeral )
.head 4 -  Call SalEnableWindow( cbSucata )
.head 4 -  !
.head 4 -  Call SalDisableWindow( pbPesquisar )
.head 4 -  Call SalDisableWindow( rbImpressora )
.head 4 -  Call SalDisableWindow( rbTela )
.head 4 -  Call SalDisableWindow( pbImprimir )
.head 4 -  Call SalDisableWindow( pbImpressoras )
.head 4 -  Call SalDisableWindow( tblRetorno )
.head 4 -  Set nPermissaoExtratoGeral = fObtemPermissao('frmConsultaVeiculoG')
.head 4 +  If nPermissaoExtratoGeral = 0
.head 5 -  Set nPermissaoExtratoGeral = 1
.head 3 +  On SAM_ReportFetchInit
.head 4 +  ! If cbSucata
.head 5 +  If fMPSConnect( hSqlSucata )
.head 6 -  Call fMPSPrepareProc( hSqlSucata, 'exec dbvcen..LeilaoDocumentosImprimir
@nLeilao    =  :frmLeilaoDocumentosImprimir.dfnLeilao,
@TipoImpressao  = "S",
@UFDeclaracao = :frmLeilaoDocumentosImprimir.sUFSucata ,
@Spid = :frmLeilaoDocumentosImprimir.nSpid  ' ,
':frmLeilaoDocumentosImprimir.sPlaca,
:frmLeilaoDocumentosImprimir.sUFPlaca,
:frmLeilaoDocumentosImprimir.nRenavam,
:frmLeilaoDocumentosImprimir.sChassi,
:frmLeilaoDocumentosImprimir.sMarcaModelo,
:frmLeilaoDocumentosImprimir.sAnoFab,
:frmLeilaoDocumentosImprimir.sCor,
:frmLeilaoDocumentosImprimir.NumLeilao,
:frmLeilaoDocumentosImprimir.DataLeilao,
:frmLeilaoDocumentosImprimir.Lote,
:frmLeilaoDocumentosImprimir.nClassificacaoLeilao,
:frmLeilaoDocumentosImprimir.sClassificacaoLeilao,
:frmLeilaoDocumentosImprimir.Arrematante,
:frmLeilaoDocumentosImprimir.CPFCGC,
:frmLeilaoDocumentosImprimir.sNumDocArrematante,
:frmLeilaoDocumentosImprimir.nOrgaoAutuante,
:frmLeilaoDocumentosImprimir.sLinha' )
.head 6 -  ! Call fMPSDisconnect( hSqlSucata )
.head 6 -  Return SqlExecute( hSqlSucata )
.head 4 -  Return TRUE
.head 3 +  On MSG_Limpa
.head 4 -  Call SalSendClassMessage( MSG_Limpa, wParam, lParam )
.head 4 -  Call SalEnableWindow( cbDebito )
.head 4 -  Call SalEnableWindow( cbRestricao )
.head 4 -  Call SalEnableWindow( cbGeral )
.head 4 -  Call SalEnableWindow( cbSucata )
.head 4 -  !
.head 4 -  Call SalDisableWindow( pbPesquisar )
.head 4 -  Call SalDisableWindow( rbImpressora )
.head 4 -  Call SalDisableWindow( rbTela )
.head 4 -  Call SalDisableWindow( pbImprimir )
.head 4 -  Call SalDisableWindow( pbImpressoras )
.head 4 -  Call SalDisableWindow( tblRetorno )
.head 4 -  !
.head 4 +  If hWndRelVeicGeral != hWndNULL
.head 5 -  Call SalSendMsg( hWndRelVeicGeral, MSG_Sai, 0, 0 )
.head 4 +  If hWndRelVeicDebito != hWndNULL
.head 5 -  Call SalSendMsg( hWndRelVeicDebito, MSG_Sai, 0, 0 )
.head 4 +  If hWndRelVeicRestricao != hWndNULL
.head 5 -  Call SalSendMsg( hWndRelVeicRestricao, MSG_Sai, 0, 0 )
.head 4 +  If hWndSucata != hWndNULL
.head 5 -  Call SalSendMsg( hWndSucata, MSG_Sai, 0, 0 )
.head 4 -  !
.head 4 +  If nSpid != 0 and nSpid != NUMBER_Null
.head 5 -  Call fLimpaTmpVeiculos()
.head 3 +  On SAM_ReportFetchNext
.head 4 -  Call SqlFetchNext( hSqlSucata, lParam )
.head 4 +  If lParam =FETCH_EOF
.head 5 -  Return FALSE
.head 4 -  Return TRUE
.head 3 +  On SAM_Destroy
.head 4 +  If hWndRelVeicGeral != hWndNULL
.head 5 -  Call SalSendMsg( hWndRelVeicGeral, MSG_Sai, 0, 0 )
.head 4 +  If hWndRelVeicDebito != hWndNULL
.head 5 -  Call SalSendMsg( hWndRelVeicDebito, MSG_Sai, 0, 0 )
.head 4 +  If hWndRelVeicRestricao != hWndNULL
.head 5 -  Call SalSendMsg( hWndRelVeicRestricao, MSG_Sai, 0, 0 )
.head 4 +  If hWndSucata != hWndNULL
.head 5 -  Call SalSendMsg( hWndSucata, MSG_Sai, 0, 0 )
.head 4 -  Call SalSendClassMessage( SAM_Destroy, wParam, lParam )
.head 4 -  Call HabilitacaoNome( 'mdipbConsVeiculo', TRUE )
.head 0 -  
.head 0 -  

